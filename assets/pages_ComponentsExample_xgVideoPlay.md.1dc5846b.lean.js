import"./chunks/index.4ed993c7.js";import{E as Dt,B as kt,S as Na,U as Bt,D as Mr,a as Yr,b as It,s as un,c as Hn,W as Ps,A as Aa,d as Ua,P as ts,u as jt,T as za,e as Oa,f as Ja,g as nt}from"./chunks/index.min.89c11ce1.js";import{E as Er,a as Ir,b as ns,c as ss,d as _r,e as Pr}from"./chunks/index.50faa8e6.js";import{E as Ba}from"./chunks/index.4b236f90.js";import{E as Kr}from"./chunks/index.3ed43d3d.js";import{g as ja}from"./chunks/commonjsHelpers.de833af9.js";import{a5 as Nn,h as rs,j as Hr,o as _t,b as as,w as ke,N as Se,l as Ze,c as Gs,K as Nr,L as Ar,k as Xt,_ as Qa,p as qa,m as $a,J as ei,a as ti,X as ni}from"./chunks/framework.b431710b.js";import"./chunks/use-form-item.197c0e3b.js";import"./chunks/index.92ea372b.js";import"./chunks/plugin-vue_export-helper.e0d3cf86.js";import"./chunks/index.410b1e43.js";import"./chunks/typescript.7063b2ea.js";import"./chunks/aria.60e0cdc6.js";import"./chunks/index.e86dced2.js";import"./chunks/index.479547c1.js";import"./chunks/event.8e91c63d.js";function si(a,i){var t=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(t!=null){var n,e,s,r,l=[],o=!0,u=!1;try{if(s=(t=t.call(a)).next,i===0){if(Object(t)!==t)return;o=!1}else for(;!(o=(n=s.call(t)).done)&&(l.push(n.value),l.length!==i);o=!0);}catch(c){u=!0,e=c}finally{try{if(!o&&t.return!=null&&(r=t.return(),Object(r)!==r))return}finally{if(u)throw e}}return l}}function Ks(a,i){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);i&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),t.push.apply(t,n)}return t}function ie(a){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?arguments[i]:{};i%2?Ks(Object(t),!0).forEach(function(n){k(a,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):Ks(Object(t)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(t,n))})}return a}function A(){A=function(){return a};var a={},i=Object.prototype,t=i.hasOwnProperty,n=Object.defineProperty||function(h,d,y){h[d]=y.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(h,d,y){return Object.defineProperty(h,d,{value:y,enumerable:!0,configurable:!0,writable:!0}),h[d]}try{o({},"")}catch{o=function(d,y,L){return d[y]=L}}function u(h,d,y,L){var Z=d&&d.prototype instanceof m?d:m,W=Object.create(Z.prototype),R=new I(L||[]);return n(W,"_invoke",{value:S(h,y,R)}),W}function c(h,d,y){try{return{type:"normal",arg:h.call(d,y)}}catch(L){return{type:"throw",arg:L}}}a.wrap=u;var p={};function m(){}function f(){}function b(){}var v={};o(v,s,function(){return this});var g=Object.getPrototypeOf,X=g&&g(g(E([])));X&&X!==i&&t.call(X,s)&&(v=X);var D=b.prototype=m.prototype=Object.create(v);function F(h){["next","throw","return"].forEach(function(d){o(h,d,function(y){return this._invoke(d,y)})})}function w(h,d){function y(Z,W,R,_){var K=c(h[Z],h,W);if(K.type!=="throw"){var Y=K.arg,J=Y.value;return J&&typeof J=="object"&&t.call(J,"__await")?d.resolve(J.__await).then(function(P){y("next",P,R,_)},function(P){y("throw",P,R,_)}):d.resolve(J).then(function(P){Y.value=P,R(Y)},function(P){return y("throw",P,R,_)})}_(K.arg)}var L;n(this,"_invoke",{value:function(Z,W){function R(){return new d(function(_,K){y(Z,W,_,K)})}return L=L?L.then(R,R):R()}})}function S(h,d,y){var L="suspendedStart";return function(Z,W){if(L==="executing")throw new Error("Generator is already running");if(L==="completed"){if(Z==="throw")throw W;return U()}for(y.method=Z,y.arg=W;;){var R=y.delegate;if(R){var _=G(R,y);if(_){if(_===p)continue;return _}}if(y.method==="next")y.sent=y._sent=y.arg;else if(y.method==="throw"){if(L==="suspendedStart")throw L="completed",y.arg;y.dispatchException(y.arg)}else y.method==="return"&&y.abrupt("return",y.arg);L="executing";var K=c(h,d,y);if(K.type==="normal"){if(L=y.done?"completed":"suspendedYield",K.arg===p)continue;return{value:K.arg,done:y.done}}K.type==="throw"&&(L="completed",y.method="throw",y.arg=K.arg)}}}function G(h,d){var y=d.method,L=h.iterator[y];if(L===void 0)return d.delegate=null,y==="throw"&&h.iterator.return&&(d.method="return",d.arg=void 0,G(h,d),d.method==="throw")||y!=="return"&&(d.method="throw",d.arg=new TypeError("The iterator does not provide a '"+y+"' method")),p;var Z=c(L,h.iterator,d.arg);if(Z.type==="throw")return d.method="throw",d.arg=Z.arg,d.delegate=null,p;var W=Z.arg;return W?W.done?(d[h.resultName]=W.value,d.next=h.nextLoc,d.method!=="return"&&(d.method="next",d.arg=void 0),d.delegate=null,p):W:(d.method="throw",d.arg=new TypeError("iterator result is not an object"),d.delegate=null,p)}function T(h){var d={tryLoc:h[0]};1 in h&&(d.catchLoc=h[1]),2 in h&&(d.finallyLoc=h[2],d.afterLoc=h[3]),this.tryEntries.push(d)}function C(h){var d=h.completion||{};d.type="normal",delete d.arg,h.completion=d}function I(h){this.tryEntries=[{tryLoc:"root"}],h.forEach(T,this),this.reset(!0)}function E(h){if(h){var d=h[s];if(d)return d.call(h);if(typeof h.next=="function")return h;if(!isNaN(h.length)){var y=-1,L=function Z(){for(;++y<h.length;)if(t.call(h,y))return Z.value=h[y],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return L.next=L}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=b,n(D,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:f,configurable:!0}),f.displayName=o(b,l,"GeneratorFunction"),a.isGeneratorFunction=function(h){var d=typeof h=="function"&&h.constructor;return!!d&&(d===f||(d.displayName||d.name)==="GeneratorFunction")},a.mark=function(h){return Object.setPrototypeOf?Object.setPrototypeOf(h,b):(h.__proto__=b,o(h,l,"GeneratorFunction")),h.prototype=Object.create(D),h},a.awrap=function(h){return{__await:h}},F(w.prototype),o(w.prototype,r,function(){return this}),a.AsyncIterator=w,a.async=function(h,d,y,L,Z){Z===void 0&&(Z=Promise);var W=new w(u(h,d,y,L),Z);return a.isGeneratorFunction(d)?W:W.next().then(function(R){return R.done?R.value:W.next()})},F(D),o(D,l,"Generator"),o(D,s,function(){return this}),o(D,"toString",function(){return"[object Generator]"}),a.keys=function(h){var d=Object(h),y=[];for(var L in d)y.push(L);return y.reverse(),function Z(){for(;y.length;){var W=y.pop();if(W in d)return Z.value=W,Z.done=!1,Z}return Z.done=!0,Z}},a.values=E,I.prototype={constructor:I,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!h)for(var d in this)d.charAt(0)==="t"&&t.call(this,d)&&!isNaN(+d.slice(1))&&(this[d]=void 0)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var d=this;function y(K,Y){return W.type="throw",W.arg=h,d.next=K,Y&&(d.method="next",d.arg=void 0),!!Y}for(var L=this.tryEntries.length-1;L>=0;--L){var Z=this.tryEntries[L],W=Z.completion;if(Z.tryLoc==="root")return y("end");if(Z.tryLoc<=this.prev){var R=t.call(Z,"catchLoc"),_=t.call(Z,"finallyLoc");if(R&&_){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}else if(R){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0)}else{if(!_)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}}}},abrupt:function(h,d){for(var y=this.tryEntries.length-1;y>=0;--y){var L=this.tryEntries[y];if(L.tryLoc<=this.prev&&t.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var Z=L;break}}Z&&(h==="break"||h==="continue")&&Z.tryLoc<=d&&d<=Z.finallyLoc&&(Z=null);var W=Z?Z.completion:{};return W.type=h,W.arg=d,Z?(this.method="next",this.next=Z.finallyLoc,p):this.complete(W)},complete:function(h,d){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&d&&(this.next=d),p},finish:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.finallyLoc===h)return this.complete(y.completion,y.afterLoc),C(y),p}},catch:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.tryLoc===h){var L=y.completion;if(L.type==="throw"){var Z=L.arg;C(y)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(h,d,y){return this.delegate={iterator:E(h),resultName:d,nextLoc:y},this.method==="next"&&(this.arg=void 0),p}},a}function gn(a){"@babel/helpers - typeof";return gn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},gn(a)}function Hs(a,i,t,n,e,s,r){try{var l=a[s](r),o=l.value}catch(u){t(u);return}l.done?i(o):Promise.resolve(o).then(n,e)}function se(a){return function(){var i=this,t=arguments;return new Promise(function(n,e){var s=a.apply(i,t);function r(o){Hs(s,n,e,r,l,"next",o)}function l(o){Hs(s,n,e,r,l,"throw",o)}r(void 0)})}}function ye(a,i){if(!(a instanceof i))throw new TypeError("Cannot call a class as a function")}function Ns(a,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,zr(n.key),n)}}function be(a,i,t){return i&&Ns(a.prototype,i),t&&Ns(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function k(a,i,t){return i=zr(i),i in a?Object.defineProperty(a,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[i]=t,a}function Tn(a,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(i&&i.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),i&&is(a,i)}function Zn(a){return Zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zn(a)}function is(a,i){return is=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},is(a,i)}function ri(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Q(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function ai(a,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q(a)}function kn(a){var i=ri();return function(){var n=Zn(a),e;if(i){var s=Zn(this).constructor;e=Reflect.construct(n,arguments,s)}else e=n.apply(this,arguments);return ai(this,e)}}function mt(a,i){return oi(a)||si(a,i)||Ur(a,i)||pi()}function ii(a){return li(a)||ui(a)||Ur(a)||ci()}function li(a){if(Array.isArray(a))return ls(a)}function oi(a){if(Array.isArray(a))return a}function ui(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Ur(a,i){if(a){if(typeof a=="string")return ls(a,i);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ls(a,i)}}function ls(a,i){(i==null||i>a.length)&&(i=a.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=a[t];return n}function ci(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pi(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function di(a,i){if(typeof a!="object"||a===null)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var n=t.call(a,i||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(a)}function zr(a){var i=di(a,"string");return typeof i=="symbol"?i:String(i)}function As(a,i){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);i&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),t.push.apply(t,n)}return t}function qt(a){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?arguments[i]:{};i%2?As(Object(t),!0).forEach(function(n){x(a,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):As(Object(t)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(t,n))})}return a}function fe(){fe=function(){return a};var a={},i=Object.prototype,t=i.hasOwnProperty,n=Object.defineProperty||function(h,d,y){h[d]=y.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(h,d,y){return Object.defineProperty(h,d,{value:y,enumerable:!0,configurable:!0,writable:!0}),h[d]}try{o({},"")}catch{o=function(d,y,L){return d[y]=L}}function u(h,d,y,L){var Z=d&&d.prototype instanceof m?d:m,W=Object.create(Z.prototype),R=new I(L||[]);return n(W,"_invoke",{value:S(h,y,R)}),W}function c(h,d,y){try{return{type:"normal",arg:h.call(d,y)}}catch(L){return{type:"throw",arg:L}}}a.wrap=u;var p={};function m(){}function f(){}function b(){}var v={};o(v,s,function(){return this});var g=Object.getPrototypeOf,X=g&&g(g(E([])));X&&X!==i&&t.call(X,s)&&(v=X);var D=b.prototype=m.prototype=Object.create(v);function F(h){["next","throw","return"].forEach(function(d){o(h,d,function(y){return this._invoke(d,y)})})}function w(h,d){function y(Z,W,R,_){var K=c(h[Z],h,W);if(K.type!=="throw"){var Y=K.arg,J=Y.value;return J&&typeof J=="object"&&t.call(J,"__await")?d.resolve(J.__await).then(function(P){y("next",P,R,_)},function(P){y("throw",P,R,_)}):d.resolve(J).then(function(P){Y.value=P,R(Y)},function(P){return y("throw",P,R,_)})}_(K.arg)}var L;n(this,"_invoke",{value:function(Z,W){function R(){return new d(function(_,K){y(Z,W,_,K)})}return L=L?L.then(R,R):R()}})}function S(h,d,y){var L="suspendedStart";return function(Z,W){if(L==="executing")throw new Error("Generator is already running");if(L==="completed"){if(Z==="throw")throw W;return U()}for(y.method=Z,y.arg=W;;){var R=y.delegate;if(R){var _=G(R,y);if(_){if(_===p)continue;return _}}if(y.method==="next")y.sent=y._sent=y.arg;else if(y.method==="throw"){if(L==="suspendedStart")throw L="completed",y.arg;y.dispatchException(y.arg)}else y.method==="return"&&y.abrupt("return",y.arg);L="executing";var K=c(h,d,y);if(K.type==="normal"){if(L=y.done?"completed":"suspendedYield",K.arg===p)continue;return{value:K.arg,done:y.done}}K.type==="throw"&&(L="completed",y.method="throw",y.arg=K.arg)}}}function G(h,d){var y=d.method,L=h.iterator[y];if(L===void 0)return d.delegate=null,y==="throw"&&h.iterator.return&&(d.method="return",d.arg=void 0,G(h,d),d.method==="throw")||y!=="return"&&(d.method="throw",d.arg=new TypeError("The iterator does not provide a '"+y+"' method")),p;var Z=c(L,h.iterator,d.arg);if(Z.type==="throw")return d.method="throw",d.arg=Z.arg,d.delegate=null,p;var W=Z.arg;return W?W.done?(d[h.resultName]=W.value,d.next=h.nextLoc,d.method!=="return"&&(d.method="next",d.arg=void 0),d.delegate=null,p):W:(d.method="throw",d.arg=new TypeError("iterator result is not an object"),d.delegate=null,p)}function T(h){var d={tryLoc:h[0]};1 in h&&(d.catchLoc=h[1]),2 in h&&(d.finallyLoc=h[2],d.afterLoc=h[3]),this.tryEntries.push(d)}function C(h){var d=h.completion||{};d.type="normal",delete d.arg,h.completion=d}function I(h){this.tryEntries=[{tryLoc:"root"}],h.forEach(T,this),this.reset(!0)}function E(h){if(h){var d=h[s];if(d)return d.call(h);if(typeof h.next=="function")return h;if(!isNaN(h.length)){var y=-1,L=function Z(){for(;++y<h.length;)if(t.call(h,y))return Z.value=h[y],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return L.next=L}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=b,n(D,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:f,configurable:!0}),f.displayName=o(b,l,"GeneratorFunction"),a.isGeneratorFunction=function(h){var d=typeof h=="function"&&h.constructor;return!!d&&(d===f||(d.displayName||d.name)==="GeneratorFunction")},a.mark=function(h){return Object.setPrototypeOf?Object.setPrototypeOf(h,b):(h.__proto__=b,o(h,l,"GeneratorFunction")),h.prototype=Object.create(D),h},a.awrap=function(h){return{__await:h}},F(w.prototype),o(w.prototype,r,function(){return this}),a.AsyncIterator=w,a.async=function(h,d,y,L,Z){Z===void 0&&(Z=Promise);var W=new w(u(h,d,y,L),Z);return a.isGeneratorFunction(d)?W:W.next().then(function(R){return R.done?R.value:W.next()})},F(D),o(D,l,"Generator"),o(D,s,function(){return this}),o(D,"toString",function(){return"[object Generator]"}),a.keys=function(h){var d=Object(h),y=[];for(var L in d)y.push(L);return y.reverse(),function Z(){for(;y.length;){var W=y.pop();if(W in d)return Z.value=W,Z.done=!1,Z}return Z.done=!0,Z}},a.values=E,I.prototype={constructor:I,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!h)for(var d in this)d.charAt(0)==="t"&&t.call(this,d)&&!isNaN(+d.slice(1))&&(this[d]=void 0)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var d=this;function y(K,Y){return W.type="throw",W.arg=h,d.next=K,Y&&(d.method="next",d.arg=void 0),!!Y}for(var L=this.tryEntries.length-1;L>=0;--L){var Z=this.tryEntries[L],W=Z.completion;if(Z.tryLoc==="root")return y("end");if(Z.tryLoc<=this.prev){var R=t.call(Z,"catchLoc"),_=t.call(Z,"finallyLoc");if(R&&_){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}else if(R){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0)}else{if(!_)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}}}},abrupt:function(h,d){for(var y=this.tryEntries.length-1;y>=0;--y){var L=this.tryEntries[y];if(L.tryLoc<=this.prev&&t.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var Z=L;break}}Z&&(h==="break"||h==="continue")&&Z.tryLoc<=d&&d<=Z.finallyLoc&&(Z=null);var W=Z?Z.completion:{};return W.type=h,W.arg=d,Z?(this.method="next",this.next=Z.finallyLoc,p):this.complete(W)},complete:function(h,d){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&d&&(this.next=d),p},finish:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.finallyLoc===h)return this.complete(y.completion,y.afterLoc),C(y),p}},catch:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.tryLoc===h){var L=y.completion;if(L.type==="throw"){var Z=L.arg;C(y)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(h,d,y){return this.delegate={iterator:E(h),resultName:d,nextLoc:y},this.method==="next"&&(this.arg=void 0),p}},a}function Ht(a){"@babel/helpers - typeof";return Ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Ht(a)}function Us(a,i,t,n,e,s,r){try{var l=a[s](r),o=l.value}catch(u){t(u);return}l.done?i(o):Promise.resolve(o).then(n,e)}function dt(a){return function(){var i=this,t=arguments;return new Promise(function(n,e){var s=a.apply(i,t);function r(o){Us(s,n,e,r,l,"next",o)}function l(o){Us(s,n,e,r,l,"throw",o)}r(void 0)})}}function _e(a,i){if(!(a instanceof i))throw new TypeError("Cannot call a class as a function")}function zs(a,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,Jr(n.key),n)}}function Pe(a,i,t){return i&&zs(a.prototype,i),t&&zs(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function x(a,i,t){return i=Jr(i),i in a?Object.defineProperty(a,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[i]=t,a}function an(a,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(i&&i.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),i&&$t(a,i)}function Rt(a){return Rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rt(a)}function $t(a,i){return $t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},$t(a,i)}function Or(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fn(a,i,t){return Or()?fn=Reflect.construct.bind():fn=function(e,s,r){var l=[null];l.push.apply(l,s);var o=Function.bind.apply(e,l),u=new o;return r&&$t(u,r.prototype),u},fn.apply(null,arguments)}function hi(a){return Function.toString.call(a).indexOf("[native code]")!==-1}function Sn(a){var i=typeof Map=="function"?new Map:void 0;return Sn=function(n){if(n===null||!hi(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof i<"u"){if(i.has(n))return i.get(n);i.set(n,e)}function e(){return fn(n,arguments,Rt(this).constructor)}return e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),$t(e,n)},Sn(a)}function mi(a,i){if(a==null)return{};var t={},n=Object.keys(a),e,s;for(s=0;s<n.length;s++)e=n[s],!(i.indexOf(e)>=0)&&(t[e]=a[e]);return t}function fi(a,i){if(a==null)return{};var t=mi(a,i),n,e;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);for(e=0;e<s.length;e++)n=s[e],!(i.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(a,n)&&(t[n]=a[n])}return t}function z(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function yi(a,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z(a)}function ln(a){var i=Or();return function(){var n=Rt(a),e;if(i){var s=Rt(this).constructor;e=Reflect.construct(n,arguments,s)}else e=n.apply(this,arguments);return yi(this,e)}}function bi(a,i){for(;!Object.prototype.hasOwnProperty.call(a,i)&&(a=Rt(a),a!==null););return a}function yn(){return typeof Reflect<"u"&&Reflect.get?yn=Reflect.get.bind():yn=function(i,t,n){var e=bi(i,t);if(e){var s=Object.getOwnPropertyDescriptor(e,t);return s.get?s.get.call(arguments.length<3?i:n):s.value}},yn.apply(this,arguments)}function vi(a,i){if(a){if(typeof a=="string")return Os(a,i);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Os(a,i)}}function Os(a,i){(i==null||i>a.length)&&(i=a.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=a[t];return n}function gi(a,i){var t=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!t){if(Array.isArray(a)||(t=vi(a))||i&&a&&typeof a.length=="number"){t&&(a=t);var n=0,e=function(){};return{s:e,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(o){throw o},f:e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,r=!1,l;return{s:function(){t=t.call(a)},n:function(){var o=t.next();return s=o.done,o},e:function(o){r=!0,l=o},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(r)throw l}}}}function Zi(a,i){if(typeof a!="object"||a===null)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var n=t.call(a,i||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(a)}function Jr(a){var i=Zi(a,"string");return typeof i=="symbol"?i:String(i)}function Et(){var a,i,t=new Promise(function(n,e){a=n,i=e});return t.used=!1,t.resolve=function(){return t.used=!0,a.apply(void 0,arguments)},t.reject=function(){return t.used=!0,i.apply(void 0,arguments)},t}function Yt(){try{return parseInt(performance.now(),10)}catch{return new Date().getTime()}}var me=function(){function a(){_e(this,a)}return Pe(a,null,[{key:"start",value:function(t){return!t||!t.length||t.length===1&&t.end(0)-t.start(0)<1e-6||t.length===1&&t.start(0)<0?0:t.start(0)}},{key:"end",value:function(t){return!t||!t.length||t.length===1&&t.end(0)-t.start(0)<1e-6?0:t.end(t.length-1)}},{key:"get",value:function(t){if(t)try{return t.buffered}catch{}}},{key:"buffers",value:function(t,n){if(!t||!t.length)return[];for(var e=[],s=0,r=t.length;s<r;s++){var l=e.length;if(!l||!n)e.push([t.start(s),t.end(s)]);else{var o=e[l-1],u=o[1],c=t.start(s);if(c-u<=n){var p=t.end(s);p>u&&(o[1]=p)}else e.push([t.start(s),t.end(s)])}}return e}},{key:"totalLength",value:function(t){return!t||!t.length?0:t.reduce(function(n,e){return n+=e[1]-e[0]},0)}},{key:"info",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var s=0,r=0,l=0,o=0,u=0,c=0,p=0,m=a.buffers(t,e),f=0,b=m.length;f<b;f++){var v=m[f];if(n+e>=v[0]&&n<=v[1])s=v[0],r=v[1],l=f;else if(n+e<v[0]){o=v[0],u=v[1];break}else n+e>v[1]&&(c=v[0],p=v[1])}return{start:s,end:r,index:l,buffers:m,nextStart:o,nextEnd:u,prevStart:c,prevEnd:p,currentTime:n,behind:n-s,remaining:r?r-n:0,length:a.totalLength&&a.totalLength(m)}}}]),a}(),Ye,q={MANIFEST:"manifest",NETWORK:"network",NETWORK_TIMEOUT:"network_timeout",NETWORK_FORBIDDEN:"network_forbidden",NETWORK_NOTFOUND:"network_notfound",NETWROK_RANGE_NOT_SATISFIABLE:"network_range_not_satisfiable",DEMUX:"demux",REMUX:"remux",MEDIA:"media",DRM:"drm",OTHER:"other",RUNTIME:"runtime",SUB_TYPES:{FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",MSE_FULL:"MSE_FULL",OPTION:"OPTION",DASH:"DASH",LICENSE:"LICENSE",CUSTOM_LICENSE:"CUSTOM_LICENSE",MSE_HIJACK:"MSE_HIJACK",EME_HIJACK:"EME_HIJACK",SIDX:"SIDX",NO_CANPLAY_ERROR:"NO_CANPLAY_ERROR",BUFFERBREAK_ERROR:"BUFFERBREAK_ERROR",WAITING_TIMEOUT_ERROR:"WAITINT_TIME_OUT_ERROR",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_CODEC_NOT_SUPPORTED:"MEDIA_ERR_CODEC_NOT_SUPPORTED",MEDIA_ERR_URL_EMPTY:"MEDIA_ERR_URL_EMPTY"}},An=(Ye={},x(Ye,q.MANIFEST,{HLS:1100,DASH:1200}),x(Ye,q.NETWORK,2100),x(Ye,q.NETWORK_TIMEOUT,2101),x(Ye,q.NETWORK_FORBIDDEN,2103),x(Ye,q.NETWORK_NOTFOUND,2104),x(Ye,q.NETWROK_RANGE_NOT_SATISFIABLE,2116),x(Ye,q.DEMUX,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400,SIDX:3410}),x(Ye,q.REMUX,{FMP4:4100,MP4:4200}),x(Ye,q.MEDIA,{MEDIA_ERR_ABORTED:5101,MEDIA_ERR_NETWORK:5102,MEDIA_ERR_DECODE:5103,MEDIA_ERR_SRC_NOT_SUPPORTED:5104,MEDIA_ERR_CODEC_NOT_SUPPORTED:5105,MEDIA_ERR_URL_EMPTY:5106,MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202,MSE_FULL:5203,MSE_HIJACK:5204,EME_HIJACK:5301}),x(Ye,q.DRM,{LICENSE:7100,CUSTOM_LICENSE:7200}),x(Ye,q.OTHER,8e3),x(Ye,q.RUNTIME,{NO_CANPLAY_ERROR:9001,BUFFERBREAK_ERROR:9002,WAITING_TIMEOUT_ERROR:9003}),Ye),pe=function(a){an(t,a);var i=ln(t);function t(n,e,s,r,l){var o;return _e(this,t),o=i.call(this,l||(s==null?void 0:s.message)),o.errorType=n===q.NETWORK_TIMEOUT?q.NETWORK:n,o.originError=s,o.ext=r,o.errorCode=An[n][e]||An[n],o.errorMessage=o.message,o.errorCode||(o.errorType=q.OTHER,o.errorCode=An[o.errorType]),o}return Pe(t,null,[{key:"create",value:function(e,s,r,l,o){return e instanceof t?e:(e instanceof Error&&(r=e,e=""),e||(e=q.OTHER),new t(e,s,r,l,o))}},{key:"network",value:function(e){var s;return new t(e!=null&&e.isTimeout?q.NETWORK_TIMEOUT:q.NETWORK,null,e instanceof Error?e:null,{url:e==null?void 0:e.url,response:e==null?void 0:e.response,httpCode:e==null||(s=e.response)===null||s===void 0?void 0:s.status})}}]),t}(Sn(Error)),Si=typeof window<"u",cn={DEBUG:1,LOG:2,WARN:3,ERROR:4},Li=200*1024,Xi=["Boolean","Number","String","Undefined","Null","Date","Object"],xe=function(){function a(i,t){_e(this,a),this.name=i||"",this._prefix="[".concat(this.name,"]"),a.disabled=(t==null?void 0:t.disabled)||!0,this.logCacheLevel=(t==null?void 0:t.logCacheLevel)||3,this.logMaxSize=(t==null?void 0:t.logMaxSize)||Li,this.logSize=0,this.logTextArray=[]}return Pe(a,[{key:"debug",value:function(){for(var t,n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];this.logCache.apply(this,[cn.DEBUG].concat(e)),!a.disabled&&(t=console).debug.apply(t,[this._prefix,zt()].concat(e))}},{key:"log",value:function(){for(var t,n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];this.logCache.apply(this,[cn.LOG].concat(e)),!a.disabled&&(t=console).log.apply(t,[this._prefix,zt()].concat(e))}},{key:"warn",value:function(){for(var t,n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];this.logCache.apply(this,[cn.WARN].concat(e)),!a.disabled&&(t=console).warn.apply(t,[this._prefix,zt()].concat(e))}},{key:"error",value:function(){for(var t,n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];this.logCache.apply(this,[cn.ERROR].concat(e)),!a.disabled&&(t=console).error.apply(t,[this._prefix,zt()].concat(e))}},{key:"logCache",value:function(t){if(!(t<this.logCacheLevel)){var n="";try{for(var e=arguments.length,s=new Array(e>1?e-1:0),r=1;r<e;r++)s[r-1]=arguments[r];var l=s.map(function(u){return Br(u)});n=this._prefix+zt()+JSON.stringify(l)}catch{return}if(t>=this.logCacheLevel&&(this.logSize+=n.length,this.logTextArray.push(n)),this.logSize>this.logMaxSize){var o=this.logTextArray.shift();this.logSize-=o.length}}}},{key:"getLogCache",value:function(){var t=this.logTextArray.join(`
`);return this.reset(),t}},{key:"reset",value:function(){this.logTextArray=[],this.logSize=0}},{key:"table",value:function(){var t;a.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}},{key:"setLogLevel",value:function(t){this.logCacheLevel=t}}],[{key:"enable",value:function(){a.disabled=!1}},{key:"disable",value:function(){a.disabled=!0}}]),a}();x(xe,"disabled",!0);function zt(){return new Date().toLocaleString()}function Di(a){if(Ht(a)!=="object")return a;var i=Object.prototype.toString.call(a).slice(8,-1);switch(i){case"Array":case"Uint8Array":case"ArrayBuffer":return i+"["+a.length+"]";case"Object":return"{}";default:return i}}function Br(a,i,t){t||(t=1),i||(i=2);var n={};if(!a||Ht(a)!=="object")return a;var e=Object.prototype.toString.call(a).slice(8,-1);if(!Xi.includes(e))return e;if(!(t>i)){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t===i?n[s]=Di(a[s]):Ht(a[s])==="object"?n[s]=Br(a[s],i,t+1):n[s]=a[s]);return n}}function wi(){try{return Si?window.MediaSource:null}catch{}}var pn=wi(),Ot={APPEND:"appendBuffer",REMOVE:"removeBuffer",UPDATE_DURATION:"updateDuration"},he=function(){function a(i,t){var n=this;_e(this,a),x(this,"media",null),x(this,"mediaSource",null),x(this,"_openPromise",Et()),x(this,"_queue",Object.create(null)),x(this,"_sourceBuffer",Object.create(null)),x(this,"_mseFullFlag",{}),x(this,"_st",0),x(this,"_opst",0),x(this,"_logger",null),x(this,"_config",null),x(this,"_url",null),x(this,"_onSBUpdateEnd",function(e){var s=n._queue[e];if(s){var r=s[0];if((r==null?void 0:r.opName)!==Ot.UPDATE_DURATION&&s.shift(),r){var l=Yt()-n._opst;n._logger.debug("UpdateEnd",r.opName,l,r.context),r.promise.resolve({name:r.opName,context:r.context,costtime:l}),n._startQueue(e)}}}),x(this,"_onSBUpdateError",function(e,s){var r=n._queue[e];if(r){var l=r[0];l&&(n._logger.error("UpdateError",e,l.opName,l.context),l.promise.reject(new pe(q.MEDIA,q.SUB_TYPES.MSE_APPEND_BUFFER,s)))}}),this._config=Object.assign(a.getDefaultConfig(),t),i&&this.bindMedia(i),this._logger=new xe("MSE"),this._config.openLog&&xe.enable()}return Pe(a,[{key:"isOpened",get:function(){var t;return((t=this.mediaSource)===null||t===void 0?void 0:t.readyState)==="open"}},{key:"url",get:function(){return this._url}},{key:"duration",get:function(){var t;return((t=this.mediaSource)===null||t===void 0?void 0:t.duration)||-1}},{key:"isEnded",get:function(){return this.mediaSource?this.mediaSource.readyState==="ended":!1}},{key:"isFull",value:function(t){return t?this._mseFullFlag[t]:this._mseFullFlag[a.VIDEO]}},{key:"updateDuration",value:function(t){var n=this,e=this.mediaSource&&this.mediaSource.duration>t;if(this.mediaSource&&this.mediaSource.duration>t){var s=0;if(Object.keys(this._sourceBuffer).forEach(function(r){try{s=Math.max(n.bufferEnd(r)||0,s)}catch{}}),t<s)return Promise.resolve()}return this._enqueueBlockingOp(function(){if(n.isEnded){n._logger.debug("[debug mse] setDuration ended");return}n.mediaSource&&(n.mediaSource.duration=t,n._logger.debug("[debug mse] setDuration"))},Ot.UPDATE_DURATION,{isReduceDuration:e})}},{key:"open",value:function(){var t=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var n=this.mediaSource,e=function s(){var r=Yt()-t._st;t._logger.debug("MSE OPEN",r),n.removeEventListener("sourceopen",s),t._openPromise.resolve({costtime:r})};n.addEventListener("sourceopen",e),this._openPromise=Et()}return this._openPromise}},{key:"bindMedia",value:function(){var i=dt(fe().mark(function n(e){var s=this,r,l;return fe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(this.mediaSource||this.media)){u.next=3;break}return u.next=3,this.unbindMedia();case 3:if(!(!e||!pn)){u.next=5;break}throw new Error("Param media or MediaSource does not exist");case 5:return this.media=e,r=this.mediaSource=new pn,this._st=Yt(),l=function c(){var p=Yt()-s._st;s._logger.debug("MSE OPEN"),r.removeEventListener("sourceopen",c),URL.revokeObjectURL(e.src),s._openPromise.resolve({costtime:p})},r.addEventListener("sourceopen",l),this._url=URL.createObjectURL(r),e.src=this._url,u.abrupt("return",this._openPromise);case 13:case"end":return u.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"unbindMedia",value:function(){var i=dt(fe().mark(function n(){var e=this,s,r,l;return fe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this._openPromise.used||this._openPromise.resolve(),s=this.mediaSource,s){if(Object.keys(this._queue).forEach(function(c){var p=e._queue[c];p&&p.forEach(function(m){return m.promise.resolve})}),r=!!this.media&&this.media.readyState>=1,l=s.readyState==="open",r&&l)try{s.endOfStream()}catch{}Object.keys(this._sourceBuffer).forEach(function(c){try{s.removeSourceBuffer(e._sourceBuffer[c])}catch{}})}if(this.media){this.media.removeAttribute("src");try{this.media.load()}catch{}this.media=null}this.mediaSource=null,this._openPromise=Et(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 8:case"end":return u.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"createSource",value:function(t,n){if(!(this._sourceBuffer[t]||!this.mediaSource)){var e;try{e=this._sourceBuffer[t]=this.mediaSource.addSourceBuffer(n)}catch(s){throw new pe(q.MEDIA,q.SUB_TYPES.MSE_ADD_SB,s)}e.mimeType=n,e.addEventListener("updateend",this._onSBUpdateEnd.bind(this,t)),e.addEventListener("error",this._onSBUpdateError.bind(this,t))}}},{key:"changeType",value:function(t,n){var e=this,s=this._sourceBuffer[t];return!this.mediaSource||!s||s.mimeType===n?Promise.resolve():typeof s.changeType!="function"?Promise.reject():this._enqueueOp(t,function(){s.changeType(n),s.mimeType=n,e._onSBUpdateEnd(t)},"changeType",{mimeType:n})}},{key:"createOrChangeSource",value:function(t,n){return this.createSource(t,n),this.changeType(t,n)}},{key:"append",value:function(t,n,e){var s=this;return!n||!n.byteLength||!this._sourceBuffer[t]?Promise.resolve():this._enqueueOp(t,function(){var r;!s.mediaSource||s.media.error||(s._logger.debug("MSE APPEND START",e),s._opst=Yt(),(r=s._sourceBuffer[t])===null||r===void 0||r.appendBuffer(n))},Ot.APPEND,e)}},{key:"remove",value:function(t,n,e,s){var r=this,l=!1;return this._mseFullFlag[t]&&(l=!0),this._enqueueOp(t,function(){if(!(!r.mediaSource||r.media.error)){var o=r._sourceBuffer[t];if(n>=e||!o){r._onSBUpdateEnd(t);return}r._opst=Yt(),r._logger.debug("MSE REMOVE START",t,n,e,s),o.remove(n,e)}},Ot.REMOVE,s,l)}},{key:"clearBuffer",value:function(t,n){var e=this,s;return Object.keys(this._sourceBuffer).forEach(function(r){s=e._enqueueOp(r,function(){if(!(!e.mediaSource||e.media.error)){var l=e._sourceBuffer[r];e._logger.debug("MSE clearBuffer START",r,t,n),l.remove(t,n)}},Ot.REMOVE)}),s}},{key:"clearAllBuffer",value:function(){var t=this,n;return Object.keys(this._sourceBuffer).forEach(function(e){n=t._enqueueOp(e,function(){if(!(!t.mediaSource||t.media.error)){var s=t._sourceBuffer[e];t._logger.debug("MSE clearAllBuffer START",e),s.remove(0,me.end(me.get(s)))}})}),n}},{key:"clearOpQueues",value:function(t,n){var e;this._logger.debug("MSE clearOpQueue START");var s=this._queue[t];if(n&&s){this._queue[t]=[];return}if(!(!s||!s[t]||s.length<5)){var r=[];s.forEach(function(l){l.context&&l.context.isinit&&r.push(l)}),this._queue[t]=s.slice(0,2),r.length>0&&(e=this._queue[t]).push.apply(e,r)}}},{key:"endOfStream",value:function(t){var n=this;return!this.mediaSource||this.mediaSource.readyState!=="open"?Promise.resolve():this._enqueueBlockingOp(function(){var e=n.mediaSource;!e||e.readyState!=="open"||(n._logger.debug("MSE endOfStream START"),t?e.endOfStream(t):e.endOfStream())},"endOfStream")}},{key:"setLiveSeekableRange",value:function(t,n){var e=this.mediaSource;t<0||n<t||!(e!=null&&e.setLiveSeekableRange)||e.readyState!=="open"||e.setLiveSeekableRange(t,n)}},{key:"getSourceBuffer",value:function(t){return this._sourceBuffer[t]}},{key:"buffered",value:function(t){return me.get(this._sourceBuffer[t])}},{key:"bufferStart",value:function(t){return me.start(this.buffered(t))}},{key:"bufferEnd",value:function(t){return me.end(this.buffered(t))}},{key:"_enqueueOp",value:function(t,n,e,s,r){var l=this;if(!this.mediaSource)return Promise.resolve();var o=this._queue[t]=this._queue[t]||[],u={exec:n,promise:Et(),opName:e,context:s};return r?(o.splice(0,0,u),this._mseFullFlag[t]=!1,this._startQueue(t)):o.push(u),this.isOpened||this.isEnded?o.length===1&&this._startQueue(t):this._openPromise.then(function(){o.length===1&&l._startQueue(t)}),u.promise}},{key:"_enqueueBlockingOp",value:function(){var i=dt(fe().mark(function n(e,s,r){var l=this,o,u;return fe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.mediaSource){p.next=2;break}return p.abrupt("return",Promise.resolve());case 2:if(o=Object.keys(this._sourceBuffer),o.length){p.next=5;break}return p.abrupt("return",e());case 5:return u=[],o.forEach(function(m){var f=l._queue[m],b=Et();u.push(b),f.push({exec:function(){b.resolve()},promise:b,opName:s,context:r}),f.length===1&&l._startQueue(m)}),p.abrupt("return",Promise.all(u).then(function(){try{return e()}finally{o.forEach(function(m){var f=l._queue[m],b=l._sourceBuffer[m];f==null||f.shift(),(!b||!b.updating)&&l._startQueue(m)})}}));case 8:case"end":return p.stop()}},n,this)}));function t(n,e,s){return i.apply(this,arguments)}return t}()},{key:"_startQueue",value:function(t){var n=this._queue[t];if(n){var e=n[0];if(e&&!this._mseFullFlag[t])try{e.exec()}catch(s){s&&s.message&&s.message.indexOf("SourceBuffer is full")>=0?(this._mseFullFlag[t]=!0,this._logger.error("[MSE error],  context,",e.context," ,name,",e.opName,",err,SourceBuffer is full"),e.promise.reject(new pe(q.MEDIA,q.SUB_TYPES.MSE_FULL,s))):(this._logger.error(s),e.promise.reject(new pe(q.MEDIA,q.SUB_TYPES.MSE_OTHER,s)),n.shift(),this._startQueue(t))}}}},{key:"setTimeoffset",value:function(t,n,e){var s=this;return this._enqueueOp(t,function(){n<0&&(n+=.001),s._sourceBuffer[t].timestampOffset=n,s._onSBUpdateEnd(t)},"setTimeoffset",e)}},{key:"abort",value:function(t,n){var e=this;return this.isOpened?this._enqueueOp(t,function(){e._sourceBuffer[t].abort(),e._onSBUpdateEnd(t)},"abort",n):Promise.resolve()}}],[{key:"getDefaultConfig",value:function(){return{openLog:!1}}},{key:"isSupported",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if(!pn)return!1;try{return pn.isTypeSupported(t)}catch(n){return this._logger.error(t,n),!1}}}]),a}();x(he,"VIDEO","video");x(he,"AUDIO","audio");var Wt={FETCH:"fetch",XHR:"xhr"},en={ARRAY_BUFFER:"arraybuffer",TEXT:"text",JSON:"json"},at=function(a){an(t,a);var i=ln(t);function t(n,e,s,r){var l;return _e(this,t),l=i.call(this,r),x(z(l),"retryCount",0),x(z(l),"isTimeout",!1),x(z(l),"loaderType",Wt.FETCH),x(z(l),"startTime",0),x(z(l),"endTime",0),x(z(l),"options",{}),l.url=n,l.request=e,l.response=s,l}return Pe(t)}(Sn(Error)),jr=Object.prototype.toString;function Gi(a){return a!==null&&Ht(a)==="object"}function Js(a){if(jr.call(a)!=="[object Object]")return!1;var i=Object.getPrototypeOf(a);return i===null||i===Object.prototype}function Fi(a){return jr.call(a)==="[object Date]"}function Qr(a){if(!(!a||a[0]===null||a[0]===void 0||a[0]===0&&(a[1]===null||a[1]===void 0))){var i="bytes="+a[0]+"-";return a[1]&&(i+=a[1]),i}}function Bs(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function qr(a,i){if(a){if(!i)return a;var t,n=Object.keys(i).map(function(s){if(t=i[s],t!=null)return Array.isArray(t)?s=s+"[]":t=[t],t.map(function(r){return Fi(r)?r=r.toISOString():Gi(r)&&(r=JSON.stringify(r)),"".concat(Bs(s),"=").concat(Bs(r))}).join("&")}).filter(Boolean).join("&");if(n){var e=a.indexOf("#");e!==-1&&(a=a.slice(0,e)),a+=(a.indexOf("?")===-1?"?":"&")+n}return a}}function os(a,i,t,n,e,s,r,l,o,u,c){e=e!=null?parseFloat(e):null,n=parseInt(n||"0",10),Number.isNaN(n)&&(n=0);var p={range:o,vid:u,index:l,contentLength:n,age:e,startTime:s,firstByteTime:r,endTime:Date.now(),priOptions:c};return{data:a,done:i,options:p,response:t}}function us(a,i){return Math.round(a*8*1e3/i/1024)}var M={ERROR:"error",TTFB:"core.ttfb",LOAD_START:"core.loadstart",LOAD_RESPONSE_HEADERS:"core.loadresponseheaders",LOAD_COMPLETE:"core.loadcomplete",LOAD_RETRY:"core.loadretry",SOURCEBUFFER_CREATED:"core.sourcebuffercreated",ANALYZE_DURATION_EXCEEDED:"core.analyzedurationexceeded",REMOVE_BUFFER:"core.removebuffer",BUFFEREOS:"core.buffereos",KEYFRAME:"core.keyframe",METADATA_PARSED:"core.metadataparsed",SEI:"core.sei",SEI_IN_TIME:"core.seiintime",FLV_SCRIPT_DATA:"core.flvscriptdata",LOWDECODE:"core.lowdecode",SWITCH_URL_SUCCESS:"core.switchurlsuccess",SWITCH_URL_FAILED:"core.switchurlfailed",SPEED:"core.speed",HLS_MANIFEST_LOADED:"core.hlsmanifestloaded",HLS_LEVEL_LOADED:"core.hlslevelloaded",DEMUXED_TRACK:"core.demuxedtrack",STREAM_EXCEPTION:"core.streamexception",LARGE_AV_FIRST_FRAME_GAP_DETECT:"LARGE_AV_FIRST_FRAME_GAP_DETECT",LARGE_VIDEO_DTS_GAP_DETECT:"LARGE_VIDEO_DTS_GAP_DETECT",LARGE_AUDIO_DTS_GAP_DETECT:"LARGE_AUDIO_DTS_GAP_DETECT",AUDIO_GAP_DETECT:"AUDIO_GAP_DETECT",AUDIO_OVERLAP_DETECT:"AUDIO_OVERLAP_DETECT",MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT:"MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT",REAL_TIME_SPEED:"real_time_speed"},js=2*1024*1024,cs=function(a){an(t,a);var i=ln(t);function t(){var n;return _e(this,t),n=i.call(this),x(z(n),"_abortController",null),x(z(n),"_timeoutTimer",null),x(z(n),"_reader",null),x(z(n),"_response",null),x(z(n),"_aborted",!1),x(z(n),"_index",-1),x(z(n),"_range",null),x(z(n),"_receivedLength",0),x(z(n),"_running",!1),x(z(n),"_logger",null),x(z(n),"_vid",""),x(z(n),"_onProcessMinLen",0),x(z(n),"_onCancel",null),x(z(n),"_priOptions",null),n}return Pe(t,[{key:"load",value:function(e){var s,r=this,l=e.url,o=e.vid,u=e.timeout,c=e.responseType,p=e.onProgress,m=e.index,f=e.onTimeout,b=e.onCancel,v=e.range,g=e.transformResponse,X=e.request,D=e.params,F=e.logger,w=e.method,S=e.headers,G=e.body,T=e.mode,C=e.credentials,I=e.cache,E=e.redirect,U=e.referrer,h=e.referrerPolicy,d=e.onProcessMinLen,y=e.priOptions;this._logger=F,this._aborted=!1,this._onProcessMinLen=d,this._onCancel=b,this._abortController=typeof AbortController<"u"&&new AbortController,this._running=!0,this._index=m,this._range=v||[0,0],this._vid=o||l,this._priOptions=y||{};var L={method:w,headers:S,body:G,mode:T,credentials:C,cache:I,redirect:E,referrer:U,referrerPolicy:h,signal:(s=this._abortController)===null||s===void 0?void 0:s.signal},Z=!1;clearTimeout(this._timeoutTimer),l=qr(l,D);var W=Qr(v);W&&(X?S=X.headers:S=L.headers=L.headers||(Headers?new Headers:{}),Headers&&S instanceof Headers?S.append("Range",W):S.Range=W),u&&(this._timeoutTimer=setTimeout(function(){if(Z=!0,r.cancel(),f){var _=new at(l,L,null,"timeout");_.isTimeout=!0,f(_,{index:r._index,range:r._range,vid:r._vid,priOptions:r._priOptions})}},u));var R=Date.now();return this._logger.debug("[fetch load start], index,",m,",range,",v),new Promise(function(_,K){fetch(X||l,X?void 0:L).then(function(){var Y=dt(fe().mark(function J(P){var st,Le,Ke,rt;return fe().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(clearTimeout(r._timeoutTimer),r._response=P,!(r._aborted||!r._running)){ae.next=4;break}return ae.abrupt("return");case 4:if(g&&(P=g(P,l)||P),P.ok){ae.next=7;break}throw new at(l,L,P,"bad network response");case 7:if(st=Date.now(),c!==en.TEXT){ae.next=15;break}return ae.next=11,P.text();case 11:Le=ae.sent,r._running=!1,ae.next=37;break;case 15:if(c!==en.JSON){ae.next=22;break}return ae.next=18,P.json();case 18:Le=ae.sent,r._running=!1,ae.next=37;break;case 22:if(!p){ae.next=29;break}return r.resolve=_,r.reject=K,r._loadChunk(P,p,R,st),ae.abrupt("return");case 29:return ae.next=31,P.arrayBuffer();case 31:Le=ae.sent,Le=new Uint8Array(Le),r._running=!1,Ke=Date.now()-R,rt=us(Le.byteLength,Ke),r.emit(M.REAL_TIME_SPEED,{speed:rt,len:Le.byteLength,time:Ke,vid:r._vid,index:r._index,range:r._range,priOptions:r._priOptions});case 37:r._logger.debug("[fetch load end], index,",m,",range,",v),_(os(Le,!0,P,P.headers.get("Content-Length"),P.headers.get("age"),R,st,m,v,r._vid,r._priOptions));case 39:case"end":return ae.stop()}},J)}));return function(J){return Y.apply(this,arguments)}}()).catch(function(Y){var J;clearTimeout(r._timeoutTimer),r._running=!1,!(r._aborted&&!Z)&&(Y=Y instanceof at?Y:new at(l,L,null,(J=Y)===null||J===void 0?void 0:J.message),Y.startTime=R,Y.endTime=Date.now(),Y.isTimeout=Z,Y.options={index:r._index,range:r._range,vid:r._vid,priOptions:r._priOptions},K(Y))})})}},{key:"cancel",value:function(){var n=dt(fe().mark(function s(){return fe().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this._aborted){l.next=2;break}return l.abrupt("return");case 2:if(this._aborted=!0,this._running=!1,!this._response){l.next=14;break}if(l.prev=5,!this._reader){l.next=9;break}return l.next=9,this._reader.cancel();case 9:l.next=13;break;case 11:l.prev=11,l.t0=l.catch(5);case 13:this._response=this._reader=null;case 14:if(this._abortController){try{this._abortController.abort()}catch{}this._abortController=null}this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions});case 16:case"end":return l.stop()}},s,this,[[5,11]])}));function e(){return n.apply(this,arguments)}return e}()},{key:"_loadChunk",value:function(e,s,r,l){var o=this;if(!e.body||!e.body.getReader){this._running=!1;var u=new at(e.url,"",e,"onProgress of bad response.body.getReader");u.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this.reject(u);return}this._onProcessMinLen>0&&(this._cache=new Uint8Array(js),this._writeIdx=0);var c=this._reader=e.body.getReader(),p,m,f,b=function(){var v=dt(fe().mark(function g(){var X,D,F,w,S,G,T,C;return fe().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return m=Date.now(),E.prev=1,E.next=4,c.read();case 4:p=E.sent,f=Date.now(),E.next=13;break;case 8:return E.prev=8,E.t0=E.catch(1),f=Date.now(),o._aborted||(o._running=!1,E.t0.options={index:o._index,range:o._range,vid:o._vid,priOptions:o._priOptions},o.reject(E.t0)),E.abrupt("return");case 13:if(D=((X=o._range)===null||X===void 0?void 0:X.length)>0?o._range[0]:0,F=D+o._receivedLength,!o._aborted){E.next=19;break}return o._running=!1,s(void 0,!1,{range:[F,F],vid:o._vid,index:o._index,startTime:m,endTime:f,st:r,firstByteTime:l,priOptions:o._priOptions},e),E.abrupt("return");case 19:w=p.value?p.value.byteLength:0,o._receivedLength+=w,o._logger.debug("【fetchLoader,onProgress call】,task,",o._range,", start,",F,", end,",D+o._receivedLength,", done,",p.done),o._onProcessMinLen>0?o._writeIdx+w>=o._onProcessMinLen||p.done?(S=new Uint8Array(o._writeIdx+w),S.set(o._cache.slice(0,o._writeIdx),0),w>0&&S.set(p.value,o._writeIdx),o._writeIdx=0,o._logger.debug("【fetchLoader,onProgress enough】,done,",p.done,",len,",S.byteLength,", writeIdx,",o._writeIdx)):w>0&&o._writeIdx+w<js?(o._cache.set(p.value,o._writeIdx),o._writeIdx+=w,o._logger.debug("【fetchLoader,onProgress cache】,len,",w,", writeIdx,",o._writeIdx)):w>0&&(G=new Uint8Array(o._writeIdx+w+2048),o._logger.debug("【fetchLoader,onProgress extra start】,size,",o._writeIdx+w+2048,", datalen,",w,", writeIdx,",o._writeIdx),G.set(o._cache.slice(0,o._writeIdx),0),w>0&&G.set(p.value,o._writeIdx),o._writeIdx+=w,delete o._cache,o._cache=G,o._logger.debug("【fetchLoader,onProgress extra end】,len,",w,", writeIdx,",o._writeIdx)):S=p.value,(S&&S.byteLength>0||p.done)&&s(S,p.done,{range:[o._range[0]+o._receivedLength-(S?S.byteLength:0),o._range[0]+o._receivedLength],vid:o._vid,index:o._index,startTime:m,endTime:f,st:r,firstByteTime:l,priOptions:o._priOptions},e),p.done?(T=Date.now()-r,C=us(o._receivedLength,T),o.emit(M.REAL_TIME_SPEED,{speed:C,len:o._receivedLength,time:T,vid:o._vid,index:o._index,range:o._range,priOptions:o._priOptions}),o._running=!1,o._logger.debug("[fetchLoader onProgress end],task,",o._range,",done,",p.done),o.resolve(os(p,!0,e,e.headers.get("Content-Length"),e.headers.get("age"),r,l,o._index,o._range,o._vid,o._priOptions))):b();case 25:case"end":return E.stop()}},g,null,[[1,8]])}));return function(){return v.apply(this,arguments)}}();b()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}}],[{key:"isSupported",value:function(){return typeof fetch<"u"}}]),t}(Dt);function Wi(a){return qt({loaderType:Wt.FETCH,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:en.TEXT,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0,onProcessMinLen:0},a)}var Ci=function(a){an(t,a);var i=ln(t);function t(){var n;return _e(this,t),n=i.call(this),x(z(n),"_xhr",null),x(z(n),"_aborted",!1),x(z(n),"_timeoutTimer",null),x(z(n),"_range",null),x(z(n),"_receivedLength",0),x(z(n),"_url",null),x(z(n),"_onProgress",null),x(z(n),"_index",-1),x(z(n),"_headers",null),x(z(n),"_currentChunkSizeKB",384),x(z(n),"_timeout",null),x(z(n),"_xhr",null),x(z(n),"_withCredentials",null),x(z(n),"_startTime",-1),x(z(n),"_loadCompleteResolve",null),x(z(n),"_loadCompleteReject",null),x(z(n),"_runing",!1),x(z(n),"_logger",!1),x(z(n),"_vid",""),x(z(n),"_responseType",void 0),x(z(n),"_credentials",void 0),x(z(n),"_method",void 0),x(z(n),"_transformResponse",void 0),x(z(n),"_firstRtt",void 0),x(z(n),"_onCancel",null),x(z(n),"_priOptions",null),n}return Pe(t,[{key:"load",value:function(e){var s=this;clearTimeout(this._timeoutTimer),this._logger=e.logger,this._range=e.range,this._onProgress=e.onProgress,this._index=e.index,this._headers=e.headers,this._withCredentials=e.credentials==="include"||e.credentials==="same-origin",this._body=e.body||null,e.method&&(this._method=e.method),this._timeout=e.timeout||null,this._runing=!0,this._vid=e.vid||e.url,this._responseType=e.responseType,this._firstRtt=-1,this._onTimeout=e.onTimeout,this._onCancel=e.onCancel,this._request=e.request,this._priOptions=e.priOptions||{},this._logger.debug("【xhrLoader task】, range",this._range),this._url=qr(e.url,e.params);var r=Date.now();return new Promise(function(l,o){s._loadCompleteResolve=l,s._loadCompleteReject=o,s._startLoad()}).catch(function(l){if(clearTimeout(s._timeoutTimer),s._runing=!1,!s._aborted)throw l=l instanceof at?l:new at(s._url,s._request),l.startTime=r,l.endTime=Date.now(),l.options={index:s._index,vid:s._vid,priOptions:s._priOptions},l})}},{key:"_startLoad",value:function(){var e=null;if(this._responseType===en.ARRAY_BUFFER&&this._range&&this._range.length>1)if(this._onProgress){this._firstRtt=-1;var s=this._currentChunkSizeKB*1024,r=this._range[0]+this._receivedLength,l=this._range[1];s<this._range[1]-r&&(l=r+s),e=[r,l],this._logger.debug("[xhr_loader->],tast :",this._range,", SubRange, ",e)}else e=this._range,this._logger.debug("[xhr_loader->],tast :",this._range,", allRange, ",e);this._internalOpen(e)}},{key:"_internalOpen",value:function(e){var s=this;try{this._startTime=Date.now();var r=this._xhr=new XMLHttpRequest;r.open(this._method||"GET",this._url,!0),r.responseType=this._responseType,this._timeout&&(r.timeout=this._timeout),r.withCredentials=this._withCredentials,r.onload=this._onLoad.bind(this),r.onreadystatechange=this._onReadyStatechange.bind(this),r.onerror=function(u){var c,p,m;s._running=!1;var f=new at(s._url,s._request,u==null||(c=u.currentTarget)===null||c===void 0?void 0:c.response,"xhr.onerror.status:"+(u==null||(p=u.currentTarget)===null||p===void 0?void 0:p.status)+",statusText,"+(u==null||(m=u.currentTarget)===null||m===void 0?void 0:m.statusText));f.options={index:s._index,range:s._range,vid:s._vid,priOptions:s._priOptions},s._loadCompleteReject(f)},r.ontimeout=function(u){s.cancel();var c=new at(s._url,s._request,{status:408},"timeout");s._onTimeout&&(c.isTimeout=!0,s._onTimeout(c,{index:s._index,range:s._range,vid:s._vid,priOptions:s._priOptions})),c.options={index:s._index,range:s._range,vid:s._vid,priOptions:s._priOptions},s._loadCompleteReject(c)};var l=this._headers||{},o=Qr(e);o&&(l.Range=o),l&&Object.keys(l).forEach(function(u){r.setRequestHeader(u,l[u])}),this._logger.debug("[xhr.send->] tast,",this._range,",load sub range, ",e),r.send(this._body)}catch(u){u.options={index:this._index,range:e,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(u)}}},{key:"_onReadyStatechange",value:function(e){var s=e.target;s.readyState===2&&this._firstRtt<0&&(this._firstRtt=Date.now())}},{key:"_onLoad",value:function(e){var s,r=e.target.status;if(r<200||r>299){var l=new at(this._url,null,qt(qt({},e.target.response),{},{status:r}),"bad response,status:"+r);return l.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(l)}var o=null,u=!1,c,p=((s=this._range)===null||s===void 0?void 0:s.length)>0?this._range[0]:0;if(this._responseType===en.ARRAY_BUFFER){var m,f=new Uint8Array(e.target.response);if(c=p+this._receivedLength,f&&f.byteLength>0){this._receivedLength+=f.byteLength;var b=Date.now()-this._startTime,v=us(this._receivedLength,b);this.emit(M.REAL_TIME_SPEED,{speed:v,len:this._receivedLength,time:b,vid:this._vid,index:this._index,range:[c,p+this._receivedLength],priOptions:this._priOptions})}o=f,((m=this._range)===null||m===void 0?void 0:m.length)>1&&this._range[1]&&this._receivedLength<this._range[1]-this._range[0]?u=!1:u=!0,this._logger.debug("[xhr load done->], tast :",this._range,", start",c,"end ",p+this._receivedLength,",dataLen,",f?f.byteLength:0,",receivedLength",this._receivedLength,",index,",this._index,", done,",u)}else u=!0,o=e.target.response;var g={ok:r>=200&&r<300,status:r,statusText:this._xhr.statusText,url:this._xhr.responseURL,headers:this._getHeaders(this._xhr),body:this._xhr.response};this._transformResponse&&(g=this._transformResponse(g,this._url)||g),this._onProgress&&this._onProgress(o,u,{index:this._index,vid:this._vid,range:[c,p+this._receivedLength],startTime:this._startTime,endTime:Date.now(),priOptions:this._priOptions},g),u?(this._runing=!1,this._loadCompleteResolve&&this._loadCompleteResolve(os(this._onProgress?null:o,u,g,g.headers["content-length"],g.headers.age,this._startTime,this._firstRtt,this._index,this._range,this._vid,this._priOptions))):this._startLoad()}},{key:"cancel",value:function(){if(!this._aborted&&(this._aborted=!0,this._runing=!1,yn(Rt(t.prototype),"removeAllListeners",this).call(this),this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions}),this._xhr))return this._xhr.abort()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}},{key:"_getHeaders",value:function(e){var s=e.getAllResponseHeaders().trim().split(`\r
`),r={},l=gi(s),o;try{for(l.s();!(o=l.n()).done;){var u=o.value,c=u.split(": ");r[c[0].toLowerCase()]=c.slice(1).join(": ")}}catch(p){l.e(p)}finally{l.f()}return r}}],[{key:"isSupported",value:function(){return typeof XMLHttpRequest<"u"}}]),t}(Dt),Ti=["retry","retryDelay","onRetryError","transformError"],ki=function(){function a(i,t){_e(this,a),this.promise=Et(),this.alive=!!t.onProgress,!t.logger&&(t.logger=new xe("Loader")),this._loaderType=i,this._loader=i===Wt.FETCH&&window.fetch?new cs:new Ci,this._config=t,this._retryCount=0,this._retryTimer=null,this._canceled=!1,this._retryCheckFunc=t.retryCheckFunc,this._logger=t.logger}return Pe(a,[{key:"exec",value:function(){var t=this,n=this._config,e=n.retry,s=n.retryDelay,r=n.onRetryError,l=n.transformError,o=fi(n,Ti),u=function(){var c=dt(fe().mark(function p(){var m,f,b;return fe().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,t._loader.load(o);case 3:m=g.sent,t.promise.resolve(m),g.next=27;break;case 7:if(g.prev=7,g.t0=g.catch(0),t._loader.running=!1,t._logger.debug("[task request catch err]",g.t0),!t._canceled){g.next=13;break}return g.abrupt("return");case 13:if(g.t0.loaderType=t._loaderType,g.t0.retryCount=t._retryCount,f=g.t0,l&&(f=l(f)||f),r&&t._retryCount>0&&r(f,t._retryCount,{index:o.index,vid:o.vid,range:o.range,priOptions:o.priOptions}),t._retryCount++,b=!0,t._retryCheckFunc&&(b=t._retryCheckFunc(g.t0)),!(b&&t._retryCount<=e)){g.next=26;break}return clearTimeout(t._retryTimer),t._logger.debug("[task request setTimeout],retry",t._retryCount,",retry range,",o.range),t._retryTimer=setTimeout(u,s),g.abrupt("return");case 26:t.promise.reject(f);case 27:case"end":return g.stop()}},p,null,[[0,7]])}));return function(){return c.apply(this,arguments)}}();return u(),this.promise}},{key:"cancel",value:function(){var i=dt(fe().mark(function n(){return fe().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,this._loader.running=!1,s.abrupt("return",this._loader.cancel());case 4:case"end":return s.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"running",get:function(){return this._loader&&this._loader.running}},{key:"loader",get:function(){return this._loader}}]),a}();function $r(a){return a&&!a.paused&&!a.ended&&a.playbackRate!==0&&a.readyState!==0}function ea(a){if(!a)return{};if(typeof a.getVideoPlaybackQuality=="function"){var i=a.getVideoPlaybackQuality();return{droppedVideoFrames:i.droppedVideoFrames||i.corruptedVideoFrames,totalVideoFrames:i.totalVideoFrames,creationTime:i.creationTime}}return{droppedVideoFrames:a.webkitDroppedFrameCount,totalVideoFrames:a.webkitDecodedFrameCount,creationTime:performance.now()}}function Tt(){for(var a=arguments.length,i=new Array(a),t=0;t<a;t++)i[t]=arguments[t];if(i=i.filter(Boolean),i.length<2)return i[0];var n=new Uint8Array(i.reduce(function(s,r){return s+r.byteLength},0)),e=0;return i.forEach(function(s){n.set(s,e),e+=s.byteLength}),n}function Ri(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(i){return setTimeout(i,a)})}var St=function(a){an(t,a);var i=ln(t);function t(n){var e;return _e(this,t),e=i.call(this,n),x(z(e),"type",Wt.FETCH),x(z(e),"_queue",[]),x(z(e),"_alive",[]),x(z(e),"_currentTask",null),x(z(e),"_config",void 0),e._config=Wi(n),(e._config.loaderType===Wt.XHR||!cs.isSupported())&&(e.type=Wt.XHR),e.log=n.logger,e}return Pe(t,[{key:"isFetch",value:function(){return this.type===Wt.FETCH}},{key:"load",value:function(e){var s=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};typeof e=="string"||!e?r.url=e||r.url||this._config.url:r=e,r=Object.assign({},this._config,r),r.params&&(r.params=Object.assign({},r.params)),r.headers&&Js(r.headers)&&(r.headers=Object.assign({},r.headers)),r.body&&Js(r.body)&&(r.body=Object.assign({},r.body)),r.transformRequest&&(r=r.transformRequest(r)||r),r.logger=this.log;var l=new ki(this.type,r);return l.loader.on(M.REAL_TIME_SPEED,function(o){s.emit(M.REAL_TIME_SPEED,o)}),this._queue.push(l),this._queue.length===1&&(!this._currentTask||!this._currentTask.running)&&this._processTask(),l.promise}},{key:"cancel",value:function(){var n=dt(fe().mark(function s(){var r;return fe().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return r=this._queue.map(function(u){return u.cancel()}).concat(this._alive.map(function(u){return u.cancel()})),this._currentTask&&r.push(this._currentTask.cancel()),this._queue=[],this._alive=[],o.next=6,Promise.all(r);case 6:return o.next=8,Ri();case 8:case"end":return o.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"_processTask",value:function(){var e=this;if(this._currentTask=this._queue.shift(),!!this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var s=this._currentTask.exec().catch(function(r){});s&&typeof s.finally=="function"&&s.finally(function(){var r,l;(r=e._currentTask)!==null&&r!==void 0&&r.alive&&((l=e._alive)===null||l===void 0?void 0:l.length)>0&&(e._alive=e._alive.filter(function(o){return o&&o!==e._currentTask})),e._processTask()})}}}],[{key:"isFetchSupport",value:function(){return cs.isSupported()}}]),t}(Dt),ta=function(){function a(){_e(this,a),x(this,"_prevCurrentTime",0)}return Pe(a,[{key:"do",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,e=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(t){var r=t.currentTime,l=0;if(this._prevCurrentTime===r){var o=me.info(me.get(t),r);if(!o.buffers.length)return;e&&o.nextStart||o.nextStart&&o.nextStart-r<n?l=o.nextStart+.1:o.end&&o.end-r>s&&!t.seeking&&(l=r+.1)}this._prevCurrentTime=r,l&&r!==l&&(t.currentTime=l)}}}]),a}(),na=function(){function a(i){var t=this;_e(this,a),x(this,"_seiSet",new Set),this.emitter=i,i.on(M.SEI,function(n){n&&t._seiSet.add(n)})}return Pe(a,[{key:"throw",value:function(t){var n=this;if(!(t==null||!this._seiSet.size)){var e=t-.2,s=t+.2,r=[];this._seiSet.forEach(function(l){l.time>=e&&l.time<=s&&r.push(l)}),r.forEach(function(l){n._seiSet.delete(l),n.emitter.emit(M.SEI_IN_TIME,l)})}}},{key:"reset",value:function(){this._seiSet.clear()}}]),a}(),sa=function(){function a(){_e(this,a),x(this,"_chunkSpeeds",[]),x(this,"_speeds",[])}return Pe(a,[{key:"addRecord",value:function(t,n){!t||!n||(this._speeds.push(8e3*t/n),this._speeds=this._speeds.slice(-3))}},{key:"addChunkRecord",value:function(t,n){!t||!n||(this._chunkSpeeds.push(8e3*t/n),this._chunkSpeeds=this._chunkSpeeds.slice(-100))}},{key:"getAvgSpeed",value:function(){return!this._chunkSpeeds.length&&!this._speeds.length?0:this._speeds.length?this._speeds.reduce(function(t,n){return t+=n})/this._speeds.length:this._chunkSpeeds.reduce(function(t,n){return t+=n})/this._chunkSpeeds.length}},{key:"getLatestSpeed",value:function(){return!this._chunkSpeeds.length&&!this._speeds.length?0:this._speeds.length?this._speeds[this._speeds.length-1]:this._chunkSpeeds[this._chunkSpeeds.length-1]}},{key:"reset",value:function(){this._chunkSpeeds=[],this._speeds=[]}}]),a}(),Qs=function(){function a(i){_e(this,a),x(this,"encodeType",""),x(this,"audioCodec",""),x(this,"videoCodec",""),x(this,"domain",""),x(this,"fps",0),x(this,"bitrate",0),x(this,"width",0),x(this,"height",0),x(this,"samplerate",0),x(this,"channelCount",0),x(this,"gop",0),x(this,"_bitsAccumulateSize",0),x(this,"_bitsAccumulateDuration",0),this._timescale=i}return Pe(a,[{key:"getStats",value:function(){return{encodeType:this.encodeType,audioCodec:this.audioCodec,videoCodec:this.videoCodec,domain:this.domain,fps:this.fps,bitrate:this.bitrate,width:this.width,height:this.height,samplerate:this.samplerate,channelCount:this.channelCount,gop:this.gop}}},{key:"setEncodeType",value:function(t){this.encodeType=t}},{key:"setFpsFromScriptData",value:function(t){var n,e=t.data,s=e==null||(n=e.onMetaData)===null||n===void 0?void 0:n.framerate;s&&s>0&&s<100&&(this.fps=s)}},{key:"setVideoMeta",value:function(t){if(this.width=t.width,this.height=t.height,this.videoCodec=t.codec,this.encodeType=t.codecType,t.fpsNum&&t.fpsDen){var n=t.fpsNum/t.fpsDen;n>0&&n<100&&(this.fps=n)}}},{key:"setAudioMeta",value:function(t){this.audioCodec=t.codec,this.samplerate=t.sampleRate,this.channelCount=t.channelCount}},{key:"setDomain",value:function(t){this.domain=t.split("/").slice(2,3)[0]}},{key:"updateBitrate",value:function(t){var n=this;if((!this.fps||this.fps>=100)&&t.length){var e=t.reduce(function(s,r){return s+=r.duration},0)/t.length;this.fps=Math.round(this._timescale/e)}t.forEach(function(s){s.gopId===1&&n.gop++,n._bitsAccumulateDuration+=s.duration/(n._timescale/1e3),n._bitsAccumulateSize+=s.units.reduce(function(r,l){return r+=l.length},0),n._bitsAccumulateDuration>=1e3&&(n.bitrate=n._bitsAccumulateSize*8,n._bitsAccumulateDuration=0,n._bitsAccumulateSize=0)})}}]),a}(),ra=function(){function a(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;_e(this,a),x(this,"_core",null),x(this,"_samples",[]),this._core=i,this._timescale=t,this._stats=new Qs(t),this._bindEvents()}return Pe(a,[{key:"getStats",value:function(){var t,n,e,s,r,l,o,u=((t=this._core)===null||t===void 0?void 0:t.media)||{},c=u.currentTime,p=c===void 0?0:c,m=u.decodeFps,f=m===void 0?0:m;return qt(qt({},this._stats.getStats()),{},{downloadSpeed:((n=this._core)===null||n===void 0||(e=n.speedInfo)===null||e===void 0?void 0:e.call(n).speed)||0,avgSpeed:((s=this._core)===null||s===void 0||(r=s.speedInfo)===null||r===void 0?void 0:r.call(s).avgSpeed)||0,currentTime:p,bufferEnd:((l=this._core)===null||l===void 0||(o=l.bufferInfo())===null||o===void 0?void 0:o.remaining)||0,decodeFps:f})}},{key:"_bindEvents",value:function(){var t=this;this._core.on(M.DEMUXED_TRACK,function(n){var e=n.videoTrack;return t._stats.updateBitrate(e.samples)}),this._core.on(M.FLV_SCRIPT_DATA,function(n){t._stats.setFpsFromScriptData(n)}),this._core.on(M.METADATA_PARSED,function(n){n.type==="video"?t._stats.setVideoMeta(n.track):t._stats.setAudioMeta(n.track)}),this._core.on(M.TTFB,function(n){t._stats.setDomain(n.responseUrl)})}},{key:"reset",value:function(){this._samples=[],this._stats=new Qs(this._timescale)}}]),a}();function Vi(a,i){var t=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(t!=null){var n,e,s,r,l=[],o=!0,u=!1;try{if(s=(t=t.call(a)).next,i===0){if(Object(t)!==t)return;o=!1}else for(;!(o=(n=s.call(t)).done)&&(l.push(n.value),l.length!==i);o=!0);}catch(c){u=!0,e=c}finally{try{if(!o&&t.return!=null&&(r=t.return(),Object(r)!==r))return}finally{if(u)throw e}}return l}}function oe(a,i){if(!(a instanceof i))throw new TypeError("Cannot call a class as a function")}function qs(a,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,oa(n.key),n)}}function ue(a,i,t){return i&&qs(a.prototype,i),t&&qs(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function V(a,i,t){return i=oa(i),i in a?Object.defineProperty(a,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[i]=t,a}function aa(a,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(i&&i.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),i&&ps(a,i)}function Ln(a){return Ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ln(a)}function ps(a,i){return ps=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},ps(a,i)}function xi(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mi(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Yi(a,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mi(a)}function ia(a){var i=xi();return function(){var n=Ln(a),e;if(i){var s=Ln(this).constructor;e=Reflect.construct(n,arguments,s)}else e=n.apply(this,arguments);return Yi(this,e)}}function Ei(a,i){return _i(a)||Vi(a,i)||la(a,i)||Hi()}function We(a){return Ii(a)||Pi(a)||la(a)||Ki()}function Ii(a){if(Array.isArray(a))return ds(a)}function _i(a){if(Array.isArray(a))return a}function Pi(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function la(a,i){if(a){if(typeof a=="string")return ds(a,i);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ds(a,i)}}function ds(a,i){(i==null||i>a.length)&&(i=a.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=a[t];return n}function Ki(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hi(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ni(a,i){if(typeof a!="object"||a===null)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var n=t.call(a,i||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(a)}function oa(a){var i=Ni(a,"string");return typeof i=="symbol"?i:String(i)}var Pt={VIDEO:"video",AUDIO:"audio",METADATA:"metadata"},ht={AVC:"avc",HEVC:"hevc"},it={AAC:"aac",G711PCMA:"g7110a",G711PCMU:"g7110m"},de={LARGE_AV_SHIFT:"LARGE_AV_SHIFT",LARGE_VIDEO_GAP:"LARGE_VIDEO_GAP",LARGE_VIDEO_GAP_BETWEEN_CHUNK:"LARGE_VIDEO_GAP_BETWEEN_CHUNK",LARGE_AUDIO_GAP:"LARGE_AUDIO_GAP",AUDIO_FILLED:"AUDIO_FILLED",AUDIO_DROPPED:"AUDIO_DROPPED"},Rn=function(){function a(){oe(this,a),V(this,"id",1),V(this,"type",Pt.VIDEO),V(this,"codecType",ht.AVC),V(this,"pid",-1),V(this,"hvcC",void 0),V(this,"codec",""),V(this,"timescale",0),V(this,"formatTimescale",0),V(this,"sequenceNumber",0),V(this,"baseMediaDecodeTime",0),V(this,"baseDts",0),V(this,"duration",0),V(this,"warnings",[]),V(this,"samples",[]),V(this,"pps",[]),V(this,"sps",[]),V(this,"vps",[]),V(this,"fpsNum",0),V(this,"fpsDen",0),V(this,"sarRatio",[]),V(this,"width",0),V(this,"height",0),V(this,"nalUnitSize",4),V(this,"present",!1),V(this,"isVideoEncryption",!1),V(this,"isAudioEncryption",!1),V(this,"isVideo",!0),V(this,"kid",null),V(this,"pssh",null),V(this,"ext",void 0)}return ue(a,[{key:"reset",value:function(){this.sequenceNumber=this.width=this.height=this.fpsDen=this.fpsNum=this.duration=this.baseMediaDecodeTime=this.timescale=0,this.codec="",this.present=!1,this.pid=-1,this.pps=[],this.sps=[],this.vps=[],this.sarRatio=[],this.samples=[],this.warnings=[],this.hvcC=null}},{key:"exist",value:function(){return!!(this.pps.length&&this.sps.length&&this.codec)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isVideoEncryption}}]),a}(),Vn=function(){function a(){oe(this,a),V(this,"id",2),V(this,"type",Pt.AUDIO),V(this,"codecType",it.AAC),V(this,"pid",-1),V(this,"codec",""),V(this,"sequenceNumber",0),V(this,"sampleDuration",0),V(this,"timescale",0),V(this,"formatTimescale",0),V(this,"baseMediaDecodeTime",0),V(this,"duration",0),V(this,"warnings",[]),V(this,"samples",[]),V(this,"baseDts",0),V(this,"sampleSize",16),V(this,"sampleRate",0),V(this,"channelCount",0),V(this,"objectType",0),V(this,"sampleRateIndex",0),V(this,"config",[]),V(this,"present",!1),V(this,"isVideoEncryption",!1),V(this,"isAudioEncryption",!1),V(this,"kid",null),V(this,"ext",void 0)}return ue(a,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec&&this.codecType===it.AAC)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isAudioEncryption}}]),a}(),tn=function(){function a(i,t,n){oe(this,a),V(this,"flag",{}),V(this,"keyframe",!1),V(this,"gopId",0),V(this,"duration",0),V(this,"size",0),V(this,"units",[]),V(this,"chromaFormat",420),this.originPts=this.pts=i,this.originDts=this.dts=t,n&&(this.units=n)}return ue(a,[{key:"cts",get:function(){return this.pts-this.dts}},{key:"setToKeyframe",value:function(){this.keyframe=!0,this.flag.dependsOn=2,this.flag.isNonSyncSample=0}}]),a}(),ft=ue(function a(i,t,n,e){oe(this,a),V(this,"duration",1024),V(this,"flag",{dependsOn:2,isNonSyncSample:0}),V(this,"keyframe",!0),this.originPts=this.pts=this.dts=i,this.data=t,this.size=t.byteLength,this.sampleOffset=e,n&&(this.duration=n)}),ua=ue(function a(i,t){oe(this,a),V(this,"time",0),this.data=i,this.originPts=this.pts=t}),Ai=function(a){aa(t,a);var i=ia(t);function t(){return oe(this,t),i.apply(this,arguments)}return ue(t)}(ua),ca=function(a){aa(t,a);var i=ia(t);function t(){return oe(this,t),i.apply(this,arguments)}return ue(t)}(ua),xn=function(){function a(){oe(this,a),V(this,"id",3),V(this,"type",Pt.METADATA),V(this,"timescale",0),V(this,"flvScriptSamples",[]),V(this,"seiSamples",[])}return ue(a,[{key:"exist",value:function(){return!!((this.flvScriptSamples.length||this.seiSamples.length)&&this.timescale)}},{key:"reset",value:function(){this.timescale=0,this.flvScriptSamples=[],this.seiSamples=[]}},{key:"hasSample",value:function(){return!!(this.flvScriptSamples.length||this.seiSamples.length)}}]),a}(),Vt=function(){function a(i){oe(this,a),this.name=i||"",this._prefix="[".concat(this.name,"]")}return ue(a,[{key:"warn",value:function(){var t;if(!a.disabled){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];(t=console).warn.apply(t,[this._prefix].concat(e))}}}],[{key:"enable",value:function(){a.disabled=!1}},{key:"disable",value:function(){a.disabled=!0}}]),a}();V(Vt,"disabled",!0);var Mn=typeof window<"u",Fs=Mn&&navigator.userAgent.toLocaleLowerCase(),pa=Mn&&/^((?!chrome|android).)*safari/.test(Fs),Ui=Mn&&Fs.includes("firefox"),zi=Mn&&Fs.includes("android"),je=function(){function a(){oe(this,a)}return ue(a,null,[{key:"getRateIndexByRate",value:function(t){return a.FREQ.indexOf(t)}},{key:"parseADTS",value:function(t,n){for(var e=t.length,s=0;s+2<e&&!(t[s]===255&&(t[s+1]&246)===240);)s++;if(!(s>=e)){var r=s,l=[],o=(t[s+2]&60)>>>2,u=a.FREQ[o];if(!u)throw new Error("Invalid sampling index: ".concat(o));for(var c=((t[s+2]&192)>>>6)+1,p=(t[s+2]&1)<<2|(t[s+3]&192)>>>6,m=a._getConfig(o,p,c),f=m.config,b=m.codec,v,g,X=0,D=a.getFrameDuration(u);s+7<e;){if(t[s]!==255||(t[s+1]&246)!==240){s++;continue}if(g=(t[s+3]&3)<<11|t[s+4]<<3|(t[s+5]&224)>>5,e-s<g)break;v=(~t[s+1]&1)*2,l.push({pts:n+X*D,data:t.subarray(s+7+v,s+g)}),X++,s+=g}return{skip:r,remaining:s>=e?void 0:t.subarray(s),frames:l,samplingFrequencyIndex:o,sampleRate:u,objectType:c,channelCount:p,codec:b,config:f,originCodec:"mp4a.40.".concat(c)}}}},{key:"parseAudioSpecificConfig",value:function(t){if(t.length){var n=t[0]>>>3,e=(t[0]&7)<<1|t[1]>>>7,s=(t[1]&120)>>>3,r=a.FREQ[e];if(r){var l=a._getConfig(e,s,n),o=l.config,u=l.codec;return{samplingFrequencyIndex:e,sampleRate:r,objectType:n,channelCount:s,config:o,codec:u,originCodec:"mp4a.40.".concat(n)}}}}},{key:"getFrameDuration",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4;return 1024*n/t}},{key:"_getConfig",value:function(t,n,e){var s=[],r,l;return Ui?t>=6?(r=5,l=t-3):(r=2,l=t):zi?(r=2,l=t):(r=e===2||e===5?e:5,l=t,t>=6?l=t-3:n===1&&(r=2,l=t)),s[0]=r<<3,s[0]|=(t&14)>>1,s[1]=(t&1)<<7,s[1]|=n<<3,r===5&&(s[1]|=(l&14)>>1,s[2]=(l&1)<<7,s[2]|=8,s[3]=0),{config:s,codec:"mp4a.40.".concat(r)}}},{key:"getSilentFrame",value:function(t,n){switch(t){case"mp4a.40.2":if(n===1)return new Uint8Array([0,200,0,128,35,128]);if(n===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(n===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(n===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(n===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(n===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(n===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}]),a}();V(je,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]);var Oi=500,$s=3,Un=1e3,zn=5e3,Ji=1e3,Bi=200,er=5e3,tr=5,ji=function(){function a(i,t,n){oe(this,a),this.videoTrack=i,this.audioTrack=t,this.metadataTrack=n,this._baseDts=-1,this._baseDtsInited=!1,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=0,this._videoTimestampBreak=0,this._lastVideoDuration=0,this._keyFrameInNextChunk=!1,this._lastAudioExceptionGapDot=-1/0,this._lastAudioExceptionOverlapDot=-1/0,this._lastAudioExceptionLargeGapDot=-1/0,this._lastVideoExceptionLargeGapDot=-1/0,this._lastVideoExceptionChunkFirstDtsDot=-1/0}return ue(a,[{key:"fix",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;n=Math.round(n*1e3);var r=this.videoTrack,l=this.audioTrack;(e||!s)&&(this._videoLastSample=null,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=0,this._videoTimestampBreak=0,this._lastAudioExceptionGapDot=-1/0,this._lastAudioExceptionOverlapDot=-1/0,this._lastAudioExceptionLargeGapDot=-1/0,this._lastVideoExceptionLargeGapDot=-1/0,this._lastVideoExceptionChunkFirstDtsDot=-1/0),e&&!s&&(this._baseDtsInited=!1),this._baseDtsInited||this._calculateBaseDts(l,r),!s&&n&&(this._audioNextPts=this._videoNextDts=n);var o=this._baseDtsInited&&(this._videoTimestampBreak||!this.videoTrack.exist())&&(this._audioTimestampBreak||!this.audioTrack.exist());if(o&&this._resetBaseDtsWhenStreamBreaked(),this._fixAudio(l),this._keyFrameInNextChunk=!1,this._fixVideo(r),this.metadataTrack.exist()){var u=this.metadataTrack.timescale;this.metadataTrack.seiSamples.forEach(function(c){c.pts=c.originPts-t._baseDts,c.time=Math.max(0,c.pts)/u}),this.metadataTrack.flvScriptSamples.forEach(function(c){c.pts=c.originPts-t._baseDts,c.time=Math.max(0,c.pts)/u})}r.samples.length&&(r.baseMediaDecodeTime=r.samples[0].dts),l.samples.length&&(l.baseMediaDecodeTime=l.samples[0].pts*l.timescale/1e3)}},{key:"_fixVideo",value:function(t){var n=this,e=t.samples;if(e.length){e.forEach(function(D){D.dts-=n._baseDts,D.pts-=n._baseDts,D.keyframe&&(n._keyFrameInNextChunk=!0)});var s;if(t.fpsNum&&t.fpsDen)s=t.timescale*(t.fpsDen/t.fpsNum);else if(t.length>1){var r=t.samples[0],l=t.samples[e.length-1];s=Math.floor((l.dts-r.dts)/(e.length-1))}else s=this._lastVideoDuration||40;var o=e.pop();if(this._videoLastSample&&e.unshift(this._videoLastSample),this._videoLastSample=o,!!e.length){if(this._videoNextDts===void 0){var u=e[0];this._videoNextDts=u.dts}var c=e.length,p=0,m=e[0],f=this._videoNextDts-m.dts;if(Math.abs(f)>Bi){if(Math.abs(m.dts-this._lastVideoExceptionChunkFirstDtsDot)>er){var b;this._lastVideoExceptionChunkFirstDtsDot=m.dts,t.warnings.push({type:de.LARGE_VIDEO_GAP_BETWEEN_CHUNK,nextDts:this._videoNextDts,firstSampleDts:m.dts,nextSampleDts:(b=e[1])===null||b===void 0?void 0:b.dts,sampleDuration:f})}this._videoTimestampBreak>=tr?(this._videoNextDts=m.dts,this._videoTimestampBreak=0):(m.dts+=f,m.pts+=f,this.audioTrack.exist()||(this._videoTimestampBreak=1))}for(var v=0;v<c;v++){var g=e[v].dts,X=e[v+1];v<c-1?p=X.dts-g:o?p=o.dts-g:p=s,(p>Ji||p<0)&&(this._videoTimestampBreak++,Math.abs(g-this._lastVideoExceptionLargeGapDot)>er&&(this._lastVideoExceptionLargeGapDot=g,t.warnings.push({type:de.LARGE_VIDEO_GAP,time:g/t.timescale,dts:g,originDts:e[v].originDts,nextDts:this._videoNextDts,sampleDuration:p,refSampleDuration:s})),p=s),e[v].duration=p,this._videoNextDts+=p,this._lastVideoDuration=p}}}}},{key:"_fixAudio",value:function(t){var n=this,e=t.samples;e.length&&(e.forEach(function(s){s.dts=s.pts-=n._baseDts}),this._doFixAudioInternal(t,e,1e3))}},{key:"_calculateBaseDts",value:function(t,n){var e=t.samples,s=n.samples;if(!e.length&&!s.length)return!1;var r=1/0,l=1/0;e.length&&(t.baseDts=r=e[0].pts),s.length&&(n.baseDts=l=s[0].dts),this._baseDts=Math.min(r,l);var o=l-r;return Number.isFinite(o)&&Math.abs(o)>Oi&&n.warnings.push({type:de.LARGE_AV_SHIFT,videoBaseDts:l,audioBasePts:r,baseDts:this._baseDts,delta:o}),this._baseDtsInited=!0,!0}},{key:"_resetBaseDtsWhenStreamBreaked",value:function(){var t=this._calculateBaseDts(this.audioTrack,this.videoTrack);t&&(this.audioTrack.exist()?this.videoTrack.exist()?this._baseDts-=Math.min(this._audioNextPts,this._videoNextDts):this._baseDts-=this._audioNextPts:this._baseDts-=this._videoNextDts,this._videoTimestampBreak=0,this._audioTimestampBreak=0)}},{key:"_doFixAudioInternal",value:function(t,n,e){t.sampleDuration||(t.sampleDuration=t.codecType===it.AAC?je.getFrameDuration(t.timescale,e):this._getG711Duration(t));var s=t.sampleDuration,r=t.codecType===it.AAC?1024:s*t.timescale/1e3;if(this._audioNextPts===void 0){var l=n[0];this._audioNextPts=l.pts}for(var o=0;o<n.length;o++){var u=this._audioNextPts,c=n[o],p=c.pts-u;if(o===0&&this._audioTimestampBreak>=tr&&this._keyFrameInNextChunk&&(u=this._audioNextPts=c.dts,p=0,this._audioTimestampBreak=0),!this._audioTimestampBreak&&p>=$s*s&&p<=Un&&!pa){var m=this._getSilentFrame(t)||n[0].data.subarray(),f=Math.floor(p/s);Math.abs(c.pts-this._lastAudioExceptionGapDot)>zn&&(this._lastAudioExceptionGapDot=c.pts,t.warnings.push({type:de.AUDIO_FILLED,pts:c.pts,originPts:c.originPts,count:f,nextPts:u,refSampleDuration:s}));for(var b=0;b<f;b++){var v=new ft(Math.floor(this._audioNextPts+s)-Math.floor(this._audioNextPts),m,r);v.originPts=Math.floor(this._baseDts+u),n.splice(o,0,v),this._audioNextPts+=s,o++}o--}else p<=-$s*s&&p>=-1*Un?(Math.abs(c.pts-this._lastAudioExceptionOverlapDot)>zn&&(this._lastAudioExceptionOverlapDot=c.pts,t.warnings.push({type:de.AUDIO_DROPPED,pts:c.pts,originPts:c.originPts,nextPts:u,refSampleDuration:s})),n.splice(o,1),o--):(Math.abs(p)>Un&&(this._audioTimestampBreak++,Math.abs(c.pts-this._lastAudioExceptionLargeGapDot)>zn&&(this._lastAudioExceptionLargeGapDot=c.pts,t.warnings.push({type:de.LARGE_AUDIO_GAP,time:c.pts/1e3,pts:c.pts,originPts:c.originPts,nextPts:u,sampleDuration:p,refSampleDuration:s}))),c.dts=c.pts=u,c.duration=r,this._audioNextPts+=s)}}},{key:"_getG711Duration",value:function(t){var n=t.sampleSize,e=t.channelCount,s=t.sampleRate,r=t.samples[0];if(r)return r.data.byteLength*2/e/(n/8)/s*1e3}},{key:"_getSilentFrame",value:function(t){return t.codecType===it.AAC?je.getSilentFrame(t.codec,t.channelCount):new Uint8Array(8*t.sampleDuration*t.channelCount)}}]),a}();function Oe(){for(var a=arguments.length,i=new Array(a),t=0;t<a;t++)i[t]=arguments[t];i=i.filter(Boolean);var n=new Uint8Array(i.reduce(function(s,r){return s+r.byteLength},0)),e=0;return i.forEach(function(s){n.set(s,e),e+=s.byteLength}),n}var Qi=Math.pow(2,32);function ce(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a[i]<<8)+(a[i+1]||0)}function qi(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a[i]<<16)+(a[i+1]<<8)+(a[i+2]||0)}function H(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a[i]<<24>>>0)+(a[i+1]<<16)+(a[i+2]<<8)+(a[i+3]||0)}function vt(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return H(a,i)*Qi+H(a,i+4)}function da(a){for(var i="avc1.",t,n=0;n<3;n++)t=a[n].toString(16),t.length<2&&(t="0".concat(t)),i+=t;return i}function $i(a){var i="";if(a.forEach(function(e){i+=el(e)}),i.length<=32)for(var t=32-i.length,n=0;n<t;n++)i+="0";return i}function nr(a){if(!Array.isArray(a)){for(var i=[],t="",n=0;n<a.length;n++)n%2&&(t=a[n-1]+a[n],i.push(parseInt(t,16)),t="");return i}return a.map(function(e){return parseInt(e,16)})}function el(a){return("0"+Number(a).toString(16)).slice(-2).toUpperCase()}var tt=function(){function a(){oe(this,a)}return ue(a,null,[{key:"parseAnnexB",value:function(t){for(var n=t.length,e=2,s=0;t[e]!==null&&t[e]!==void 0&&t[e]!==1;)e++;if(e++,s=e+2,s>=n)return[];for(var r=[];s<n;)switch(t[s]){case 0:if(t[s-1]!==0){s+=2;break}else if(t[s-2]!==0){s++;break}e!==s-2&&r.push(t.subarray(e,s-2));do s++;while(t[s]!==1&&s<n);e=s+1,s=e+2;break;case 1:if(t[s-1]!==0||t[s-2]!==0){s+=3;break}e!==s-2&&r.push(t.subarray(e,s-2)),e=s+1,s=e+2;break;default:s+=3;break}return e<n&&r.push(t.subarray(e)),r}},{key:"parseAvcC",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;if(!(t.length<4)){for(var e=t.length,s=[],r=0,l;r+n<e;)if(l=H(t,r),n===3&&(l>>>=8),r+=n,!!l){if(r+l>e)break;s.push(t.subarray(r,r+l)),r+=l}return s}}},{key:"parseSEI",value:function(t,n){for(var e=t.length,s=n?2:1,r=0,l=0,o="";t[s]===255;)r+=255,s++;for(r+=t[s++];t[s]===255;)l+=255,s++;if(l+=t[s++],r===5&&e>s+16)for(var u=0;u<16;u++)o+=t[s].toString(16),s++;return{payload:t.subarray(s),type:r,size:l,uuid:o}}},{key:"removeEPB",value:function(t){for(var n=t.byteLength,e=[],s=1;s<n-2;)t[s]===0&&t[s+1]===0&&t[s+2]===3?(e.push(s+2),s+=2):s++;if(!e.length)return t;var r=n-e.length,l=new Uint8Array(r),o=0;for(s=0;s<r;o++,s++)o===e[0]&&(o++,e.shift()),l[s]=t[o];return l}}]),a}(),hs=function(){function a(i){if(oe(this,a),V(this,"_bytesAvailable",void 0),V(this,"_bitsAvailable",0),V(this,"_word",0),!i)throw new Error("ExpGolomb data params is required");this._data=i,this._bytesAvailable=i.byteLength,this._bytesAvailable&&this._loadWord()}return ue(a,[{key:"_loadWord",value:function(){var t=this._data.byteLength-this._bytesAvailable,n=Math.min(4,this._bytesAvailable);if(n===0)throw new Error("No bytes available");var e=new Uint8Array(4);e.set(this._data.subarray(t,t+n)),this._word=new DataView(e.buffer).getUint32(0),this._bitsAvailable=n*8,this._bytesAvailable-=n}},{key:"skipBits",value:function(t){if(this._bitsAvailable>t)this._word<<=t,this._bitsAvailable-=t;else{t-=this._bitsAvailable;var n=Math.floor(t/8);t-=n*8,this._bytesAvailable-=n,this._loadWord(),this._word<<=t,this._bitsAvailable-=t}}},{key:"readBits",value:function(t){if(t>32)throw new Error("Cannot read more than 32 bits");var n=Math.min(this._bitsAvailable,t),e=this._word>>>32-n;return this._bitsAvailable-=n,this._bitsAvailable>0?this._word<<=n:this._bytesAvailable>0&&this._loadWord(),n=t-n,n>0&&this._bitsAvailable?e<<n|this.readBits(n):e}},{key:"skipLZ",value:function(){var t;for(t=0;t<this._bitsAvailable;++t)if(this._word&2147483648>>>t)return this._word<<=t,this._bitsAvailable-=t,t;return this._loadWord(),t+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var t=this.skipLZ();return this.readBits(t+1)-1}},{key:"readEG",value:function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}},{key:"readBool",value:function(){return this.readBits(1)===1}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"skipScalingList",value:function(t){for(var n=8,e=8,s,r=0;r<t;r++)e!==0&&(s=this.readEG(),e=(n+s+256)%256),n=e===0?n:e}}]),a}(),ha=function(){function a(){oe(this,a)}return ue(a,null,[{key:"parseAVCDecoderConfigurationRecord",value:function(t){if(!(t.length<7)){for(var n=(t[4]&3)+1,e,s=[],r=[],l=6,o=t[5]&31,u,c=0;c<o;c++)if(u=t[l]<<8|t[l+1],l+=2,!!u){var p=t.subarray(l,l+u);l+=u,s.push(p),e||(e=a.parseSPS(tt.removeEPB(p)))}var m=t[l];l++;for(var f,b=0;b<m;b++)f=t[l]<<8|t[l+1],l+=2,f&&(r.push(t.subarray(l,l+f)),l+=f);return{sps:e,spsArr:s,ppsArr:r,nalUnitSize:n}}}},{key:"parseSPS",value:function(t){var n=new hs(t);n.readUByte();var e=n.readUByte(),s=n.readUByte(),r=n.readUByte();n.skipUEG();var l=420;if(e===100||e===110||e===122||e===244||e===44||e===83||e===86||e===118||e===128||e===138||e===144){var o=n.readUEG();if(o<=3&&(l=[0,420,422,444][o]),o===3&&n.skipBits(1),n.skipUEG(),n.skipUEG(),n.skipBits(1),n.readBool())for(var u=o!==3?8:12,c=0;c<u;c++)n.readBool()&&(c<6?n.skipScalingList(16):n.skipScalingList(64))}n.skipUEG();var p=n.readUEG();if(p===0)n.readUEG();else if(p===1){n.skipBits(1),n.skipUEG(),n.skipUEG();for(var m=n.readUEG(),f=0;f<m;f++)n.skipUEG()}n.skipUEG(),n.skipBits(1);var b=n.readUEG(),v=n.readUEG(),g=n.readBits(1);g===0&&n.skipBits(1),n.skipBits(1);var X=0,D=0,F=0,w=0;n.readBool()&&(X=n.readUEG(),D=n.readUEG(),F=n.readUEG(),w=n.readUEG());var S,G,T,C,I;if(n.readBool()){if(n.readBool()){var E=n.readUByte();switch(E){case 1:S=[1,1];break;case 2:S=[12,11];break;case 3:S=[10,11];break;case 4:S=[16,11];break;case 5:S=[40,33];break;case 6:S=[24,11];break;case 7:S=[20,11];break;case 8:S=[32,11];break;case 9:S=[80,33];break;case 10:S=[18,11];break;case 11:S=[15,11];break;case 12:S=[64,33];break;case 13:S=[160,99];break;case 14:S=[4,3];break;case 15:S=[3,2];break;case 16:S=[2,1];break;case 255:{S=[n.readUByte()<<8|n.readUByte(),n.readUByte()<<8|n.readUByte()];break}}}if(n.readBool()&&n.readBool(),n.readBool()&&(n.readBits(4),n.readBool()&&n.readBits(24)),n.readBool()&&(n.readUEG(),n.readUEG()),n.readBool()){var U=n.readBits(32),h=n.readBits(32);G=n.readBool(),T=h,C=U*2,I=T/C}}return{codec:da(t.subarray(1,4)),profileIdc:e,profileCompatibility:s,levelIdc:r,chromaFormat:l,width:Math.ceil((b+1)*16-2*(X+D)),height:(2-g)*(v+1)*16-(g?2:4)*(F+w),sarRatio:S,fpsNum:T,fpsDen:C,fps:I,fixedFrame:G}}}]),a}(),ms=function(){function a(){oe(this,a)}return ue(a,null,[{key:"parseHEVCDecoderConfigurationRecord",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!(t.length<23)){n=n||{};for(var e=(t[21]&3)+1,s,r,l=[],o=[],u=[],c=23,p=t[22],m,f,b,v=0;v<p;v++){m=t[c]&63,f=t[c+1]<<8|t[c+2],c+=3;for(var g=0;g<f;g++)if(b=t[c]<<8|t[c+1],c+=2,!!b){switch(m){case 32:{var X=t.subarray(c,c+b);s||(s=a.parseVPS(tt.removeEPB(X),n)),u.push(X)}break;case 33:{var D=t.subarray(c,c+b);r||(r=a.parseSPS(tt.removeEPB(D),n)),l.push(D)}break;case 34:o.push(t.subarray(c,c+b));break}c+=b}}return{hvcC:n,sps:r,spsArr:l,ppsArr:o,vpsArr:u,nalUnitSize:e}}}},{key:"parseVPS",value:function(t,n){n=n||{};var e=new hs(t);e.readUByte(),e.readUByte(),e.readBits(12);var s=e.readBits(3);return n.numTemporalLayers=Math.max(n.numTemporalLayers||0,s+1),e.readBits(17),a._parseProfileTierLevel(e,s,n),n}},{key:"parseSPS",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n=n||{};var e=new hs(t);e.readUByte(),e.readUByte(),e.readBits(4);var s=e.readBits(3);n.numTemporalLayers=Math.max(s+1,n.numTemporalLayers||0),n.temporalIdNested=e.readBits(1),a._parseProfileTierLevel(e,s,n),e.readUEG();var r=n.chromaFormatIdc=e.readUEG(),l=420;r<=3&&(l=[0,420,422,444][r]);var o=0;r===3&&(o=e.readBits(1));var u=e.readUEG(),c=e.readUEG(),p=e.readBits(1),m,f,b,v;if(p===1&&(m=e.readUEG(),f=e.readUEG(),b=e.readUEG(),v=e.readUEG()),n.bitDepthLumaMinus8=e.readUEG(),n.bitDepthChromaMinus8=e.readUEG(),p===1){var g=(r===1||r===2)&&o===0?2:1,X=r===1&&o===0?2:1;u-=g*(f+m),c-=X*(v+b)}return{codec:"hev1.1.6.L93.B0",width:u,height:c,chromaFormat:l,hvcC:n}}},{key:"_parseProfileTierLevel",value:function(t,n,e){var s=e.generalTierFlag||0;e.generalProfileSpace=t.readBits(2),e.generalTierFlag=Math.max(t.readBits(1),s),e.generalProfileIdc=Math.max(t.readBits(5),e.generalProfileIdc||0),e.generalProfileCompatibilityFlags=t.readBits(32),e.generalConstraintIndicatorFlags=[t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8)];var r=t.readBits(8);s<e.generalTierFlag?e.generalLevelIdc=r:e.generalLevelIdc=Math.max(r,e.generalLevelIdc||0);for(var l=[],o=[],u=0;u<n;u++)l[u]=t.readBits(1),o[u]=t.readBits(1);n>0&&t.readBits((8-n)*2);for(var c=0;c<n;c++)l[c]!==0&&(t.readBits(2),t.readBits(1),t.readBits(5),t.readBits(16),t.readBits(16),t.readBits(4),t.readBits(16),t.readBits(16),t.readBits(12)),o[c]!==0&&t.readBits(8)}}]),a}(),sr=function(){function a(){oe(this,a)}return ue(a,null,[{key:"decode",value:function(t){for(var n=[],e=t,s=0,r=t.length;s<r;){if(e[s]<128){n.push(String.fromCharCode(e[s])),++s;continue}else if(!(e[s]<192)){if(e[s]<224){if(a._checkContinuation(e,s,1)){var l=(e[s]&31)<<6|e[s+1]&63;if(l>=128){n.push(String.fromCharCode(l&65535)),s+=2;continue}}}else if(e[s]<240){if(a._checkContinuation(e,s,2)){var o=(e[s]&15)<<12|(e[s+1]&63)<<6|e[s+2]&63;if(o>=2048&&(o&63488)!==55296){n.push(String.fromCharCode(o&65535)),s+=3;continue}}}else if(e[s]<248&&a._checkContinuation(e,s,3)){var u=(e[s]&7)<<18|(e[s+1]&63)<<12|(e[s+2]&63)<<6|e[s+3]&63;if(u>65536&&u<1114112){u-=65536,n.push(String.fromCharCode(u>>>10|55296)),n.push(String.fromCharCode(u&1023|56320)),s+=4;continue}}}n.push(String.fromCharCode(65533)),++s}return n.join("")}},{key:"_checkContinuation",value:function(t,n,e){var s=t;if(n+e<s.length){for(;e--;)if((s[++n]&192)!==128)return!1;return!0}else return!1}}]),a}(),tl=function(){function a(){oe(this,a)}return ue(a,null,[{key:"parse",value:function(t){if(!(t.length<3)){var n={},e=a._parseValue(new DataView(t.buffer,t.byteOffset,t.byteLength)),s=a._parseValue(new DataView(t.buffer,t.byteOffset+e.size,t.byteLength-e.size));return n[e.data]=s.data,n}}},{key:"_parseValue",value:function(t){var n=t.byteLength,e=t.getUint8(0),s=1,r=!1,l;switch(e){case 0:l=t.getFloat64(1),s+=8;break;case 1:{l=!!t.getUint8(1),s+=1;break}case 2:{var o=a._parseString(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s)),u=o.data,c=o.size;l=u,s+=c}break;case 3:{l={};var p=0;for((t.getUint32(n-4)&16777215)===9&&(p=3);s<n-4;){var m=a._parseObject(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s-p)),f=m.size,b=m.data,v=m.isEnd;if(v)break;l[b.name]=b.value,s+=f}if(s<=n-3){var g=t.getUint32(s-1)&16777215;g===9&&(s+=3)}}break;case 8:{l={},s+=4;var X=0;for((t.getUint32(n-4)&16777215)===9&&(X=3);s<n-8;){var D=a._parseObject(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s-X)),F=D.size,w=D.data,S=D.isEnd;if(S)break;l[w.name]=w.value,s+=F}if(s<=n-3){var G=t.getUint32(s-1)&16777215;G===9&&(s+=3)}}break;case 9:l=void 0,s=1,r=!0;break;case 10:{l=[];var T=t.getUint32(1);s+=4;for(var C=0;C<T;C++){var I=a._parseValue(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s)),E=I.data,U=I.size;l.push(E),s+=U}}break;case 11:{var h=t.getFloat64(s)+t.getInt16(s+8)*6e4;l=new Date(h),s+=10}break;case 12:{var d=t.getUint32(1);s+=4,l="",d>0&&(l=sr.decode(new Uint8Array(t.buffer,t.byteOffset+s,d))),s+=d}break;default:s=n;break}return{data:l,size:s,isEnd:r}}},{key:"_parseString",value:function(t){var n=t.getUint16(0),e="";return n>0&&(e=sr.decode(new Uint8Array(t.buffer,t.byteOffset+2,n))),{data:e,size:2+n}}},{key:"_parseObject",value:function(t){if(!(t.byteLength<3)){var n=a._parseString(t),e=a._parseValue(new DataView(t.buffer,t.byteOffset+n.size,t.byteLength-n.size));return{data:{name:n.data,value:e.data},size:n.size+e.size,isEnd:e.isEnd}}}}]),a}(),ot=new Vt("FlvDemuxer"),ma=function(){function a(i,t,n){oe(this,a),V(this,"_headerParsed",!1),V(this,"_remainingData",null),V(this,"_gopId",0),V(this,"_needAddMetaBeforeKeyFrameNal",!0),this.videoTrack=i||new Rn,this.audioTrack=t||new Vn,this.metadataTrack=n||new xn,this._fixer=new ji(this.videoTrack,this.audioTrack,this.metadataTrack)}return ue(a,[{key:"demux",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=this.audioTrack,r=this.videoTrack,l=this.metadataTrack;if((n||!e)&&(this._remainingData=null,this._headerParsed=!1),n?(r.reset(),s.reset(),l.reset()):(r.samples=[],s.samples=[],l.seiSamples=[],l.flvScriptSamples=[],r.warnings=[],s.warnings=[],this._remainingData&&(t=Oe(this._remainingData,t),this._remainingData=null)),!t.length)return{videoTrack:r,audioTrack:s,metadataTrack:l};var o=0;if(!this._headerParsed){if(!a.probe(t))throw new Error("Invalid flv file");s.present=(t[4]&4)>>>2!==0,r.present=(t[4]&1)!==0,this._headerParsed=!0,o=H(t,5)+4}for(var u=t.length,c,p,m,f,b;o+15<u&&(c=t[o],p=t[o+1]<<16|t[o+2]<<8|t[o+3],!(o+15+p>u));)m=(t[o+7]<<24>>>0)+(t[o+4]<<16)+(t[o+5]<<8)+t[o+6],o+=11,f=t.subarray(o,o+p),c===8?this._parseAudio(f,m):c===9?this._parseVideo(f,m):c===18?this._parseScript(f,m):ot.warn("Invalid tag type: ".concat(c)),o+=p,b=H(t,o),b!==11+p&&ot.warn("Invalid PrevTagSize ".concat(b," (").concat(11+p,")")),o+=4;return o<u&&(this._remainingData=t.subarray(o)),s.formatTimescale=r.formatTimescale=r.timescale=l.timescale=1e3,s.timescale=s.sampleRate||0,!s.exist()&&s.hasSample()&&s.reset(),!r.exist()&&r.hasSample()&&r.reset(),{videoTrack:r,audioTrack:s,metadataTrack:l}}},{key:"fix",value:function(t,n,e){return this._fixer.fix(t,n,e),{videoTrack:this.videoTrack,audioTrack:this.audioTrack,metadataTrack:this.metadataTrack}}},{key:"demuxAndFix",value:function(t,n,e,s){return this.demux(t,n,e),this.fix(s,n,e)}},{key:"_parseAudio",value:function(t,n){if(t.length){var e=(t[0]&240)>>>4,s=this.audioTrack;if(e!==10&&e!==7&&e!==8){ot.warn("Unsupported sound format: ".concat(e)),s.reset();return}if(e!==10){var r=(t[0]&12)>>2,l=(t[0]&2)>>1,o=t[0]&1;s.sampleRate=a.AUDIO_RATE[r],s.sampleSize=l?16:8,s.channelCount=o+1}e===10?this._parseAac(t,n):this._parseG711(t,n,e)}}},{key:"_parseG711",value:function(t,n,e){var s=this.audioTrack;s.codecType=e===7?it.G711PCMA:it.G711PCMU,s.sampleRate=8e3,s.codec=s.codecType,s.samples.push(new ft(n,t.subarray(1)))}},{key:"_parseAac",value:function(t,n){var e=this.audioTrack;if(e.codecType=it.AAC,t[1]===0){var s=je.parseAudioSpecificConfig(t.subarray(2));s?(e.codec=s.codec,e.channelCount=s.channelCount,e.sampleRate=s.sampleRate,e.config=s.config,e.objectType=s.objectType,e.sampleRateIndex=s.samplingFrequencyIndex):(e.reset(),ot.warn("Cannot parse AudioSpecificConfig",t))}else if(t[1]===1){if(n==null)return;e.samples.push(new ft(n,t.subarray(2)))}else ot.warn("Unknown AACPacketType: ".concat(t[1]))}},{key:"_parseVideo",value:function(t,n){var e=this;if(!(t.length<6)){var s=(t[0]&240)>>>4,r=t[0]&15,l=this.videoTrack;if(r!==7&&r!==12){l.reset(),ot.warn("Unsupported codecId: ".concat(r));return}var o=r===12;l.codecType=o?ht.HEVC:ht.AVC;var u=t[1],c=(t[2]<<16|t[3]<<8|t[4])<<8>>8;if(u===0){var p=t.subarray(5),m=o?ms.parseHEVCDecoderConfigurationRecord(p):ha.parseAVCDecoderConfigurationRecord(p);if(m){var f=m.hvcC,b=m.sps,v=m.ppsArr,g=m.spsArr,X=m.vpsArr,D=m.nalUnitSize;f&&(l.hvcC=l.hvcC||f),b&&(l.codec=b.codec,l.width=b.width,l.height=b.height,l.sarRatio=b.sarRatio,l.fpsNum=b.fpsNum,l.fpsDen=b.fpsDen),g.length&&(l.sps=g),v.length&&(l.pps=v),X&&X.length&&(l.vps=X),D&&(l.nalUnitSize=D)}else ot.warn("Cannot parse ".concat(o?"HEVC":"AVC","DecoderConfigurationRecord"),t)}else if(u===1){var F=tt.parseAvcC(t.subarray(5),l.nalUnitSize);if(F=this._checkAddMetaNalToUnits(o,F,l),F&&F.length){var w=new tn(n+c,n,F);s===1&&w.setToKeyframe(),l.samples.push(w),F.forEach(function(S){var G=o?S[0]>>>1&63:S[0]&31;switch(G){case 5:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:if(!o&&G!==5||o&&G===5)break;w.setToKeyframe();break;case 6:case 39:case 40:if(!o&&G!==6||o&&G===6)break;e.metadataTrack.seiSamples.push(new ca(tt.parseSEI(tt.removeEPB(S),o),n+c));break}}),w.keyframe&&this._gopId++,w.gopId=this._gopId}else ot.warn("Cannot parse NALUs",t)}else u===2||ot.warn("Unknown AVCPacketType: ".concat(u))}}},{key:"_checkAddMetaNalToUnits",value:function(t,n,e){if(!t||!this._needAddMetaBeforeKeyFrameNal)return this._needAddMetaBeforeKeyFrameNal=!1,n;var s=n.map(function(r){return r[0]>>>1&63});return s.includes(32)?(this._needAddMetaBeforeKeyFrameNal=!1,n):(n.unshift(e.pps[0]),n.unshift(e.sps[0]),n.unshift(e.vps[0]),n.filter(Boolean))}},{key:"_parseScript",value:function(t,n){this.metadataTrack.flvScriptSamples.push(new Ai(tl.parse(t),n))}}],[{key:"probe",value:function(t){return t[0]!==70||t[1]!==76||t[2]!==86||t[3]!==1?!1:H(t,5)>=9}}]),a}();V(ma,"AUDIO_RATE",[5500,11e3,22e3,44e3]);var nl=9e4/2,rr=3,On=9e4,Jn=5*9e4,Bn=9e4,sl=9e4/2,rl=function(){function a(i,t,n){oe(this,a),this.videoTrack=i,this.audioTrack=t,this.metadataTrack=n,this._baseDts=-1,this._baseDtsInited=!1,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=!1,this._videoTimestampBreak=!1,this._lastAudioExceptionGapDot=0,this._lastAudioExceptionOverlapDot=0,this._lastAudioExceptionLargeGapDot=0}return ue(a,[{key:"fix",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;n=Math.round(n*9e4);var r=this.videoTrack,l=this.audioTrack,o=r.samples,u=l.samples;if(!(!o.length&&!u.length)){var c=o[0],p=u[0],m=0;if(o.length&&u.length&&(m=c.dts-p.pts),this._baseDtsInited||this._calculateBaseDts(this.audioTrack,this.videoTrack),e&&(this._calculateBaseDts(this.audioTrack,this.videoTrack),this._baseDts-=n),!s){this._videoNextDts=m>0?n+m:n,this._audioNextPts=m>0?n:n-m;var f=c?c.dts-this._baseDts-this._videoNextDts:0,b=p?p.pts-this._baseDts-this._audioNextPts:0;Math.abs(f||b)>Bn&&(this._calculateBaseDts(this.audioTrack,this.videoTrack),this._baseDts-=n)}if(this._resetBaseDtsWhenStreamBreaked(),this._fixAudio(l),this._fixVideo(r),this.metadataTrack.exist()){var v=this.metadataTrack.timescale;this.metadataTrack.seiSamples.forEach(function(g){g.pts=g.originPts-t._baseDts,g.time=Math.max(0,g.pts)/v})}r.samples.length&&(r.baseMediaDecodeTime=r.samples[0].dts),l.samples.length&&(l.baseMediaDecodeTime=l.samples[0].pts*l.timescale/9e4)}}},{key:"_fixVideo",value:function(t){var n=this,e=t.samples;if(e.length){if(e.forEach(function(F){F.dts-=n._baseDts,F.pts-=n._baseDts}),this._videoNextDts===void 0){var s=e[0];this._videoNextDts=s.dts}var r=e.length,l=0,o=e[0],u=e[1],c=this._videoNextDts-o.dts;if(Math.abs(c)>sl){var p;o.dts+=c,o.pts+=c,t.warnings.push({type:de.LARGE_VIDEO_GAP_BETWEEN_CHUNK,nextDts:this._videoNextDts,firstSampleDts:o.dts,nextSampleDts:(p=e[1])===null||p===void 0?void 0:p.dts,sampleDuration:c}),u&&Math.abs(u.dts-o.dts)>Bn&&(this._videoTimestampBreak=!0,e.forEach(function(F,w){w!==0&&(F.dts+=c,F.pts+=c)}))}var m;if(t.fpsNum&&t.fpsDen)m=t.timescale*(t.fpsDen/t.fpsNum);else{var f=t.samples[0],b=t.samples[r-1];m=r===1?9e3:Math.floor((b.dts-f.dts)/(r-1))}for(var v=0;v<r;v++){var g=e[v].dts,X=e[v+1];if(v<r-1?l=X.dts-g:e[v-1]?l=Math.min(g-e[v-1].dts,m):l=m,l>Bn||l<0){this._videoTimestampBreak=!0,l=this._audioTimestampBreak?m:Math.max(l,30*90);var D=this._audioNextPts||0;X&&X.dts>D&&(l=m),t.warnings.push({type:de.LARGE_VIDEO_GAP,time:g/t.timescale,dts:g,originDts:e[v].originDts,nextDts:this._videoNextDts,sampleDuration:l,refSampleDuration:m})}e[v].duration=l,this._videoNextDts+=l}}}},{key:"_fixAudio",value:function(t){var n=this,e=t.samples;e.length&&(e.forEach(function(s){s.pts-=n._baseDts,s.dts=s.pts}),this._doFixAudioInternal(t,e,9e4))}},{key:"_calculateBaseDts",value:function(t,n){var e=t.samples,s=n.samples;if(!e.length&&!s.length)return!1;var r=1/0,l=1/0;e.length&&(t.baseDts=r=e[0].pts),s.length&&(n.baseDts=l=s[0].dts),this._baseDts=Math.min(r,l);var o=l-r;return Number.isFinite(o)&&Math.abs(o)>nl&&n.warnings.push({type:de.LARGE_AV_SHIFT,videoBaseDts:l,audioBasePts:r,baseDts:this._baseDts,delta:o}),this._baseDtsInited=!0,!0}},{key:"_resetBaseDtsWhenStreamBreaked",value:function(){if(this._baseDtsInited&&this._videoTimestampBreak&&this._audioTimestampBreak){var t=this._calculateBaseDts(this.audioTrack,this.videoTrack);if(!t)return;this._baseDts-=Math.min(this._audioNextPts,this._videoNextDts),this._audioLastSample=null,this._videoLastSample=null,this._videoTimestampBreak=!1,this._audioTimestampBreak=!1}}},{key:"_doFixAudioInternal",value:function(t,n,e){t.sampleDuration||(t.sampleDuration=je.getFrameDuration(t.timescale,e));var s=t.sampleDuration;if(this._audioNextPts===void 0){var r=n[0];this._audioNextPts=r.pts}for(var l=0;l<n.length;l++){var o=this._audioNextPts,u=n[l],c=u.pts-o;if(!this._audioTimestampBreak&&c>=rr*s&&c<=On&&!pa){var p=je.getSilentFrame(t.codec,t.channelCount)||n[0].data.subarray(),m=Math.floor(c/s);Math.abs(u.pts-this._lastAudioExceptionGapDot)>Jn&&(this._lastAudioExceptionGapDot=u.pts),t.warnings.push({type:de.AUDIO_FILLED,pts:u.pts,originPts:u.originPts,count:m,nextPts:o,refSampleDuration:s});for(var f=0;f<m;f++){var b=new ft(Math.floor(o),p);b.originPts=Math.floor(this._baseDts+o),n.splice(l,0,b),this._audioNextPts+=s,l++}l--}else c<=-rr*s&&c>=-1*On?(Math.abs(u.pts-this._lastAudioExceptionOverlapDot)>Jn&&(this._lastAudioExceptionOverlapDot=u.pts,t.warnings.push({type:de.AUDIO_DROPPED,pts:u.pts,originPts:u.originPts,nextPts:o,refSampleDuration:s})),n.splice(l,1),l--):(Math.abs(c)>=On&&(this._audioTimestampBreak=!0,Math.abs(u.pts-this._lastAudioExceptionLargeGapDot)>Jn&&(this._lastAudioExceptionLargeGapDot=u.pts,t.warnings.push({type:de.LARGE_AUDIO_GAP,time:u.pts/1e3,pts:u.pts,originPts:u.originPts,nextPts:o,sampleDuration:c,refSampleDuration:s}))),u.dts=u.pts=o,this._audioNextPts+=s)}}}]),a}(),Qe=new Vt("TsDemuxer"),fa=function(){function a(i,t,n){oe(this,a),V(this,"_pmtId",-1),V(this,"_remainingPacketData",null),V(this,"_videoPesData",[]),V(this,"_audioPesData",[]),V(this,"_gopId",0),this.videoTrack=i||new Rn,this.audioTrack=t||new Vn,this.metadataTrack=n||new xn,this._fixer=new rl(this.videoTrack,this.audioTrack,this.metadataTrack)}return ue(a,[{key:"demux",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=this.audioTrack,r=this.videoTrack,l=this.metadataTrack;n&&(this._pmtId=-1,r.reset(),s.reset(),l.reset()),!e||n?(this._remainingPacketData=null,this._videoPesData=[],this._audioPesData=[]):(r.samples=[],s.samples=[],l.seiSamples=[],r.warnings=[],s.warnings=[],this._remainingPacketData&&(t=Oe(this._remainingPacketData,t),this._remainingPacketData=null));var o=t.length,u=o%188;u&&(this._remainingPacketData=t.subarray(o-u),o-=u);for(var c=r.pid,p=s.pid,m=0;m<o;m+=188){if(t[m]!==71)throw new Error("TS packet did not start with 0x47");var f=!!(t[m+1]&64),b=((t[m+1]&31)<<8)+t[m+2],v=(t[m+3]&48)>>4,g=void 0;if(v>1){if(g=m+5+t[m+4],g===m+188)continue}else g=m+4;switch(b){case 0:f&&(g+=t[g]+1),this._pmtId=(t[g+10]&31)<<8|t[g+11];break;case this._pmtId:{f&&(g+=t[g]+1);var X=g+3+((t[g+1]&15)<<8|t[g+2])-4,D=(t[g+10]&15)<<8|t[g+11];for(g+=12+D;g<X;){var F=(t[g+1]&31)<<8|t[g+2];switch(t[g]){case 15:s.pid=p=F;break;case 27:if(c!==-1)break;r.codecType=ht.AVC,r.pid=c=F;break;case 36:if(c!==-1)break;r.codecType=ht.HEVC,r.pid=c=F;break;default:Qe.warn("Unsupported stream. type: ".concat(t[g],", pid: ").concat(F))}g+=((t[g+3]&15)<<8|t[g+4])+5}}break;case c:f&&this._videoPesData.length&&this._parseVideoData(),this._videoPesData.push(t.subarray(g,m+188));break;case p:f&&this._audioPesData.length&&this._parseAudioData(),this._audioPesData.push(t.subarray(g,m+188));break;case 17:case 8191:break;default:Qe.warn("Unknown pid: ".concat(b))}}return this._parseVideoData(),this._parseAudioData(),s.formatTimescale=r.formatTimescale=r.timescale=l.timescale=9e4,s.timescale=s.sampleRate||0,{videoTrack:r,audioTrack:s,metadataTrack:l}}},{key:"fix",value:function(t,n,e){return this._fixer.fix(t,n,e),{videoTrack:this.videoTrack,audioTrack:this.audioTrack,metadataTrack:this.metadataTrack}}},{key:"demuxAndFix",value:function(t,n,e,s){return this.demux(t,n,e),this.fix(s,n,e)}},{key:"_parseVideoData",value:function(){if(this._videoPesData.length){var t=a._parsePES(Oe.apply(void 0,We(this._videoPesData)));if(!t){Qe.warn("Cannot parse video pes",this._videoPesData);return}var n=tt.parseAnnexB(t.data);n?this._createVideoSample(n,t.pts,t.dts):Qe.warn("Cannot parse avc units",t),this._videoPesData=[]}}},{key:"_createVideoSample",value:function(t,n,e){var s=this;if(t.length){var r=this.videoTrack,l=r.codecType===ht.HEVC,o=new tn(n,e);t.forEach(function(u){var c=l?u[0]>>>1&63:u[0]&31;switch(c){case 5:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:if(!l&&c!==5||l&&c===5)break;o.setToKeyframe(),s._gopId++;break;case 6:case 39:case 40:if(!l&&c!==6||l&&c===6)break;s.metadataTrack.seiSamples.push(new ca(tt.parseSEI(tt.removeEPB(u),l),n));return;case 32:if(!l)break;if(!r.vps.length){var p=ms.parseVPS(tt.removeEPB(u),r.hvcC);r.hvcC=r.hvcC||p,r.vps=[u]}break;case 7:case 33:if(!l&&c!==7||l&&c===7)break;if(!r.sps.length){var m=tt.removeEPB(u),f=l?ms.parseSPS(m,r.hvcC):ha.parseSPS(m);r.sps=[u],r.hvcC=r.hvcC||f.hvcC,r.codec=f.codec,r.width=f.width,r.height=f.height,r.sarRatio=f.sarRatio,r.fpsNum=f.fpsNum,r.fpsDen=f.fpsDen}break;case 8:case 34:if(!l&&c!==8||l&&c===8)break;r.pps.length||(r.pps=[u]);break}o.units.push(u)}),o.gopId=this._gopId,this._pushVideoSample(r,o)}}},{key:"_pushVideoSample",value:function(t,n){if(n.units.length)if(n.pts===null||n.pts===void 0){Qe.warn("Video sample no pts",n);var e=t.samples[t.samples.length-1];e?(n.pts=e.pts,n.dts=e.dts):Qe.warn("Drop video sample",n)}else t.samples.push(n)}},{key:"_parseAudioData",value:function(){if(this._audioPesData.length){var t=a._parsePES(Oe.apply(void 0,We(this._audioPesData)));if(!t){Qe.warn("Cannot parse audio pes",this._audioPesData);return}this._parseAacData(t),this._audioPesData=[]}}},{key:"_parseAacData",value:function(t){var n=this.audioTrack,e=t.pts;if(e==null){if(Qe.warn("AAC pes not pts",n),!n.samples.length||!n.sampleRate)return;e=n.samples[n.samples.length-1].pts+je.getFrameDuration(n.sampleRate)}var s=je.parseADTS(t.data,e);if(s){var r;n.codec=s.codec,n.channelCount=s.channelCount,n.sampleRate=s.sampleRate,n.objectType=s.objectType,n.sampleRateIndex=s.samplingFrequencyIndex,n.config=s.config,(r=n.samples).push.apply(r,We(s.frames.map(function(l){return new ft(l.pts,l.data)}))),s.skip&&Qe.warn("Skip aac adts ".concat(s.skip," bits")),s.remaining&&Qe.warn("Remaining aac adts ".concat(s.remaining," bits"))}else Qe.warn("Cannot parse aac adts",t)}}],[{key:"probe",value:function(t){return t.length?t[0]===71&&t[188]===71&&t[376]===71:!1}},{key:"_parsePES",value:function(t){var n=t[8];if(!(n==null||t.length<n+9)){var e=t[0]<<16|t[1]<<8|t[2];if(e===1){var s=(t[4]<<8)+t[5];if(!(s&&s>t.length-6)){var r,l,o=t[7];return o&192&&(r=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,o&64?(l=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,r-l>60*9e4&&(r=l)):l=r),{data:t.subarray(9+n),pts:r,dts:l}}}}}}]),a}(),re=function(){function a(){oe(this,a)}return ue(a,null,[{key:"findBox",value:function(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=[];if(!t)return s;for(var r=0,l="",o=0;t.length>7;){if(r=H(t),l=String.fromCharCode.apply(null,t.subarray(4,8)),o=8,r===1?(r=vt(t,8),o+=8):r||(r=t.length),!n[0]||l===n[0]){var u=t.subarray(0,r);if(n.length<2)s.push({start:e,size:r,headerSize:o,type:l,data:u});else return a.findBox(u.subarray(o),n.slice(1),e+o)}e+=r,t=t.subarray(r)}return s}},{key:"tfhd",value:function(t){return B(t,!0,function(n,e){n.trackId=H(e);var s=4,r=n.flags&255&1,l=n.flags&255&2,o=n.flags&255&8,u=n.flags&255&16,c=n.flags&255&32;r&&(s+=4,n.baseDataOffset=H(e,s),s+=4),l&&(n.sampleDescriptionIndex=H(e,s),s+=4),o&&(n.defaultSampleDuration=H(e,s),s+=4),u&&(n.defaultSampleSize=H(e,s),s+=4),c&&(n.defaultSampleFlags=H(e,s))})}},{key:"sidx",value:function(t){return B(t,!0,function(n,e){var s=0;n.reference_ID=H(e,s),s+=4,n.timescale=H(e,s),s+=4,n.version===0?(n.earliest_presentation_time=H(e,s),s+=4,n.first_offset=H(e,s),s+=4):(n.earliest_presentation_time=vt(e,s),s+=8,n.first_offset=vt(e,s),s+=8),s+=2,n.references=[];var r=ce(e,s);s+=2;for(var l=0;l<r;l++){var o={};n.references.push(o);var u=H(e,s);s+=4,o.reference_type=u>>31&1,o.referenced_size=u&2147483647,o.subsegment_duration=H(e,s),s+=4,u=H(e,s),s+=4,o.starts_with_SAP=u>>31&1,o.SAP_type=u>>28&7,o.SAP_delta_time=u&268435455}})}},{key:"moov",value:function(t){return B(t,!1,function(n,e,s){n.mvhd=a.mvhd(a.findBox(e,["mvhd"],s)[0]),n.trak=a.findBox(e,["trak"],s).map(function(r){return a.trak(r)}),n.pssh=a.pssh(a.findBox(e,["pssh"],s)[0])})}},{key:"mvhd",value:function(t){return B(t,!0,function(n,e){var s=0;n.version===1?(n.timescale=H(e,16),n.duration=vt(e,20),s+=28):(n.timescale=H(e,8),n.duration=H(e,12),s+=16),n.nextTrackId=H(e,s+76)})}},{key:"trak",value:function(t){return B(t,!1,function(n,e,s){n.tkhd=a.tkhd(a.findBox(e,["tkhd"],s)[0]),n.mdia=a.mdia(a.findBox(e,["mdia"],s)[0])})}},{key:"tkhd",value:function(t){return B(t,!0,function(n,e){var s=0;n.version===1?(n.trackId=H(e,16),n.duration=vt(e,24),s+=32):(n.trackId=H(e,8),n.duration=H(e,16),s+=20),n.width=H(e,s+52),n.height=H(e,s+56)})}},{key:"mdia",value:function(t){return B(t,!1,function(n,e,s){n.mdhd=a.mdhd(a.findBox(e,["mdhd"],s)[0]),n.hdlr=a.hdlr(a.findBox(e,["hdlr"],s)[0]),n.minf=a.minf(a.findBox(e,["minf"],s)[0])})}},{key:"mdhd",value:function(t){return B(t,!0,function(n,e){var s=0;n.version===1?(n.timescale=H(e,16),n.duration=vt(e,20),s+=28):(n.timescale=H(e,8),n.duration=H(e,12),s+=16);var r=ce(e,s);n.language=String.fromCharCode((r>>10&31)+96,(r>>5&31)+96,(r&31)+96)})}},{key:"hdlr",value:function(t){return B(t,!0,function(n,e){n.version===0&&(n.handlerType=String.fromCharCode.apply(null,e.subarray(4,8)))})}},{key:"minf",value:function(t){return B(t,!1,function(n,e,s){n.vmhd=a.vmhd(a.findBox(e,["vmhd"],s)[0]),n.smhd=a.smhd(a.findBox(e,["smhd"],s)[0]),n.stbl=a.stbl(a.findBox(e,["stbl"],s)[0])})}},{key:"vmhd",value:function(t){return B(t,!0,function(n,e){n.graphicsmode=ce(e),n.opcolor=[ce(e,2),ce(e,4),ce(e,6)]})}},{key:"smhd",value:function(t){return B(t,!0,function(n,e){n.balance=ce(e)})}},{key:"stbl",value:function(t){return B(t,!1,function(n,e,s){var r,l,o;n.stsd=a.stsd(a.findBox(e,["stsd"],s)[0]),n.stts=a.stts(a.findBox(e,["stts"],s)[0]),n.ctts=a.ctts(a.findBox(e,["ctts"],s)[0]),n.stsc=a.stsc(a.findBox(e,["stsc"],s)[0]),n.stsz=a.stsz(a.findBox(e,["stsz"],s)[0]),n.stco=a.stco(a.findBox(e,["stco"],s)[0]),n.stco||(n.co64=a.co64(a.findBox(e,["co64"],s)[0]),n.stco=n.co64);var u=(r=n.stsd.entries[0])===null||r===void 0||(l=r.sinf)===null||l===void 0||(o=l.schi)===null||o===void 0?void 0:o.tenc.default_IV_size;n.stss=a.stss(a.findBox(e,["stss"],s)[0]),n.senc=a.senc(a.findBox(e,["senc"],s)[0],u)})}},{key:"senc",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;return B(t,!0,function(e,s){var r=0,l=H(s,r);r+=4,e.samples=[];for(var o=0;o<l;o++){var u={};u.InitializationVector=[];for(var c=0;c<n;c++)u.InitializationVector[c]=s[r+c];if(r+=n,e.flags&2){u.subsamples=[];var p=ce(s,r);r+=2;for(var m=0;m<p;m++){var f={};f.BytesOfClearData=ce(s,r),r+=2,f.BytesOfProtectedData=H(s,r),r+=4,u.subsamples.push(f)}}e.samples.push(u)}})}},{key:"pssh",value:function(t){return B(t,!0,function(n,e){for(var s=[],r=[],l=0,o=0;o<16;o++)r.push(jn(e[l+o]));if(l+=16,n.version>0){var u=H(e,l);l+=4;for(var c=0;c<(""+u).length;c++)for(var p=0;p<16;p++){var m=e[l];l+=1,s.push(jn(m))}}var f=H(e,l);n.data_size=f,l+=4,n.kid=s,n.system_id=r,n.buffer=e})}},{key:"stsd",value:function(t){return B(t,!0,function(n,e,s){n.entryCount=H(e),n.entries=a.findBox(e.subarray(4),[],s+4).map(function(r){switch(r.type){case"avc1":case"avc2":case"avc3":case"avc4":return a.avc1(r);case"hvc1":case"hev1":return a.hvc1(r);case"mp4a":return a.mp4a(r);case"alaw":case"ulaw":return a.alaw(r);case"enca":return B(r,!1,function(l,o,u){l.channelCount=ce(o,16),l.samplesize=ce(o,18),l.sampleRate=H(o,24)/65536,o=o.subarray(28),l.sinf=a.sinf(a.findBox(o,["sinf"],u)[0]),l.esds=a.esds(a.findBox(o,["esds"],u)[0])});case"encv":return B(r,!1,function(l,o,u){l.width=ce(o,24),l.height=ce(o,26),l.horizresolution=H(o,28),l.vertresolution=H(o,32),o=o.subarray(78),l.sinf=a.sinf(a.findBox(o,["sinf"],u)[0]),l.avcC=a.avcC(a.findBox(o,["avcC"],u)[0]),l.hvcC=a.hvcC(a.findBox(o,["hvcC"],u)[0]),l.pasp=a.pasp(a.findBox(o,["pasp"],u)[0])})}}).filter(Boolean)})}},{key:"tenc",value:function(t){return B(t,!1,function(n,e){var s=6;n.default_IsEncrypted=e[s],s+=1,n.default_IV_size=e[s],s+=1,n.default_KID=[];for(var r=0;r<16;r++)n.default_KID.push(jn(e[s])),s+=1})}},{key:"schi",value:function(t){return B(t,!1,function(n,e,s){n.tenc=a.tenc(a.findBox(e,["tenc"],s)[0])})}},{key:"sinf",value:function(t){return B(t,!1,function(n,e,s){n.schi=a.schi(a.findBox(e,["schi"],s)[0]),n.frma=a.frma(a.findBox(e,["frma"],s)[0])})}},{key:"frma",value:function(t){return B(t,!1,function(n,e){n.data_format="";for(var s=0;s<4;s++)n.data_format+=String.fromCharCode(e[s])})}},{key:"avc1",value:function(t){return B(t,!1,function(n,e,s){var r=ir(n,e),l=e.subarray(r);s+=r,n.avcC=a.avcC(a.findBox(l,["avcC"],s)[0]),n.pasp=a.pasp(a.findBox(l,["pasp"],s)[0])})}},{key:"avcC",value:function(t){return B(t,!1,function(n,e){n.configurationVersion=e[0],n.AVCProfileIndication=e[1],n.profileCompatibility=e[2],n.AVCLevelIndication=e[3],n.codec=da([e[1],e[2],e[3]]),n.lengthSizeMinusOne=e[4]&3,n.spsLength=e[5]&31,n.sps=[];for(var s=6,r=0;r<n.spsLength;r++){var l=ce(e,s);s+=2,n.sps.push(e.subarray(s,s+l)),s+=l}n.ppsLength=e[s],s+=1,n.pps=[];for(var o=0;o<n.ppsLength;o++){var u=ce(e,s);s+=2,n.pps.push(e.subarray(s,s+=u)),s+=u}})}},{key:"hvc1",value:function(t){return B(t,!1,function(n,e,s){var r=ir(n,e),l=e.subarray(r);s+=r,n.hvcC=a.hvcC(a.findBox(l,["hvcC"],s)[0]),n.pasp=a.pasp(a.findBox(l,["pasp"],s)[0])})}},{key:"hvcC",value:function(t){return B(t,!1,function(n,e){n.data=t.data,n.codec="hev1.1.6.L93.B0",n.configurationVersion=e[0];var s=e[1];n.generalProfileSpace=s>>6,n.generalTierFlag=(s&32)>>5,n.generalProfileIdc=s&31,n.generalProfileCompatibility=H(e,2),n.generalConstraintIndicatorFlags=e.subarray(6,12),n.generalLevelIdc=e[12],n.avgFrameRate=ce(e,19),n.numOfArrays=e[22],n.vps=[],n.sps=[],n.pps=[];for(var r=23,l=0,o=0,u=0,c=0;c<n.numOfArrays;c++){l=e[r]&63,o=ce(e,r+1),r+=3;for(var p=[],m=0;m<o;m++)u=ce(e,r),r+=2,p.push(e.subarray(r,r+u)),r+=u;if(l===32){var f;(f=n.vps).push.apply(f,p)}else if(l===33){var b;(b=n.sps).push.apply(b,p)}else if(l===34){var v;(v=n.pps).push.apply(v,p)}}})}},{key:"pasp",value:function(t){return B(t,!1,function(n,e){n.hSpacing=H(e),n.vSpacing=H(e,4)})}},{key:"mp4a",value:function(t){return B(t,!1,function(n,e,s){var r=lr(n,e);n.esds=a.esds(a.findBox(e.subarray(r),["esds"],s+r)[0])})}},{key:"esds",value:function(t){return B(t,!0,function(n,e){n.codec="mp4a.";for(var s=0,r=0,l=0,o=0;e.length;){for(s=0,o=e[s],r=e[s+1],s+=2;r&128;)l=(r&127)<<7,r=e[s],s+=1;if(l+=r&127,o===3)e=e.subarray(s+3);else if(o===4)n.codec+=(e[s].toString(16)+".").padStart(3,"0"),e=e.subarray(s+13);else if(o===5){var u=n.config=e.subarray(s,s+l),c=(u[0]&248)>>3;c===31&&u.length>=2&&(c=32+((u[0]&7)<<3)+((u[1]&224)>>5)),n.objectType=c,n.codec+=c.toString(16),n.codec[n.codec.length-1]==="."&&(n.codec=n.codec.substring(0,n.codec.length-1));return}else{n.codec[n.codec.length-1]==="."&&(n.codec=n.codec.substring(0,n.codec.length-1));return}}})}},{key:"alaw",value:function(t){return B(t,!1,function(n,e){lr(n,e)})}},{key:"stts",value:function(t){return B(t,!0,function(n,e){for(var s=H(e),r=[],l=4,o=0;o<s;o++)r.push({count:H(e,l),delta:H(e,l+4)}),l+=8;n.entryCount=s,n.entries=r})}},{key:"ctts",value:function(t){return B(t,!0,function(n,e){var s=H(e),r=[],l=4;if(n.version===1)for(var o=0;o<s;o++)r.push({count:H(e,l),offset:H(e,l+4)}),l+=8;else for(var u=0;u<s;u++)r.push({count:H(e,l),offset:-(~H(e,l+4)+1)}),l+=8;n.entryCount=s,n.entries=r})}},{key:"stsc",value:function(t){return B(t,!0,function(n,e){for(var s=H(e),r=[],l=4,o=0;o<s;o++)r.push({firstChunk:H(e,l),samplesPerChunk:H(e,l+4),sampleDescriptionIndex:H(e,l+8)}),l+=12;n.entryCount=s,n.entries=r})}},{key:"stsz",value:function(t){return B(t,!0,function(n,e){var s=H(e),r=H(e,4),l=[];if(!s)for(var o=8,u=0;u<r;u++)l.push(H(e,o)),o+=4;n.sampleSize=s,n.sampleCount=r,n.entrySizes=l})}},{key:"stco",value:function(t){return B(t,!0,function(n,e){for(var s=H(e),r=[],l=4,o=0;o<s;o++)r.push(H(e,l)),l+=4;n.entryCount=s,n.entries=r})}},{key:"co64",value:function(t){return B(t,!0,function(n,e){for(var s=H(e),r=[],l=4,o=0;o<s;o++)r.push(vt(e,l)),l+=8;n.entryCount=s,n.entries=r})}},{key:"stss",value:function(t){return B(t,!0,function(n,e){for(var s=H(e),r=[],l=4,o=0;o<s;o++)r.push(H(e,l)),l+=4;n.entryCount=s,n.entries=r})}},{key:"moof",value:function(t){return B(t,!1,function(n,e,s){n.mfhd=a.mfhd(a.findBox(e,["mfhd"],s)[0]),n.traf=a.findBox(e,["traf"],s).map(function(r){return a.traf(r)})})}},{key:"mfhd",value:function(t){return B(t,!0,function(n,e){n.sequenceNumber=H(e)})}},{key:"traf",value:function(t){return B(t,!1,function(n,e,s){n.tfhd=a.tfhd(a.findBox(e,["tfhd"],s)[0]),n.tfdt=a.tfdt(a.findBox(e,["tfdt"],s)[0]),n.trun=a.trun(a.findBox(e,["trun"],s)[0])})}},{key:"trun",value:function(t){return B(t,!0,function(n,e){var s=n.version,r=n.flags,l=e.length,o=n.sampleCount=H(e),u=4;if(l>u&&r&1&&(n.dataOffset=-(~H(e,u)+1),u+=4),l>u&&r&4&&(n.firstSampleFlags=H(e,u),u+=4),n.samples=[],l>u)for(var c,p=0;p<o;p++)c={},r&256&&(c.duration=H(e,u),u+=4),r&512&&(c.size=H(e,u),u+=4),r&1024&&(c.flags=H(e,u),u+=4),r&2048&&(s?c.cts=-(~H(e,u+4)+1):c.cts=H(e,u),u+=4),n.samples.push(c)})}},{key:"tfdt",value:function(t){return B(t,!0,function(n,e){n.version===1?n.baseMediaDecodeTime=vt(e):n.baseMediaDecodeTime=H(e)})}},{key:"probe",value:function(t){return!!a.findBox(t,["ftyp"])}},{key:"parseSampleFlags",value:function(t){return{isLeading:(t[0]&12)>>>2,dependsOn:t[0]&3,isDependedOn:(t[1]&192)>>>6,hasRedundancy:(t[1]&48)>>>4,paddingValue:(t[1]&14)>>>1,isNonSyncSample:t[1]&1,degradationPriority:t[2]<<8|t[3]}}},{key:"moovToTrack",value:function(t,n,e){var s,r,l=t.trak;if(!(!l||!l.length)){var o=l.find(function(Kn){var wt,Gt;return((wt=Kn.mdia)===null||wt===void 0||(Gt=wt.hdlr)===null||Gt===void 0?void 0:Gt.handlerType)==="vide"}),u=l.find(function(Kn){var wt,Gt;return((wt=Kn.mdia)===null||wt===void 0||(Gt=wt.hdlr)===null||Gt===void 0?void 0:Gt.handlerType)==="soun"});if(o&&n){var c,p,m,f,b,v,g,X=n,D=(c=o.tkhd)===null||c===void 0?void 0:c.trackId;D!=null&&(X.id=o.tkhd.trackId),X.tkhdDuration=o.tkhd.duration,X.mvhdDurtion=t.mvhd.duration,X.mvhdTimecale=t.mvhd.timescale,X.timescale=X.formatTimescale=o.mdia.mdhd.timescale,X.duration=o.mdia.mdhd.duration||X.mvhdDurtion/X.mvhdTimecale*X.timescale;var F=o.mdia.minf.stbl.stsd.entries[0];if(X.width=F.width,X.height=F.height,F.pasp&&(X.sarRatio=[F.pasp.hSpacing,F.pasp.vSpacing]),F.hvcC)X.codecType=ht.HEVC,X.codec=F.hvcC.codec,X.vps=F.hvcC.vps,X.sps=F.hvcC.sps,X.pps=F.hvcC.pps,X.hvcC=F.hvcC.data;else if(F.avcC)X.codec=F.avcC.codec,X.sps=F.avcC.sps,X.pps=F.avcC.pps;else throw new Error("unknown video stsd entry");if(X.present=!0,X.ext={},X.ext.stss=(p=o.mdia)===null||p===void 0||(m=p.minf)===null||m===void 0||(f=m.stbl)===null||f===void 0?void 0:f.stss,X.ext.ctts=(b=o.mdia)===null||b===void 0||(v=b.minf)===null||v===void 0||(g=v.stbl)===null||g===void 0?void 0:g.ctts,F&&F.type==="encv"){var w,S,G,T,C,I,E,U;X.isVideoEncryption=!0,F.default_KID=(w=F.sinf)===null||w===void 0||(S=w.schi)===null||S===void 0?void 0:S.tenc.default_KID,F.default_IsEncrypted=(G=F.sinf)===null||G===void 0||(T=G.schi)===null||T===void 0?void 0:T.tenc.default_IsEncrypted,F.default_IV_size=(C=F.sinf)===null||C===void 0||(I=C.schi)===null||I===void 0?void 0:I.tenc.default_IV_size,X.videoSenc=o.mdia.minf.stbl.senc&&o.mdia.minf.stbl.senc.samples,F.data_format=(E=F.sinf)===null||E===void 0||(U=E.frma)===null||U===void 0?void 0:U.data_format,X.useEME=t.useEME,X.kidValue=t.kidValue,X.pssh=t.pssh,X.encv=F}}if(u&&e){var h,d,y,L,Z,W,R,_,K,Y=e,J=(h=u.tkhd)===null||h===void 0?void 0:h.trackId;J!=null&&(Y.id=u.tkhd.trackId),Y.tkhdDuration=u.tkhd.duration,Y.mvhdDurtion=t.mvhd.duration,Y.mvhdTimecale=t.mvhd.timescale,Y.timescale=Y.formatTimescale=u.mdia.mdhd.timescale,Y.duration=u.mdia.mdhd.duration||Y.mvhdDurtion/Y.mvhdTimecale*Y.timescale;var P=u.mdia.minf.stbl.stsd.entries[0];switch(Y.sampleSize=P.sampleSize,Y.sampleRate=P.sampleRate,Y.channelCount=P.channelCount,Y.present=!0,P.type){case"alaw":Y.codecType=Y.codec=it.G711PCMA,Y.sampleRate=8e3;break;case"ulaw":Y.codecType=Y.codec=it.G711PCMU,Y.sampleRate=8e3;break;default:Y.sampleDuration=je.getFrameDuration(Y.sampleRate,Y.timescale),Y.sampleRateIndex=je.getRateIndexByRate(Y.sampleRate),Y.objectType=((s=P.esds)===null||s===void 0?void 0:s.objectType)||2,P.esds&&(Y.config=Array.from(P.esds.config)),Y.codec=((r=P.esds)===null||r===void 0?void 0:r.codec)||"mp4a.40.2";break}if(Y.sampleDuration=je.getFrameDuration(Y.sampleRate,Y.timescale),Y.objectType=((d=P.esds)===null||d===void 0?void 0:d.objectType)||2,P.esds&&(P.esds.config?Y.config=Array.from(P.esds.config):console.warn("esds config is null")),Y.codec=((y=P.esds)===null||y===void 0?void 0:y.codec)||"mp4a.40.2",Y.sampleRateIndex=je.getRateIndexByRate(Y.sampleRate),Y.ext={},Y.ext.stss=(L=u.mdia)===null||L===void 0||(Z=L.minf)===null||Z===void 0||(W=Z.stbl)===null||W===void 0?void 0:W.stss,Y.ext.ctts=(R=u.mdia)===null||R===void 0||(_=R.minf)===null||_===void 0||(K=_.stbl)===null||K===void 0?void 0:K.ctts,Y.present=!0,P&&P.type==="enca"){var st,Le,Ke,rt,He,ae,Be,lt;Y.isAudioEncryption=!0,P.data_format=(st=P.sinf)===null||st===void 0||(Le=st.frma)===null||Le===void 0?void 0:Le.data_format,P.default_KID=(Ke=P.sinf)===null||Ke===void 0||(rt=Ke.schi)===null||rt===void 0?void 0:rt.tenc.default_KID,P.default_IsEncrypted=(He=P.sinf)===null||He===void 0||(ae=He.schi)===null||ae===void 0?void 0:ae.tenc.default_IsEncrypted,P.default_IV_size=(Be=P.sinf)===null||Be===void 0||(lt=Be.schi)===null||lt===void 0?void 0:lt.tenc.default_IV_size,Y.audioSenc=u.mdia.minf.stbl.senc&&u.mdia.minf.stbl.senc.samples,Y.useEME=t.useEME,Y.kidValue=t.kidValue,Y.enca=P}}if(e&&(e.isVideoEncryption=n?n.isVideoEncryption:!1),n&&(n.isAudioEncryption=e?e.isAudioEncryption:!1),n!=null&&n.encv||e!=null&&e.enca){var _n,Pn,Es=n==null||(_n=n.encv)===null||_n===void 0?void 0:_n.default_KID,Is=e==null||(Pn=e.enca)===null||Pn===void 0?void 0:Pn.default_KID,_s=Es||Is?(Es||Is).join(""):null;n&&(n.kid=_s),e&&(e.kid=_s)}return n&&(n.flags=3841),e&&(e.flags=1793),{videoTrack:n,audioTrack:e}}}},{key:"evaluateDefaultDuration",value:function(t,n,e){var s,r=n==null||(s=n.samples)===null||s===void 0?void 0:s.length;if(!r)return 1024;var l=1024*r/n.timescale;return l*t.timescale/e}},{key:"moofToSamples",value:function(t,n,e){var s={};return t.mfhd&&(n&&(n.sequenceNumber=t.mfhd.sequenceNumber),e&&(e.sequenceNumber=t.mfhd.sequenceNumber)),t.traf.forEach(function(r){var l=r.tfhd,o=r.tfdt,u=r.trun;if(!(!l||!u)){o&&(n&&n.id===l.trackId&&(n.baseMediaDecodeTime=o.baseMediaDecodeTime),e&&e.id===l.trackId&&(e.baseMediaDecodeTime=o.baseMediaDecodeTime));var c=l.defaultSampleSize||0,p=l.defaultSampleDuration||a.evaluateDefaultDuration(n,e,u.samples.length||u.sampleCount),m=u.dataOffset||0,f=0,b=-1;if(!u.samples.length&&u.sampleCount){s[l.trackId]=[];for(var v=0;v<u.sampleCount;v++)s[l.trackId].push({offset:m,dts:f,duration:p,size:c}),f+=p,m+=c}else s[l.trackId]=u.samples.map(function(g,X){return g={offset:m,dts:f,pts:f+(g.cts||0),duration:g.duration||p,size:g.size||c,gopId:b,keyframe:X===0||g.flags!==null&&g.flags!==void 0&&(g.flags&65536)>>>0!==65536},g.keyframe&&(b++,g.gopId=b),f+=g.duration,m+=g.size,g})}}),s}},{key:"moovToSamples",value:function(t){var n=t.trak;if(!(!n||!n.length)){var e=n.find(function(E){var U,h;return((U=E.mdia)===null||U===void 0||(h=U.hdlr)===null||h===void 0?void 0:h.handlerType)==="vide"}),s=n.find(function(E){var U,h;return((U=E.mdia)===null||U===void 0||(h=U.hdlr)===null||h===void 0?void 0:h.handlerType)==="soun"});if(!(!e&&!s)){var r,l;if(e){var o,u,c=(o=e.mdia)===null||o===void 0||(u=o.minf)===null||u===void 0?void 0:u.stbl;if(!c)return;var p=c.stts,m=c.stsc,f=c.stsz,b=c.stco,v=c.stss,g=c.ctts;if(!p||!m||!f||!b||!v)return;r=ar(p,m,f,b,g,v)}if(s){var X,D,F,w=(X=s.mdia)===null||X===void 0||(D=X.minf)===null||D===void 0?void 0:D.stbl;if(!w)return;var S=(F=s.mdia.mdhd)===null||F===void 0?void 0:F.timescale,G=w.stts,T=w.stsc,C=w.stsz,I=w.stco;if(!S||!G||!T||!C||!I)return;l=ar(G,T,C,I)}return{videoSamples:r,audioSamples:l}}}}}]),a}();function ar(a,i,t,n,e,s){var r=[],l=e==null?void 0:e.entries,o=i.entries,u=n.entries,c=t.entrySizes,p=s==null?void 0:s.entries,m;p&&(m={},p.forEach(function(T){m[T-1]=!0}));var f;l&&(f=[],l.forEach(function(T){for(var C=T.count,I=T.offset,E=0;E<C;E++)f.push(I)}));var b,v=-1,g=0,X=0,D=0,F=0,w=0,S=o[0].samplesPerChunk,G=o[1]?o[1].firstChunk-1:1/0;return a.entries.forEach(function(T){for(var C=T.count,I=T.delta,E=0;E<C;E++)b={dts:g,duration:I,size:c[X]||t.sampleSize,offset:u[D]+w,index:X},p&&(b.keyframe=m[X],b.keyframe&&v++,b.gopId=v),f&&X<f.length&&(b.pts=b.dts+f[X]),r.push(b),g+=I,X++,X<S?w+=b.size:(D++,w=0,D>=G&&(F++,G=o[F+1]?o[F+1].firstChunk-1:1/0),S+=o[F].samplesPerChunk)}),r}function ir(a,i){return a.dataReferenceIndex=ce(i,6),a.width=ce(i,24),a.height=ce(i,26),a.horizresolution=H(i,28),a.vertresolution=H(i,32),a.frameCount=ce(i,40),a.depth=ce(i,74),78}function lr(a,i){return a.dataReferenceIndex=ce(i,6),a.channelCount=ce(i,16),a.sampleSize=ce(i,18),a.sampleRate=H(i,24)/65536,28}function B(a,i,t){if(a){if(a.size!==a.data.length)throw new Error("box ".concat(a.type," size !== data.length"));var n={start:a.start,size:a.size,headerSize:a.headerSize,type:a.type};return i&&(n.version=a.data[a.headerSize],n.flags=qi(a.data,a.headerSize+1),n.headerSize+=4),t(n,a.data.subarray(n.headerSize),n.start+n.headerSize),n}}var al=function(i,t,n){for(var e=String(n),s=t>>0,r=Math.ceil(s/e.length),l=[],o=String(i);r--;)l.push(e);return l.join("").substring(0,s-o.length)+o},jn=function(){for(var i=[],t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return n.forEach(function(s){i.push(al(Number(s).toString(16),2,0))}),i[0]},il=function(){function a(i,t,n){oe(this,a),this.videoTrack=i||new Rn,this.audioTrack=t||new Vn,this.metadataTrack=n||new xn}return ue(a,[{key:"demux",value:function(t,n){var e=this.videoTrack,s=this.audioTrack,r=e.exist(),l=s.exist();if(e.samples=[],s.samples=[],n){if(!l){var o=re.findBox(n,["moov"])[0];if(!o)throw new Error("cannot found moov box");re.moovToTrack(re.moov(o),null,s)}var u=re.findBox(n,["moof"])[0];if(u){var c=re.moofToSamples(re.moof(u),null,s)[s.id],p=s.baseMediaDecodeTime;if(c){var m=u.start;c.map(function(w){w.offset+=m;var S=n.subarray(w.offset,w.offset+w.size);s.samples.push(new ft(w.dts+p,S,w.duration))})}}}if(t){if(!r&&!l){var f=re.findBox(t,["moov"])[0];if(!f)throw new Error("cannot found moov box");re.moovToTrack(re.moov(f),e,s)}var b=re.findBox(t,["moof"])[0];if(b){var v=re.moofToSamples(re.moof(b),e,s),g=e.baseMediaDecodeTime,X=s.baseMediaDecodeTime,D=b.start,F;Object.keys(v).forEach(function(w){e.id==w?v[w].map(function(S){S.offset+=D;var G=new tn((S.pts||S.dts)+g,S.dts+g);G.duration=S.duration,G.gopId=S.gopId,S.keyframe&&G.setToKeyframe();var T=t.subarray(S.offset,S.offset+S.size);G.data=T;for(var C=0,I=T.length-1;C<I;)F=H(T,C),C+=4,G.units.push(T.subarray(C,C+F)),C+=F;e.samples.push(G)}):s.id==w&&v[w].map(function(S){S.offset+=D;var G=t.subarray(S.offset,S.offset+S.size);s.samples.push(new ft(S.dts+X,G,S.duration))})})}}return{videoTrack:e,audioTrack:s,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}}],[{key:"probe",value:function(t){return re.probe(t)}}]),a}();function ll(a){for(var i=0,t=arguments.length,n=new Array(t>1?t-1:0),e=1;e<t;e++)n[e-1]=arguments[e];n.forEach(function(l){i+=l.length});var s=new a(i),r=0;return n.forEach(function(l){s.set(l,r),r+=l.length}),s}var ve=function(){function a(){oe(this,a),this.buffer=new Uint8Array(0)}return ue(a,[{key:"write",value:function(){for(var t=this,n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];e.forEach(function(r){r?t.buffer=ll(Uint8Array,t.buffer,r):window.console.warn(r)})}}],[{key:"writeUint16",value:function(t){return new Uint8Array([t>>8&255,t&255])}},{key:"writeUint32",value:function(t){return new Uint8Array([t>>24,t>>16&255,t>>8&255,t&255])}}]),a}(),or=Math.pow(2,32)-1,j=function(){function a(){oe(this,a)}return ue(a,null,[{key:"box",value:function(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),s=1;s<n;s++)e[s-1]=arguments[s];e=e.filter(Boolean);var r=8+e.reduce(function(u,c){return u+c.byteLength},0),l=new Uint8Array(r);l[0]=r>>24&255,l[1]=r>>16&255,l[2]=r>>8&255,l[3]=r&255,l.set(t,4);var o=8;return e.forEach(function(u){l.set(u,o),o+=u.byteLength}),l}},{key:"ftyp",value:function(t){var n=t.find(function(e){return e.type===Pt.VIDEO&&e.codecType===ht.HEVC});return n?a.FTYPHEV1:a.FTYPAVC1}},{key:"initSegment",value:function(t){var n=a.ftyp(t),e=Oe(n,a.moov(t));return e}},{key:"pssh",value:function(t){var n=new Uint8Array([1,0,0,0].concat([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75],[0,0,0,1],nr(t.kid),[0,0,0,0]));return a.box(a.types.pssh,n)}},{key:"moov",value:function(t){if(t[0].useEME&&(t[0].encv||t[0].enca)){t[0].pssh||(t[0].pssh={kid:t[0].kid});var n=this.pssh(t[0].pssh);return a.box.apply(a,[a.types.moov,a.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale),a.mvex(t)].concat(We(t.map(function(e){return a.trak(e)})),[n]))}else return a.box.apply(a,[a.types.moov,a.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale)].concat(We(t.map(function(e){return a.trak(e)})),[a.mvex(t)]))}},{key:"mvhd",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4,e=a.box(a.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,n&255,t>>24&255,t>>16&255,t>>8&255,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]));return e}},{key:"trak",value:function(t){var n=a.box(a.types.trak,a.tkhd(t.id,t.tkhdDuration||0,t.width,t.height),a.mdia(t));return n}},{key:"tkhd",value:function(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=a.box(a.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,e>>8&255,e&255,0,0,s>>8&255,s&255,0,0]));return r}},{key:"mdia",value:function(t){var n=a.box(a.types.mdia,a.mdhd(t.duration,t.timescale),a.hdlr(t.type),a.minf(t));return n}},{key:"mdhd",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4,e=a.box(a.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,n&255,t>>24&255,t>>16&255,t>>8&255,t&255,85,196,0,0]));return e}},{key:"hdlr",value:function(t){var n=a.box(a.types.hdlr,a.HDLR_TYPES[t]);return n}},{key:"minf",value:function(t){var n=a.box(a.types.minf,t.type===Pt.VIDEO?a.VMHD:a.SMHD,a.DINF,a.stbl(t));return n}},{key:"stbl",value:function(t){var n=[];t&&t.ext&&t.ext.stss&&n.push(a.stss(t.ext.stss.entries));var e=a.box(a.types.stbl,a.stsd(t),a.STTS,n[0],a.STSC,a.STSZ,a.STCO);return e}},{key:"stsd",value:function(t){var n;t.type==="audio"?t.useEME&&t.enca?n=a.enca(t):n=a.mp4a(t):t.useEME&&t.encv?n=a.encv(t):n=a.avc1hev1(t);var e=a.box(a.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),n);return e}},{key:"enca",value:function(t){var n=t.enca.channelCount,e=t.enca.sampleRate,s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,e>>8&255,e&255,0,0]),r=a.esds(t.config),l=a.sinf(t.enca);return a.box(a.types.enca,s,r,l)}},{key:"encv",value:function(t){var n,e,s=t.sps.length>0?t.sps[0]:[],r=t.pps.length>0?t.pps[0]:[],l=t.width,o=t.height,u=t.sarRatio[0],c=t.sarRatio[1],p=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,o>>8&255,o&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),m=new Uint8Array((n=(e=[1,s[1],s[2],s[3],255,225,s.length>>>8&255,s.length&255]).concat.apply(e,We(s)).concat([1,r.length>>>8&255,r.length&255])).concat.apply(n,We(r))),f=new Uint8Array([0,0,88,57,0,15,200,192,0,4,86,72]),b=a.sinf(t.encv),v=new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,c>>24,c>>16&255,c>>8&255,c&255]);return a.box(a.types.encv,p,a.box(a.types.avcC,m),a.box(a.types.btrt,f),b,a.box(a.types.pasp,v))}},{key:"schi",value:function(t){var n=new Uint8Array([]),e=a.tenc(t);return a.box(a.types.schi,n,e)}},{key:"tenc",value:function(t){var n=new Uint8Array([0,0,0,0,0,0,t.default_IsEncrypted&255,t.default_IV_size&255].concat(nr(t.default_KID)));return a.box(a.types.tenc,n)}},{key:"sinf",value:function(t){var n=new Uint8Array([]),e=new Uint8Array([t.data_format.charCodeAt(0),t.data_format.charCodeAt(1),t.data_format.charCodeAt(2),t.data_format.charCodeAt(3)]),s=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),r=a.schi(t);return a.box(a.types.sinf,n,a.box(a.types.frma,e),a.box(a.types.schm,s),r)}},{key:"avc1hev1",value:function(t){var n=t.codecType===ht.HEVC,e=n?a.types.hvc1:a.types.avc1,s=n?a.hvcC(t):a.avcC(t),r=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,t.width&255,t.height>>8&255,t.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s];return n?r.push(a.box(a.types.fiel,new Uint8Array([1,0]))):t.sarRatio&&t.sarRatio.length>1&&r.push(a.pasp(t.sarRatio)),a.box.apply(a,[e].concat(r))}},{key:"avcC",value:function(t){var n,e,s=[],r=[],l;return t.sps.forEach(function(o){l=o.byteLength,s.push(l>>>8&255),s.push(l&255),s.push.apply(s,We(o))}),t.pps.forEach(function(o){l=o.byteLength,r.push(l>>>8&255),r.push(l&255),r.push.apply(r,We(o))}),a.box(a.types.avcC,new Uint8Array((n=(e=[1,s[3],s[4],s[5],255,224|t.sps.length]).concat.apply(e,s).concat([t.pps.length])).concat.apply(n,r)))}},{key:"hvcC",value:function(t){var n=t.hvcC;if(n instanceof ArrayBuffer||n instanceof Uint8Array)return n;var e=t.vps,s=t.sps,r=t.pps,l;if(n){var o=n.generalProfileCompatibilityFlags,u=n.generalConstraintIndicatorFlags,c=(e.length&&1)+(s.length&&1)+(r.length&&1);l=[1,n.generalProfileSpace<<6|n.generalTierFlag<<5|n.generalProfileIdc,o>>>24,o>>>16,o>>>8,o,u[0],u[1],u[2],u[3],u[4],u[5],n.generalLevelIdc,240,0,252,n.chromaFormatIdc|252,n.bitDepthLumaMinus8|248,n.bitDepthChromaMinus8|248,0,0,n.numTemporalLayers<<3|n.temporalIdNested<<2|3,c];var p=function(f){var b;l.push(f.length>>8,f.length),(b=l).push.apply(b,We(f))};e.length&&(l.push(160,0,e.length),e.forEach(p)),s.length&&(l.push(161,0,s.length),s.forEach(p)),r.length&&(l.push(162,0,r.length),r.forEach(p))}else l=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return a.box(a.types.hvcC,new Uint8Array(l))}},{key:"pasp",value:function(t){var n=Ei(t,2),e=n[0],s=n[1];return a.box(a.types.pasp,new Uint8Array([e>>24,e>>16&255,e>>8&255,e&255,s>>24,s>>16&255,s>>8&255,s&255]))}},{key:"mp4a",value:function(t){return a.box(a.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,t.sampleRate&255,0,0]),t.config.length?a.esds(t.config):void 0)}},{key:"esds",value:function(t){var n=t.length,e=a.box(a.types.esds,new Uint8Array([0,0,0,0,3,23+n,0,0,0,4,15+n,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([n]).concat(t).concat([6,1,2])));return e}},{key:"mvex",value:function(t){var n=a.box.apply(a,[a.types.mvex].concat(We(t.map(function(e){return a.trex(e.id)}))));return n}},{key:"trex",value:function(t){var n=a.box(a.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]));return n}},{key:"trex1",value:function(t){var n=a.box(a.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,2,0,0,0,0,0,0,1,0,0]));return n}},{key:"trex2",value:function(t){var n=a.box(a.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,4,0,0,0,0,0,2,0,0,0]));return n}},{key:"moof",value:function(t){var n=a.box.apply(a,[a.types.moof,a.mfhd(t[0].samples?t[0].samples[0].gopId:0)].concat(We(t.map(function(e){return a.traf(e)}))));return n}},{key:"mfhd",value:function(t){var n=a.box(a.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]));return n}},{key:"traf",value:function(t){var n=a.tfhd(t.id),e=a.tfdt(t,t.baseMediaDecodeTime),s=0,r;if(t.isVideo&&t.videoSenc&&(r=t.videoSenc,r.forEach(function(d){s=s+8,d.subsamples&&d.subsamples.length&&(s=s+2,s=s+d.subsamples.length*6)})),t.videoSencLength=s,!t.useEME||!t.isVideoEncryption&&!t.isAudioEncryption){var l=a.sdtp(t),o=16+20+8+16+8+8;return a.box(a.types.traf,n,e,l,a.trun(t.samples,l.byteLength+o))}else if(t.isVideoEncryption)if(t.isVideo){var u=a.saiz(t),c=a.saio(t),p=a.trun1(t),m=a.senc(t),f=a.box(a.types.traf,n,e,u,c,p,m);return f}else if(t.isAudioEncryption){var g=a.sbgp(),X=a.saiz(t),D=a.saio(t),F=a.senc(t),w=a.trun1(t),S=a.box(a.types.traf,n,e,g,X,D,F,w);return S}else{var b=a.sbgp(),v=a.trun1(t);return a.box(a.types.traf,n,e,b,v)}else if(t.isVideo){var G=a.trun1(t);return a.box(a.types.traf,n,e,G)}else{var T=a.sbgp(),C=a.saiz(t),I=a.saio(t),E=a.senc(t),U=a.trun1(t),h=a.box(a.types.traf,n,e,T,C,I,E,U);return h}}},{key:"sdtp",value:function(t){var n=new ve;return t.samples.forEach(function(e){n.write(new Uint8Array(t.isVideo?[e.keyframe?32:16]:[16]))}),a.box(a.types.sdtp,this.extension(0,0),n.buffer)}},{key:"trun1",value:function(t){var n=new ve,e=ve.writeUint32(t.samples.length),s=null;if(t.isVideo){var r=t.videoSencLength;s=ve.writeUint32(t.samples.length*16+r+149),!t.isVideoEncryption&&t.isAudioEncryption&&(s=ve.writeUint32(t.samples.length*16+92))}else{var l=t.samples.length*12+124;t.isAudioEncryption&&(l=t.samples.length*12+8*t.audioSenc.length+177),s=ve.writeUint32(l)}return t.samples.forEach(function(o){n.write(ve.writeUint32(o.duration)),n.write(ve.writeUint32(o.size)),n.write(ve.writeUint32(o.keyframe?33554432:65536)),t.isVideo&&n.write(ve.writeUint32(o.cts?o.cts:0))}),a.box(a.types.trun,this.extension(0,t.flags),e,s,n.buffer)}},{key:"senc",value:function(t){var n=new ve,e=t.samples.length,s=t.isVideo?16:8,r=t.isVideo?2:0,l=[],o=0;return t.isVideo?(l=t.videoSenc,o=t.videoSencLength):l=t.audioSenc,o=o||s*e,n.write(ve.writeUint32(16+o),a.types.senc,this.extension(0,r)),n.write(ve.writeUint32(e)),l.forEach(function(u){for(var c=0;c<u.InitializationVector.length;c++)n.write(new Uint8Array([u.InitializationVector[c]]));u.subsamples&&u.subsamples.length&&(n.write(ve.writeUint16(u.subsamples.length)),u.subsamples.forEach(function(p){n.write(ve.writeUint16(p.BytesOfClearData)),n.write(ve.writeUint32(p.BytesOfProtectedData))}))}),n.buffer}},{key:"saio",value:function(t){var n=t.samples.length*12+141;!t.isVideo&&t.isAudioEncryption&&(n=149);var e=new Uint8Array([1,0,0,0,0,0,0,1,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,n&255]);return a.box(a.types.saio,e)}},{key:"saiz",value:function(t){var n=t.samples.length,e=new Uint8Array([0,0,0,0,16,n>>24&255,n>>16&255,n>>8&255,n&255]);return a.box(a.types.saiz,e)}},{key:"sbgp",value:function(){var t=new Uint8Array([114,111,108,108,0,0,0,1,0,0,1,25,0,0,0,1]);return a.box(a.types.sbgp,this.extension(0,0),t)}},{key:"extension",value:function(t,n){return new Uint8Array([t,n>>16&255,n>>8&255,n&255])}},{key:"tfhd",value:function(t){return a.box(a.types.tfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}},{key:"tfdt",value:function(t,n){var e=Math.floor(n/(or+1)),s=Math.floor(n%(or+1));return t.useEME&&(t.isVideoEncryption||t.isAudioEncryption)?a.box(a.types.tfdt,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])):a.box(a.types.tfdt,new Uint8Array([1,0,0,0,e>>24,e>>16&255,e>>8&255,e&255,s>>24,s>>16&255,s>>8&255,s&255]))}},{key:"trun",value:function(t,n){var e=t.length,s=12+16*e;n+=8+s;var r=new Uint8Array(s);r.set([0,0,15,1,e>>>24&255,e>>>16&255,e>>>8&255,e&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0);for(var l=0;l<e;l++){var o=t[l],u=o.duration,c=o.size,p=o.flag,m=p===void 0?{}:p,f=o.cts,b=f===void 0?0:f;r.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,m.isLeading<<2|(m.dependsOn===null||m.dependsOn===void 0?1:m.dependsOn),m.isDependedOn<<6|m.hasRedundancy<<4|m.paddingValue<<1|(m.isNonSyncSample===null||m.isNonSyncSample===void 0?1:m.isNonSyncSample),m.degradationPriority&61440,m.degradationPriority&15,b>>>24&255,b>>>16&255,b>>>8&255,b&255],12+16*l)}return a.box(a.types.trun,r)}},{key:"moovMP4",value:function(t){return a.box.apply(a,[a.types.moov,a.mvhd(t[0].duration,t[0].timescale)].concat(We(t.map(function(n){return a.trackMP4(n)}))))}},{key:"trackMP4",value:function(t){return a.box(a.types.trak,a.tkhd(t.id,t.duration,t.width,t.height),a.mdiaMP4(t))}},{key:"mdiaMP4",value:function(t){return a.box(a.types.mdia,a.mdhd(t.duration,t.timescale),a.hdlr(t.type),a.minfMP4(t))}},{key:"minfMP4",value:function(t){return a.box(a.types.minf,t.type===Pt.VIDEO?a.VMHD:a.SMHD,a.DINF,a.stblMP4(t))}},{key:"stblMP4",value:function(t){var n=t.ext,e=[a.stsd(t),a.stts(n.stts),a.stsc(n.stsc),a.stsz(n.stsz),a.stco(n.stco)];return n.stss.length&&e.push(a.stss(n.stss)),n.ctts.length&&e.push(a.ctts(n.ctts)),a.box.apply(a,[a.types.stbl].concat(e))}},{key:"stts",value:function(t){var n=t.length,e=new Uint8Array(8*n),s=0;return t.forEach(function(r){var l=r.value,o=r.count;e.set([o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255],s),s+=8}),a.box(a.types.stts,Oe(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255]),e))}},{key:"stsc",value:function(t){var n=t.length,e=new Uint8Array(12*n),s=0;return t.forEach(function(r){var l=r.firstChunk,o=r.samplesPerChunk,u=r.sampleDescIndex;e.set([l>>24,l>>16&255,l>>8&255,l&255,o>>24,o>>16&255,o>>8&255,o&255,u>>24,u>>16&255,u>>8&255,u&255],s),s+=12}),a.box(a.types.stsc,Oe(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255]),e))}},{key:"stsz",value:function(t){var n=t.length,e=new Uint8Array(4*n),s=0;return t.forEach(function(r){e.set([r>>24,r>>16&255,r>>8&255,r&255],s),s+=4}),a.box(a.types.stsz,Oe(new Uint8Array([0,0,0,0,0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255]),e))}},{key:"stco",value:function(t){var n=t.length,e=new Uint8Array(4*n),s=0;return t.forEach(function(r){e.set([r>>24,r>>16&255,r>>8&255,r&255],s),s+=4}),a.box(a.types.stco,Oe(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255]),e))}},{key:"stss",value:function(t){var n=t.length,e=new Uint8Array(4*n),s=0;return t.forEach(function(r){e.set([r>>24,r>>16&255,r>>8&255,r&255],s),s+=4}),a.box(a.types.stss,Oe(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255]),e))}},{key:"ctts",value:function(t){var n=t.length,e=new Uint8Array(8*n),s=0;return t.forEach(function(r){var l=r.value,o=r.count;e.set([o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255],s),s+=8}),a.box(a.types.ctts,Oe(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255]),e))}},{key:"styp",value:function(){return a.box(a.types.styp,new Uint8Array([109,115,100,104,0,0,0,0,109,115,100,104,109,115,105,120]))}},{key:"sidx",value:function(t){var n=t.timescale,e=t.samples[0].duration,s=e*t.samples.length,r=t.samples[0].sampleOffset*e,l=8;t.samples.forEach(function(m){l+=m.size});var o=0;if(t.isVideo){var u=0,c;t.videoSenc&&(c=t.videoSenc),t.isVideo&&c.forEach(function(m){u=u+8,m.subsamples&&m.subsamples.length&&(u=u+2,u=u+m.subsamples.length*6)}),t.videoSencLength=u,o=l+141+t.samples.length*16+u,t.useEME&&t.isAudioEncryption&&!t.isVideoEncryption&&(o=l+t.samples.length*16+84)}else o=l+116+t.samples.length*12,t.useEME&&t.isAudioEncryption&&(o=l+169+t.samples.length*12+8*t.audioSenc.length);var p=new Uint8Array([0,0,0,0,0,0,0,t.id&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,0,0,0,0,0,0,0,1,0,o>>16&255,o>>8&255,o&255,s>>24&255,s>>16&255,s>>8&255,s&255,144,0,0,0]);return a.box(a.types.sidx,p)}},{key:"mdat",value:function(t){var n=a.box(a.types.mdat,t);return n}}]),a}();V(j,"types",["avc1","avcC","hvc1","hvcC","dinf","dref","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trex","tkhd","vmhd","smhd","ctts","stss","styp","pssh","sidx","sbgp","saiz","saio","senc","trun","encv","enca","sinf","btrt","frma","tenc","schm","schi","mehd","fiel","sdtp"].reduce(function(a,i){return a[i]=[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3)],a},Object.create(null)));V(j,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])});V(j,"FTYPAVC1",j.box(j.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49])));V(j,"FTYPHEV1",j.box(j.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49])));V(j,"DINF",j.box(j.types.dinf,j.box(j.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]))));V(j,"VMHD",j.box(j.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])));V(j,"SMHD",j.box(j.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0])));V(j,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0]));V(j,"STTS",j.box(j.types.stts,j.StblTable));V(j,"STSC",j.box(j.types.stsc,j.StblTable));V(j,"STSZ",j.box(j.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0])));V(j,"STCO",j.box(j.types.stco,j.StblTable));var Ws=function(){function a(i,t){oe(this,a),this.name=i||"",this._prefix="[".concat(this.name,"]"),a.disabled=t}return ue(a,[{key:"debug",value:function(){var t;if(!a.disabled){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];(t=console).debug.apply(t,[this._prefix].concat(e))}}},{key:"log",value:function(){var t;if(!a.disabled){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];(t=console).log.apply(t,[this._prefix].concat(e))}}},{key:"warn",value:function(){var t;if(!a.disabled){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];(t=console).warn.apply(t,[this._prefix].concat(e))}}},{key:"error",value:function(){var t;if(!a.disabled){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];(t=console).error.apply(t,[this._prefix].concat(e))}}},{key:"table",value:function(){var t;a.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}}],[{key:"enable",value:function(){a.disabled=!1}},{key:"disable",value:function(){a.disabled=!0}}]),a}();V(Ws,"disabled",!0);var Cs=function(){function a(i,t,n){oe(this,a),this.videoTrack=i,this.audioTrack=t;var e=/Chrome\/([^.]+)/.exec(navigator.userAgent);this.forceFirstIDR=e&&Number(e[1])<50,this.log=new Ws("FMP4Remuxer",n&&n.openLog?!n.openLog:!0)}return ue(a,[{key:"remux",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=this.videoTrack,s=this.audioTrack,r=e.exist(),l=s.exist(),o,u,c,p=[];t&&(n&&n.initMerge?(r&&p.push(this.videoTrack),l&&p.push(this.audioTrack),c=j.initSegment(p)):(r&&(o=j.initSegment([this.videoTrack])),l&&(u=j.initSegment([this.audioTrack]))));var m,f;return r&&e.hasSample()&&(m=this._remuxVideo()),l&&s.hasSample()&&(f=this._remuxAudio()),e.samples=[],s.samples=[],{initSegment:c,videoInitSegment:o,audioInitSegment:u,videoSegment:m,audioSegment:f}}},{key:"_remuxVideo",value:function(){var t=this.videoTrack;this.forceFirstIDR&&(t.samples[0].flag={dependsOn:2,isNonSyncSample:0});var n=t.samples,e=0;n.forEach(function(b){e+=b.units.reduce(function(v,g){return v+g.byteLength},0),e+=b.units.length*4});for(var s=new Uint8Array(e),r=new DataView(s.buffer),l=function(v,g){g=n[o];var X=0;g.units.forEach(function(D){r.setUint32(v,D.byteLength),v+=4,s.set(D,v),v+=D.byteLength,X+=4+D.byteLength}),g.size=X,c=v,p=g},o=0,u=n.length,c=0,p;o<u;o++)l(c,p);var m=j.mdat(s),f=j.moof([t]);return Oe(f,m)}},{key:"_remuxAudio",value:function(){var t=this.audioTrack,n=new Uint8Array(t.samples.reduce(function(r,l){return r+l.size},0));t.samples.reduce(function(r,l){return n.set(l.data,r),r+l.size},0);var e=j.mdat(n),s=j.moof([t]);return Oe(s,e)}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset()}}]),a}();class Ve{static create(...i){return new this(...i)}mixIn(i){return Object.assign(this,i)}clone(){const i=new this.constructor;return Object.assign(i,this),i}}class Me extends Ve{constructor(i=[],t=i.length*4){super();let n=i;if(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),(n instanceof Int8Array||n instanceof Uint8ClampedArray||n instanceof Int16Array||n instanceof Uint16Array||n instanceof Int32Array||n instanceof Uint32Array||n instanceof Float32Array||n instanceof Float64Array)&&(n=new Uint8Array(n.buffer,n.byteOffset,n.byteLength)),n instanceof Uint8Array){const e=n.byteLength,s=[];for(let r=0;r<e;r+=1)s[r>>>2]|=n[r]<<24-r%4*8;this.words=s,this.sigBytes=e}else this.words=i,this.sigBytes=t}static random(i){const t=[],n=e=>{let s=e,r=987654321;const l=4294967295;return()=>{r=36969*(r&65535)+(r>>16)&l,s=18e3*(s&65535)+(s>>16)&l;let o=(r<<16)+s&l;return o/=4294967296,o+=.5,o*(Math.random()>.5?1:-1)}};for(let e=0,s;e<i;e+=4){const r=n((s||Math.random())*4294967296);s=r()*987654071,t.push(r()*4294967296|0)}return new Me(t,i)}toString(i=fs){return i.stringify(this)}concat(i){const t=this.words,n=i.words,e=this.sigBytes,s=i.sigBytes;if(this.clamp(),e%4)for(let r=0;r<s;r+=1){const l=n[r>>>2]>>>24-r%4*8&255;t[e+r>>>2]|=l<<24-(e+r)%4*8}else for(let r=0;r<s;r+=4)t[e+r>>>2]=n[r>>>2];return this.sigBytes+=s,this}clamp(){const{words:i,sigBytes:t}=this;i[t>>>2]&=4294967295<<32-t%4*8,i.length=Math.ceil(t/4)}clone(){const i=super.clone.call(this);return i.words=this.words.slice(0),i}}const fs={stringify(a){const{words:i,sigBytes:t}=a,n=[];for(let e=0;e<t;e+=1){const s=i[e>>>2]>>>24-e%4*8&255;n.push((s>>>4).toString(16)),n.push((s&15).toString(16))}return n.join("")},parse(a){const i=a.length,t=[];for(let n=0;n<i;n+=2)t[n>>>3]|=parseInt(a.substr(n,2),16)<<24-n%8*4;return new Me(t,i/2)}},ur={stringify(a){const{words:i,sigBytes:t}=a,n=[];for(let e=0;e<t;e+=1){const s=i[e>>>2]>>>24-e%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse(a){const i=a.length,t=[];for(let n=0;n<i;n+=1)t[n>>>2]|=(a.charCodeAt(n)&255)<<24-n%4*8;return new Me(t,i)}},ya={stringify(a){try{return decodeURIComponent(escape(ur.stringify(a)))}catch{throw new Error("Malformed UTF-8 data")}},parse(a){return ur.parse(unescape(encodeURIComponent(a)))}};class ba extends Ve{constructor(){super(),this._minBufferSize=0}reset(){this._data=new Me,this._nDataBytes=0}_append(i){let t=i;typeof t=="string"&&(t=ya.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_process(i){let t;const{_data:n,blockSize:e}=this,s=n.words,r=n.sigBytes,l=e*4;let o=r/l;i?o=Math.ceil(o):o=Math.max((o|0)-this._minBufferSize,0);const u=o*e,c=Math.min(u*4,r);if(u){for(let p=0;p<u;p+=e)this._doProcessBlock(s,p);t=s.splice(0,u),n.sigBytes-=c}return new Me(t,c)}clone(){const i=super.clone.call(this);return i._data=this._data.clone(),i}}class ol extends ba{constructor(i){super(),this.blockSize=512/32,this.cfg=Object.assign(new Ve,i),this.reset()}static _createHelper(i){return(t,n)=>new i(n).finalize(t)}static _createHmacHelper(i){return(t,n)=>new ul(i,n).finalize(t)}reset(){super.reset.call(this),this._doReset()}update(i){return this._append(i),this._process(),this}finalize(i){return i&&this._append(i),this._doFinalize()}}class ul extends Ve{constructor(i,t){super();const n=new i;this._hasher=n;let e=t;typeof e=="string"&&(e=ya.parse(e));const s=n.blockSize,r=s*4;e.sigBytes>r&&(e=n.finalize(t)),e.clamp();const l=e.clone();this._oKey=l;const o=e.clone();this._iKey=o;const u=l.words,c=o.words;for(let p=0;p<s;p+=1)u[p]^=1549556828,c[p]^=909522486;l.sigBytes=r,o.sigBytes=r,this.reset()}reset(){const i=this._hasher;i.reset(),i.update(this._iKey)}update(i){return this._hasher.update(i),this}finalize(i){const t=this._hasher,n=t.finalize(i);return t.reset(),t.finalize(this._oKey.clone().concat(n))}}const cl=(a,i,t)=>{const n=[];let e=0;for(let s=0;s<i;s+=1)if(s%4){const r=t[a.charCodeAt(s-1)]<<s%4*2,l=t[a.charCodeAt(s)]>>>6-s%4*2,o=r|l;n[e>>>2]|=o<<24-e%4*8,e+=1}return Me.create(n,e)},cr={stringify(a){const{words:i,sigBytes:t}=a,n=this._map;a.clamp();const e=[];for(let r=0;r<t;r+=3){const l=i[r>>>2]>>>24-r%4*8&255,o=i[r+1>>>2]>>>24-(r+1)%4*8&255,u=i[r+2>>>2]>>>24-(r+2)%4*8&255,c=l<<16|o<<8|u;for(let p=0;p<4&&r+p*.75<t;p+=1)e.push(n.charAt(c>>>6*(3-p)&63))}const s=n.charAt(64);if(s)for(;e.length%4;)e.push(s);return e.join("")},parse(a){let i=a.length;const t=this._map;let n=this._reverseMap;if(!n){this._reverseMap=[],n=this._reverseMap;for(let s=0;s<t.length;s+=1)n[t.charCodeAt(s)]=s}const e=t.charAt(64);if(e){const s=a.indexOf(e);s!==-1&&(i=s)}return cl(a,i,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},N=[];for(let a=0;a<64;a+=1)N[a]=Math.abs(Math.sin(a+1))*4294967296|0;const Xe=(a,i,t,n,e,s,r)=>{const l=a+(i&t|~i&n)+e+r;return(l<<s|l>>>32-s)+i},De=(a,i,t,n,e,s,r)=>{const l=a+(i&n|t&~n)+e+r;return(l<<s|l>>>32-s)+i},we=(a,i,t,n,e,s,r)=>{const l=a+(i^t^n)+e+r;return(l<<s|l>>>32-s)+i},Ge=(a,i,t,n,e,s,r)=>{const l=a+(t^(i|~n))+e+r;return(l<<s|l>>>32-s)+i};class pl extends ol{_doReset(){this._hash=new Me([1732584193,4023233417,2562383102,271733878])}_doProcessBlock(i,t){const n=i;for(let I=0;I<16;I+=1){const E=t+I,U=i[E];n[E]=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360}const e=this._hash.words,s=n[t+0],r=n[t+1],l=n[t+2],o=n[t+3],u=n[t+4],c=n[t+5],p=n[t+6],m=n[t+7],f=n[t+8],b=n[t+9],v=n[t+10],g=n[t+11],X=n[t+12],D=n[t+13],F=n[t+14],w=n[t+15];let S=e[0],G=e[1],T=e[2],C=e[3];S=Xe(S,G,T,C,s,7,N[0]),C=Xe(C,S,G,T,r,12,N[1]),T=Xe(T,C,S,G,l,17,N[2]),G=Xe(G,T,C,S,o,22,N[3]),S=Xe(S,G,T,C,u,7,N[4]),C=Xe(C,S,G,T,c,12,N[5]),T=Xe(T,C,S,G,p,17,N[6]),G=Xe(G,T,C,S,m,22,N[7]),S=Xe(S,G,T,C,f,7,N[8]),C=Xe(C,S,G,T,b,12,N[9]),T=Xe(T,C,S,G,v,17,N[10]),G=Xe(G,T,C,S,g,22,N[11]),S=Xe(S,G,T,C,X,7,N[12]),C=Xe(C,S,G,T,D,12,N[13]),T=Xe(T,C,S,G,F,17,N[14]),G=Xe(G,T,C,S,w,22,N[15]),S=De(S,G,T,C,r,5,N[16]),C=De(C,S,G,T,p,9,N[17]),T=De(T,C,S,G,g,14,N[18]),G=De(G,T,C,S,s,20,N[19]),S=De(S,G,T,C,c,5,N[20]),C=De(C,S,G,T,v,9,N[21]),T=De(T,C,S,G,w,14,N[22]),G=De(G,T,C,S,u,20,N[23]),S=De(S,G,T,C,b,5,N[24]),C=De(C,S,G,T,F,9,N[25]),T=De(T,C,S,G,o,14,N[26]),G=De(G,T,C,S,f,20,N[27]),S=De(S,G,T,C,D,5,N[28]),C=De(C,S,G,T,l,9,N[29]),T=De(T,C,S,G,m,14,N[30]),G=De(G,T,C,S,X,20,N[31]),S=we(S,G,T,C,c,4,N[32]),C=we(C,S,G,T,f,11,N[33]),T=we(T,C,S,G,g,16,N[34]),G=we(G,T,C,S,F,23,N[35]),S=we(S,G,T,C,r,4,N[36]),C=we(C,S,G,T,u,11,N[37]),T=we(T,C,S,G,m,16,N[38]),G=we(G,T,C,S,v,23,N[39]),S=we(S,G,T,C,D,4,N[40]),C=we(C,S,G,T,s,11,N[41]),T=we(T,C,S,G,o,16,N[42]),G=we(G,T,C,S,p,23,N[43]),S=we(S,G,T,C,b,4,N[44]),C=we(C,S,G,T,X,11,N[45]),T=we(T,C,S,G,w,16,N[46]),G=we(G,T,C,S,l,23,N[47]),S=Ge(S,G,T,C,s,6,N[48]),C=Ge(C,S,G,T,m,10,N[49]),T=Ge(T,C,S,G,F,15,N[50]),G=Ge(G,T,C,S,c,21,N[51]),S=Ge(S,G,T,C,X,6,N[52]),C=Ge(C,S,G,T,o,10,N[53]),T=Ge(T,C,S,G,v,15,N[54]),G=Ge(G,T,C,S,r,21,N[55]),S=Ge(S,G,T,C,f,6,N[56]),C=Ge(C,S,G,T,w,10,N[57]),T=Ge(T,C,S,G,p,15,N[58]),G=Ge(G,T,C,S,D,21,N[59]),S=Ge(S,G,T,C,u,6,N[60]),C=Ge(C,S,G,T,g,10,N[61]),T=Ge(T,C,S,G,l,15,N[62]),G=Ge(G,T,C,S,b,21,N[63]),e[0]=e[0]+S|0,e[1]=e[1]+G|0,e[2]=e[2]+T|0,e[3]=e[3]+C|0}_doFinalize(){const i=this._data,t=i.words,n=this._nDataBytes*8,e=i.sigBytes*8;t[e>>>5]|=128<<24-e%32;const s=Math.floor(n/4294967296),r=n;t[(e+64>>>9<<4)+15]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360,t[(e+64>>>9<<4)+14]=(r<<8|r>>>24)&16711935|(r<<24|r>>>8)&4278255360,i.sigBytes=(t.length+1)*4,this._process();const l=this._hash,o=l.words;for(let u=0;u<4;u+=1){const c=o[u];o[u]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}return l}clone(){const i=super.clone.call(this);return i._hash=this._hash.clone(),i}}class dl extends Ve{constructor(i){super(),this.cfg=Object.assign(new Ve,{keySize:128/32,hasher:pl,iterations:1},i)}compute(i,t){let n;const{cfg:e}=this,s=e.hasher.create(),r=Me.create(),l=r.words,{keySize:o,iterations:u}=e;for(;l.length<o;){n&&s.update(n),n=s.update(i).finalize(t),s.reset();for(let c=1;c<u;c+=1)n=s.finalize(n),s.reset();r.concat(n)}return r.sigBytes=o*4,r}}class on extends ba{constructor(i,t,n){super(),this.cfg=Object.assign(new Ve,n),this._xformMode=i,this._key=t,this.reset()}static createEncryptor(i,t){return this.create(this._ENC_XFORM_MODE,i,t)}static createDecryptor(i,t){return this.create(this._DEC_XFORM_MODE,i,t)}static _createHelper(i){const t=n=>typeof n=="string"?Sa:Kt;return{encrypt(n,e,s){return t(e).encrypt(i,n,e,s)},decrypt(n,e,s){return t(e).decrypt(i,n,e,s)}}}reset(){super.reset.call(this),this._doReset()}process(i){return this._append(i),this._process()}finalize(i){return i&&this._append(i),this._doFinalize()}}on._ENC_XFORM_MODE=1;on._DEC_XFORM_MODE=2;on.keySize=128/32;on.ivSize=128/32;class va extends Ve{constructor(i,t){super(),this._cipher=i,this._iv=t}static createEncryptor(i,t){return this.Encryptor.create(i,t)}static createDecryptor(i,t){return this.Decryptor.create(i,t)}}function ga(a,i,t){const n=a;let e;const s=this._iv;s?(e=s,this._iv=void 0):e=this._prevBlock;for(let r=0;r<t;r+=1)n[i+r]^=e[r]}class nn extends va{}nn.Encryptor=class extends nn{processBlock(a,i){const t=this._cipher,{blockSize:n}=t;ga.call(this,a,i,n),t.encryptBlock(a,i),this._prevBlock=a.slice(i,i+n)}};nn.Decryptor=class extends nn{processBlock(a,i){const t=this._cipher,{blockSize:n}=t,e=a.slice(i,i+n);t.decryptBlock(a,i),ga.call(this,a,i,n),this._prevBlock=e}};const hl={pad(a,i){const t=i*4,n=t-a.sigBytes%t,e=n<<24|n<<16|n<<8|n,s=[];for(let l=0;l<n;l+=4)s.push(e);const r=Me.create(s,n);a.concat(r)},unpad(a){const i=a,t=i.words[i.sigBytes-1>>>2]&255;i.sigBytes-=t}};class Za extends on{constructor(i,t,n){super(i,t,Object.assign({mode:nn,padding:hl},n)),this.blockSize=128/32}reset(){let i;super.reset.call(this);const{cfg:t}=this,{iv:n,mode:e}=t;this._xformMode===this.constructor._ENC_XFORM_MODE?i=e.createEncryptor:(i=e.createDecryptor,this._minBufferSize=1),this._mode=i.call(e,this,n&&n.words),this._mode.__creator=i}_doProcessBlock(i,t){this._mode.processBlock(i,t)}_doFinalize(){let i;const{padding:t}=this.cfg;return this._xformMode===this.constructor._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),i=this._process(!0)):(i=this._process(!0),t.unpad(i)),i}}class Yn extends Ve{constructor(i){super(),this.mixIn(i)}toString(i){return(i||this.formatter).stringify(this)}}const ml={stringify(a){let i;const{ciphertext:t,salt:n}=a;return n?i=Me.create([1398893684,1701076831]).concat(n).concat(t):i=t,i.toString(cr)},parse(a){let i;const t=cr.parse(a),n=t.words;return n[0]===1398893684&&n[1]===1701076831&&(i=Me.create(n.slice(2,4)),n.splice(0,4),t.sigBytes-=16),Yn.create({ciphertext:t,salt:i})}};class Kt extends Ve{static encrypt(i,t,n,e){const s=Object.assign(new Ve,this.cfg,e),r=i.createEncryptor(n,s),l=r.finalize(t),o=r.cfg;return Yn.create({ciphertext:l,key:n,iv:o.iv,algorithm:i,mode:o.mode,padding:o.padding,blockSize:r.blockSize,formatter:s.format})}static decrypt(i,t,n,e){let s=t;const r=Object.assign(new Ve,this.cfg,e);return s=this._parse(s,r.format),i.createDecryptor(n,r).finalize(s.ciphertext)}static _parse(i,t){return typeof i=="string"?t.parse(i,this):i}}Kt.cfg=Object.assign(new Ve,{format:ml});const fl={execute(a,i,t,n){let e=n;e||(e=Me.random(64/8));const s=dl.create({keySize:i+t}).compute(a,e),r=Me.create(s.words.slice(i),t*4);return s.sigBytes=i*4,Yn.create({key:s,iv:r,salt:e})}};class Sa extends Kt{static encrypt(i,t,n,e){const s=Object.assign(new Ve,this.cfg,e),r=s.kdf.execute(n,i.keySize,i.ivSize);s.iv=r.iv;const l=Kt.encrypt.call(this,i,t,r.key,s);return l.mixIn(r),l}static decrypt(i,t,n,e){let s=t;const r=Object.assign(new Ve,this.cfg,e);s=this._parse(s,r.format);const l=r.kdf.execute(n,i.keySize,i.ivSize,s.salt);return r.iv=l.iv,Kt.decrypt.call(this,i,s,l.key,r)}}Sa.cfg=Object.assign(Kt.cfg,{kdf:fl});const Ee=[],La=[],Xa=[],Da=[],wa=[],Ga=[],ys=[],bs=[],vs=[],gs=[],$e=[];for(let a=0;a<256;a+=1)a<128?$e[a]=a<<1:$e[a]=a<<1^283;let qe=0,ut=0;for(let a=0;a<256;a+=1){let i=ut^ut<<1^ut<<2^ut<<3^ut<<4;i=i>>>8^i&255^99,Ee[qe]=i,La[i]=qe;const t=$e[qe],n=$e[t],e=$e[n];let s=$e[i]*257^i*16843008;Xa[qe]=s<<24|s>>>8,Da[qe]=s<<16|s>>>16,wa[qe]=s<<8|s>>>24,Ga[qe]=s,s=e*16843009^n*65537^t*257^qe*16843008,ys[i]=s<<24|s>>>8,bs[i]=s<<16|s>>>16,vs[i]=s<<8|s>>>24,gs[i]=s,qe?(qe=t^$e[$e[$e[e^t]]],ut^=$e[$e[ut]]):(ut=1,qe=ut)}const yl=[0,1,2,4,8,16,32,64,128,27,54];class Fa extends Za{_doReset(){let i;if(this._nRounds&&this._keyPriorReset===this._key)return;this._keyPriorReset=this._key;const t=this._keyPriorReset,n=t.words,e=t.sigBytes/4;this._nRounds=e+6;const r=(this._nRounds+1)*4;this._keySchedule=[];const l=this._keySchedule;for(let u=0;u<r;u+=1)u<e?l[u]=n[u]:(i=l[u-1],u%e?e>6&&u%e===4&&(i=Ee[i>>>24]<<24|Ee[i>>>16&255]<<16|Ee[i>>>8&255]<<8|Ee[i&255]):(i=i<<8|i>>>24,i=Ee[i>>>24]<<24|Ee[i>>>16&255]<<16|Ee[i>>>8&255]<<8|Ee[i&255],i^=yl[u/e|0]<<24),l[u]=l[u-e]^i);this._invKeySchedule=[];const o=this._invKeySchedule;for(let u=0;u<r;u+=1){const c=r-u;u%4?i=l[c]:i=l[c-4],u<4||c<=4?o[u]=i:o[u]=ys[Ee[i>>>24]]^bs[Ee[i>>>16&255]]^vs[Ee[i>>>8&255]]^gs[Ee[i&255]]}}encryptBlock(i,t){this._doCryptBlock(i,t,this._keySchedule,Xa,Da,wa,Ga,Ee)}decryptBlock(i,t){const n=i;let e=n[t+1];n[t+1]=n[t+3],n[t+3]=e,this._doCryptBlock(n,t,this._invKeySchedule,ys,bs,vs,gs,La),e=n[t+1],n[t+1]=n[t+3],n[t+3]=e}_doCryptBlock(i,t,n,e,s,r,l,o){const u=i,c=this._nRounds;let p=u[t]^n[0],m=u[t+1]^n[1],f=u[t+2]^n[2],b=u[t+3]^n[3],v=4;for(let w=1;w<c;w+=1){const S=e[p>>>24]^s[m>>>16&255]^r[f>>>8&255]^l[b&255]^n[v];v+=1;const G=e[m>>>24]^s[f>>>16&255]^r[b>>>8&255]^l[p&255]^n[v];v+=1;const T=e[f>>>24]^s[b>>>16&255]^r[p>>>8&255]^l[m&255]^n[v];v+=1;const C=e[b>>>24]^s[p>>>16&255]^r[m>>>8&255]^l[f&255]^n[v];v+=1,p=S,m=G,f=T,b=C}const g=(o[p>>>24]<<24|o[m>>>16&255]<<16|o[f>>>8&255]<<8|o[b&255])^n[v];v+=1;const X=(o[m>>>24]<<24|o[f>>>16&255]<<16|o[b>>>8&255]<<8|o[p&255])^n[v];v+=1;const D=(o[f>>>24]<<24|o[b>>>16&255]<<16|o[p>>>8&255]<<8|o[m&255])^n[v];v+=1;const F=(o[b>>>24]<<24|o[p>>>16&255]<<16|o[m>>>8&255]<<8|o[f&255])^n[v];v+=1,u[t]=g,u[t+1]=X,u[t+2]=D,u[t+3]=F}}Fa.keySize=256/32;const bl=Za._createHelper(Fa);class sn extends va{}sn.Encryptor=class extends sn{processBlock(a,i){const t=a,n=this._cipher,{blockSize:e}=n,s=this._iv;let r=this._counter;s&&(this._counter=s.slice(0),r=this._counter,this._iv=void 0);const l=r.slice(0);n.encryptBlock(l,0),r[e-1]=r[e-1]+1|0;for(let o=0;o<e;o+=1)t[i+o]^=l[o]}};sn.Decryptor=sn.Encryptor;const vl={pad(){},unpad(){}};var bn={decryptWordArray:function(i,t,n){var e=fs.parse(t),s=fs.parse($i(n)),r=Me.create(new Uint8Array(i)),l=bl.decrypt(Yn.create({ciphertext:r}),e,{iv:s,mode:sn,padding:vl});return bn.wordArrayToUint8Array(l)},wordArrayToUint8Array:function(i){for(var t=i.sigBytes,n=i.words,e=new Uint8Array(t),s=0,r=0;s!==t;){var l=n[r++];if(e[s++]=(l&4278190080)>>>24,s===t||(e[s++]=(l&16711680)>>>16,s===t)||(e[s++]=(l&65280)>>>8,s===t))break;e[s++]=l&255}return e},decoderAESCTRData:function(i,t,n){if(i.videoSenc){var e=i.kidValue,s=i.videoSenc;i.samples.forEach(function(o,u){var c=s[u],p=o.data,m=[],f=[],b=c.InitializationVector;if(c.subsamples&&c.subsamples.length)c.subsamples.forEach(function(F){var w=F.BytesOfClearData+F.BytesOfProtectedData,S=p.slice(0,w);m.push(S.slice(0,F.BytesOfClearData)),f.push(S.slice(F.BytesOfClearData)),p=p.slice(w)});else{var v=o.size;m.push(p.slice(0,0)),f.push(p.slice(0,v)),p=p.slice(v)}var g=new ve;g.write.apply(g,f);var X=n?n(g.buffer,e,b):bn.decryptWordArray(g.buffer,e,b),D=new ve;m.forEach(function(F,w){var S=f[w].length,G=X.slice(0,S);D.write(F),D.write(G),X=X.slice(S)}),i.samples[u].data=D.buffer})}if(t.audioSenc){var r=t.kidValue,l=t.audioSenc;t.samples.forEach(function(o,u){var c=l[u],p=n?n(o.data,r,c.InitializationVector):bn.decryptWordArray(o.data,r,c.InitializationVector);t.samples[u].data=p})}}},pr=20,gl=function(){function a(i,t,n,e){var s=this;oe(this,a),V(this,"_videoSamples",[]),V(this,"_audioSamples",[]),V(this,"_lastRemainBuffer",[]),V(this,"_lastRemainBufferStartPos",0),this.videoTrack=new Rn,this.audioTrack=new Vn,this.metadataTrack=n||new xn,this.log=new Ws("MP4Demuxer",e&&e.openLog?!e.openLog:!0),i&&i.forEach(function(r){var l;(l=s._videoSamples).push.apply(l,We(r.frames))}),t&&t.forEach(function(r){var l;(l=s._audioSamples).push.apply(l,We(r.frames))})}return ue(a,[{key:"parseSamples",value:function(t){if(!t)throw new Error("moov is required");if(!this.videoTrack.codec&&!this.audioTrack.codec&&(re.moovToTrack(t,this.videoTrack,this.audioTrack),this.videoSenc=this.videoTrack.videoSenc,this.audioSenc=this.audioTrack.audioSenc),!this._audioSamples.length&&!this._videoSamples.length){var n=re.moovToSamples(t);if(!n)throw new Error("cannot parse samples from moov box");this._videoSamples=n.videoSamples||[],this._audioSamples=n.audioSamples||[]}}},{key:"demux",value:function(t,n,e,s,r){this.parseSamples(r);var l=this.videoTrack,o=this.audioTrack;l.samples=[],o.samples=[];var u,c,p;if(e){for(var m,f=0,b=e[0],v=e[1];b<=v;b++){if(u=this._videoSamples[b],!u)throw new Error("cannot found video frame #".concat(b));p=u.offset-n,c=t.subarray(p,p+u.size),m=new tn(u.pts||u.dts,u.dts),m.duration=u.duration,m.gopId=u.gopId,u.keyframe&&m.setToKeyframe();for(var g=0,X=c.length-1;g<X;)f=H(c,g),g+=4,m.units.push(c.subarray(g,g+f)),g+=f;l.samples.push(m)}l.baseMediaDecodeTime=l.samples[0].dts}if(s){for(var D=s[0],F=s[1];D<=F;D++){if(u=this._audioSamples[D],!u)throw new Error("cannot found video frame #".concat(D));p=u.offset-n,c=t.subarray(p,p+u.size),o.samples.push(new ft(u.dts,c,u.duration))}o.baseMediaDecodeTime=o.samples[0].dts}return{videoTrack:l,audioTrack:o,metadataTrack:this.metadataTrack}}},{key:"demuxPart",value:function(t,n,e,s,r,l,o,u){if(this.parseSamples(r),this.videoTrack.useEME=l,this.audioTrack.useEME=l,this._lastRemainBuffer&&this._lastRemainBuffer.byteLength>0&&n>this._lastRemainBufferStartPos&&n<=this._lastRemainBufferStartPos+this._lastRemainBuffer.byteLength)for(var c=0;c<pr;)try{var p=this._lastRemainBuffer.subarray(0,n-this._lastRemainBufferStartPos),m=new Uint8Array(t.byteLength+p.byteLength);m.set(p,0),m.set(new Uint8Array(t),p.byteLength),t=m,n-=p.byteLength,this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0;break}catch(d){if(c<pr)c++;else throw new Error("new Uint8Array error:,"+d.errorMessage)}var f=this.videoTrack,b=this.audioTrack;f.samples=[],b.samples=[],f.videoSenc=null,b.audioSenc=null;var v,g,X,D=0,F=0;if(this._videoSamples.length>0&&e.length>0){for(var w,S=t.byteLength+n,G=e[0];G<=e[1];G++){if(v=this._videoSamples[G],!v)throw new Error("cannot found video frame #".concat(G));v.offset>=n&&v.offset+v.size<=S&&(X=v.offset-n,D=X+v.size,g=t.subarray(X,D),w=new tn(v.pts||v.dts,v.dts),w.duration=v.duration,w.gopId=v.gopId,w.sampleOffset=v.index,v.keyframe&&w.setToKeyframe(),w.data=g,w.size=v.size,f.samples.push(w))}f.samples.length>0&&(f.gopId=f.samples[0].gopId,f.baseMediaDecodeTime=f.samples[0].dts,f.startPts=f.samples[0].pts/f.timescale,f.endPts=f.samples[f.samples.length-1].pts/f.timescale,this.videoSenc&&(f.videoSenc=this.videoSenc.slice(f.samples[0].sampleOffset,f.samples[0].sampleOffset+f.samples.length),f.kidValue=o))}if(this._audioSamples.length>0&&s.length>0){for(var T=s[0];T<=s[1];T++){if(v=this._audioSamples[T],!v)throw new Error("cannot found video frame #".concat(T));v.offset>=n&&v.offset+v.size<=t.byteLength+n&&(X=v.offset-n,F=X+v.size,g=t.subarray(X,F),b.samples.push(new ft(v.dts,g,v.duration,v.index)))}b.samples.length>0&&(b.gopId=b.samples[0].gopId||f.gopId,b.baseMediaDecodeTime=b.samples[0].dts,b.startPts=b.samples[0].pts/b.timescale,b.endPts=b.samples[b.samples.length-1].pts/b.timescale,this.audioSenc&&(b.audioSenc=this.audioSenc.slice(b.samples[0].sampleOffset,b.samples[0].sampleOffset+b.samples.length),b.kidValue=o))}this.decoderData(f,b,u);for(var C=0,I=0;I<f.samples.length;I++)for(var E=0,U=f.samples[I].data,h=U.length-1;E<h;)C=H(U,E),E+=4,f.samples[I].units.push(U.subarray(E,E+C)),E+=C;return this._lastRemainBuffer=t.subarray(Math.max(D,F)),this._lastRemainBuffer.byteLength>0?this._lastRemainBufferStartPos=n+t.byteLength-this._lastRemainBuffer.byteLength:this._lastRemainBufferStartPos=0,{videoTrack:f,audioTrack:b,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this._videoSamples=[],this._audioSamples=[],this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0,this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}},{key:"decoderData",value:function(t,n,e){t.useEME||n.useEME||bn.decoderAESCTRData(t,n,e)}}],[{key:"probe",value:function(t){return re.probe(t)}}]),a}(),Zl=function(){function a(){ye(this,a);var i=window.crypto||window.msCrypto;this.subtle=i&&(i.subtle||i.webkitSubtle),this.externalDecryptor=null}return be(a,[{key:"destroy",value:function(){var t;(t=this.externalDecryptor)!==null&&t!==void 0&&t.destroy&&this.externalDecryptor.destroy()}},{key:"decrypt",value:function(t,n){if(!(!t&&!n)){var e=[];return t&&(e[0]=this._decryptSegment(t)),n&&(e[1]=this._decryptSegment(n)),Promise.all(e)}}},{key:"_decryptSegment",value:function(){var i=se(A().mark(function n(e){var s;return A().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(s=e.data,!e.key){l.next=5;break}return l.next=4,this._decryptData(e.data,e.key,e.keyIv);case 4:s=l.sent;case 5:if(e.map){l.next=7;break}return l.abrupt("return",s);case 7:return l.abrupt("return",Tt(e.map,s));case 8:case"end":return l.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"_decryptData",value:function(){var i=se(A().mark(function n(e,s,r){var l;return A().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!this.externalDecryptor){u.next=6;break}return u.next=3,this.externalDecryptor.decrypt(e,s,r);case 3:return u.abrupt("return",u.sent);case 6:if(this.subtle){u.next=8;break}throw new Error("crypto is not defined");case 8:return u.next=10,this.subtle.importKey("raw",s,{name:"AES-CBC"},!1,["encrypt","decrypt"]);case 10:return l=u.sent,u.t0=Uint8Array,u.next=14,this.subtle.decrypt({name:"AES-CBC",iv:r},l,e);case 14:return u.t1=u.sent,u.abrupt("return",new u.t0(u.t1));case 16:case"end":return u.stop()}},n,this)}));function t(n,e,s){return i.apply(this,arguments)}return t}()}]),a}(),$=ie(ie({},M),{},{STREAM_PARSED:"core.streamparsed",NO_AUDIO_TRACK:"core.noaudiotrack",SUBTITLE_SEGMENTS:"core.subtitlesegments",SUBTITLE_PLAYLIST:"core.subtitleplaylist",SEI_PAYLOAD_TIME:"core.seipayloadtime",APPEND_COST:"core.appendcost"}),dn=new xe("Transmuxer"),dr=function(){function a(i,t,n){ye(this,a),k(this,"_initSegmentId",""),this.hls=i,this._demuxer=t?new il:new fa,this._isMP4=t,n&&(this._remuxer=new Cs(this._demuxer.videoTrack,this._demuxer.audioTrack))}return be(a,[{key:"transmux",value:function(t,n,e,s,r,l){var o=this._demuxer;try{this._isMP4?o.demux(t,n):o.demuxAndFix(Tt(t,n),e,s,r)}catch(w){throw new pe(q.DEMUX,q.SUB_TYPES.HLS,w)}var u=o.videoTrack,c=o.audioTrack,p=o.metadataTrack,m="".concat(u.codec,"/").concat(u.width,"/").concat(u.height,"/").concat(c.codec,"/").concat(c.config);if(m!==this._initSegmentId&&(this._initSegmentId=m,l=!0),this._fireEvents(u,c,p,e||l),this.hls.emit($.DEMUXED_TRACK,{videoTrack:u,audioTrack:c}),this._remuxer)try{var f=this._remuxer.remux(l),b=f.videoInitSegment,v=f.videoSegment,g=f.audioInitSegment,X=f.audioSegment,D=Tt(b,v),F=Tt(g,X);return[D?{codec:u.codec,data:D}:void 0,F?{codec:c.codec,data:F}:void 0]}catch(w){throw new pe(q.REMUX,q.SUB_TYPES.FMP4,w)}else return[u,c]}},{key:"_fireEvents",value:function(t,n,e,s){var r=this;dn.debug(t.samples,n.samples),s&&(t.exist()&&this.hls.emit($.METADATA_PARSED,{type:"video",track:t,meta:{codec:t.codec,timescale:t.timescale,width:t.width,height:t.height,sarRatio:t.sarRatio,baseDts:t.baseDts}}),n.exist()&&this.hls.emit($.METADATA_PARSED,{type:"audio",track:n,meta:{codec:n.codec,channelCount:n.channelCount,sampleRate:n.sampleRate,timescale:n.timescale,baseDts:n.baseDts}}),dn.debug("discontinuity",t,n)),t.warnings.forEach(function(l){var o;switch(l.type){case de.LARGE_AV_SHIFT:o=$.LARGE_AV_FIRST_FRAME_GAP_DETECT;break;case de.LARGE_VIDEO_GAP:o=$.LARGE_VIDEO_DTS_GAP_DETECT;break;case de.LARGE_VIDEO_GAP_BETWEEN_CHUNK:o=$.MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT;break}o&&r.hls.emit($.STREAM_EXCEPTION,ie(ie({},l),{},{type:o})),dn.warn("video exception",l)}),n.warnings.forEach(function(l){var o;switch(l.type){case de.LARGE_AUDIO_GAP:o=$.LARGE_AUDIO_DTS_GAP_DETECT;break;case de.AUDIO_FILLED:o=$.AUDIO_GAP_DETECT;break;case de.AUDIO_DROPPED:o=$.AUDIO_OVERLAP_DETECT;break}o&&r.hls.emit($.STREAM_EXCEPTION,ie(ie({},l),{},{type:o})),dn.warn("audio exception",l)}),t.samples.forEach(function(l){l.keyframe&&r.hls.emit($.KEYFRAME,{pts:l.pts})}),e.seiSamples.forEach(function(l){r.hls.emit($.SEI,ie(ie({},l),{},{originPts:l.originPts/90,sei:{code:l.data.type,content:l.data.payload,dts:l.pts}}))})}}]),a}(),hr=new xe("BufferService"),Sl=function(){function a(i){ye(this,a),k(this,"_decryptor",new Zl),k(this,"_transmuxer",null),k(this,"_mse",null),k(this,"_softVideo",null),k(this,"_sourceCreated",!1),k(this,"_needInitSegment",!0),k(this,"_directAppend",!1),this.hls=i,i.config.softDecode?this._softVideo=i.media:(this._mse=new he,i.config.url&&this._mse.bindMedia(i.media)),i.config.decryptor&&(this._decryptor.externalDecryptor=i.config.decryptor)}return be(a,[{key:"baseDts",get:function(){var t,n,e;return(t=this._transmuxer)===null||t===void 0||(n=t._demuxer)===null||n===void 0||(e=n._fixer)===null||e===void 0?void 0:e._baseDts}},{key:"nbSb",get:function(){var t;return(t=this._mse)!==null&&t!==void 0&&t._sourceBuffer?Object.keys(this._mse._sourceBuffer).length:0}},{key:"msIsOpend",get:function(){var t;return(t=this._mse)===null||t===void 0?void 0:t.isOpened}},{key:"updateDuration",value:function(){var i=se(A().mark(function n(e){return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(hr.debug("update duration",e),!this._mse){r.next=9;break}if(this._mse.isOpened){r.next=5;break}return r.next=5,this._mse.open();case 5:return r.next=7,this._mse.updateDuration(e);case 7:r.next=10;break;case 9:this._softVideo&&(this._softVideo.duration=e);case 10:case"end":return r.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"createSource",value:function(t,n,e,s){if(!this._sourceCreated){var r=t||n;if(r){if(fa.probe(r))this._transmuxer||(this._transmuxer=new dr(this.hls,!1,!this._softVideo));else if(re.probe(r))if(this._softVideo)this._transmuxer||(this._transmuxer=new dr(this.hls,!0));else{this._directAppend=!0;var l=!1;t&&!e&&re.findBox(t,["moov","trak"]).forEach(function(o){var u=re.findBox(o.data,["trak","mdia","minf","stbl","stsd"])[0];if(u){var c=re.stsd(u).entries[0];if(c){if(c.hvcC)e=c.hvcC.codec||"hev1.1.6.L93.B0";else if(c.avcC)e=c.avcC.codec;else if(c.sampleRate||c.esds){var p;s=((p=c.esds)===null||p===void 0?void 0:p.codec)||"mp4a.40.2",l=!0}}}}),n&&!s&&re.findBox(n,["moov","trak","mdia","minf","stbl","stsd"]).forEach(function(o){var u=re.stsd(o).entries[0];u&&u.esds&&(s=u.esds.codec)}),t&&!e&&(e="avc1.42e01e"),n&&!s&&(s="mp4a.40.2"),l&&(e+=", ".concat(s),s=""),this._createMseSource(e,s)}else throw new pe(q.OTHER,null,null,null,"unsupported stream");this._softVideo&&(this._sourceCreated=!0)}}}},{key:"appendBuffer",value:function(){var i=se(A().mark(function n(e,s,r,l,o,u,c){var p,m,f,b,v,g,X,D,F;return A().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(!(r!=null&&r.length)&&!(l!=null&&l.length))){S.next=2;break}return S.abrupt("return");case 2:if(!this._directAppend){S.next=7;break}return p=[],r&&p.push(this._mse.append(he.VIDEO,r)),l&&p.push(this._mse.append(he.AUDIO,l)),S.abrupt("return",Promise.all(p));case 7:if(m=this._needInitSegment||o,f=this._transmuxer.transmux(r,l,o,u,c,this._needInitSegment||o),b=mt(f,2),v=b[0],g=b[1],l&&s&&(s==null||s.setTrackExist(!1,!0)),l&&e&&(e==null||e.setTrackExist(!0,!1)),s||e==null||e.setTrackExist(!!v,!!g),v&&!g&&this.hls.emit($.NO_AUDIO_TRACK),!this._softVideo){S.next=18;break}this._softVideo.appendBuffer(v,g),this._needInitSegment=!1,S.next=28;break;case 18:if(!this._mse){S.next=28;break}return X=!this._sourceCreated,X&&this._createMseSource(v==null?void 0:v.codec,g==null?void 0:g.codec),this._needInitSegment=!1,D=this._mse,F=[],m&&!X&&this._handleCodecChange(v,g),v&&F.push(D.append(he.VIDEO,v.data)),g&&F.push(D.append(he.AUDIO,g.data)),S.abrupt("return",Promise.all(F));case 28:case"end":return S.stop()}},n,this)}));function t(n,e,s,r,l,o,u){return i.apply(this,arguments)}return t}()},{key:"removeBuffer",value:function(){var i=se(A().mark(function n(){var e=this,s,r,l,o=arguments;return A().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(s=o.length>0&&o[0]!==void 0?o[0]:0,r=o.length>1&&o[1]!==void 0?o[1]:1/0,l=this.hls.media,!(!this._mse||!l||s<0||r<s||s>=this._mse.duration)){c.next=5;break}return c.abrupt("return");case 5:return c.abrupt("return",this._mse.clearBuffer(s,r).then(function(){return e.hls.emit(M.REMOVE_BUFFER,{start:s,end:r,removeEnd:r})}));case 6:case"end":return c.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"evictBuffer",value:function(){var i=se(A().mark(function n(e){var s,r,l,o;return A().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(s=this.hls.media,!(!this._mse||!s||!e||e<0)){c.next=3;break}return c.abrupt("return");case 3:if(r=s.currentTime,l=r-e,!(l<=0)){c.next=7;break}return c.abrupt("return");case 7:if(o=me.start(me.get(s)),!(o+1>=l)){c.next=10;break}return c.abrupt("return");case 10:return c.abrupt("return",this.removeBuffer(0,l));case 11:case"end":return c.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"clearAllBuffer",value:function(){var i=se(A().mark(function n(){return A().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._mse){s.next=2;break}return s.abrupt("return",this._mse.clearAllBuffer());case 2:case"end":return s.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"decryptBuffer",value:function(t,n){return this._decryptor.decrypt(t,n)}},{key:"reset",value:function(){var i=se(A().mark(function n(){var e,s=arguments;return A().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(e=s.length>0&&s[0]!==void 0?s[0]:!1,!(this._mse&&!e)){l.next=8;break}return this._transmuxer=null,this._sourceCreated=!1,l.next=6,this._mse.unbindMedia();case 6:return l.next=8,this._mse.bindMedia(this.hls.media);case 8:this._needInitSegment=!0,this._directAppend=!1;case 10:case"end":return l.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"endOfStream",value:function(){var i=se(A().mark(function n(){return A().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._mse){s.next=5;break}if(!this._sourceCreated){s.next=5;break}return s.next=4,this._mse.endOfStream();case 4:this.hls.emit(M.BUFFEREOS);case 5:this._softVideo&&this._softVideo.endOfStream();case 6:case"end":return s.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"setLiveSeekableRange",value:function(){var i=se(A().mark(function n(e,s){return A().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:this._mse&&this._mse.setLiveSeekableRange(e,s);case 1:case"end":return l.stop()}},n,this)}));function t(n,e){return i.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var i=se(A().mark(function n(){var e;return A().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if((e=this._decryptor)===null||e===void 0||e.destroy(),!this._mse){r.next=4;break}return r.next=4,this._mse.unbindMedia();case 4:this._decryptor=null,this._mse=null,this._softVideo=null;case 7:case"end":return r.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"_createMseSource",value:function(t,n){hr.debug("create mse source, videoCodec=".concat(t,", audioCodec=").concat(n));var e=this._mse;e&&(t&&(e.createSource(he.VIDEO,"video/mp4;codecs=".concat(t)),this._sourceCreated=!0),n&&(e.createSource(he.AUDIO,"audio/mp4;codecs=".concat(n)),this._sourceCreated=!0),this.hls.emit(M.SOURCEBUFFER_CREATED))}},{key:"_handleCodecChange",value:function(t,n){var e=this._mse,s=[{type:he.VIDEO,codecs:t==null?void 0:t.codec},{type:he.AUDIO,codecs:n==null?void 0:n.codec}];s.filter(function(r){return!!r.codecs}).forEach(function(r){var l=r.type,o=r.codecs,u=e.getSourceBuffer(l);if(u){var c=o.split(",")[0];new RegExp(c,"ig").test(u.mimeType)||e.changeType(l,"".concat(l,"/mp4;codecs=").concat(o))}})}},{key:"seamlessSwitch",value:function(){this._needInitSegment=!0}}]),a}();function Ll(a){var i=(a==null?void 0:a.media)||document.createElement("video");return ie(ie({maxPlaylistSize:50,retryCount:3,retryDelay:1e3,pollRetryCount:2,loadTimeout:1e4,preloadTime:30,softDecode:!1,bufferBehind:10,maxJumpDistance:3,startTime:0,targetLatency:10,maxLatency:20,allowedStreamTrackChange:!0,seiInTime:!1,manifest:""},a),{},{media:i})}var Xl=be(function a(){ye(this,a),k(this,"version",0),k(this,"streams",[]),k(this,"isMaster",!0)}),Wa={Audio:"AUDIO",Video:"VIDEO",SubTitle:"SUBTITLE",ClosedCaptions:"CLOSED-CAPTIONS"},Ts=be(function a(){ye(this,a),k(this,"id",0),k(this,"url",""),k(this,"default",!1),k(this,"autoSelect",!1),k(this,"forced",!1),k(this,"group",""),k(this,"name",""),k(this,"lang",""),k(this,"segments",[]),k(this,"endSN",0)}),Dl=function(a){Tn(t,a);var i=kn(t);function t(){var n;ye(this,t);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=i.call.apply(i,[this].concat(s)),k(Q(n),"mediaType",Wa.Audio),k(Q(n),"channels",0),n}return be(t)}(Ts),wl=function(a){Tn(t,a);var i=kn(t);function t(){var n;ye(this,t);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=i.call.apply(i,[this].concat(s)),k(Q(n),"mediaType",Wa.SubTitle),n}return be(t)}(Ts),Gl=be(function a(){ye(this,a),k(this,"id",0),k(this,"bitrate",0),k(this,"width",0),k(this,"height",0),k(this,"name",""),k(this,"url",""),k(this,"audioCodec",""),k(this,"videoCodec",""),k(this,"textCodec",""),k(this,"audioGroup",""),k(this,"audioStreams",[]),k(this,"subtitleStreams",[]),k(this,"closedCaptionsStream",[])}),Fl=be(function a(){ye(this,a),k(this,"version",0),k(this,"url",""),k(this,"type",""),k(this,"startCC",0),k(this,"endCC",0),k(this,"startSN",0),k(this,"endSN",0),k(this,"totalDuration",0),k(this,"targetDuration",0),k(this,"live",!0),k(this,"segments",[])}),Qn=function(){function a(){ye(this,a),k(this,"sn",0),k(this,"cc",0),k(this,"url",""),k(this,"title",""),k(this,"start",0),k(this,"duration",0),k(this,"key",null),k(this,"byteRange",null),k(this,"isInitSegment",!1),k(this,"initSegment",null),k(this,"isLast",!1),k(this,"hasAudio",!1),k(this,"hasVideo",!1)}return be(a,[{key:"end",get:function(){return this.start+this.duration}},{key:"setTrackExist",value:function(t,n){this.hasVideo=t,this.hasAudio=n}},{key:"setByteRange",value:function(t,n){this.byteRange=[0];var e=t.split("@");e.length===1&&n&&n.byteRange?(this.byteRange[0]=n.byteRange[1]||0,this.byteRange[0]&&(this.byteRange[0]+=1)):this.byteRange[0]=parseInt(e[1]),this.byteRange[1]=this.byteRange[0]+parseInt(e[0])-1}}]),a}(),Wl=function(){function a(i){ye(this,a),k(this,"method",""),k(this,"url",""),k(this,"iv",null),k(this,"keyFormat",""),k(this,"keyFormatVersions",""),i instanceof a&&(this.method=i.method,this.url=i.url,this.keyFormat=i.keyFormat,this.keyFormatVersions=i.keyFormatVersions,i.iv&&(this.iv=new Uint8Array(i.iv)))}return be(a,[{key:"clone",value:function(t){var n=new a(this);return t!=null&&n.setIVFromSN(t),n}},{key:"setIVFromSN",value:function(t){if(!this.iv&&this.method==="AES-128"&&typeof t=="number"&&this.url){this.iv=new Uint8Array(16);for(var n=12;n<16;n++)this.iv[n]=t>>8*(15-n)&255}}}]),a}(),Cl=/^#(EXT[^:]*)(?::(.*))?$/,mr=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g,Tl=/^(?:[a-zA-Z0-9+\-.]+:)?\/\//,kl=/^((?:[a-zA-Z0-9+\-.]+:)?\/\/[^/?#]*)?([^?#]*\/)?/;function Rl(a){return a.split(/[\r\n]/).map(function(i){return i.trim()}).filter(Boolean)}function Ca(a){var i=a.match(Cl);if(!(!i||!i[1]))return[i[1].replace("EXT-X-",""),i[2]]}function Xn(a){for(var i={},t=mr.exec(a);t;)i[t[1]]=t[2]||t[3],t=mr.exec(a);return i}function Qt(a,i){if(!i||!a||Tl.test(a))return a;var t=kl.exec(i);return t?a[0]==="/"?t[1]+a:t[1]+t[2]+a:a}var Vl={audio:[/^mp4a/,/^vorbis$/,/^opus$/,/^flac$/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function qn(a,i){var t=Vl[a];if(!(!t||!i||!i.length)){for(var n=0;n<t.length;n++)for(var e=0;e<i.length;e++)if(t[n].test(i[e]))return i[e]}}function xl(a,i){for(var t=new Xl,n=0,e,s=[],r=[];e=a[n++];){var l=Ca(e);if(l){var o=mt(l,2),u=o[0],c=o[1];if(u==="VERSION")t.version=parseInt(c);else if(u==="MEDIA"&&c){var p=Xn(c),m=void 0;switch(p.TYPE){case"AUDIO":m=new Dl;break;case"SUBTITLES":m=new wl;break;default:m=new Ts}m.url=Qt(p.URI,i),m.default=p.DEFAULT==="YES",m.autoSelect=p.AUTOSELECT==="YES",m.group=p["GROUP-ID"],m.name=p.NAME,m.lang=p.LANGUAGE,p.CHANNELS&&(m.channels=Number(p.CHANNELS.split("/")[0]),Number.isNaN(m.channels)&&(m.channels=0)),p.TYPE==="AUDIO"&&p.URI&&s.push(m),p.TYPE==="SUBTITLES"&&r.push(m)}else if(u==="STREAM-INF"&&c){var f=new Gl,b=Xn(c);if(f.bitrate=parseInt(b["AVERAGE-BANDWIDTH"]||b.BANDWIDTH),f.name=b.NAME,f.url=Qt(a[n++],i),b.RESOLUTION){var v=b.RESOLUTION.split("x"),g=mt(v,2),X=g[0],D=g[1];f.width=parseInt(X),f.height=parseInt(D)}if(b.CODECS){var F=b.CODECS.split(/[ ,]+/).filter(Boolean);f.videoCodec=qn("video",F),f.audioCodec=qn("audio",F),f.textCodec=qn("text",F)}f.audioGroup=b.AUDIO,f.subtitleGroup=b.SUBTITLES,t.streams.push(f)}}}return t.streams.forEach(function(w,S){w.id=S}),s.length&&(s.forEach(function(w,S){w.id=S}),t.streams.forEach(function(w){w.audioGroup&&(w.audioStreams=s.filter(function(S){return S.group===w.audioGroup}))})),r.length&&(r.forEach(function(w,S){w.id=S}),t.streams.forEach(function(w){w.subtitleGroup&&(w.subtitleStreams=r.filter(function(S){return S.group===w.subtitleGroup}))})),t}function Ml(a,i){var t=new Fl;t.url=i;for(var n=new Qn,e=null,s=null,r=0,l=0,o=0,u=0,c,p=!1;(c=a[u++])&&!p;){if(c[0]!=="#"){n.sn=l,n.cc=o,n.url=Qt(c,i),s&&(n.key=s.clone(l)),e&&(n.initSegment=e),t.segments.push(n),n=new Qn,l++;continue}var m=Ca(c);if(m){var f=mt(m,2),b=f[0],v=f[1];switch(b){case"VERSION":t.version=parseInt(v);break;case"PLAYLIST-TYPE":t.type=v==null?void 0:v.toUpperCase();break;case"TARGETDURATION":t.targetDuration=parseFloat(v);break;case"ENDLIST":{var g=t.segments[t.segments.length-1];g&&(g.isLast=!0),t.live=!1,p=!0}break;case"MEDIA-SEQUENCE":l=t.startSN=parseInt(v);break;case"DISCONTINUITY-SEQUENCE":o=t.startCC=parseInt(v);break;case"DISCONTINUITY":o++;break;case"BYTERANGE":n.setByteRange(v,t.segments[t.segments.length-1]);break;case"EXTINF":{var X=v.split(","),D=mt(X,2),F=D[0],w=D[1];n.start=r,n.duration=parseFloat(F),r+=n.duration,n.title=w}break;case"KEY":{var S=Xn(v);if(S.METHOD==="NONE"){s=null;break}if(S.METHOD!=="AES-128")throw new Error("encrypt ".concat(S.METHOD,"/").concat(S.KEYFORMAT," is not supported"));if(s=new Wl,s.method=S.METHOD,s.url=/^blob:/.test(S.URI)?S.URI:Qt(S.URI,i),s.keyFormat=S.KEYFORMAT||"identity",s.keyFormatVersions=S.KEYFORMATVERSIONS,S.IV){var G=S.IV.slice(2);G=(G.length&1?"0":"")+G,s.iv=new Uint8Array(G.length/2);for(var T=0,C=G.length/2;T<C;T++)s.iv[T]=parseInt(G.slice(T*2,T*2+2),16)}}break;case"MAP":{var I=Xn(v);n.url=Qt(I.URI,i),I.BYTERANGE&&n.setByteRange(I.BYTERANGE),n.isInitSegment=!0,n.sn=0,s&&(n.key=s.clone(0)),e=n,n=new Qn}break}}}t.segments=t.segments.filter(function(U){return U.duration!==0});var E=t.segments[t.segments.length-1];return E&&(t.endSN=E.sn),t.totalDuration=r,t.endCC=o,t}var hn=function(){function a(){ye(this,a)}return be(a,null,[{key:"parse",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;if(!t.includes("#EXTM3U"))throw new Error("Invalid m3u8 file");var e=Rl(t);return a.isMediaPlaylist(t)?Ml(e,n):xl(e,n)}},{key:"isMediaPlaylist",value:function(t){return t.includes("#EXTINF:")||t.includes("#EXT-X-TARGETDURATION:")}}]),a}(),Yl=function(){function a(i){var t=this;ye(this,a),k(this,"_emitOnLoaded",function(o,u){var c=o.response,p=o.options,m=p||{},f=m.firstByteTime,b=m.startTime,v=m.endTime,g=m.contentLength,X=v-b;t.hls.emit(M.SPEED,{time:X,byteLength:g,url:u}),t.hls.emit(M.LOAD_COMPLETE,{url:u,elapsed:X||0}),t.hls.emit(M.TTFB,{url:u,responseUrl:c.url,elapsed:f-b}),t.hls.emit(M.LOAD_RESPONSE_HEADERS,{headers:c.headers,url:u})}),k(this,"_onLoaderRetry",function(o,u){t.hls.emit($.LOAD_RETRY,{error:pe.network(o),retryTime:u})}),this.hls=i,this._timer=null;var n=this.hls.config,e=n.retryCount,s=n.retryDelay,r=n.loadTimeout,l=n.fetchOptions;this._loader=new St(ie(ie({},l),{},{responseType:"text",retry:e,retryDelay:s,timeout:r,onRetryError:this._onLoaderRetry})),this._audioLoader=new St(ie(ie({},l),{},{responseType:"text",retry:e,retryDelay:s,timeout:r,onRetryError:this._onLoaderRetry})),this._subtitleLoader=new St(ie(ie({},l),{},{responseType:"text",retry:e,retryDelay:s,timeout:r,onRetryError:this._onLoaderRetry}))}return be(a,[{key:"load",value:function(){var i=se(A().mark(function n(e,s,r){var l,o,u,c,p,m,f,b,v,g,X,D,F,w;return A().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return l=[this._loader.load(e)],s&&l.push(this._audioLoader.load(s)),r&&l.push(this._subtitleLoader.load(r)),G.prev=3,G.next=6,Promise.all(l);case 6:if(p=G.sent,m=mt(p,3),f=m[0],b=m[1],v=m[2],f){G.next=13;break}return G.abrupt("return",[]);case 13:this._emitOnLoaded(f,e),o=f.data,s?(u=b==null?void 0:b.data,c=v==null?void 0:v.data,u&&this._emitOnLoaded(b,s),c&&this._emitOnLoaded(v,r)):(c=v==null?void 0:v.data,c&&this._emitOnLoaded(v,r)),G.next=21;break;case 18:throw G.prev=18,G.t0=G.catch(3),pe.network(G.t0);case 21:if(g=this.hls.config.onPreM3U8Parse,G.prev=22,g&&(o=g(o)||o,u&&(u=g(u,!0)||u),c&&(c=g(c,!0)||c)),X=hn.parse(o,e),!(((w=X)===null||w===void 0?void 0:w.live)===!1&&X.segments&&!X.segments.length)){G.next=27;break}throw new Error("empty segments list");case 27:u&&(D=hn.parse(u,s)),c&&(F=hn.parse(c,r)),G.next=34;break;case 31:throw G.prev=31,G.t1=G.catch(22),new pe(q.MANIFEST,q.SUB_TYPES.HLS,G.t1);case 34:return X&&(X.isMaster?this.hls.emit($.HLS_MANIFEST_LOADED,{playlist:X}):this.hls.emit($.HLS_LEVEL_LOADED,{playlist:X})),G.abrupt("return",[X,D,F]);case 36:case"end":return G.stop()}},n,this,[[3,18],[22,31]])}));function t(n,e,s){return i.apply(this,arguments)}return t}()},{key:"parseText",value:function(t,n){var e=this.hls.config.onPreM3U8Parse,s;try{var r;if(e&&(t=e(t)||t),s=hn.parse(t,n),((r=s)===null||r===void 0?void 0:r.live)===!1&&s.segments&&!s.segments.length)throw new Error("empty segments list")}catch(l){throw new pe(q.MANIFEST,q.SUB_TYPES.HLS,l)}return s&&(s.isMaster?this.hls.emit($.HLS_MANIFEST_LOADED,{playlist:s}):this.hls.emit($.HLS_LEVEL_LOADED,{playlist:s})),[s]}},{key:"poll",value:function(t,n,e,s,r,l){var o=this;clearTimeout(this._timer),l=l||3e3;var u=this.hls.config.pollRetryCount,c=function(){var p=se(A().mark(function m(){var f;return A().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return clearTimeout(o._timer),v.prev=1,v.next=4,o.load(t,n,e);case 4:if(f=v.sent,f[0]){v.next=7;break}return v.abrupt("return");case 7:u=o.hls.config.pollRetryCount,s(f[0],f[1],f[2]),v.next=15;break;case 11:v.prev=11,v.t0=v.catch(1),u--,u<=0&&r(v.t0);case 15:o._timer=setTimeout(c,l);case 16:case"end":return v.stop()}},m,null,[[1,11]])}));return function(){return p.apply(this,arguments)}}();this._timer=setTimeout(c,l)}},{key:"stopPoll",value:function(){return clearTimeout(this._timer),this.cancel()}},{key:"cancel",value:function(){return Promise.all([this._loader.cancel(),this._audioLoader.cancel()])}}]),a}();function Ta(a,i,t){return i>t&&(t=i),Math.min(Math.max(a,i),t)}var fr=function(){function a(i,t,n){ye(this,a),k(this,"live",void 0),k(this,"id",0),k(this,"bitrate",0),k(this,"width",0),k(this,"height",0),k(this,"name",""),k(this,"url",""),k(this,"audioCodec",""),k(this,"videoCodec",""),k(this,"textCodec",""),k(this,"startCC",0),k(this,"endCC",0),k(this,"startSN",0),k(this,"endSN",-1),k(this,"totalDuration",0),k(this,"targetDuration",0),k(this,"snDiff",null),k(this,"segments",[]),k(this,"audioStreams",[]),k(this,"subtitleStreams",[]),k(this,"closedCaptions",[]),k(this,"currentAudioStream",null),k(this,"currentSubtitleStream",null),this.update(i,t,n)}return be(a,[{key:"lastSegment",get:function(){return this.segments.length?this.segments[this.segments.length-1]:null}},{key:"segmentDuration",get:function(){var t;return this.targetDuration||((t=this.segments[0])===null||t===void 0?void 0:t.duration)||0}},{key:"liveEdge",get:function(){return this.endTime}},{key:"endTime",get:function(){var t;return((t=this.lastSegment)===null||t===void 0?void 0:t.end)||0}},{key:"currentSubtitleEndSn",get:function(){var t;return((t=this.currentSubtitleStream)===null||t===void 0?void 0:t.endSN)||0}},{key:"clearOldSegment",value:function(t,n){return this.currentAudioStream&&this._clearSegments(t,n),this._clearSegments(t,n)}},{key:"getAudioSegment",value:function(t){if(!(!t||!this.currentAudioStream)){var n=t.sn-this.snDiff;return this.currentAudioStream.segments.find(function(e){return e.sn===n})}}},{key:"update",value:function(t,n){this.url=t.url,Array.isArray(t.segments)?((this.live===null||this.live===void 0)&&(this.live=t.live),this._updateSegments(t,this),this.startCC=t.startCC,this.endCC=t.endCC,this.startSN=t.startSN,this.endSN=t.endSN||-1,this.totalDuration=t.totalDuration,this.targetDuration=t.targetDuration,this.live=t.live,n&&this.currentAudioStream&&Array.isArray(n.segments)&&(this._updateSegments(n,this.currentAudioStream),(this.snDiff===null||this.snDiff===void 0)&&t.segments.length&&n.segments.length&&(this.snDiff=t.segments[0].sn-n.segments[0].sn))):(this.id=t.id,this.bitrate=t.bitrate,this.width=t.width,this.height=t.height,this.name=t.name,this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.textCodec=t.textCodec,this.audioStreams=t.audioStreams,this.subtitleStreams=t.subtitleStreams,!this.currentAudioStream&&this.audioStreams.length&&(this.currentAudioStream=this.audioStreams.find(function(e){return e.default})||this.audioStreams[0]),!this.currentSubtitleStream&&this.subtitleStreams.length&&(this.currentSubtitleStream=this.subtitleStreams.find(function(e){return e.default})||this.subtitleStreams[0]))}},{key:"updateSubtitle",value:function(t){var n=this;if(t&&this.currentSubtitleStream&&Array.isArray(t.segments)){var e=this._updateSegments(t,this.currentSubtitleStream),s=this.currentSubtitleStream.segments;if(s.length>100&&(this.currentSubtitleStream.segments=s.slice(100)),!!e)return e.map(function(r){return{sn:r.sn,url:r.url,duration:r.duration,start:r.start,end:r.end,lang:n.currentSubtitleStream.lang}})}}},{key:"switchSubtitle",value:function(t){var n=this.subtitleStreams.find(function(s){return s.lang===t}),e=this.currentSubtitleStream;n&&(this.currentSubtitleStream=n,e.segments=[])}},{key:"_clearSegments",value:function(t,n){for(var e=0,s=this.segments,r=0,l=s.length;r<l;r++)if(s[r].end>=t){e=r;break}return e>n&&(e=n),e&&(this.segments=this.segments.slice(e),this.currentAudioStream&&(this.currentAudioStream.segments=this.currentAudioStream.segments.slice(e))),n-e}},{key:"_updateSegments",value:function(t,n){var e=n.segments;if(this.live){var s=e[e.length-1],r=(s==null?void 0:s.sn)||-1;if(r<t.endSN&&t.segments.length){var l=t.segments.findIndex(function(p){return p.sn===r}),o=l<0?t.segments:t.segments.slice(l+1);if(e.length&&o.length){var u=s.end;o.forEach(function(p){p.start=u,u=p.end});var c=(s==null?void 0:s.cc)||-1;c>o[0].cc&&o.forEach(function(p){return p.cc+=c})}return n.endSN=t.endSN,n.segments=e.concat(o),o}}else n.segments=t.segments}}]),a}(),El=function(){function a(i){ye(this,a),k(this,"streams",[]),k(this,"currentStream",null),k(this,"dvrWindow",0),k(this,"_segmentPointer",-1),this.hls=i}return be(a,[{key:"lastSegment",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.lastSegment}},{key:"currentSegment",get:function(){var t;return(t=this.currentSegments)===null||t===void 0?void 0:t[this._segmentPointer]}},{key:"nextSegment",get:function(){var t;return(t=this.currentSegments)===null||t===void 0?void 0:t[this._segmentPointer+1]}},{key:"currentSegments",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.segments}},{key:"currentSubtitleEndSn",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.currentSubtitleEndSn}},{key:"liveEdge",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.liveEdge}},{key:"totalDuration",get:function(){var t;return((t=this.currentStream)===null||t===void 0?void 0:t.totalDuration)||0}},{key:"seekRange",get:function(){var t=this.currentSegments;if(!(!t||!t.length))return[t[0].start,t[t.length-1].end]}},{key:"isEmpty",get:function(){var t;return!((t=this.currentSegments)!==null&&t!==void 0&&t.length)}},{key:"isLive",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.live}},{key:"hasSubtitle",get:function(){var t;return!!((t=this.currentStream)!==null&&t!==void 0&&t.currentSubtitleStream)}},{key:"getAudioSegment",value:function(t){var n;return(n=this.currentStream)===null||n===void 0?void 0:n.getAudioSegment(t)}},{key:"moveSegmentPointer",value:function(t){var n;t==null&&(t=this._segmentPointer+1),this._segmentPointer=Ta(t,-1,(n=this.currentSegments)===null||n===void 0?void 0:n.length)}},{key:"reset",value:function(){this.streams=[],this.currentStream=null,this.dvrWindow=0,this._segmentPointer=-1}},{key:"getSegmentByIndex",value:function(t){var n;return(n=this.currentSegments)===null||n===void 0?void 0:n[t]}},{key:"setNextSegmentByIndex",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this._segmentPointer=t-1}},{key:"findSegmentIndexByTime",value:function(t){var n=this.currentSegments;if(n){for(var e=0,s=n.length,r;e<s;e++)if(r=n[e],t>=r.start&&t<r.end)return e;var l=n[n.length-1];if(Math.abs(t-l.end)<.2)return n.length-1}}},{key:"upsertPlaylist",value:function(t,n,e){var s=this;if(t){if(t.isMaster)this.streams.length=t.streams.length,t.streams.filter(function(u){return u.url}).forEach(function(u,c){s.streams[c]?s.streams[c].update(u):s.streams[c]=new fr(u)}),this.currentStream=this.streams[0];else if(Array.isArray(t.segments)){var r=this.currentStream;if(r){r.update(t,n,e);var l=r.updateSubtitle(e);l&&this.hls.emit($.SUBTITLE_SEGMENTS,{list:l})}else this.reset(),this.currentStream=this.streams[0]=new fr(t,n,e)}var o=this.currentStream;o&&this.hls.isLive&&!this.dvrWindow&&(this.dvrWindow=this.currentSegments.reduce(function(u,c){return u+=c.duration,u},0))}}},{key:"switchSubtitle",value:function(t){var n;(n=this.currentStream)===null||n===void 0||n.switchSubtitle(t)}},{key:"clearOldSegment",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,n=this.currentStream;if(!(!this.dvrWindow||!n)){var e=n.endTime-this.dvrWindow;if(!(e<=0)){var s=n.segments;s.length<=t||(this._segmentPointer=n.clearOldSegment(e,this._segmentPointer))}}}},{key:"checkSegmentTrackChange",value:function(t,n){var e=this.findSegmentIndexByTime(t),s=this.getSegmentByIndex(e);if(s&&!(!s.hasAudio&&!s.hasVideo)){if(n!==2&&s.hasAudio&&s.hasVideo)return s;if(!(s.end-t>.3)){var r=this.getSegmentByIndex(e+1);if(r&&!(!r.hasAudio&&!r.hasVideo)&&(r.hasAudio!==s.hasAudio||r.hasVideo!==s.hasVideo))return r}}}}]),a}(),Il=function(){function a(i){var t=this;ye(this,a),k(this,"error",null),k(this,"_emitOnLoaded",function(o,u){var c=o.data,p=o.response,m=o.options,f=m||{},b=f.firstByteTime,v=f.startTime,g=f.endTime,X=f.contentLength,D=g-v;t._bandwidthService.addRecord(X||c.byteLength,D),t.hls.emit(M.SPEED,{time:D,byteLength:X,url:u}),t.hls.emit(M.LOAD_COMPLETE,{url:u,elapsed:D||0}),t.hls.emit(M.TTFB,{url:u,responseUrl:p.url,elapsed:b-v}),t.hls.emit(M.LOAD_RESPONSE_HEADERS,{headers:p.headers,url:u})}),k(this,"_onLoaderRetry",function(o,u){t.hls.emit(M.LOAD_RETRY,{error:pe.network(o),retryTime:u})}),this.hls=i,this._bandwidthService=new sa,this._mapCache={},this._keyCache={};var n=this.hls.config,e=n.retryCount,s=n.retryDelay,r=n.loadTimeout,l=n.fetchOptions;this._segmentLoader=new St(ie(ie({},l),{},{responseType:"arraybuffer",retry:e,retryDelay:s,timeout:r,onRetryError:this._onLoaderRetry})),this._audioSegmentLoader=new St(ie(ie({},l),{},{responseType:"arraybuffer",retry:e,retryDelay:s,timeout:r,onRetryError:this._onLoaderRetry})),this._keyLoader=new St(ie(ie({},l),{},{responseType:"arraybuffer",retry:e,retryDelay:s,timeout:r,onRetryError:this._onLoaderRetry}))}return be(a,[{key:"speedInfo",value:function(){return{speed:this._bandwidthService.getLatestSpeed(),avgSpeed:this._bandwidthService.getAvgSpeed()}}},{key:"load",value:function(t,n,e){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,r=[];return t&&(r[0]=this.loadVideoSegment(t,e)),n&&(r[1]=this.loadAudioSegment(n,s)),Promise.all(r)}},{key:"loadVideoSegment",value:function(t,n){return this._loadSegment(this._segmentLoader,t,n)}},{key:"loadAudioSegment",value:function(t,n){return this._loadSegment(this._audioSegmentLoader,t,n)}},{key:"_loadSegment",value:function(){var i=se(A().mark(function n(e,s,r){var l=this,o,u,c,p,m,f,b,v,g,X,D,F,w,S,G;return A().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return b=[],this.hls.emit(M.LOAD_START,{url:s.url}),b[0]=e.load(s.url),r&&s.initSegment&&(g=s.initSegment.url,u=this._mapCache[g],u||(this.hls.emit(M.LOAD_START,{url:g}),b[1]=e.load(g).then(function(I){if(I){var E=Object.keys(l._mapCache);E>30&&(l._mapCache={}),u=l._mapCache[g]=I.data,l._emitOnLoaded(I,g)}})),X=(v=s.initSegment.key)===null||v===void 0?void 0:v.url,X&&(f=s.initSegment.key.iv,m=this._keyCache[X],m||(this.hls.emit(M.LOAD_START,{url:X}),b[2]=this._keyLoader.load(X).then(function(I){I&&(m=l._keyCache[X]=I.data,l._emitOnLoaded(I,X))})))),D=(o=s.key)===null||o===void 0?void 0:o.url,D&&(p=s.key.iv,c=this._keyCache[D],c||(this.hls.emit(M.LOAD_START,{url:D}),b[3]=this._keyLoader.load(D).then(function(I){I&&(c=l._keyCache[D]=I.data,l._emitOnLoaded(I,D))}))),C.next=8,Promise.all(b);case 8:if(F=C.sent,w=mt(F,1),S=w[0],S){C.next=13;break}return C.abrupt("return");case 13:return G=S.data,this._emitOnLoaded(S,s.url),C.abrupt("return",{data:G,map:u,key:c,mapKey:m,keyIv:p,mapKeyIv:f});case 16:case"end":return C.stop()}},n,this)}));function t(n,e,s){return i.apply(this,arguments)}return t}()},{key:"reset",value:function(){this.error=null,this._mapCache={},this._keyCache={},this._bandwidthService.reset()}},{key:"cancel",value:function(){var i=se(A().mark(function n(){return A().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Promise.all([this._keyLoader.cancel(),this._segmentLoader.cancel(),this._audioSegmentLoader.cancel()]);case 2:case"end":return s.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()}]),a}(),Ft=new xe("hls"),Nt=function(a){Tn(t,a);var i=kn(t);function t(n){var e;return ye(this,t),e=i.call(this),k(Q(e),"version",t.version),k(Q(e),"media",null),k(Q(e),"config",null),k(Q(e),"_manifestLoader",null),k(Q(e),"_segmentLoader",null),k(Q(e),"_playlist",null),k(Q(e),"_bufferService",null),k(Q(e),"_gapService",null),k(Q(e),"_seiService",null),k(Q(e),"_stats",null),k(Q(e),"_prevSegSn",null),k(Q(e),"_prevSegCc",null),k(Q(e),"_tickTimer",null),k(Q(e),"_tickInterval",500),k(Q(e),"_segmentProcessing",!1),k(Q(e),"_reloadOnPlay",!1),k(Q(e),"_switchUrlOpts",null),k(Q(e),"_loadSegment",se(A().mark(function s(){var r,l,o;return A().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(e._segmentProcessing||!e.media)){c.next=2;break}return c.abrupt("return");case 2:if(r=e._playlist.nextSegment,r){c.next=5;break}return c.abrupt("return");case 5:if(e.isLive){c.next=12;break}if(l=e.bufferInfo(),o=Math.abs(l.end-e.media.duration)<.1,!(l.remaining>=e.config.preloadTime||o)){c.next=11;break}return o&&e._bufferService.msIsOpend&&e._bufferService.endOfStream(),c.abrupt("return");case 11:!e._urlSwitching&&e._prevSegSn!==r.sn-1&&l.end&&Math.abs(r.start-l.end)>1&&e._playlist.setNextSegmentByIndex(e._playlist.findSegmentIndexByTime(l.end+.1));case 12:return c.abrupt("return",e._loadSegmentDirect());case 13:case"end":return c.stop()}},s)}))),k(Q(e),"_onPlay",se(A().mark(function s(){return A().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(clearTimeout(e._disconnectTimer),!e._reloadOnPlay){l.next=6;break}e._reloadOnPlay=!1,e.replay(!0),l.next=9;break;case 6:return l.next=8,e._loadSegment();case 8:e._startTick();case 9:case"end":return l.stop()}},s)}))),k(Q(e),"_onPause",function(){if(e.isLive){if(!e._reloadOnPlay){var s=e.config.disconnectTime;if(s==null&&(s=e._playlist.dvrWindow),!Number.isFinite(s))return;clearTimeout(e._disconnectTimer),e._disconnectTimer=setTimeout(function(){e._reloadOnPlay=!0,e._clear()},s||0)}}else e._stopTick()}),k(Q(e),"_onSeeking",se(A().mark(function s(){var r,l,o,u,c,p,m;return A().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(e.media){b.next=2;break}return b.abrupt("return");case 2:if(r=e.media.currentTime,l=e._playlist.seekRange,!l){b.next=9;break}if(o=Ta(r,l[0],l[1]),!(o>=0&&Math.abs(r-o)>=.1)){b.next=9;break}return e.media.currentTime=o,b.abrupt("return");case 9:if(u=e._playlist.currentSegment,c=me.info(me.get(e.media),r,.1),!u){b.next=14;break}if(!(c.end&&Math.abs(c.end-u.end)<.2)){b.next=14;break}return b.abrupt("return");case 14:if(p=e._playlist.findSegmentIndexByTime(r),m=e._playlist.getSegmentByIndex(p),!(p==null||!m||e._segmentProcessing&&m===e._playlist.nextSegment)){b.next=18;break}return b.abrupt("return");case 18:return Ft.debug("seek to",r,m),e._playlist.setNextSegmentByIndex(p),e._stopTick(),b.next=23,e._segmentLoader.cancel();case 23:if(e._segmentProcessing=!1,!(!c.end||e.isLive)){b.next=27;break}return b.next=27,e._loadSegmentDirect();case 27:e._startTick();case 28:case"end":return b.stop()}},s)}))),k(Q(e),"_onTimeupdate",function(){if(e.media){var s=e.config;if(s.isLive&&s.maxLatency&&s.targetLatency&&e.media){var r=e._playlist.liveEdge;if(!r)return;var l=r-e.media.currentTime;l>=s.maxLatency&&(Ft.debug("latency jump, currentTime:".concat(e.media.currentTime,", liveEdge:").concat(r,",  latency=").concat(l)),e.media.currentTime=r-s.targetLatency)}if(s.seiInTime){var o;(o=e._seiService)===null||o===void 0||o.throw(e.media.currentTime)}e.config.allowedStreamTrackChange&&!e.config.softDecode&&e._checkStreamTrackChange(e.media.currentTime)}}),k(Q(e),"_tick",function(){if(e.media){e._startTick();var s=e.media,r=me.get(s),l=e._segmentLoader.error;if(l){var o=.5;(!s.readyState||e.bufferInfo(o).remaining<1)&&(l.fatal=!0,e._emitError(pe.network(l)));return}me.end(r)<.1||!s.readyState||($r(s)?(e._loadSegment(),e._gapService&&e._gapService.do(s,e.config.maxJumpDistance,e.isLive)):s.readyState<2&&e._gapService&&e._gapService.do(s,e.config.maxJumpDistance,s.currentTime?e.isLive:!0))}}),e.config=n=Ll(n),e.media=e.config.media,e._manifestLoader=new Yl(Q(e)),e._segmentLoader=new Il(Q(e)),e._playlist=new El(Q(e)),e._bufferService=new Sl(Q(e)),n.seiInTime&&(e._seiService=new na(Q(e))),n.softDecode||(e._gapService=new ta),e._stats=new ra(Q(e),9e4),e.media.addEventListener("play",e._onPlay),e.media.addEventListener("pause",e._onPause),e.media.addEventListener("seeking",e._onSeeking),e.media.addEventListener("timeupdate",e._onTimeupdate),e}return be(t,[{key:"isLive",get:function(){return this._playlist.isLive}},{key:"streams",get:function(){return this._playlist.streams}},{key:"currentStream",get:function(){return this._playlist.currentStream}},{key:"hasSubtitle",get:function(){return this._playlist.hasSubtitle}},{key:"baseDts",get:function(){var e;return(e=this._bufferService)===null||e===void 0?void 0:e.baseDts}},{key:"speedInfo",value:function(){return this._segmentLoader.speedInfo()}},{key:"bufferInfo",value:function(){var e,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.1;return me.info(me.get(this.media),(e=this.media)===null||e===void 0?void 0:e.currentTime,s)}},{key:"getStats",value:function(){return this._stats.getStats()}},{key:"playbackQuality",value:function(){return ea(this.media)}},{key:"load",value:function(){var n=se(A().mark(function s(r){var l,o=arguments;return A().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return l=o.length>1&&o[1]!==void 0?o[1]:!1,r&&(this.config.url=r),r=this.config.url,c.next=5,this._reset(l);case 5:return c.next=7,this._loadData(r);case 7:this._startTick();case 8:case"end":return c.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"_loadData",value:function(){var n=se(A().mark(function s(r){var l,o,u,c,p,m,f,b,v,g;return A().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:try{r&&(r=r.trim())}catch{}if(r){D.next=3;break}throw this._emitError(new pe(q.OTHER,q.SUB_TYPES.OPTION,null,null,"m3u8 url is missing"));case 3:return D.next=5,this._loadM3U8(r,this.config.manifest);case 5:if(l=D.sent,o=this._playlist.currentStream,!this._urlSwitching){D.next=17;break}if(o.bitrate===0&&(u=this._switchUrlOpts)!==null&&u!==void 0&&u.bitrate&&(o.bitrate=(c=this._switchUrlOpts)===null||c===void 0?void 0:c.bitrate),p=this._getSeamlessSwitchPoint(),this.config.startTime=p,m=this._playlist.findSegmentIndexByTime(p),f=this._playlist.getSegmentByIndex(m+1),!f){D.next=17;break}return b=f.start,D.next=17,this._bufferService.removeBuffer(b);case 17:if(!l){D.next=29;break}if(!this.isLive){D.next=25;break}this._bufferService.setLiveSeekableRange(0,4294967295),Ft.log("totalDuration first time got",this._playlist.totalDuration),this.config.targetLatency<this._playlist.totalDuration&&(this.config.targetLatency=this._playlist.totalDuration,this.config.maxLatency=1.5*this.config.targetLatency),l.isMaster||this._pollM3U8(r),D.next=29;break;case 25:return D.next=27,this._bufferService.updateDuration(o.totalDuration);case 27:v=this.config.startTime,v&&((g=this._switchUrlOpts)!==null&&g!==void 0&&g.seamless||(this.media.currentTime=v),this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(v)||0));case 29:return D.next=31,this._loadSegment();case 31:case"end":return D.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"replay",value:function(){var n=se(A().mark(function s(r){return A().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.config.startTime=0,o.next=3,this.load();case 3:return this._reloadOnPlay=!1,o.abrupt("return",this.media.play(!r));case 5:case"end":return o.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"switchURL",value:function(){var n=se(A().mark(function s(r){var l,o,u,c,p,m,f,b=arguments;return A().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:l=b.length>1&&b[1]!==void 0?b[1]:{},o={seamless:!1,startTime:0,bitrate:0},g.t0=gn(l),g.next=g.t0==="number"?5:g.t0==="boolean"?7:g.t0==="object"?9:11;break;case 5:return l={startTime:l},g.abrupt("break",12);case 7:return l={seamless:l},g.abrupt("break",12);case 9:for(u in l)(l[u]===void 0||l[u]===null)&&delete l[u];return g.abrupt("break",12);case 11:throw"unsupported switchURL args: ".concat(l);case 12:if(l=Object.assign({},o,l),c=l,p=c.seamless,m=c.startTime,this.config.url=r,this.config.startTime=m,this._switchUrlOpts=l,p){g.next=38;break}if(g.prev=18,!this.config.softDecode){g.next=23;break}g.t1=this.load(r),g.next=26;break;case 23:return g.next=25,this.load(r);case 25:g.t1=g.sent;case 26:f=g.t1,g.next=33;break;case 29:throw g.prev=29,g.t2=g.catch(18),this.emit($.SWITCH_URL_FAILED,g.t2),g.t2;case 33:return this._reloadOnPlay=!1,f&&this.emit($.SWITCH_URL_SUCCESS,{url:r}),g.abrupt("return",this.media.play(!0));case 38:return this._urlSwitching=!0,this._prevSegSn=null,this._prevSegCc=null,this._playlist.reset(),this._bufferService.seamlessSwitch(),g.next=45,this._clear();case 45:return g.next=47,this._loadData(r);case 47:this._startTick();case 48:this._switchUrlOpts=null;case 49:case"end":return g.stop()}},s,this,[[18,29]])}));function e(s){return n.apply(this,arguments)}return e}()},{key:"switchStream",value:function(){var n=se(A().mark(function s(r){var l,o,u,c,p,m=arguments;return A().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(l=m.length>1&&m[1]!==void 0?m[1]:!0,o=this.currentStream,u=this.streams,!(!o||o.id===r||!u||u.length<2)){b.next=5;break}return b.abrupt("return");case 5:if(c=u.find(function(v){return v.id===r}),c){b.next=8;break}return b.abrupt("return");case 8:return b.prev=8,b.next=11,this._clear();case 11:if(!l){b.next=14;break}return b.next=14,this._bufferService.clearAllBuffer();case 14:b.next=19;break;case 16:throw b.prev=16,b.t0=b.catch(8),this._emitError(pe.create(b.t0));case 19:if(o.currentAudioStream&&c.audioStreams.length>2&&(p=o.currentAudioStream.id,c.currentAudioStream=c.audioStreams.find(function(v){return v.id===p})||c.currentAudioStream),this._playlist.currentStream=c,b.prev=21,!(this.isLive||!c.segments.length)){b.next=25;break}return b.next=25,this._refreshM3U8();case 25:return this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(this.media.currentTime)||0),this._prevSegCc=null,b.next=29,this._loadSegmentDirect();case 29:b.next=35;break;case 31:throw b.prev=31,b.t1=b.catch(21),this._playlist.currentStream=o,b.t1;case 35:return this._startTick(),b.abrupt("return",c);case 37:case"end":return b.stop()}},s,this,[[8,16],[21,31]])}));function e(s){return n.apply(this,arguments)}return e}()},{key:"switchAudioStream",value:function(){var n=se(A().mark(function s(r){var l,o,u,c,p=arguments;return A().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(l=p.length>1&&p[1]!==void 0?p[1]:!0,o=this.currentStream,o){f.next=4;break}return f.abrupt("return");case 4:if(u=o.currentAudioStream,!(!u||u.id===r||o.audioStreams.length<2)){f.next=7;break}return f.abrupt("return");case 7:if(c=o.audioStreams.find(function(b){return b.id===r}),c){f.next=10;break}return f.abrupt("return");case 10:return f.prev=10,f.next=13,this._clear();case 13:if(!l){f.next=16;break}return f.next=16,this._bufferService.clearAllBuffer();case 16:f.next=21;break;case 18:throw f.prev=18,f.t0=f.catch(10),this._emitError(pe.create(f.t0));case 21:if(o.currentAudioStream=c,f.prev=22,!(this.isLive||!c.segments.length)){f.next=26;break}return f.next=26,this._refreshM3U8();case 26:return this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(this.media.currentTime)||0),this._prevSegCc=null,f.next=30,this._loadSegmentDirect();case 30:f.next=36;break;case 32:throw f.prev=32,f.t1=f.catch(22),o.currentAudioStream=u,f.t1;case 36:return this._startTick(),f.abrupt("return",c);case 38:case"end":return f.stop()}},s,this,[[10,18],[22,32]])}));function e(s){return n.apply(this,arguments)}return e}()},{key:"switchSubtitleStream",value:function(){var n=se(A().mark(function s(r){return A().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this._playlist.switchSubtitle(r),o.next=3,this._manifestLoader.stopPoll();case 3:return o.next=5,this._refreshM3U8();case 5:case"end":return o.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"destroy",value:function(){var n=se(A().mark(function s(){var r;return A().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.media){o.next=2;break}return o.abrupt("return");case 2:return this.removeAllListeners(),this._playlist.reset(),this._segmentLoader.reset(),(r=this._seiService)===null||r===void 0||r.reset(),this.media.removeEventListener("play",this._onPlay),this.media.removeEventListener("pause",this._onPause),this.media.removeEventListener("seeking",this._onSeeking),this.media.removeEventListener("timeupdate",this._onTimeupdate),o.next=12,Promise.all([this._clear(),this._bufferService.destroy()]);case 12:this.media=null;case 13:case"end":return o.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"_loadM3U8",value:function(){var n=se(A().mark(function s(r,l){var o,u,c,p;return A().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(f.prev=0,!l){f.next=5;break}f.t0=this._manifestLoader.parseText(l,r),f.next=8;break;case 5:return f.next=7,this._manifestLoader.load(r);case 7:f.t0=f.sent;case 8:u=f.t0,c=mt(u,1),o=c[0],f.next=16;break;case 13:throw f.prev=13,f.t1=f.catch(0),this._emitError(pe.create(f.t1));case 16:if(o){f.next=18;break}return f.abrupt("return");case 18:if(this._playlist.upsertPlaylist(o),!o.isMaster){f.next=23;break}return(p=this._playlist.currentStream.subtitleStreams)!==null&&p!==void 0&&p.length&&this.emit($.SUBTITLE_PLAYLIST,{list:this._playlist.currentStream.subtitleStreams}),f.next=23,this._refreshM3U8();case 23:return this.emit($.STREAM_PARSED),f.abrupt("return",o);case 25:case"end":return f.stop()}},s,this,[[0,13]])}));function e(s,r){return n.apply(this,arguments)}return e}()},{key:"_refreshM3U8",value:function(){var e,s,r=this,l=this._playlist.currentStream;if(!l||!l.url)throw this._emitError(pe.create(null,null,new Error("m3u8 url is not defined")));var o=l.url,u=(e=l.currentAudioStream)===null||e===void 0?void 0:e.url,c=(s=l.currentSubtitleStream)===null||s===void 0?void 0:s.url;return this._manifestLoader.load(o,u,c).then(function(p){var m=mt(p,3),f=m[0],b=m[1],v=m[2];f&&(r._playlist.upsertPlaylist(f,b,v),r.isLive&&r._pollM3U8(o,u,c))}).catch(function(p){throw r._emitError(pe.create(p))})}},{key:"_pollM3U8",value:function(e,s,r){var l=this,o,u=this._playlist.isEmpty;this._manifestLoader.poll(e,s,r,function(c,p,m){l._playlist.upsertPlaylist(c,p,m),l._playlist.clearOldSegment(),c&&u&&!l._playlist.isEmpty&&l._loadSegment(),u&&(u=l._playlist.isEmpty)},function(c){l._emitError(pe.create(c))},(((o=this._playlist.lastSegment)===null||o===void 0?void 0:o.duration)||0)*1e3)}},{key:"_loadSegmentDirect",value:function(){var n=se(A().mark(function s(){var r,l,o;return A().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(r=this._playlist.nextSegment,r){c.next=3;break}return c.abrupt("return");case 3:return l=!1,o=null,c.prev=5,this._segmentProcessing=!0,c.next=9,this._reqAndBufferSegment(r,this._playlist.getAudioSegment(r));case 9:l=c.sent,c.next=15;break;case 12:c.prev=12,c.t0=c.catch(5),o=c.t0;case 15:return c.prev=15,this._segmentProcessing=!1,c.finish(15);case 18:if(!o){c.next=20;break}return c.abrupt("return",this._emitError(pe.create(o)));case 20:return l&&(this._urlSwitching&&(this._urlSwitching=!1,this.emit($.SWITCH_URL_SUCCESS,{url:this.config.url})),this._playlist.moveSegmentPointer(),r.isLast?this._end():this._loadSegment()),c.abrupt("return",l);case 22:case"end":return c.stop()}},s,this,[[5,12,15,18]])}));function e(){return n.apply(this,arguments)}return e}()},{key:"_reqAndBufferSegment",value:function(){var n=se(A().mark(function s(r,l){var o,u,c,p,m,f,b,v,g;return A().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return u=r?r.cc:l.cc,c=this._prevSegCc!==u,p=[],D.prev=3,D.next=6,this._segmentLoader.load(r,l,c);case 6:p=D.sent,D.next=14;break;case 9:throw D.prev=9,D.t0=D.catch(3),D.t0.fatal=!1,this._segmentLoader.error=D.t0,D.t0;case 14:if(p[0]){D.next=16;break}return D.abrupt("return");case 16:return D.next=18,(o=this._bufferService).decryptBuffer.apply(o,ii(p));case 18:if(m=D.sent,m){D.next=21;break}return D.abrupt("return");case 21:return f=r?r.sn:l.sn,b=r?r.start:l.start,v=this._playlist.currentStream,this._bufferService.createSource(m[0],m[1],v==null?void 0:v.videoCodec,v==null?void 0:v.audioCodec),g=Date.now(),D.next=28,this._bufferService.appendBuffer(r,l,m[0],m[1],c,this._prevSegSn===f-1,b);case 28:return this.emit($.APPEND_COST,{elapsed:Date.now()-g,url:r.url}),D.next=31,this._bufferService.evictBuffer(this.config.bufferBehind);case 31:return this._prevSegCc=u,this._prevSegSn=f,D.abrupt("return",!0);case 34:case"end":return D.stop()}},s,this,[[3,9]])}));function e(s,r){return n.apply(this,arguments)}return e}()},{key:"_checkStreamTrackChange",value:function(e){var s=this._playlist.checkSegmentTrackChange(e,this._bufferService.nbSb);s&&this.switchURL(this.config.url,s.start+.2)}},{key:"_clear",value:function(){var n=se(A().mark(function s(){return A().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return clearTimeout(this._disconnectTimer),this._stopTick(),l.next=4,Promise.all([this._segmentLoader.cancel(),this._manifestLoader.stopPoll()]);case 4:this._segmentProcessing=!1;case 5:case"end":return l.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"_reset",value:function(){var n=se(A().mark(function s(){var r,l,o=arguments;return A().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return l=o.length>0&&o[0]!==void 0?o[0]:!1,this._reloadOnPlay=!1,this._prevSegSn=null,this._prevSegCc=null,this._switchUrlOpts=null,this._playlist.reset(),this._segmentLoader.reset(),(r=this._seiService)===null||r===void 0||r.reset(),this._stats.reset(),c.next=11,this._clear();case 11:return c.abrupt("return",this._bufferService.reset(l));case 12:case"end":return c.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"_end",value:function(){this._clear(),this._bufferService.endOfStream(),this.media.readyState<=2&&this._startTick()}},{key:"_stopTick",value:function(){this._tickTimer&&clearTimeout(this._tickTimer),this._tickTimer=null}},{key:"_startTick",value:function(){this._stopTick(),this._tickTimer=setTimeout(this._tick,this._tickInterval)}},{key:"_emitError",value:function(e){var s,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(((s=e.originError)===null||s===void 0?void 0:s.fatal)===!1)Ft.warn(e);else{var l,o,u;Ft.table(e),Ft.error(e),Ft.error((l=this.media)===null||l===void 0?void 0:l.error),(o=this.media)!==null&&o!==void 0&&o.readyState&&this.media.pause(),this._stopTick(),this._urlSwitching&&(this._urlSwitching=!1,this.emit($.SWITCH_URL_FAILED,e)),this.emit($.ERROR,e),r&&this._end(),(u=this._seiService)===null||u===void 0||u.reset()}return e}},{key:"_getSeamlessSwitchPoint",value:function(){var e=this.media,s=e.currentTime;if(!e.paused){var r,l=this._playlist.findSegmentIndexByTime(e.currentTime),o=this._playlist.getSegmentByIndex(l),u=(r=this._stats)===null||r===void 0?void 0:r.getStats().downloadSpeed;if(u&&o){var c=o.duration*this._playlist.currentStream.bitrate/u+1;s+=c}else s+=5}return s}}],[{key:"isSupported",value:function(e){return!e||e==="video"||e==="audio"?he.isSupported():typeof WebAssembly<"u"}},{key:"enableLogger",value:function(){xe.enable(),Vt.enable()}},{key:"disableLogger",value:function(){xe.disable(),Vt.disable()}}]),t}(Dt);k(Nt,"version","3.0.7");try{localStorage.getItem("xgd")?Nt.enableLogger():Nt.disableLogger()}catch{}var _l=function(){function a(i,t){var n=this;ye(this,a),k(this,"_opts",null),k(this,"_plugin",null),k(this,"_onLowDecode",function(){var e,s,r,l,o=n._opts,u=o.media,c=o.innerDegrade;(e=n._plugin)===null||e===void 0||(s=e.player)===null||s===void 0||s.emit("lowdecode",u.degradeInfo),(r=n._plugin)===null||r===void 0||(l=r.player)===null||l===void 0||l.emit("core_event",ie(ie({},u.degradeInfo),{},{eventName:$.LOWDECODE})),c===1&&n._degrade(u.src)}),k(this,"_degrade",function(e){var s=n._plugin.player,r=s.video;if(!(r&&r.TAG!=="MVideo")){var l=s.video.degradeVideo;s.video=l,r.degrade(e),e&&(s.config.url=e);var o=s.root.firstChild;o.TAG==="MVideo"&&s.root.replaceChild(l,o);var u=n._plugin.constructor.pluginName.toLowerCase();s.unRegisterPlugin(u),s.once("canplay",function(){s.play()})}}),k(this,"forceDegradeToVideo",function(e){var s=n._opts.innerDegrade;s===1&&n._degrade(e)}),this._opts=i,this._plugin=t,this._init()}return be(a,[{key:"_init",value:function(){var t=this._opts,n=t.media,e=t.preloadTime,s=t.innerDegrade,r=t.isLive;if(n){if(!r&&n.setPlayMode){n.setPlayMode("VOD");return}s&&n.setAttribute("innerdegrade",s),e&&n.setAttribute("preloadtime",e),this._bindEvents()}}},{key:"_bindEvents",value:function(){var t=this._opts.media;t.addEventListener("lowdecode",this._onLowDecode)}},{key:"destroy",value:function(){var t,n;(t=this._opts)===null||t===void 0||(n=t.media)===null||n===void 0||n.removeEventListener("lowdecode",this._onLowDecode),this._plugin=null}}]),a}();function Pl(a,i){var t=i.player,n=t.currentTime,e={startTime:n};switch(gn(a)){case"boolean":e.seamless=a;break;case"object":Object.assign(e,a);break}return e}var Dn=function(a){Tn(t,a);var i=kn(t);function t(){var n;ye(this,t);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=i.call.apply(i,[this].concat(s)),k(Q(n),"hls",null),k(Q(n),"pluginExtension",null),k(Q(n),"getStats",function(){var l;return(l=n.hls)===null||l===void 0?void 0:l.getStats()}),k(Q(n),"_onSwitchSubtitle",function(l){var o,u=l.lang;(o=n.hls)===null||o===void 0||o.switchSubtitleStream(u)}),k(Q(n),"_onSwitchURL",function(l,o){var u=Q(n),c=u.player,p=u.hls;if(p){var m,f,b=Pl(o,Q(n));c.config.url=l,p.switchURL(l,b).catch(function(v){}),!b.seamless&&(m=n.player.config)!==null&&m!==void 0&&(f=m.hls)!==null&&f!==void 0&&f.keepStatusAfterSwitch&&n._keepPauseStatus()}}),k(Q(n),"_keepPauseStatus",function(){var l=n.player.paused;l&&n.player.once("canplay",function(){n.player.pause()})}),n}return be(t,[{key:"core",get:function(){return this.hls}},{key:"version",get:function(){var e;return(e=this.hls)===null||e===void 0?void 0:e.version}},{key:"softDecode",get:function(){var e,s,r=(e=this.player)===null||e===void 0||(s=e.config)===null||s===void 0?void 0:s.mediaType;return!!r&&r!=="video"&&r!=="audio"}},{key:"beforePlayerInit",value:function(){var e=this,s=this.player.config;if(!(!s.url&&!s.__allowHlsEmptyUrl__)){this.hls&&this.hls.destroy(),this.player.switchURL=this._onSwitchURL;var r=s.hls||{};if(r.innerDegrade=r.innerDegrade||s.innerDegrade,(r.disconnectTime===null||r.disconnectTime===void 0)&&(r.disconnectTime=0),this.hls=new Nt(ie({softDecode:this.softDecode,isLive:s.isLive,media:this.player.media||this.player.video,startTime:s.startTime,url:s.url},r)),this.softDecode||kt.defineGetterOrSetter(this.player,{url:{get:function(){var u,c;return(u=e.hls)===null||u===void 0||(c=u.media)===null||c===void 0?void 0:c.src},configurable:!0}}),this.softDecode&&(this.pluginExtension=new _l(ie({isLive:s.isLive,media:this.player.video},r),this),this.player.forceDegradeToVideo=function(){for(var o,u=arguments.length,c=new Array(u),p=0;p<u;p++)c[p]=arguments[p];return(o=e.pluginExtension)===null||o===void 0?void 0:o.forceDegradeToVideo.apply(o,c)}),s.isLive){var l;(l=this.player)===null||l===void 0||l.useHooks("replay",function(){var o;return(o=e.hls)===null||o===void 0?void 0:o.replay()})}this.on(Na,this._onSwitchSubtitle),this.on(Bt,this._onSwitchURL),this.on(Mr,this.destroy.bind(this)),this._transError(),this._transCoreEvent(M.TTFB),this._transCoreEvent(M.LOAD_START),this._transCoreEvent(M.LOAD_RESPONSE_HEADERS),this._transCoreEvent(M.LOAD_COMPLETE),this._transCoreEvent(M.LOAD_RETRY),this._transCoreEvent(M.SOURCEBUFFER_CREATED),this._transCoreEvent(M.REMOVE_BUFFER),this._transCoreEvent(M.BUFFEREOS),this._transCoreEvent(M.KEYFRAME),this._transCoreEvent(M.METADATA_PARSED),this._transCoreEvent(M.DEMUXED_TRACK),this._transCoreEvent(M.SEI),this._transCoreEvent(M.SEI_IN_TIME),this._transCoreEvent(M.SPEED),this._transCoreEvent(M.HLS_MANIFEST_LOADED),this._transCoreEvent(M.HLS_LEVEL_LOADED),this._transCoreEvent(M.STREAM_EXCEPTION),this._transCoreEvent(M.SWITCH_URL_SUCCESS),this._transCoreEvent(M.SWITCH_URL_FAILED),this._transCoreEvent($.NO_AUDIO_TRACK),this._transCoreEvent($.STREAM_PARSED),this._transCoreEvent($.SUBTITLE_SEGMENTS),this._transCoreEvent($.SUBTITLE_PLAYLIST),this._transCoreEvent($.APPEND_COST),s.url&&this.hls.load(s.url,!0).catch(function(o){})}}},{key:"destroy",value:function(){var e;this.hls&&(this.hls.destroy(),this.hls=null),(e=this.pluginExtension)===null||e===void 0||e.destroy(),this.pluginExtension=null}},{key:"_transError",value:function(){var e=this;this.hls.on($.ERROR,function(s){e.player&&e.player.emit(Yr,new It(e.player,s))})}},{key:"_transCoreEvent",value:function(e){var s=this;this.hls.on(e,function(r){s.player&&(s.player.emit("core_event",ie(ie({},r),{},{eventName:e})),e===M.SEI_IN_TIME&&s.hls.hasSubtitle&&s._emitSeiPaylodTime(r))})}},{key:"_emitSeiPaylodTime",value:function(e){try{var s=JSON.parse(Array.from(e.data.payload).map(function(r){return String.fromCharCode(r)}).join("").slice(0,-1));if(!s.rtmp_dts)return;this.player.emit("core_event",{eventName:$.SEI_PAYLOAD_TIME,time:s.rtmp_dts})}catch{}}}],[{key:"pluginName",get:function(){return"hls"}},{key:"isSupported",value:function(e,s){return Nt.isSupported(e,s)}}]),t}(kt);k(Dn,"Hls",Nt);k(Dn,"EVENT",$);function yr(a,i){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);i&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),t.push.apply(t,n)}return t}function Re(a){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?arguments[i]:{};i%2?yr(Object(t),!0).forEach(function(n){O(a,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):yr(Object(t)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(t,n))})}return a}function ne(){ne=function(){return a};var a={},i=Object.prototype,t=i.hasOwnProperty,n=Object.defineProperty||function(h,d,y){h[d]=y.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(h,d,y){return Object.defineProperty(h,d,{value:y,enumerable:!0,configurable:!0,writable:!0}),h[d]}try{o({},"")}catch{o=function(d,y,L){return d[y]=L}}function u(h,d,y,L){var Z=d&&d.prototype instanceof m?d:m,W=Object.create(Z.prototype),R=new I(L||[]);return n(W,"_invoke",{value:S(h,y,R)}),W}function c(h,d,y){try{return{type:"normal",arg:h.call(d,y)}}catch(L){return{type:"throw",arg:L}}}a.wrap=u;var p={};function m(){}function f(){}function b(){}var v={};o(v,s,function(){return this});var g=Object.getPrototypeOf,X=g&&g(g(E([])));X&&X!==i&&t.call(X,s)&&(v=X);var D=b.prototype=m.prototype=Object.create(v);function F(h){["next","throw","return"].forEach(function(d){o(h,d,function(y){return this._invoke(d,y)})})}function w(h,d){function y(Z,W,R,_){var K=c(h[Z],h,W);if(K.type!=="throw"){var Y=K.arg,J=Y.value;return J&&typeof J=="object"&&t.call(J,"__await")?d.resolve(J.__await).then(function(P){y("next",P,R,_)},function(P){y("throw",P,R,_)}):d.resolve(J).then(function(P){Y.value=P,R(Y)},function(P){return y("throw",P,R,_)})}_(K.arg)}var L;n(this,"_invoke",{value:function(Z,W){function R(){return new d(function(_,K){y(Z,W,_,K)})}return L=L?L.then(R,R):R()}})}function S(h,d,y){var L="suspendedStart";return function(Z,W){if(L==="executing")throw new Error("Generator is already running");if(L==="completed"){if(Z==="throw")throw W;return U()}for(y.method=Z,y.arg=W;;){var R=y.delegate;if(R){var _=G(R,y);if(_){if(_===p)continue;return _}}if(y.method==="next")y.sent=y._sent=y.arg;else if(y.method==="throw"){if(L==="suspendedStart")throw L="completed",y.arg;y.dispatchException(y.arg)}else y.method==="return"&&y.abrupt("return",y.arg);L="executing";var K=c(h,d,y);if(K.type==="normal"){if(L=y.done?"completed":"suspendedYield",K.arg===p)continue;return{value:K.arg,done:y.done}}K.type==="throw"&&(L="completed",y.method="throw",y.arg=K.arg)}}}function G(h,d){var y=d.method,L=h.iterator[y];if(L===void 0)return d.delegate=null,y==="throw"&&h.iterator.return&&(d.method="return",d.arg=void 0,G(h,d),d.method==="throw")||y!=="return"&&(d.method="throw",d.arg=new TypeError("The iterator does not provide a '"+y+"' method")),p;var Z=c(L,h.iterator,d.arg);if(Z.type==="throw")return d.method="throw",d.arg=Z.arg,d.delegate=null,p;var W=Z.arg;return W?W.done?(d[h.resultName]=W.value,d.next=h.nextLoc,d.method!=="return"&&(d.method="next",d.arg=void 0),d.delegate=null,p):W:(d.method="throw",d.arg=new TypeError("iterator result is not an object"),d.delegate=null,p)}function T(h){var d={tryLoc:h[0]};1 in h&&(d.catchLoc=h[1]),2 in h&&(d.finallyLoc=h[2],d.afterLoc=h[3]),this.tryEntries.push(d)}function C(h){var d=h.completion||{};d.type="normal",delete d.arg,h.completion=d}function I(h){this.tryEntries=[{tryLoc:"root"}],h.forEach(T,this),this.reset(!0)}function E(h){if(h){var d=h[s];if(d)return d.call(h);if(typeof h.next=="function")return h;if(!isNaN(h.length)){var y=-1,L=function Z(){for(;++y<h.length;)if(t.call(h,y))return Z.value=h[y],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return L.next=L}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=b,n(D,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:f,configurable:!0}),f.displayName=o(b,l,"GeneratorFunction"),a.isGeneratorFunction=function(h){var d=typeof h=="function"&&h.constructor;return!!d&&(d===f||(d.displayName||d.name)==="GeneratorFunction")},a.mark=function(h){return Object.setPrototypeOf?Object.setPrototypeOf(h,b):(h.__proto__=b,o(h,l,"GeneratorFunction")),h.prototype=Object.create(D),h},a.awrap=function(h){return{__await:h}},F(w.prototype),o(w.prototype,r,function(){return this}),a.AsyncIterator=w,a.async=function(h,d,y,L,Z){Z===void 0&&(Z=Promise);var W=new w(u(h,d,y,L),Z);return a.isGeneratorFunction(d)?W:W.next().then(function(R){return R.done?R.value:W.next()})},F(D),o(D,l,"Generator"),o(D,s,function(){return this}),o(D,"toString",function(){return"[object Generator]"}),a.keys=function(h){var d=Object(h),y=[];for(var L in d)y.push(L);return y.reverse(),function Z(){for(;y.length;){var W=y.pop();if(W in d)return Z.value=W,Z.done=!1,Z}return Z.done=!0,Z}},a.values=E,I.prototype={constructor:I,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!h)for(var d in this)d.charAt(0)==="t"&&t.call(this,d)&&!isNaN(+d.slice(1))&&(this[d]=void 0)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var d=this;function y(K,Y){return W.type="throw",W.arg=h,d.next=K,Y&&(d.method="next",d.arg=void 0),!!Y}for(var L=this.tryEntries.length-1;L>=0;--L){var Z=this.tryEntries[L],W=Z.completion;if(Z.tryLoc==="root")return y("end");if(Z.tryLoc<=this.prev){var R=t.call(Z,"catchLoc"),_=t.call(Z,"finallyLoc");if(R&&_){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}else if(R){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0)}else{if(!_)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}}}},abrupt:function(h,d){for(var y=this.tryEntries.length-1;y>=0;--y){var L=this.tryEntries[y];if(L.tryLoc<=this.prev&&t.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var Z=L;break}}Z&&(h==="break"||h==="continue")&&Z.tryLoc<=d&&d<=Z.finallyLoc&&(Z=null);var W=Z?Z.completion:{};return W.type=h,W.arg=d,Z?(this.method="next",this.next=Z.finallyLoc,p):this.complete(W)},complete:function(h,d){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&d&&(this.next=d),p},finish:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.finallyLoc===h)return this.complete(y.completion,y.afterLoc),C(y),p}},catch:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.tryLoc===h){var L=y.completion;if(L.type==="throw"){var Z=L.arg;C(y)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(h,d,y){return this.delegate={iterator:E(h),resultName:d,nextLoc:y},this.method==="next"&&(this.arg=void 0),p}},a}function br(a,i,t,n,e,s,r){try{var l=a[s](r),o=l.value}catch(u){t(u);return}l.done?i(o):Promise.resolve(o).then(n,e)}function Te(a){return function(){var i=this,t=arguments;return new Promise(function(n,e){var s=a.apply(i,t);function r(o){br(s,n,e,r,l,"next",o)}function l(o){br(s,n,e,r,l,"throw",o)}r(void 0)})}}function En(a,i){if(!(a instanceof i))throw new TypeError("Cannot call a class as a function")}function vr(a,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,Va(n.key),n)}}function In(a,i,t){return i&&vr(a.prototype,i),t&&vr(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function O(a,i,t){return i=Va(i),i in a?Object.defineProperty(a,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[i]=t,a}function ka(a,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(i&&i.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),i&&Zs(a,i)}function wn(a){return wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wn(a)}function Zs(a,i){return Zs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},Zs(a,i)}function Kl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ee(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Hl(a,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ee(a)}function Ra(a){var i=Kl();return function(){var n=wn(a),e;if(i){var s=wn(this).constructor;e=Reflect.construct(n,arguments,s)}else e=n.apply(this,arguments);return Hl(this,e)}}function Nl(a,i){if(typeof a!="object"||a===null)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var n=t.call(a,i||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(a)}function Va(a){var i=Nl(a,"string");return typeof i=="symbol"?i:String(i)}var ct=new xe("BufferService"),Al=function(){function a(i,t,n){En(this,a),O(this,"flv",null),O(this,"_demuxer",new ma),O(this,"_remuxer",null),O(this,"_mse",null),O(this,"_softVideo",null),O(this,"_sourceCreated",!1),O(this,"_needInitSegment",!0),O(this,"_discontinuity",!0),O(this,"_contiguous",!1),O(this,"_initSegmentId",""),O(this,"_cachedBuffer",null),O(this,"_demuxStartTime",0),O(this,"_opts",null),this.flv=i,this._opts=n,t?this._softVideo=t:(this._remuxer=new Cs(this._demuxer.videoTrack,this._demuxer.audioTrack),this._mse=new he,this._mse.bindMedia(i.media))}return In(a,[{key:"baseDts",get:function(){var t,n;return(t=this._demuxer)===null||t===void 0||(n=t._fixer)===null||n===void 0?void 0:n._baseDts}},{key:"seamlessSwitch",value:function(){this._needInitSegment=!0,this._discontinuity=!0,this._contiguous=!0,this._initSegmentId=""}},{key:"unContiguous",value:function(t){this._contiguous=!1,this._demuxStartTime=t}},{key:"reset",value:function(){var i=Te(ne().mark(function n(){var e,s=arguments;return ne().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(e=s.length>0&&s[0]!==void 0?s[0]:!1,!(this._mse&&!e)){l.next=6;break}return l.next=4,this._mse.unbindMedia();case 4:return l.next=6,this._mse.bindMedia(this.flv.media);case 6:this._needInitSegment=!0,this._discontinuity=!0,this._contiguous=!1,this._sourceCreated=!1,this._initSegmentId="";case 11:case"end":return l.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"endOfStream",value:function(){var i=Te(ne().mark(function n(){return ne().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._mse){s.next=7;break}if(!this._sourceCreated){s.next=5;break}return s.next=4,this._mse.endOfStream();case 4:this.flv.emit(M.BUFFEREOS);case 5:s.next=8;break;case 7:this._softVideo&&this._softVideo.endOfStream();case 8:case"end":return s.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"updateDuration",value:function(){var i=Te(ne().mark(function n(e){return ne().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!this._mse){r.next=7;break}if(this._mse.isOpened){r.next=4;break}return r.next=4,this._mse.open();case 4:return ct.debug("update duration",e),r.next=7,this._mse.updateDuration(e);case 7:case"end":return r.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var i=Te(ne().mark(function n(){return ne().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._mse){s.next=3;break}return s.next=3,this._mse.unbindMedia();case 3:this._mse=null,this._softVideo=null,this._demuxer=null,this._remuxer=null;case 7:case"end":return s.stop()}},n,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"appendBuffer",value:function(){var i=Te(ne().mark(function n(e){var s,r,l,o,u,c,p,m,f,b,v,g,X,D;return ne().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this._cachedBuffer&&(e=Tt(this._cachedBuffer,e),this._cachedBuffer=null),s=this._demuxer,!(!e||!e.length||!s)){w.next=4;break}return w.abrupt("return");case 4:w.prev=4,s.demuxAndFix(e,this._discontinuity,this._contiguous,this._demuxStartTime),w.next=11;break;case 8:throw w.prev=8,w.t0=w.catch(4),new pe(q.DEMUX,q.SUB_TYPES.FLV,w.t0);case 11:if(r=s.videoTrack,l=s.audioTrack,o=s.metadataTrack,u=r.exist(),c=l.exist(),this._opts.onlyAudio&&(u=!1,r.present=!1),this._opts.onlyVideo&&(c=!1,l.present=!1),!(!u&&r.present||!c&&l.present)){w.next=29;break}if(p=0,m=u?r:c?l:void 0,m&&m.samples.length&&(p=(m.samples[m.samples.length-1].originPts-m.samples[0].originPts)/m.timescale*1e3),!(p>this._opts.analyzeDuration)){w.next=27;break}ct.warn("analyze duration exceeded, ".concat(p,"ms"),m),r.present=u,l.present=c,this.flv.emit(M.ANALYZE_DURATION_EXCEEDED,{duration:p}),w.next=29;break;case 27:return this._cachedBuffer=e,w.abrupt("return");case 29:if(f=r.type,b=l.type,this._fireEvents(r,l,o),this._discontinuity=!1,this._contiguous=!0,this._demuxStartTime=0,v=this._mse,this.flv.emit(M.DEMUXED_TRACK,{videoTrack:r}),g="".concat(r.codec,"/").concat(r.width,"/").concat(r.height,"/").concat(l.codec,"/").concat(l.config),g!==this._initSegmentId&&(this._needInitSegment=!0,this._initSegmentId=g,this._emitMetaParsedEvent(r,l)),!v){w.next=65;break}if(this._sourceCreated){w.next=47;break}return w.next=43,v.open();case 43:u&&(ct.log("codec: video/mp4;codecs=".concat(r.codec)),v.createSource(f,"video/mp4;codecs=".concat(r.codec))),c&&(ct.log("codec: audio/mp4;codecs=".concat(l.codec)),v.createSource(b,"audio/mp4;codecs=".concat(l.codec))),this._sourceCreated=!0,this.flv.emit(M.SOURCEBUFFER_CREATED);case 47:w.prev=47,X=this._remuxer.remux(this._needInitSegment),w.next=54;break;case 51:throw w.prev=51,w.t1=w.catch(47),new pe(q.REMUX,q.SUB_TYPES.FMP4,w.t1);case 54:if(!(this._needInitSegment&&!X.videoInitSegment&&!X.audioInitSegment)){w.next=56;break}return w.abrupt("return");case 56:return this._needInitSegment=!1,D=[],X.videoInitSegment&&D.push(v.append(f,X.videoInitSegment)),X.audioInitSegment&&D.push(v.append(b,X.audioInitSegment)),X.videoSegment&&D.push(v.append(f,X.videoSegment)),X.audioSegment&&D.push(v.append(b,X.audioSegment)),w.abrupt("return",Promise.all(D));case 65:this._softVideo&&this._softVideo.appendBuffer(r,l);case 66:case"end":return w.stop()}},n,this,[[4,8],[47,51]])}));function t(n){return i.apply(this,arguments)}return t}()},{key:"evictBuffer",value:function(){var i=Te(ne().mark(function n(e){var s=this,r,l,o,u;return ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(r=this.flv.media,!(!this._mse||!this._demuxer||!r||!e||e<0)){p.next=3;break}return p.abrupt("return");case 3:if(l=r.currentTime,o=l-e,!(o<=0)){p.next=7;break}return p.abrupt("return");case 7:if(u=me.start(me.get(r)),!(u+1>=o)){p.next=10;break}return p.abrupt("return");case 10:return p.abrupt("return",this._mse.clearBuffer(0,o).then(function(){return s.flv.emit(M.REMOVE_BUFFER,{removeEnd:o})}));case 11:case"end":return p.stop()}},n,this)}));function t(n){return i.apply(this,arguments)}return t}()},{key:"_emitMetaParsedEvent",value:function(t,n){t.exist()&&this.flv.emit(M.METADATA_PARSED,{type:"video",track:t,meta:{codec:t.codec,timescale:t.timescale,width:t.width,height:t.height,sarRatio:t.sarRatio,baseDts:t.baseDts}}),n.exist()&&this.flv.emit(M.METADATA_PARSED,{type:"audio",track:n,meta:{codec:n.codec,channelCount:n.channelCount,sampleRate:n.sampleRate,timescale:n.timescale,baseDts:n.baseDts}}),ct.debug("track parsed",t,n)}},{key:"_fireEvents",value:function(t,n,e){var s=this;ct.debug(t.samples,n.samples),e.flvScriptSamples.forEach(function(r){s.flv.emit(M.FLV_SCRIPT_DATA,r),ct.debug("flvScriptData",r)}),t.samples.forEach(function(r){r.keyframe&&s.flv.emit(M.KEYFRAME,{pts:r.pts})}),t.warnings.forEach(function(r){var l;switch(r.type){case de.LARGE_AV_SHIFT:l=M.LARGE_AV_FIRST_FRAME_GAP_DETECT;break;case de.LARGE_VIDEO_GAP:l=M.LARGE_VIDEO_DTS_GAP_DETECT;break;case de.LARGE_VIDEO_GAP_BETWEEN_CHUNK:l=M.MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT;break}l&&s.flv.emit(M.STREAM_EXCEPTION,Re(Re({},r),{},{type:l})),ct.warn("video exception",r)}),n.warnings.forEach(function(r){var l;switch(r.type){case de.LARGE_AUDIO_GAP:l=M.LARGE_AUDIO_DTS_GAP_DETECT;break;case de.AUDIO_FILLED:l=M.AUDIO_GAP_DETECT;break;case de.AUDIO_DROPPED:l=M.AUDIO_OVERLAP_DETECT;break}l&&s.flv.emit(M.STREAM_EXCEPTION,Re(Re({},r),{},{type:l})),ct.warn("audio exception",r)}),e.seiSamples.forEach(function(r){s.flv.emit(M.SEI,Re(Re({},r),{},{sei:{code:r.data.type,content:r.data.payload,dts:r.pts}}))})}}]),a}();function Ul(a){var i=Re({retryCount:3,retryDelay:1e3,loadTimeout:1e4,maxReaderInterval:5e3,preloadTime:5,isLive:!1,softDecode:!1,bufferBehind:10,maxJumpDistance:3,analyzeDuration:2e4,seamlesslyReload:!1,keepStatusAfterSwitch:!0,onlyVideo:!1,onlyAudio:!1},a);return i.isLive&&i.preloadTime&&(i.maxLatency||(i.maxLatency=i.preloadTime*2),i.targetLatency||(i.targetLatency=i.preloadTime),(i.disconnectTime===null||i.disconnectTime===void 0)&&(i.disconnectTime=i.maxLatency)),i}function zl(a,i){var t=0,n=a.length-1,e=0,s=0,r=n;for(i<a[0]&&(t=0,s=r+1);s<=r;)if(e=s+Math.floor((r-s)/2),e===n||i>=a[e]&&i<a[e+1]){t=e;break}else a[e]<i?s=e+1:r=e-1;return t}var pt=new xe("flv"),rn=function(a){ka(t,a);var i=Ra(t);function t(n){var e;return En(this,t),e=i.call(this),O(ee(e),"media",null),O(ee(e),"_loading",!1),O(ee(e),"_opts",null),O(ee(e),"_bufferService",null),O(ee(e),"_gapService",null),O(ee(e),"_stats",null),O(ee(e),"_mediaLoader",null),O(ee(e),"_maxChunkWaitTimer",null),O(ee(e),"_tickTimer",null),O(ee(e),"_tickInterval",500),O(ee(e),"_urlSwitching",!1),O(ee(e),"_seamlessSwitching",!1),O(ee(e),"_keyframes",null),O(ee(e),"_acceptRanges",!0),O(ee(e),"_onProgress",function(){var s=Te(ne().mark(function r(l,o,u,c){var p,m,f,b,v,g,X,D;return ne().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(p=u.startTime,m=u.endTime,f=u.st,b=u.firstByteTime,e._loading=!o,e._firstProgressEmit){w.next=11;break}if(e.media){w.next=6;break}return(v=e._mediaLoader)===null||v===void 0||v.cancel(),w.abrupt("return");case 6:g=c.headers,e.emit(M.TTFB,{url:e._opts.url,responseUrl:c.url,elapsed:f?b-f:m-p}),e.emit(M.LOAD_RESPONSE_HEADERS,{headers:g}),e._acceptRanges=!!(g!=null&&g.get("Accept-Ranges"))||!!(g!=null&&g.get("Content-Range")),e._firstProgressEmit=!0;case 11:if(e._bufferService){w.next=13;break}return w.abrupt("return");case 13:return clearTimeout(e._maxChunkWaitTimer),e._bandwidthService.addChunkRecord(l==null?void 0:l.byteLength,m-p),w.prev=15,w.next=18,e._bufferService.appendBuffer(l);case 18:(X=e._bufferService)===null||X===void 0||X.evictBuffer(e._opts.bufferBehind),w.next=24;break;case 21:return w.prev=21,w.t0=w.catch(15),w.abrupt("return",e._emitError(pe.create(w.t0)));case 24:if(e._urlSwitching&&(e._urlSwitching=!1,e.emit(M.SWITCH_URL_SUCCESS,{url:e._opts.url})),e._seamlessSwitching&&(e._seamlessSwitching=!1,e._tick()),!(o&&!e.media.seeking)){w.next=32;break}return e.emit(M.LOAD_COMPLETE),pt.debug("load done"),w.abrupt("return",e._end());case 32:D=e._opts.maxReaderInterval,D&&(clearTimeout(e._maxChunkWaitTimer),e._maxChunkWaitTimer=setTimeout(function(){pt.debug("onMaxChunkWait",D),e._end()},D));case 34:case"end":return w.stop()}},r,null,[[15,21]])}));return function(r,l,o,u){return s.apply(this,arguments)}}()),O(ee(e),"_onRetryError",function(s,r){pt.debug("load retry",s,r),e.emit(M.LOAD_RETRY,{error:pe.network(s),retryTime:r})}),O(ee(e),"_end",function(){e._clear(),e._bufferService&&e._bufferService.endOfStream(),pt.debug("end stream")}),O(ee(e),"_tick",function(){clearTimeout(e._tickTimer);var s=ee(e),r=s.media;if(r){e._tickTimer=setTimeout(e._tick,e._tickInterval);var l=me.end(me.get(r));if(!(l<.1||!r.readyState)){var o=e._opts;if($r(r))e._gapService&&e._gapService.do(r,o.maxJumpDistance,e.isLive,3);else{if(!r.currentTime&&e._gapService){e._gapService.do(r,o.maxJumpDistance,e.isLive,3);return}o.isLive&&l>o.disconnectTime&&e.disconnect()}}}}),O(ee(e),"_onPlay",function(){var s,r,l=e._opts.softDecode||((s=e.media)===null||s===void 0||(r=s.buffered)===null||r===void 0?void 0:r.length);e.isLive&&!e._loading&&l&&e.replay(void 0,!0)}),O(ee(e),"_onSeeking",Te(ne().mark(function s(){var r,l,o,u,c;return ne().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(!e.isLive&&e.seekable)){m.next=14;break}if(r=e._keyframes.times,l=e._keyframes.filepositions,!(!(r!=null&&r.length)||!(l!=null&&l.length))){m.next=5;break}return m.abrupt("return");case 5:if(o=e.media.currentTime,u=zl(e._keyframes.times,o),c=l[u],c!=null){m.next=10;break}return m.abrupt("return");case 10:return m.next=12,e._mediaLoader.cancel();case 12:e._loadData(null,[c]),e._bufferService.unContiguous(r[u]);case 14:case"end":return m.stop()}},s)}))),O(ee(e),"_onTimeupdate",function(){if(e.media){var s=e._opts,r=e.media.currentTime;if(s.isLive&&s.maxLatency&&s.targetLatency){var l=me.end(me.get(e.media)),o=l-r;o>=s.maxLatency&&(e.media.currentTime=l-s.targetLatency)}e._seiService.throw(r)}}),O(ee(e),"_onFlvScriptData",function(s){var r,l,o,u,c=(r=s.data)===null||r===void 0||(l=r.onMetaData)===null||l===void 0?void 0:l.keyframes,p=(o=s.data)===null||o===void 0||(u=o.onMetaData)===null||u===void 0?void 0:u.duration;c&&(e._keyframes=c),!e._opts.isLive&&p&&e._bufferService.updateDuration(p)}),e._opts=Ul(n),e.media=e._opts.media||document.createElement("video"),e._opts.media=null,e._firstProgressEmit=!1,e._mediaLoader=new St(Re(Re({},e._opts.fetchOptions),{},{retry:e._opts.retryCount,retryDelay:e._opts.retryDelay,timeout:e._opts.loadTimeout,onRetryError:e._onRetryError,onProgress:e._onProgress,responseType:"arraybuffer"})),e._bufferService=new Al(ee(e),e._opts.softDecode?e.media:void 0,e._opts),e._seiService=new na(ee(e)),e._bandwidthService=new sa,e._stats=new ra(ee(e)),e._opts.softDecode||(e._gapService=new ta),e.media.addEventListener("play",e._onPlay),e.media.addEventListener("seeking",e._onSeeking),e.media.addEventListener("timeupdate",e._onTimeupdate),e.on(M.FLV_SCRIPT_DATA,e._onFlvScriptData),e}return In(t,[{key:"version",get:function(){return"3.0.7"}},{key:"isLive",get:function(){return this._opts.isLive}},{key:"baseDts",get:function(){var e;return(e=this._bufferService)===null||e===void 0?void 0:e.baseDts}},{key:"seekable",get:function(){return!!this._keyframes&&this._acceptRanges}},{key:"speedInfo",value:function(){return{speed:this._bandwidthService.getLatestSpeed(),avgSpeed:this._bandwidthService.getAvgSpeed()}}},{key:"getStats",value:function(){return this._stats.getStats()}},{key:"bufferInfo",value:function(){var e,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.1;return me.info(me.get(this.media),(e=this.media)===null||e===void 0?void 0:e.currentTime,s)}},{key:"playbackQuality",value:function(){return ea(this.media)}},{key:"load",value:function(){var n=Te(ne().mark(function s(r){var l,o=arguments;return ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(l=o.length>1&&o[1]!==void 0?o[1]:!1,this._bufferService){c.next=3;break}return c.abrupt("return");case 3:return c.next=5,this._reset(l);case 5:this._loadData(r),clearTimeout(this._tickTimer),this._tickTimer=setTimeout(this._tick,this._tickInterval);case 8:case"end":return c.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"replay",value:function(){var n=Te(ne().mark(function s(){var r=this,l,o,u=arguments;return ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(l=u.length>0&&u[0]!==void 0?u[0]:this._opts.seamlesslyReload,o=u.length>1?u[1]:void 0,this.media){p.next=4;break}return p.abrupt("return");case 4:if(!l){p.next=10;break}return p.next=7,this._clear();case 7:setTimeout(function(){r._loadData(r._opts.url),r._bufferService.seamlessSwitch(),r._seamlessSwitching=!0}),p.next=12;break;case 10:return p.next=12,this.load();case 12:return p.abrupt("return",this.media.play(!o).catch(function(){}));case 13:case"end":return p.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"disconnect",value:function(){return pt.debug("disconnect!"),this._clear()}},{key:"switchURL",value:function(){var n=Te(ne().mark(function s(r,l){var o=this;return ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(this._bufferService){c.next=2;break}return c.abrupt("return");case 2:if(!(!l||!this._opts.isLive)){c.next=7;break}return c.next=5,this.load(r);case 5:return this._urlSwitching=!0,c.abrupt("return",this.media.play(!0).catch(function(){}));case 7:return c.next=9,this._clear();case 9:setTimeout(function(){o._loadData(r),o._bufferService.seamlessSwitch(),o._urlSwitching=!0,o._seamlessSwitching=!0});case 10:case"end":return c.stop()}},s,this)}));function e(s,r){return n.apply(this,arguments)}return e}()},{key:"destroy",value:function(){var n=Te(ne().mark(function s(){return ne().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.media){l.next=2;break}return l.abrupt("return");case 2:return this.removeAllListeners(),this._seiService.reset(),this.media.removeEventListener("play",this._onPlay),this.media.removeEventListener("seeking",this._onSeeking),this.media.removeEventListener("timeupdate",this._onTimeupdate),l.next=9,Promise.all([this._clear(),this._bufferService.destroy()]);case 9:this.media=null,this._bufferService=null;case 11:case"end":return l.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"_emitError",value:function(e){var s,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;pt.table(e),pt.error(e),pt.error((s=this.media)===null||s===void 0?void 0:s.error),this._urlSwitching&&(this._urlSwitching=!1,this._seamlessSwitching=!1,this.emit(M.SWITCH_URL_FAILED,e)),this.emit(M.ERROR,e),r&&(this._seiService.reset(),this._end())}},{key:"_reset",value:function(){var n=Te(ne().mark(function s(){var r,l=arguments;return ne().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r=l.length>0&&l[0]!==void 0?l[0]:!1,this._seiService.reset(),this._bandwidthService.reset(),this._stats.reset(),u.next=6,this._clear();case 6:return u.next=8,this._bufferService.reset(r);case 8:this._firstProgressEmit=!1;case 9:case"end":return u.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"_loadData",value:function(){var n=Te(ne().mark(function s(r,l){return ne().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(r&&(this._opts.url=r),r=this._opts.url,r){u.next=4;break}throw new Error("Source url is missing");case 4:if(this.emit(M.LOAD_START,{url:r}),pt.debug("load data, loading:",this._loading,r),!this._loading){u.next=9;break}return u.next=9,this._mediaLoader.cancel();case 9:return this._loading=!0,u.prev=10,u.next=13,this._mediaLoader.load({url:r,range:l});case 13:u.next=18;break;case 15:return u.prev=15,u.t0=u.catch(10),u.abrupt("return",this._emitError(pe.network(u.t0)));case 18:case"end":return u.stop()}},s,this,[[10,15]])}));function e(s,r){return n.apply(this,arguments)}return e}()},{key:"_clear",value:function(){var n=Te(ne().mark(function s(){return ne().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(clearTimeout(this._maxChunkWaitTimer),clearTimeout(this._tickTimer),!this._mediaLoader){l.next=5;break}return l.next=5,this._mediaLoader.cancel();case 5:this._loading=!1;case 6:case"end":return l.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()}],[{key:"isSupported",value:function(e){return!e||e==="video"||e==="audio"?he.isSupported():typeof WebAssembly<"u"}},{key:"enableLogger",value:function(){xe.enable(),Vt.enable()}},{key:"disableLogger",value:function(){xe.disable(),Vt.disable()}}]),t}(Dt);try{localStorage.getItem("xgd")?rn.enableLogger():rn.disableLogger()}catch{}var Ol=function(){function a(i,t){var n=this;En(this,a),O(this,"_onLowDecode",function(){var e,s,r,l,o=n._opts,u=o.media,c=o.innerDegrade,p=o.backupURL;(e=n._plugin)===null||e===void 0||(s=e.player)===null||s===void 0||s.emit("lowdecode",u.degradeInfo),(r=n._plugin)===null||r===void 0||(l=r.player)===null||l===void 0||l.emit("core_event",Re(Re({},u.degradeInfo),{},{eventName:M.LOWDECODE})),(c===1||c===3)&&p&&n._degrade(p)}),O(this,"_degrade",function(e){var s=n._plugin.player,r=s.video;if((r==null?void 0:r.TAG)==="MVideo"){var l=s.video.degradeVideo;s.video=l,r.degrade(e),e&&(s.config.url=e);var o=s.root.firstChild;o.TAG==="MVideo"&&s.root.replaceChild(l,o);var u=n._plugin.constructor.pluginName.toLowerCase();s.unRegisterPlugin(u),s.once("canplay",function(){s.play()})}}),O(this,"forceDegradeToVideo",function(e){var s=n._opts.innerDegrade;(s===1||s===3)&&n._degrade(e)}),this._opts=i,this._plugin=t,this._init()}return In(a,[{key:"_init",value:function(){var t=this._opts,n=t.media,e=t.preloadTime,s=t.innerDegrade,r=t.decodeMode;n&&(s&&n.setAttribute("innerdegrade",s),e&&n.setAttribute("preloadtime",e),n.setDecodeMode&&n.setDecodeMode(r),this._bindEvents())}},{key:"_bindEvents",value:function(){var t=this._opts.media;t.addEventListener("lowdecode",this._onLowDecode)}},{key:"destroy",value:function(){var t,n;(t=this._opts)===null||t===void 0||(n=t.media)===null||n===void 0||n.removeEventListener("lowdecode",this._onLowDecode),this._plugin=null}}]),a}(),xa=function(a){ka(t,a);var i=Ra(t);function t(){var n;En(this,t);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=i.call.apply(i,[this].concat(s)),O(ee(n),"flv",null),O(ee(n),"pluginExtension",null),O(ee(n),"getStats",function(){var l;return(l=n.flv)===null||l===void 0?void 0:l.getStats()}),O(ee(n),"destroy",function(){var l;n.flv&&(n.flv.destroy(),n.flv=null),(l=n.pluginExtension)===null||l===void 0||l.destroy(),n.pluginExtension=null}),O(ee(n),"_onSwitchURL",function(l,o){if(n.flv){var u,c;n.player.config.url=l,n.flv.switchURL(l,o),!o&&(u=n.player.config)!==null&&u!==void 0&&(c=u.flv)!==null&&c!==void 0&&c.keepStatusAfterSwitch&&n._keepPauseStatus()}}),O(ee(n),"_keepPauseStatus",function(){var l=n.player.paused;l&&n.player.once("canplay",function(){n.player.pause()})}),O(ee(n),"_onDefinitionChange",function(l){var o=l.to;n.flv&&n.flv.switchURL(o)}),n}return In(t,[{key:"core",get:function(){return this.flv}},{key:"version",get:function(){var e;return(e=this.flv)===null||e===void 0?void 0:e.version}},{key:"softDecode",get:function(){var e,s,r=(e=this.player)===null||e===void 0||(s=e.config)===null||s===void 0?void 0:s.mediaType;return!!r&&r!=="video"&&r!=="audio"}},{key:"beforePlayerInit",value:function(){var e=this,s=this.player.config;if(s.url){this.flv&&this.flv.destroy(),this.player.switchURL=this._onSwitchURL;var r=s.flv||{};if((r.disconnectTime===null||r.disconnectTime===void 0)&&(r.disconnectTime=0),this.flv=new rn(Re({softDecode:this.softDecode,isLive:s.isLive,media:this.player.video},r)),this.softDecode||kt.defineGetterOrSetter(this.player,{url:{get:function(){var u,c;return(u=e.flv)===null||u===void 0||(c=u.media)===null||c===void 0?void 0:c.src},configurable:!0}}),this.softDecode&&(this.pluginExtension=new Ol(Re({media:this.player.video},s.flv),this),this.player.forceDegradeToVideo=function(){for(var o,u=arguments.length,c=new Array(u),p=0;p<u;p++)c[p]=arguments[p];return(o=e.pluginExtension)===null||o===void 0?void 0:o.forceDegradeToVideo.apply(o,c)}),s.isLive){var l;(l=this.player)===null||l===void 0||l.useHooks("replay",function(){var o;return(o=e.flv)===null||o===void 0?void 0:o.replay()})}this.on(Bt,this._onSwitchURL),this.on(Mr,this.destroy),this._transError(),this._transCoreEvent(M.TTFB),this._transCoreEvent(M.LOAD_START),this._transCoreEvent(M.LOAD_RESPONSE_HEADERS),this._transCoreEvent(M.LOAD_COMPLETE),this._transCoreEvent(M.LOAD_RETRY),this._transCoreEvent(M.SOURCEBUFFER_CREATED),this._transCoreEvent(M.ANALYZE_DURATION_EXCEEDED),this._transCoreEvent(M.REMOVE_BUFFER),this._transCoreEvent(M.BUFFEREOS),this._transCoreEvent(M.KEYFRAME),this._transCoreEvent(M.METADATA_PARSED),this._transCoreEvent(M.SEI),this._transCoreEvent(M.SEI_IN_TIME),this._transCoreEvent(M.FLV_SCRIPT_DATA),this._transCoreEvent(M.STREAM_EXCEPTION),this._transCoreEvent(M.SWITCH_URL_SUCCESS),this._transCoreEvent(M.SWITCH_URL_FAILED),this.flv.load(s.url,!0)}}},{key:"_transError",value:function(){var e=this;this.flv.on(M.ERROR,function(s){e.player&&e.player.emit(Yr,new It(e.player,s))})}},{key:"_transCoreEvent",value:function(e){var s=this;this.flv.on(e,function(r){s.player&&s.player.emit("core_event",Re(Re({},r),{},{eventName:e}))})}}],[{key:"pluginName",get:function(){return"flv"}},{key:"isSupported",value:function(e,s){return rn.isSupported(e,s)}}]),t}(kt);O(xa,"Flv",rn);function gr(a,i){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);i&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),t.push.apply(t,n)}return t}function Zt(a){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?arguments[i]:{};i%2?gr(Object(t),!0).forEach(function(n){ze(a,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):gr(Object(t)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(t,n))})}return a}function te(){te=function(){return a};var a={},i=Object.prototype,t=i.hasOwnProperty,n=Object.defineProperty||function(h,d,y){h[d]=y.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(h,d,y){return Object.defineProperty(h,d,{value:y,enumerable:!0,configurable:!0,writable:!0}),h[d]}try{o({},"")}catch{o=function(d,y,L){return d[y]=L}}function u(h,d,y,L){var Z=d&&d.prototype instanceof m?d:m,W=Object.create(Z.prototype),R=new I(L||[]);return n(W,"_invoke",{value:S(h,y,R)}),W}function c(h,d,y){try{return{type:"normal",arg:h.call(d,y)}}catch(L){return{type:"throw",arg:L}}}a.wrap=u;var p={};function m(){}function f(){}function b(){}var v={};o(v,s,function(){return this});var g=Object.getPrototypeOf,X=g&&g(g(E([])));X&&X!==i&&t.call(X,s)&&(v=X);var D=b.prototype=m.prototype=Object.create(v);function F(h){["next","throw","return"].forEach(function(d){o(h,d,function(y){return this._invoke(d,y)})})}function w(h,d){function y(Z,W,R,_){var K=c(h[Z],h,W);if(K.type!=="throw"){var Y=K.arg,J=Y.value;return J&&typeof J=="object"&&t.call(J,"__await")?d.resolve(J.__await).then(function(P){y("next",P,R,_)},function(P){y("throw",P,R,_)}):d.resolve(J).then(function(P){Y.value=P,R(Y)},function(P){return y("throw",P,R,_)})}_(K.arg)}var L;n(this,"_invoke",{value:function(Z,W){function R(){return new d(function(_,K){y(Z,W,_,K)})}return L=L?L.then(R,R):R()}})}function S(h,d,y){var L="suspendedStart";return function(Z,W){if(L==="executing")throw new Error("Generator is already running");if(L==="completed"){if(Z==="throw")throw W;return U()}for(y.method=Z,y.arg=W;;){var R=y.delegate;if(R){var _=G(R,y);if(_){if(_===p)continue;return _}}if(y.method==="next")y.sent=y._sent=y.arg;else if(y.method==="throw"){if(L==="suspendedStart")throw L="completed",y.arg;y.dispatchException(y.arg)}else y.method==="return"&&y.abrupt("return",y.arg);L="executing";var K=c(h,d,y);if(K.type==="normal"){if(L=y.done?"completed":"suspendedYield",K.arg===p)continue;return{value:K.arg,done:y.done}}K.type==="throw"&&(L="completed",y.method="throw",y.arg=K.arg)}}}function G(h,d){var y=d.method,L=h.iterator[y];if(L===void 0)return d.delegate=null,y==="throw"&&h.iterator.return&&(d.method="return",d.arg=void 0,G(h,d),d.method==="throw")||y!=="return"&&(d.method="throw",d.arg=new TypeError("The iterator does not provide a '"+y+"' method")),p;var Z=c(L,h.iterator,d.arg);if(Z.type==="throw")return d.method="throw",d.arg=Z.arg,d.delegate=null,p;var W=Z.arg;return W?W.done?(d[h.resultName]=W.value,d.next=h.nextLoc,d.method!=="return"&&(d.method="next",d.arg=void 0),d.delegate=null,p):W:(d.method="throw",d.arg=new TypeError("iterator result is not an object"),d.delegate=null,p)}function T(h){var d={tryLoc:h[0]};1 in h&&(d.catchLoc=h[1]),2 in h&&(d.finallyLoc=h[2],d.afterLoc=h[3]),this.tryEntries.push(d)}function C(h){var d=h.completion||{};d.type="normal",delete d.arg,h.completion=d}function I(h){this.tryEntries=[{tryLoc:"root"}],h.forEach(T,this),this.reset(!0)}function E(h){if(h){var d=h[s];if(d)return d.call(h);if(typeof h.next=="function")return h;if(!isNaN(h.length)){var y=-1,L=function Z(){for(;++y<h.length;)if(t.call(h,y))return Z.value=h[y],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return L.next=L}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=b,n(D,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:f,configurable:!0}),f.displayName=o(b,l,"GeneratorFunction"),a.isGeneratorFunction=function(h){var d=typeof h=="function"&&h.constructor;return!!d&&(d===f||(d.displayName||d.name)==="GeneratorFunction")},a.mark=function(h){return Object.setPrototypeOf?Object.setPrototypeOf(h,b):(h.__proto__=b,o(h,l,"GeneratorFunction")),h.prototype=Object.create(D),h},a.awrap=function(h){return{__await:h}},F(w.prototype),o(w.prototype,r,function(){return this}),a.AsyncIterator=w,a.async=function(h,d,y,L,Z){Z===void 0&&(Z=Promise);var W=new w(u(h,d,y,L),Z);return a.isGeneratorFunction(d)?W:W.next().then(function(R){return R.done?R.value:W.next()})},F(D),o(D,l,"Generator"),o(D,s,function(){return this}),o(D,"toString",function(){return"[object Generator]"}),a.keys=function(h){var d=Object(h),y=[];for(var L in d)y.push(L);return y.reverse(),function Z(){for(;y.length;){var W=y.pop();if(W in d)return Z.value=W,Z.done=!1,Z}return Z.done=!0,Z}},a.values=E,I.prototype={constructor:I,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!h)for(var d in this)d.charAt(0)==="t"&&t.call(this,d)&&!isNaN(+d.slice(1))&&(this[d]=void 0)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var d=this;function y(K,Y){return W.type="throw",W.arg=h,d.next=K,Y&&(d.method="next",d.arg=void 0),!!Y}for(var L=this.tryEntries.length-1;L>=0;--L){var Z=this.tryEntries[L],W=Z.completion;if(Z.tryLoc==="root")return y("end");if(Z.tryLoc<=this.prev){var R=t.call(Z,"catchLoc"),_=t.call(Z,"finallyLoc");if(R&&_){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}else if(R){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0)}else{if(!_)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}}}},abrupt:function(h,d){for(var y=this.tryEntries.length-1;y>=0;--y){var L=this.tryEntries[y];if(L.tryLoc<=this.prev&&t.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var Z=L;break}}Z&&(h==="break"||h==="continue")&&Z.tryLoc<=d&&d<=Z.finallyLoc&&(Z=null);var W=Z?Z.completion:{};return W.type=h,W.arg=d,Z?(this.method="next",this.next=Z.finallyLoc,p):this.complete(W)},complete:function(h,d){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&d&&(this.next=d),p},finish:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.finallyLoc===h)return this.complete(y.completion,y.afterLoc),C(y),p}},catch:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.tryLoc===h){var L=y.completion;if(L.type==="throw"){var Z=L.arg;C(y)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(h,d,y){return this.delegate={iterator:E(h),resultName:d,nextLoc:y},this.method==="next"&&(this.arg=void 0),p}},a}function Zr(a,i,t,n,e,s,r){try{var l=a[s](r),o=l.value}catch(u){t(u);return}l.done?i(o):Promise.resolve(o).then(n,e)}function Fe(a){return function(){var i=this,t=arguments;return new Promise(function(n,e){var s=a.apply(i,t);function r(o){Zr(s,n,e,r,l,"next",o)}function l(o){Zr(s,n,e,r,l,"throw",o)}r(void 0)})}}function At(a,i){if(!(a instanceof i))throw new TypeError("Cannot call a class as a function")}function Sr(a,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,Ma(n.key),n)}}function Ut(a,i,t){return i&&Sr(a.prototype,i),t&&Sr(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function ze(a,i,t){return i=Ma(i),i in a?Object.defineProperty(a,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[i]=t,a}function ks(a,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(i&&i.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),i&&Ss(a,i)}function Gn(a){return Gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gn(a)}function Ss(a,i){return Ss=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},Ss(a,i)}function Jl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ge(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Bl(a,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ge(a)}function Rs(a){var i=Jl();return function(){var n=Gn(a),e;if(i){var s=Gn(this).constructor;e=Reflect.construct(n,arguments,s)}else e=n.apply(this,arguments);return Bl(this,e)}}function jl(a,i){if(typeof a!="object"||a===null)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var n=t.call(a,i||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(a)}function Ma(a){var i=jl(a,"string");return typeof i=="symbol"?i:String(i)}var Vs={};Object.defineProperty(Vs,"__esModule",{value:!0});Vs.default=function(a){for(var i=0,t=arguments.length,n=Array(t>1?t-1:0),e=1;e<t;e++)n[e-1]=arguments[e];var s=!0,r=!1,l=void 0;try{for(var o=n[Symbol.iterator](),u;!(s=(u=o.next()).done);s=!0){var c=u.value;i+=c.length}}catch(F){r=!0,l=F}finally{try{!s&&o.return&&o.return()}finally{if(r)throw l}}var p=new a(i),m=0,f=!0,b=!1,v=void 0;try{for(var g=n[Symbol.iterator](),X;!(f=(X=g.next()).done);f=!0){var D=X.value;p.set(D,m),m+=D.length}}catch(F){b=!0,v=F}finally{try{!f&&g.return&&g.return()}finally{if(b)throw v}}return p};var Ql=Vs,ql=$l(Ql);function $l(a){return a&&a.__esModule?a:{default:a}}var eo=ql.default;const to=ja(eo);var Ya="3.0.7",gt={416:-499899,401:-499898,403:-499897,404:-499896,timeout:-499895,"4xx":-499894,"5xx":-499893,networkError:-499892,contentError:-499891,mse:-499971,mseOpen:-499972,mseAppend:-499973,boxsError:-499980,moovError:-499981,notH264:-499982,mdatError:-499983,mdhdError:-499984,metaError:-499985,muxError:-499986,h265Error:-499987,noneURL:-499988,other:-499989,other1:-499990,waitTimeout:-499791,onWaitInBufferRange:-499792},Ct={network:1003,format:1005,runtime:1002,other:9999,demux:1006,remux:1007},no=Ut(function a(i,t,n){At(this,a);var e=0,s=0;return n&&n.range&&n.range.length>1&&(e=n.range[0],s=n.range[1]),{errorCode:t,errorType:i,errorTypeCode:Ct[i],errorMessage:(n==null?void 0:n.httpText)||(n==null?void 0:n.message),url:n==null?void 0:n.url,httpCode:t,version:Ya,rangeStart:e,rangeEnd:s,ext:n,mediaError:{code:t,message:(n==null?void 0:n.httpText)||(n==null?void 0:n.message)}}}),so=Ut(function a(i,t,n){return At(this,a),{errorCode:t,errorType:i,errorTypeCode:Ct[i],version:Ya,errorMessage:n.msg,ext:n,mediaError:{code:t,message:n.msg}}}),et={};et.nowTime=function(){try{return parseInt(performance.now(),10)}catch{return new Date().getTime()}};et.concatData=function(a,i){var t=[],n=0;a&&t.push(a),i&&t.push(i),t.every(function(r){return r&&(n+=r.byteLength),!0});var e=new Uint8Array(n),s=0;return t.every(function(r){return r&&(e.set(r,s),s+=r.byteLength),!0}),e};function ro(a,i){var t=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(t!=null){var n,e,s,r,l=[],o=!0,u=!1;try{if(s=(t=t.call(a)).next,i===0){if(Object(t)!==t)return;o=!1}else for(;!(o=(n=s.call(t)).done)&&(l.push(n.value),l.length!==i);o=!0);}catch(c){u=!0,e=c}finally{try{if(!o&&t.return!=null&&(r=t.return(),Object(r)!==r))return}finally{if(u)throw e}}return l}}function Lr(a,i){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);i&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),t.push.apply(t,n)}return t}function Ls(a){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?arguments[i]:{};i%2?Lr(Object(t),!0).forEach(function(n){Ie(a,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):Lr(Object(t)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(t,n))})}return a}function le(){le=function(){return a};var a={},i=Object.prototype,t=i.hasOwnProperty,n=Object.defineProperty||function(h,d,y){h[d]=y.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(h,d,y){return Object.defineProperty(h,d,{value:y,enumerable:!0,configurable:!0,writable:!0}),h[d]}try{o({},"")}catch{o=function(d,y,L){return d[y]=L}}function u(h,d,y,L){var Z=d&&d.prototype instanceof m?d:m,W=Object.create(Z.prototype),R=new I(L||[]);return n(W,"_invoke",{value:S(h,y,R)}),W}function c(h,d,y){try{return{type:"normal",arg:h.call(d,y)}}catch(L){return{type:"throw",arg:L}}}a.wrap=u;var p={};function m(){}function f(){}function b(){}var v={};o(v,s,function(){return this});var g=Object.getPrototypeOf,X=g&&g(g(E([])));X&&X!==i&&t.call(X,s)&&(v=X);var D=b.prototype=m.prototype=Object.create(v);function F(h){["next","throw","return"].forEach(function(d){o(h,d,function(y){return this._invoke(d,y)})})}function w(h,d){function y(Z,W,R,_){var K=c(h[Z],h,W);if(K.type!=="throw"){var Y=K.arg,J=Y.value;return J&&typeof J=="object"&&t.call(J,"__await")?d.resolve(J.__await).then(function(P){y("next",P,R,_)},function(P){y("throw",P,R,_)}):d.resolve(J).then(function(P){Y.value=P,R(Y)},function(P){return y("throw",P,R,_)})}_(K.arg)}var L;n(this,"_invoke",{value:function(Z,W){function R(){return new d(function(_,K){y(Z,W,_,K)})}return L=L?L.then(R,R):R()}})}function S(h,d,y){var L="suspendedStart";return function(Z,W){if(L==="executing")throw new Error("Generator is already running");if(L==="completed"){if(Z==="throw")throw W;return U()}for(y.method=Z,y.arg=W;;){var R=y.delegate;if(R){var _=G(R,y);if(_){if(_===p)continue;return _}}if(y.method==="next")y.sent=y._sent=y.arg;else if(y.method==="throw"){if(L==="suspendedStart")throw L="completed",y.arg;y.dispatchException(y.arg)}else y.method==="return"&&y.abrupt("return",y.arg);L="executing";var K=c(h,d,y);if(K.type==="normal"){if(L=y.done?"completed":"suspendedYield",K.arg===p)continue;return{value:K.arg,done:y.done}}K.type==="throw"&&(L="completed",y.method="throw",y.arg=K.arg)}}}function G(h,d){var y=d.method,L=h.iterator[y];if(L===void 0)return d.delegate=null,y==="throw"&&h.iterator.return&&(d.method="return",d.arg=void 0,G(h,d),d.method==="throw")||y!=="return"&&(d.method="throw",d.arg=new TypeError("The iterator does not provide a '"+y+"' method")),p;var Z=c(L,h.iterator,d.arg);if(Z.type==="throw")return d.method="throw",d.arg=Z.arg,d.delegate=null,p;var W=Z.arg;return W?W.done?(d[h.resultName]=W.value,d.next=h.nextLoc,d.method!=="return"&&(d.method="next",d.arg=void 0),d.delegate=null,p):W:(d.method="throw",d.arg=new TypeError("iterator result is not an object"),d.delegate=null,p)}function T(h){var d={tryLoc:h[0]};1 in h&&(d.catchLoc=h[1]),2 in h&&(d.finallyLoc=h[2],d.afterLoc=h[3]),this.tryEntries.push(d)}function C(h){var d=h.completion||{};d.type="normal",delete d.arg,h.completion=d}function I(h){this.tryEntries=[{tryLoc:"root"}],h.forEach(T,this),this.reset(!0)}function E(h){if(h){var d=h[s];if(d)return d.call(h);if(typeof h.next=="function")return h;if(!isNaN(h.length)){var y=-1,L=function Z(){for(;++y<h.length;)if(t.call(h,y))return Z.value=h[y],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return L.next=L}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=b,n(D,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:f,configurable:!0}),f.displayName=o(b,l,"GeneratorFunction"),a.isGeneratorFunction=function(h){var d=typeof h=="function"&&h.constructor;return!!d&&(d===f||(d.displayName||d.name)==="GeneratorFunction")},a.mark=function(h){return Object.setPrototypeOf?Object.setPrototypeOf(h,b):(h.__proto__=b,o(h,l,"GeneratorFunction")),h.prototype=Object.create(D),h},a.awrap=function(h){return{__await:h}},F(w.prototype),o(w.prototype,r,function(){return this}),a.AsyncIterator=w,a.async=function(h,d,y,L,Z){Z===void 0&&(Z=Promise);var W=new w(u(h,d,y,L),Z);return a.isGeneratorFunction(d)?W:W.next().then(function(R){return R.done?R.value:W.next()})},F(D),o(D,l,"Generator"),o(D,s,function(){return this}),o(D,"toString",function(){return"[object Generator]"}),a.keys=function(h){var d=Object(h),y=[];for(var L in d)y.push(L);return y.reverse(),function Z(){for(;y.length;){var W=y.pop();if(W in d)return Z.value=W,Z.done=!1,Z}return Z.done=!0,Z}},a.values=E,I.prototype={constructor:I,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!h)for(var d in this)d.charAt(0)==="t"&&t.call(this,d)&&!isNaN(+d.slice(1))&&(this[d]=void 0)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var d=this;function y(K,Y){return W.type="throw",W.arg=h,d.next=K,Y&&(d.method="next",d.arg=void 0),!!Y}for(var L=this.tryEntries.length-1;L>=0;--L){var Z=this.tryEntries[L],W=Z.completion;if(Z.tryLoc==="root")return y("end");if(Z.tryLoc<=this.prev){var R=t.call(Z,"catchLoc"),_=t.call(Z,"finallyLoc");if(R&&_){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}else if(R){if(this.prev<Z.catchLoc)return y(Z.catchLoc,!0)}else{if(!_)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return y(Z.finallyLoc)}}}},abrupt:function(h,d){for(var y=this.tryEntries.length-1;y>=0;--y){var L=this.tryEntries[y];if(L.tryLoc<=this.prev&&t.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var Z=L;break}}Z&&(h==="break"||h==="continue")&&Z.tryLoc<=d&&d<=Z.finallyLoc&&(Z=null);var W=Z?Z.completion:{};return W.type=h,W.arg=d,Z?(this.method="next",this.next=Z.finallyLoc,p):this.complete(W)},complete:function(h,d){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&d&&(this.next=d),p},finish:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.finallyLoc===h)return this.complete(y.completion,y.afterLoc),C(y),p}},catch:function(h){for(var d=this.tryEntries.length-1;d>=0;--d){var y=this.tryEntries[d];if(y.tryLoc===h){var L=y.completion;if(L.type==="throw"){var Z=L.arg;C(y)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(h,d,y){return this.delegate={iterator:E(h),resultName:d,nextLoc:y},this.method==="next"&&(this.arg=void 0),p}},a}function Xr(a,i,t,n,e,s,r){try{var l=a[s](r),o=l.value}catch(u){t(u);return}l.done?i(o):Promise.resolve(o).then(n,e)}function Ne(a){return function(){var i=this,t=arguments;return new Promise(function(n,e){var s=a.apply(i,t);function r(o){Xr(s,n,e,r,l,"next",o)}function l(o){Xr(s,n,e,r,l,"throw",o)}r(void 0)})}}function xs(a,i){if(!(a instanceof i))throw new TypeError("Cannot call a class as a function")}function Dr(a,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,Ia(n.key),n)}}function Ms(a,i,t){return i&&Dr(a.prototype,i),t&&Dr(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function Ie(a,i,t){return i=Ia(i),i in a?Object.defineProperty(a,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[i]=t,a}function ao(a,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(i&&i.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),i&&Xs(a,i)}function Fn(a){return Fn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fn(a)}function Xs(a,i){return Xs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},Xs(a,i)}function io(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lo(a,i){if(a==null)return{};var t={},n=Object.keys(a),e,s;for(s=0;s<n.length;s++)e=n[s],!(i.indexOf(e)>=0)&&(t[e]=a[e]);return t}function oo(a,i){if(a==null)return{};var t=lo(a,i),n,e;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);for(e=0;e<s.length;e++)n=s[e],!(i.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(a,n)&&(t[n]=a[n])}return t}function Ue(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function uo(a,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ue(a)}function co(a){var i=io();return function(){var n=Fn(a),e;if(i){var s=Fn(this).constructor;e=Reflect.construct(n,arguments,s)}else e=n.apply(this,arguments);return uo(this,e)}}function po(a,i){return fo(a)||ro(a,i)||Ea(a,i)||vo()}function ho(a){return mo(a)||yo(a)||Ea(a)||bo()}function mo(a){if(Array.isArray(a))return Ds(a)}function fo(a){if(Array.isArray(a))return a}function yo(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Ea(a,i){if(a){if(typeof a=="string")return Ds(a,i);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ds(a,i)}}function Ds(a,i){(i==null||i>a.length)&&(i=a.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=a[t];return n}function bo(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function go(a,i){if(typeof a!="object"||a===null)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var n=t.call(a,i||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(a)}function Ia(a){var i=go(a,"string");return typeof i=="symbol"?i:String(i)}function Zo(a){return Ls({vid:"",moovEnd:8e4,segmentDuration:2,maxDownloadInfoSize:30,responseType:"arraybuffer",cache:null},a)}var mn=Ms(function a(i,t){xs(this,a),this.type="file",this.message=i,this.data=t}),So=function(){function a(){xs(this,a),Ie(this,"_data",Object.create(null))}return Ms(a,[{key:"set",value:function(t,n){this._data[t]=n}},{key:"get",value:function(t){return this._data[t]}},{key:"clear",value:function(){this._data=Object.create(null)}}]),a}();function $n(a,i){var t=a.trak;if(!(!t||!t.length)){var n=t.find(function(h){var d,y;return((d=h.mdia)===null||d===void 0||(y=d.hdlr)===null||y===void 0?void 0:y.handlerType)==="vide"}),e=t.find(function(h){var d,y;return((d=h.mdia)===null||d===void 0||(y=d.hdlr)===null||y===void 0?void 0:y.handlerType)==="soun"});if(!(!n&&!e)){var s=[],r=[],l;if(n){var o,u,c,p=(o=n.mdia)===null||o===void 0||(u=o.minf)===null||u===void 0?void 0:u.stbl;if(!p)return;var m=(c=n.mdia.mdhd)===null||c===void 0?void 0:c.timescale,f=p.stts,b=p.stsc,v=p.stsz,g=p.stco,X=p.stss,D=p.ctts;if(!m||!f||!b||!v||!g||!X)return;s=wr(i,m,f,b,v,g,X,D),l=s.map(function(h){return h.duration})}if(e){var F,w,S,G=(F=e.mdia)===null||F===void 0||(w=F.minf)===null||w===void 0?void 0:w.stbl;if(!G)return;var T=(S=e.mdia.mdhd)===null||S===void 0?void 0:S.timescale,C=G.stts,I=G.stsc,E=G.stsz,U=G.stco;if(!T||!C||!I||!E||!U)return;r=wr(i,T,C,I,E,U,null,null,l)}return{videoSegments:s,audioSegments:r}}}}function wr(a,i,t,n,e,s,r,l,o){var u=[],c=[],p=[],m=n.entries,f=s.entries,b=e.entrySizes,v=r==null?void 0:r.entries,g=l==null?void 0:l.entries,X;g&&(X=[],g.forEach(function(He){for(var ae=He.count,Be=He.offset,lt=0;lt<ae;lt++)X.push(Be)}));var D;v&&(D={},v.forEach(function(He){D[He-1]=!0}));var F,w,S=0,G=0,T=0,C=0,I=0,E=m[0].samplesPerChunk,U=m[1]?m[1].firstChunk-1:1/0,h=0,d=-1;t.entries.forEach(function(He){var ae=He.count,Be=He.delta;w=Be;for(var lt=0;lt<ae;lt++)F={dts:h,startTime:S,duration:w,size:b[G]||e.sampleSize,offset:f[T]+I,index:G},v&&(F.keyframe=D[G],F.keyframe?(d++,c.push([F]),p.push(F.duration)):(c[c.length-1].push(F),p[c.length-1]+=F.duration),F.gopId=d),X&&G<X.length&&(F.pts=h+X[G]),G===0&&(F.pts=0),u.push(F),S+=w,h+=Be,G++,G<E?I+=F.size:(T++,I=0,T>=U&&(C++,U=m[C+1]?m[C+1].firstChunk-1:1/0),E+=m[C].samplesPerChunk)});var y=u.length;if(!(!y||r&&!u[0].keyframe)){var L=[],Z=[],W=0,R,_=0,K=function(ae){var Be;R=Z[Z.length-1],L.push({index:L.length,startTime:((Be=L[L.length-1])===null||Be===void 0?void 0:Be.endTime)||Z[0].startTime/i,endTime:(R.startTime+R.duration)/i,duration:ae,range:[Z[0].offset,R.offset+R.size],frames:Z}),W=0,Z=[]};if(r)for(var Y=a*i,J=0,P=c.length;J<P;J++){var st;W+=p[J],(st=Z).push.apply(st,ho(c[J])),J+1<P?(J===0||W>Y)&&K(W/i):K(W/i)}else{o=o||[];for(var Le=o[0]||a,Ke=0;Ke<y;Ke++){Z.push(u[Ke]),W+=u[Ke].duration;var rt=W/i;(Ke+1>=y||rt+_>=Le)&&(_+=rt-Le,K(rt),Le=o[L.length]||a)}}return L}}function Gr(a){var i="",t="",n=0,e=0,s=0,r=0,l=0,o=0,u=0;a.mvhd&&(l=a.mvhd.duration/a.mvhd.timescale);var c=a.trak;if(c){var p=c.find(function(L){var Z,W;return((Z=L.mdia)===null||Z===void 0||(W=Z.hdlr)===null||W===void 0?void 0:W.handlerType)==="vide"}),m=c.find(function(L){var Z,W;return((Z=L.mdia)===null||Z===void 0||(W=Z.hdlr)===null||W===void 0?void 0:W.handlerType)==="soun"}),f=null,b;if(p){var v,g,X;if(f=(v=p.mdia)===null||v===void 0||(g=v.minf)===null||g===void 0||(X=g.stbl)===null||X===void 0?void 0:X.stsd.entries[0],f){var D,F,w;if(n=f.width,e=f.height,o=(D=p.mdia)===null||D===void 0||(F=D.mdhd)===null||F===void 0?void 0:F.timescale,i=(w=f.avcC||f.hvcC)===null||w===void 0?void 0:w.codec,f.type==="encv"){var S,G;b=(S=f.sinf)===null||S===void 0||(G=S.schi)===null||G===void 0?void 0:G.tenc.default_KID}}}if(m){var T,C,I;if(f=(T=m.mdia)===null||T===void 0||(C=T.minf)===null||C===void 0||(I=C.stbl)===null||I===void 0?void 0:I.stsd.entries[0],f){var E,U,h;if(s=f.channelCount,r=f.sampleRate,t=(E=f.esds)===null||E===void 0?void 0:E.codec,u=(U=m.mdia)===null||U===void 0||(h=U.mdhd)===null||h===void 0?void 0:h.timescale,f.type==="enca"){var d,y;b=b||((d=f.sinf)===null||d===void 0||(y=d.schi)===null||y===void 0?void 0:y.tenc.default_KID)}}}return{kid:b?b.join(""):null,videoCodec:i,audioCodec:t,width:n,height:e,videoTimescale:o,audioChannelCount:s,audioSampleRate:r,duration:l,audioTimescale:u,moov:a}}}function Fr(a){return typeof a=="number"&&!Number.isNaN(a)}var Lo=["vid","cache"],Xo=function(a){ao(t,a);var i=co(t);function t(n){var e;xs(this,t),e=i.call(this),Ie(Ue(e),"vid",""),Ie(Ue(e),"url",""),Ie(Ue(e),"meta",{}),Ie(Ue(e),"downloadInfo",[]),Ie(Ue(e),"videoSegments",[]),Ie(Ue(e),"audioSegments",[]),Ie(Ue(e),"cache",null),Ie(Ue(e),"_currentSegmentIndex",-1),Ie(Ue(e),"_currentLoadingSegmentIndex",-1),Ie(Ue(e),"buffer",void 0),Ie(Ue(e),"_error",void 0),Ie(Ue(e),"_transformError",function(u){return u}),e._config=Zo(n);var s=e._config,r=s.vid,l=s.cache,o=oo(s,Lo);return e.cache=l||new So,e.vid=r||o.url,e.url=o.url,o.transformError=e._transformError,e.logger=new xe("MP4Loader_"+e.vid),n.openLog&&xe.enable(),o.logger=e.logger,e._loader=new St(o),e._loader.on(M.REAL_TIME_SPEED,function(u){e.emit(M.REAL_TIME_SPEED,u)}),e}return Ms(t,[{key:"isMetaLoaded",get:function(){return this.videoSegments.length||this.audioSegments.length}},{key:"setCurrentSegment",value:function(e){Fr(e)&&(this._currentSegmentIndex=e)}},{key:"isLastSegment",value:function(e){if(Fr(e)){var s,r,l=((s=this.videoSegments[this.videoSegments.length-1])===null||s===void 0?void 0:s.index)||((r=this.audioSegments[this.audioSegments.length-1])===null||r===void 0?void 0:r.index)||0;return e>=l}return!1}},{key:"isSegmentLoading",value:function(e){return e===this._currentLoadingSegmentIndex}},{key:"changeUrl",value:function(){var n=Ne(le().mark(function s(r){var l,o,u,c=arguments;return le().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return l=c.length>1&&c[1]!==void 0?c[1]:r,o=c.length>2?c[2]:void 0,u=c.length>3?c[3]:void 0,m.next=5,this.reset(u);case 5:r&&(this.url=r),l&&(this.vid=l),o&&(this._config.moovEnd=o);case 8:case"end":return m.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"getOrLoadMeta",value:function(){var n=Ne(le().mark(function s(r){return le().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.isMetaLoaded){o.next=3;break}return o.next=3,this.loadMeta(r);case 3:return o.abrupt("return",this.meta);case 4:case"end":return o.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"loadMetaProcess",value:function(){var n=Ne(le().mark(function s(r,l,o,u){var c=this,p,m,f,b;return le().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return p=po(l,2),m=p[0],f=p[1],this._error=!1,this.logger.debug("[loadMetaProcess start], range,",[m,f]),b=function(){var X=Ne(le().mark(function D(F,w,S){var G,T,C,I,E,U,h,d;return le().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(c.meta&&S!==null&&S!==void 0&&S.range&&S.range.length>0&&S.range[1]>=f&&(w=!0,c.logger.debug("[loadMetaProcess],data done,setstate true,[",m,f,"]")),w&&S!==null&&S!==void 0&&S.range&&S.range.length>0&&S.range[1]<f&&(w=!1,c.logger.debug("[loadMetaProcess],data not done,setstate false,[",m,f,"]")),c.logger.debug("[loadMetaProcess],task,[",m,f,"], range,",S.range,",dataLen,",F?F.byteLength:void 0,", state,",w,",err,",c._error),!c._error&&F&&F.byteLength>0&&o(F,w,S),!(c.meta.moov||c._error)){L.next=6;break}return L.abrupt("return");case 6:if(!(F&&F.byteLength>0)){L.next=44;break}if(c.buffer=Tt(c.buffer,F),G=re.findBox(c.buffer,["moov"])[0],G){L.next=23;break}if(T=re.findBox(c.buffer,["mdat"])[0],!w){L.next=23;break}if(T){L.next=18;break}return c._error=!0,o(null,w,S,{err:"cannot find moov or mdat box"}),L.abrupt("return");case 18:return C=T.start+T.size,L.next=21,c.loadData([C,""],r,u);case 21:I=L.sent,I&&(G=re.findBox(I.data,["moov"])[0]);case 23:if(!(G&&w&&G.size>G.data.length)){L.next=27;break}return c.logger.debug("[loadMetaProcess],moov not all, range,",S.range[1],",dataLen,",c.buffer.byteLength,", state,",w),L.next=27,c.loadMetaProcess(r,[S.range[1],G.start+G.size-1],o);case 27:if(!(G&&G.size<=G.data.length&&!c.meta.moov)){L.next=44;break}if(E=re.moov(G),E){L.next=33;break}return c._error=!0,o(null,w,S,{err:"cannot parse moov box"}),L.abrupt("return");case 33:if(U=$n(E,c._config.segmentDuration),U){L.next=38;break}return c._error=!0,o(null,w,S,{err:"cannot parse segments"}),L.abrupt("return");case 38:c.meta=Gr(E),h=U.videoSegments,d=U.audioSegments,c.videoSegments=h,c.audioSegments=d,c.logger.debug("[loadMetaProcess] moov ok"),o(void 0,w,{meta:{meta:c.meta,videoSegments:h,audioSegments:d}});case 44:case"end":return L.stop()}},D)}));return function(F,w,S){return X.apply(this,arguments)}}(),g.next=6,this.loadData([m,f||this._config.moovEnd],r,Ls({onProgress:b},u));case 6:case"end":return g.stop()}},s,this)}));function e(s,r,l,o){return n.apply(this,arguments)}return e}()},{key:"loadMeta",value:function(){var n=Ne(le().mark(function s(r,l,o){var u,c,p,m,f,b,v,g,X;return le().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return u=[],this.logger.debug("[loadMeta start]"),F.next=4,this.loadData([0,l||this._config.moovEnd],r,o);case 4:if(c=F.sent,c){F.next=7;break}return F.abrupt("return");case 7:if(u.push(c),p=re.findBox(c.data,["moov"])[0],p){F.next=23;break}if(m=re.findBox(c.data,["mdat"])[0],m){F.next=13;break}throw new mn("cannot find moov or mdat box",c.data);case 13:return f=m.start+m.size,F.next=16,this.loadData([f],r,o);case 16:if(c=F.sent,c){F.next=19;break}return F.abrupt("return");case 19:if(u.push(c),p=re.findBox(c.data,["moov"],f)[0],p){F.next=23;break}throw new mn("cannot find moov box",c.data);case 23:if(!(p.size>p.data.length)){F.next=31;break}return F.next=26,this.loadData([c.data.length,p.start+p.size-1],r,o);case 26:if(c=F.sent,c){F.next=29;break}return F.abrupt("return");case 29:u.push(c),p.data=Tt(p.data,c.data);case 31:if(b=re.moov(p),b){F.next=34;break}throw new mn("cannot parse moov box",p.data);case 34:if(v=$n(b,this._config.segmentDuration),v){F.next=37;break}throw new mn("cannot parse segments",p.data);case 37:return this.meta=Gr(b),g=v.videoSegments,X=v.audioSegments,this.videoSegments=g,this.audioSegments=X,this.logger.debug("[load moov end!!!!!]"),F.abrupt("return",{meta:this.meta,videoSegments:g,audioSegments:X,responses:u});case 43:case"end":return F.stop()}},s,this)}));function e(s,r,l){return n.apply(this,arguments)}return e}()},{key:"loadCacheMeta",value:function(e,s){var r=e.moov,l=$n(r,this._config.segmentDuration),o=l.videoSegments,u=l.audioSegments;this.videoSegments=o,this.audioSegments=u,this._currentSegmentIndex=s,this.meta=e}},{key:"getSegmentByTime",value:function(e){var s,r;return this.videoSegments.length?(s=this.videoSegments.find(function(l){return l.startTime<=e&&l.endTime>e}),s&&(r=this.audioSegments[s.index])):r=this.audioSegments.find(function(l){return l.startTime<=e&&l.endTime>e}),{video:s,audio:r}}},{key:"loadSegmentByTime",value:function(){var n=Ne(le().mark(function s(r,l){var o,u,c,p,m,f=arguments;return le().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(o=f.length>2&&f[2]!==void 0?f[2]:!0,u=f.length>3&&f[3]!==void 0?f[3]:{},this.isMetaLoaded){v.next=5;break}return v.next=5,this.loadMeta(l);case 5:return c=this.getSegmentByTime(r),p=c.video,m=c.audio,v.abrupt("return",this._loadSegment(p,m,l,o,u));case 7:case"end":return v.stop()}},s,this)}));function e(s,r){return n.apply(this,arguments)}return e}()},{key:"loadNextSegment",value:function(){var n=Ne(le().mark(function s(r){var l,o,u,c,p=arguments;return le().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(l=p.length>1&&p[1]!==void 0?p[1]:!0,o=p.length>2&&p[2]!==void 0?p[2]:{},this.isMetaLoaded){f.next=5;break}return f.next=5,this.loadMeta();case 5:return u=this.videoSegments[this._currentSegmentIndex+1],c=this.audioSegments[this._currentSegmentIndex+1],f.abrupt("return",this._loadSegment(u,c,r,l,o));case 8:case"end":return f.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"preload",value:function(){var n=Ne(le().mark(function s(r){var l=this,o,u,c,p,m,f,b;return le().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.isMetaLoaded){g.next=3;break}return g.next=3,this.loadMeta(!0);case 3:if(!(!r||r<0)){g.next=5;break}return g.abrupt("return");case 5:if(o=this.getSegmentByTime(r),u=o.video,c=o.audio,p=Math.max((u==null?void 0:u.index)||0,(c==null?void 0:c.index)||0),p){g.next=9;break}return g.abrupt("return");case 9:return m=this.videoSegments.slice(0,p),f=this.audioSegments.slice(0,p),b=function(){var X=Ne(le().mark(function D(F){return le().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(F>p)){S.next=2;break}return S.abrupt("return");case 2:return S.next=4,l._loadSegment(m[F],f[F],!0,!1);case 4:return S.next=6,b(F+1);case 6:case"end":return S.stop()}},D)}));return function(F){return X.apply(this,arguments)}}(),g.next=14,b(0);case 14:case"end":return g.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"cancel",value:function(){return this._loader.cancel()}},{key:"reset",value:function(){var n=Ne(le().mark(function s(){var r,l=arguments;return le().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(r=l.length>0&&l[0]!==void 0?l[0]:!1,r){u.next=5;break}return this.logger.debug("[MP4loader reset func call loader.cancel]"),u.next=5,this._loader.cancel();case 5:this.vid=this.url="",this.meta={},this.downloadInfo=[],this.videoSegments=[],this.audioSegments=[],this._currentSegmentIndex=-1,this._currentLoadingSegmentIndex=-1;case 12:case"end":return u.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"destroy",value:function(){var n=Ne(le().mark(function s(){return le().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.reset();case 2:this.cache.clear();case 3:case"end":return l.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"_loadSegment",value:function(){var n=Ne(le().mark(function s(r,l,o,u,c){var p,m;return le().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(!r&&!l)){b.next=2;break}return b.abrupt("return");case 2:return p=(r==null?void 0:r.index)||(l==null?void 0:l.index)||0,this._currentLoadingSegmentIndex=p,b.prev=4,b.next=7,this.loadData([Math.min((r==null?void 0:r.range[0])||1/0,(l==null?void 0:l.range[0])||1/0),Math.max((r==null?void 0:r.range[1])||0,(l==null?void 0:l.range[1])||0)],o,c);case 7:m=b.sent;case 8:return b.prev=8,this._currentLoadingSegmentIndex=-1,b.finish(8);case 11:if(m){b.next=13;break}return b.abrupt("return");case 13:return u&&(this._currentSegmentIndex=p),m.video=r,m.audio=l,b.abrupt("return",m);case 17:case"end":return b.stop()}},s,this,[[4,,8,11]])}));function e(s,r,l,o,u){return n.apply(this,arguments)}return e}()},{key:"loadData",value:function(){var n=Ne(le().mark(function s(r,l,o){var u,c,p,m;return le().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return u=this._getCacheKey(r),b.next=3,this.cache.get(u);case 3:if(c=b.sent,c){b.next=11;break}return m=o&&o.url?o.url:this.url,b.next=8,this._loader.load(m,Ls({range:r,vid:this.vid},o));case 8:p=b.sent,b.next=12;break;case 11:p={data:c,state:!0,options:{fromCache:!0,range:r,vid:this.vid}};case 12:if(p){b.next=14;break}return b.abrupt("return");case 14:return c||(p.data&&this.downloadInfo.push({startTime:p.startTime,endTime:p.endTime,size:p.data.byteLength,range:r}),this.downloadInfo&&this.downloadInfo.length>this._config.maxDownloadInfoSize&&(this.downloadInfo=this.downloadInfo.slice(-this._config.maxDownloadInfoSize))),b.abrupt("return",p);case 17:case"end":return b.stop()}},s,this)}));function e(s,r,l){return n.apply(this,arguments)}return e}()},{key:"_getCacheKey",value:function(e){return(this.vid||this.url)+":"+e}}]),t}(Dt),_a=Fo(),Do=Jt();Wo();function wo(){try{return typeof localStorage<"u"&&"setItem"in window.localStorage&&!!window.localStorage.setItem}catch{return!1}}function Go(){var a="_localstorage_support_test";try{return window.localStorage.setItem(a,!0),window.localStorage.removeItem(a),!1}catch{return!0}}function Jt(){if(_a)try{return!!window.localStorage.getItem("playerlog")}catch{return!1}return!1}function Fo(){return wo()&&!Go()}function Pa(a){for(var i,t=arguments.length,n=new Array(t>1?t-1:0),e=1;e<t;e++)n[e-1]=arguments[e];Do&&console.log&&(i=console).log.apply(i,["[logger]",et.nowTime(),a].concat(n))}function Wo(){if(_a)try{return!!window.localStorage.getItem("playertestlog")}catch{return!1}return!1}var Ka="IWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUoZSx0KXt2YXIgcj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgYT1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihhPWEuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLHIucHVzaC5hcHBseShyLGEpfXJldHVybiByfWZ1bmN0aW9uIHQodCl7Zm9yKHZhciByPTE7cjxhcmd1bWVudHMubGVuZ3RoO3IrKyl7dmFyIGE9bnVsbCE9YXJndW1lbnRzW3JdP2FyZ3VtZW50c1tyXTp7fTtyJTI/ZShPYmplY3QoYSksITApLmZvckVhY2goKGZ1bmN0aW9uKGUpe2kodCxlLGFbZV0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoYSkpOmUoT2JqZWN0KGEpKS5mb3JFYWNoKChmdW5jdGlvbihlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYSxlKSl9KSl9cmV0dXJuIHR9ZnVuY3Rpb24gcihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfWZ1bmN0aW9uIGEoZSx0KXtmb3IodmFyIHI9MDtyPHQubGVuZ3RoO3IrKyl7dmFyIGE9dFtyXTthLmVudW1lcmFibGU9YS5lbnVtZXJhYmxlfHwhMSxhLmNvbmZpZ3VyYWJsZT0hMCwidmFsdWUiaW4gYSYmKGEud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLGsoYS5rZXkpLGEpfX1mdW5jdGlvbiBuKGUsdCxyKXtyZXR1cm4gdCYmYShlLnByb3RvdHlwZSx0KSxyJiZhKGUsciksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsInByb3RvdHlwZSIse3dyaXRhYmxlOiExfSksZX1mdW5jdGlvbiBpKGUsdCxyKXtyZXR1cm4odD1rKHQpKWluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6cixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09cixlfWZ1bmN0aW9uIHMoZSx0KXtpZigiZnVuY3Rpb24iIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHQmJnQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6ZSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsInByb3RvdHlwZSIse3dyaXRhYmxlOiExfSksdCYmdShlLHQpfWZ1bmN0aW9uIG8oZSl7cmV0dXJuKG89T2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5nZXRQcm90b3R5cGVPZi5iaW5kKCk6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSl9KShlKX1mdW5jdGlvbiB1KGUsdCl7cmV0dXJuKHU9T2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZi5iaW5kKCk6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5fX3Byb3RvX189dCxlfSkoZSx0KX1mdW5jdGlvbiBjKCl7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBSZWZsZWN0fHwhUmVmbGVjdC5jb25zdHJ1Y3QpcmV0dXJuITE7aWYoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSlyZXR1cm4hMTtpZigiZnVuY3Rpb24iPT10eXBlb2YgUHJveHkpcmV0dXJuITA7dHJ5e3JldHVybiBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbixbXSwoZnVuY3Rpb24oKXt9KSkpLCEwfWNhdGNoKGUpe3JldHVybiExfX1mdW5jdGlvbiBsKGUsdCxyKXtyZXR1cm4obD1jKCk/UmVmbGVjdC5jb25zdHJ1Y3QuYmluZCgpOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYT1bbnVsbF07YS5wdXNoLmFwcGx5KGEsdCk7dmFyIG49bmV3KEZ1bmN0aW9uLmJpbmQuYXBwbHkoZSxhKSk7cmV0dXJuIHImJnUobixyLnByb3RvdHlwZSksbn0pLmFwcGx5KG51bGwsYXJndW1lbnRzKX1mdW5jdGlvbiBkKGUsdCl7aWYodCYmKCJvYmplY3QiPT10eXBlb2YgdHx8ImZ1bmN0aW9uIj09dHlwZW9mIHQpKXJldHVybiB0O2lmKHZvaWQgMCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiRGVyaXZlZCBjb25zdHJ1Y3RvcnMgbWF5IG9ubHkgcmV0dXJuIG9iamVjdCBvciB1bmRlZmluZWQiKTtyZXR1cm4gZnVuY3Rpb24oZSl7aWYodm9pZCAwPT09ZSl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiBlfShlKX1mdW5jdGlvbiBmKGUpe3ZhciB0PWMoKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgcixhPW8oZSk7aWYodCl7dmFyIG49byh0aGlzKS5jb25zdHJ1Y3RvcjtyPVJlZmxlY3QuY29uc3RydWN0KGEsYXJndW1lbnRzLG4pfWVsc2Ugcj1hLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gZCh0aGlzLHIpfX1mdW5jdGlvbiBoKGUsdCl7Zm9yKDshT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsdCkmJm51bGwhPT0oZT1vKGUpKTspO3JldHVybiBlfWZ1bmN0aW9uIHAoKXtyZXR1cm4gcD0idW5kZWZpbmVkIiE9dHlwZW9mIFJlZmxlY3QmJlJlZmxlY3QuZ2V0P1JlZmxlY3QuZ2V0LmJpbmQoKTpmdW5jdGlvbihlLHQscil7dmFyIGE9aChlLHQpO2lmKGEpe3ZhciBuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYSx0KTtyZXR1cm4gbi5nZXQ/bi5nZXQuY2FsbChhcmd1bWVudHMubGVuZ3RoPDM/ZTpyKTpuLnZhbHVlfX0scC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gdihlLHQpe3JldHVybiBmdW5jdGlvbihlKXtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBlfShlKXx8ZnVuY3Rpb24oZSx0KXt2YXIgcj1udWxsPT1lP251bGw6InVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXXx8ZVsiQEBpdGVyYXRvciJdO2lmKG51bGwhPXIpe3ZhciBhLG4saSxzLG89W10sdT0hMCxjPSExO3RyeXtpZihpPShyPXIuY2FsbChlKSkubmV4dCwwPT09dCl7aWYoT2JqZWN0KHIpIT09cilyZXR1cm47dT0hMX1lbHNlIGZvcig7ISh1PShhPWkuY2FsbChyKSkuZG9uZSkmJihvLnB1c2goYS52YWx1ZSksby5sZW5ndGghPT10KTt1PSEwKTt9Y2F0Y2gobCl7Yz0hMCxuPWx9ZmluYWxseXt0cnl7aWYoIXUmJm51bGwhPXIucmV0dXJuJiYocz1yLnJldHVybigpLE9iamVjdChzKSE9PXMpKXJldHVybn1maW5hbGx5e2lmKGMpdGhyb3cgbn19cmV0dXJuIG99fShlLHQpfHxtKGUsdCl8fGZ1bmN0aW9uKCl7dGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKX0oKX1mdW5jdGlvbiB5KGUpe3JldHVybiBmdW5jdGlvbihlKXtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBnKGUpfShlKXx8ZnVuY3Rpb24oZSl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJm51bGwhPWVbU3ltYm9sLml0ZXJhdG9yXXx8bnVsbCE9ZVsiQEBpdGVyYXRvciJdKXJldHVybiBBcnJheS5mcm9tKGUpfShlKXx8bShlKXx8ZnVuY3Rpb24oKXt0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKX0oKX1mdW5jdGlvbiBtKGUsdCl7aWYoZSl7aWYoInN0cmluZyI9PXR5cGVvZiBlKXJldHVybiBnKGUsdCk7dmFyIHI9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpLnNsaWNlKDgsLTEpO3JldHVybiJPYmplY3QiPT09ciYmZS5jb25zdHJ1Y3RvciYmKHI9ZS5jb25zdHJ1Y3Rvci5uYW1lKSwiTWFwIj09PXJ8fCJTZXQiPT09cj9BcnJheS5mcm9tKGUpOiJBcmd1bWVudHMiPT09cnx8L14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3Qocik/ZyhlLHQpOnZvaWQgMH19ZnVuY3Rpb24gZyhlLHQpeyhudWxsPT10fHx0PmUubGVuZ3RoKSYmKHQ9ZS5sZW5ndGgpO2Zvcih2YXIgcj0wLGE9bmV3IEFycmF5KHQpO3I8dDtyKyspYVtyXT1lW3JdO3JldHVybiBhfWZ1bmN0aW9uIGsoZSl7dmFyIHQ9ZnVuY3Rpb24oZSx0KXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiBlO3ZhciByPWVbU3ltYm9sLnRvUHJpbWl0aXZlXTtpZih2b2lkIDAhPT1yKXt2YXIgYT1yLmNhbGwoZSx0fHwiZGVmYXVsdCIpO2lmKCJvYmplY3QiIT10eXBlb2YgYSlyZXR1cm4gYTt0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpfXJldHVybigic3RyaW5nIj09PXQ/U3RyaW5nOk51bWJlcikoZSl9KGUsInN0cmluZyIpO3JldHVybiJzeW1ib2wiPT10eXBlb2YgdD90OlN0cmluZyh0KX12YXIgYj0idmlkZW8iLF89ImF1ZGlvIix3PSJtZXRhZGF0YSIseD0iYXZjIixTPSJoZXZjIixBPSJhYWMiLEQ9Imc3MTEwYSIsRT0iZzcxMTBtIixCPSJMQVJHRV9BVl9TSElGVCIsVD0iTEFSR0VfVklERU9fR0FQIixDPSJMQVJHRV9WSURFT19HQVBfQkVUV0VFTl9DSFVOSyIsVT0iTEFSR0VfQVVESU9fR0FQIixQPSJBVURJT19GSUxMRUQiLEk9IkFVRElPX0RST1BQRUQiLHo9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpLGkodGhpcywiaWQiLDEpLGkodGhpcywidHlwZSIsYiksaSh0aGlzLCJjb2RlY1R5cGUiLHgpLGkodGhpcywicGlkIiwtMSksaSh0aGlzLCJodmNDIix2b2lkIDApLGkodGhpcywiY29kZWMiLCIiKSxpKHRoaXMsInRpbWVzY2FsZSIsMCksaSh0aGlzLCJmb3JtYXRUaW1lc2NhbGUiLDApLGkodGhpcywic2VxdWVuY2VOdW1iZXIiLDApLGkodGhpcywiYmFzZU1lZGlhRGVjb2RlVGltZSIsMCksaSh0aGlzLCJiYXNlRHRzIiwwKSxpKHRoaXMsImR1cmF0aW9uIiwwKSxpKHRoaXMsIndhcm5pbmdzIixbXSksaSh0aGlzLCJzYW1wbGVzIixbXSksaSh0aGlzLCJwcHMiLFtdKSxpKHRoaXMsInNwcyIsW10pLGkodGhpcywidnBzIixbXSksaSh0aGlzLCJmcHNOdW0iLDApLGkodGhpcywiZnBzRGVuIiwwKSxpKHRoaXMsInNhclJhdGlvIixbXSksaSh0aGlzLCJ3aWR0aCIsMCksaSh0aGlzLCJoZWlnaHQiLDApLGkodGhpcywibmFsVW5pdFNpemUiLDQpLGkodGhpcywicHJlc2VudCIsITEpLGkodGhpcywiaXNWaWRlb0VuY3J5cHRpb24iLCExKSxpKHRoaXMsImlzQXVkaW9FbmNyeXB0aW9uIiwhMSksaSh0aGlzLCJpc1ZpZGVvIiwhMCksaSh0aGlzLCJraWQiLG51bGwpLGkodGhpcywicHNzaCIsbnVsbCksaSh0aGlzLCJleHQiLHZvaWQgMCl9cmV0dXJuIG4oZSxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5zZXF1ZW5jZU51bWJlcj10aGlzLndpZHRoPXRoaXMuaGVpZ2h0PXRoaXMuZnBzRGVuPXRoaXMuZnBzTnVtPXRoaXMuZHVyYXRpb249dGhpcy5iYXNlTWVkaWFEZWNvZGVUaW1lPXRoaXMudGltZXNjYWxlPTAsdGhpcy5jb2RlYz0iIix0aGlzLnByZXNlbnQ9ITEsdGhpcy5waWQ9LTEsdGhpcy5wcHM9W10sdGhpcy5zcHM9W10sdGhpcy52cHM9W10sdGhpcy5zYXJSYXRpbz1bXSx0aGlzLnNhbXBsZXM9W10sdGhpcy53YXJuaW5ncz1bXSx0aGlzLmh2Y0M9bnVsbH19LHtrZXk6ImV4aXN0Iix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiEhKHRoaXMucHBzLmxlbmd0aCYmdGhpcy5zcHMubGVuZ3RoJiZ0aGlzLmNvZGVjKX19LHtrZXk6Imhhc1NhbXBsZSIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuc2FtcGxlcy5sZW5ndGh9fSx7a2V5OiJpc0VuY3J5cHRpb24iLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzVmlkZW9FbmNyeXB0aW9ufX1dKSxlfSgpLE09ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpLGkodGhpcywiaWQiLDIpLGkodGhpcywidHlwZSIsXyksaSh0aGlzLCJjb2RlY1R5cGUiLEEpLGkodGhpcywicGlkIiwtMSksaSh0aGlzLCJjb2RlYyIsIiIpLGkodGhpcywic2VxdWVuY2VOdW1iZXIiLDApLGkodGhpcywic2FtcGxlRHVyYXRpb24iLDApLGkodGhpcywidGltZXNjYWxlIiwwKSxpKHRoaXMsImZvcm1hdFRpbWVzY2FsZSIsMCksaSh0aGlzLCJiYXNlTWVkaWFEZWNvZGVUaW1lIiwwKSxpKHRoaXMsImR1cmF0aW9uIiwwKSxpKHRoaXMsIndhcm5pbmdzIixbXSksaSh0aGlzLCJzYW1wbGVzIixbXSksaSh0aGlzLCJiYXNlRHRzIiwwKSxpKHRoaXMsInNhbXBsZVNpemUiLDE2KSxpKHRoaXMsInNhbXBsZVJhdGUiLDApLGkodGhpcywiY2hhbm5lbENvdW50IiwwKSxpKHRoaXMsIm9iamVjdFR5cGUiLDApLGkodGhpcywic2FtcGxlUmF0ZUluZGV4IiwwKSxpKHRoaXMsImNvbmZpZyIsW10pLGkodGhpcywicHJlc2VudCIsITEpLGkodGhpcywiaXNWaWRlb0VuY3J5cHRpb24iLCExKSxpKHRoaXMsImlzQXVkaW9FbmNyeXB0aW9uIiwhMSksaSh0aGlzLCJraWQiLG51bGwpLGkodGhpcywiZXh0Iix2b2lkIDApfXJldHVybiBuKGUsW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuc2VxdWVuY2VOdW1iZXI9MCx0aGlzLnRpbWVzY2FsZT0wLHRoaXMuc2FtcGxlRHVyYXRpb249MCx0aGlzLnNhbXBsZVJhdGU9MCx0aGlzLmNoYW5uZWxDb3VudD0wLHRoaXMuYmFzZU1lZGlhRGVjb2RlVGltZT0wLHRoaXMucHJlc2VudD0hMSx0aGlzLnBpZD0tMSx0aGlzLmNvZGVjPSIiLHRoaXMuc2FtcGxlcz1bXSx0aGlzLmNvbmZpZz1bXSx0aGlzLndhcm5pbmdzPVtdfX0se2tleToiZXhpc3QiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuISEodGhpcy5zYW1wbGVSYXRlJiZ0aGlzLmNoYW5uZWxDb3VudCYmdGhpcy5jb2RlYyYmdGhpcy5jb2RlY1R5cGU9PT1BKX19LHtrZXk6Imhhc1NhbXBsZSIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuc2FtcGxlcy5sZW5ndGh9fSx7a2V5OiJpc0VuY3J5cHRpb24iLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzQXVkaW9FbmNyeXB0aW9ufX1dKSxlfSgpLFI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsYSxuKXtyKHRoaXMsZSksaSh0aGlzLCJmbGFnIix7fSksaSh0aGlzLCJrZXlmcmFtZSIsITEpLGkodGhpcywiZ29wSWQiLDApLGkodGhpcywiZHVyYXRpb24iLDApLGkodGhpcywic2l6ZSIsMCksaSh0aGlzLCJ1bml0cyIsW10pLGkodGhpcywiY2hyb21hRm9ybWF0Iiw0MjApLHRoaXMub3JpZ2luUHRzPXRoaXMucHRzPXQsdGhpcy5vcmlnaW5EdHM9dGhpcy5kdHM9YSxuJiYodGhpcy51bml0cz1uKX1yZXR1cm4gbihlLFt7a2V5OiJjdHMiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB0cy10aGlzLmR0c319LHtrZXk6InNldFRvS2V5ZnJhbWUiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5rZXlmcmFtZT0hMCx0aGlzLmZsYWcuZGVwZW5kc09uPTIsdGhpcy5mbGFnLmlzTm9uU3luY1NhbXBsZT0wfX1dKSxlfSgpLE89bigoZnVuY3Rpb24gZSh0LGEsbixzKXtyKHRoaXMsZSksaSh0aGlzLCJkdXJhdGlvbiIsMTAyNCksaSh0aGlzLCJmbGFnIix7ZGVwZW5kc09uOjIsaXNOb25TeW5jU2FtcGxlOjB9KSxpKHRoaXMsImtleWZyYW1lIiwhMCksdGhpcy5vcmlnaW5QdHM9dGhpcy5wdHM9dGhpcy5kdHM9dCx0aGlzLmRhdGE9YSx0aGlzLnNpemU9YS5ieXRlTGVuZ3RoLHRoaXMuc2FtcGxlT2Zmc2V0PXMsbiYmKHRoaXMuZHVyYXRpb249bil9KSksTD1uKChmdW5jdGlvbiBlKHQsYSl7cih0aGlzLGUpLGkodGhpcywidGltZSIsMCksdGhpcy5kYXRhPXQsdGhpcy5vcmlnaW5QdHM9dGhpcy5wdHM9YX0pKSxWPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1mKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEpfShMKSxGPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1mKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEpfShMKSxOPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKSxpKHRoaXMsImlkIiwzKSxpKHRoaXMsInR5cGUiLHcpLGkodGhpcywidGltZXNjYWxlIiwwKSxpKHRoaXMsImZsdlNjcmlwdFNhbXBsZXMiLFtdKSxpKHRoaXMsInNlaVNhbXBsZXMiLFtdKX1yZXR1cm4gbihlLFt7a2V5OiJleGlzdCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hKCF0aGlzLmZsdlNjcmlwdFNhbXBsZXMubGVuZ3RoJiYhdGhpcy5zZWlTYW1wbGVzLmxlbmd0aHx8IXRoaXMudGltZXNjYWxlKX19LHtrZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMudGltZXNjYWxlPTAsdGhpcy5mbHZTY3JpcHRTYW1wbGVzPVtdLHRoaXMuc2VpU2FtcGxlcz1bXX19LHtrZXk6Imhhc1NhbXBsZSIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hKCF0aGlzLmZsdlNjcmlwdFNhbXBsZXMubGVuZ3RoJiYhdGhpcy5zZWlTYW1wbGVzLmxlbmd0aCl9fV0pLGV9KCksaj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7aWYocih0aGlzLGUpLGkodGhpcywiX2J5dGVzQXZhaWxhYmxlIix2b2lkIDApLGkodGhpcywiX2JpdHNBdmFpbGFibGUiLDApLGkodGhpcywiX3dvcmQiLDApLCF0KXRocm93IG5ldyBFcnJvcigiRXhwR29sb21iIGRhdGEgcGFyYW1zIGlzIHJlcXVpcmVkIik7dGhpcy5fZGF0YT10LHRoaXMuX2J5dGVzQXZhaWxhYmxlPXQuYnl0ZUxlbmd0aCx0aGlzLl9ieXRlc0F2YWlsYWJsZSYmdGhpcy5fbG9hZFdvcmQoKX1yZXR1cm4gbihlLFt7a2V5OiJfbG9hZFdvcmQiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fZGF0YS5ieXRlTGVuZ3RoLXRoaXMuX2J5dGVzQXZhaWxhYmxlLHQ9TWF0aC5taW4oNCx0aGlzLl9ieXRlc0F2YWlsYWJsZSk7aWYoMD09PXQpdGhyb3cgbmV3IEVycm9yKCJObyBieXRlcyBhdmFpbGFibGUiKTt2YXIgcj1uZXcgVWludDhBcnJheSg0KTtyLnNldCh0aGlzLl9kYXRhLnN1YmFycmF5KGUsZSt0KSksdGhpcy5fd29yZD1uZXcgRGF0YVZpZXcoci5idWZmZXIpLmdldFVpbnQzMigwKSx0aGlzLl9iaXRzQXZhaWxhYmxlPTgqdCx0aGlzLl9ieXRlc0F2YWlsYWJsZS09dH19LHtrZXk6InNraXBCaXRzIix2YWx1ZTpmdW5jdGlvbihlKXtpZih0aGlzLl9iaXRzQXZhaWxhYmxlPmUpdGhpcy5fd29yZDw8PWUsdGhpcy5fYml0c0F2YWlsYWJsZS09ZTtlbHNle2UtPXRoaXMuX2JpdHNBdmFpbGFibGU7dmFyIHQ9TWF0aC5mbG9vcihlLzgpO2UtPTgqdCx0aGlzLl9ieXRlc0F2YWlsYWJsZS09dCx0aGlzLl9sb2FkV29yZCgpLHRoaXMuX3dvcmQ8PD1lLHRoaXMuX2JpdHNBdmFpbGFibGUtPWV9fX0se2tleToicmVhZEJpdHMiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKGU+MzIpdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgcmVhZCBtb3JlIHRoYW4gMzIgYml0cyIpO3ZhciB0PU1hdGgubWluKHRoaXMuX2JpdHNBdmFpbGFibGUsZSkscj10aGlzLl93b3JkPj4+MzItdDtyZXR1cm4gdGhpcy5fYml0c0F2YWlsYWJsZS09dCx0aGlzLl9iaXRzQXZhaWxhYmxlPjA/dGhpcy5fd29yZDw8PXQ6dGhpcy5fYnl0ZXNBdmFpbGFibGU+MCYmdGhpcy5fbG9hZFdvcmQoKSwodD1lLXQpPjAmJnRoaXMuX2JpdHNBdmFpbGFibGU/cjw8dHx0aGlzLnJlYWRCaXRzKHQpOnJ9fSx7a2V5OiJza2lwTFoiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU7Zm9yKGU9MDtlPHRoaXMuX2JpdHNBdmFpbGFibGU7KytlKWlmKDAhPSh0aGlzLl93b3JkJjIxNDc0ODM2NDg+Pj5lKSlyZXR1cm4gdGhpcy5fd29yZDw8PWUsdGhpcy5fYml0c0F2YWlsYWJsZS09ZSxlO3JldHVybiB0aGlzLl9sb2FkV29yZCgpLGUrdGhpcy5za2lwTFooKX19LHtrZXk6InNraXBVRUciLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5za2lwQml0cygxK3RoaXMuc2tpcExaKCkpfX0se2tleToicmVhZFVFRyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnNraXBMWigpO3JldHVybiB0aGlzLnJlYWRCaXRzKGUrMSktMX19LHtrZXk6InJlYWRFRyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnJlYWRVRUcoKTtyZXR1cm4gMSZlPzErZT4+PjE6LTEqKGU+Pj4xKX19LHtrZXk6InJlYWRCb29sIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiAxPT09dGhpcy5yZWFkQml0cygxKX19LHtrZXk6InJlYWRVQnl0ZSIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZWFkQml0cyg4KX19LHtrZXk6InNraXBTY2FsaW5nTGlzdCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTgscj04LGE9MDthPGU7YSsrKTAhPT1yJiYocj0odCt0aGlzLnJlYWRFRygpKzI1NiklMjU2KSx0PTA9PT1yP3Q6cn19XSksZX0oKSxHPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtyKHRoaXMsZSksdGhpcy5uYW1lPXR8fCIiLHRoaXMuX3ByZWZpeD0iWyIuY29uY2F0KHRoaXMubmFtZSwiXSIpfXJldHVybiBuKGUsW3trZXk6Indhcm4iLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ7aWYoIWUuZGlzYWJsZWQpe2Zvcih2YXIgcj1hcmd1bWVudHMubGVuZ3RoLGE9bmV3IEFycmF5KHIpLG49MDtuPHI7bisrKWFbbl09YXJndW1lbnRzW25dOyh0PWNvbnNvbGUpLndhcm4uYXBwbHkodCxbdGhpcy5fcHJlZml4XS5jb25jYXQoYSkpfX19XSxbe2tleToiZW5hYmxlIix2YWx1ZTpmdW5jdGlvbigpe2UuZGlzYWJsZWQ9ITF9fSx7a2V5OiJkaXNhYmxlIix2YWx1ZTpmdW5jdGlvbigpe2UuZGlzYWJsZWQ9ITB9fV0pLGV9KCk7aShHLCJkaXNhYmxlZCIsITApO3ZhciBIPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKX1yZXR1cm4gbihlLG51bGwsW3trZXk6ImRlY29kZSIsdmFsdWU6ZnVuY3Rpb24odCl7Zm9yKHZhciByPVtdLGE9dCxuPTAsaT10Lmxlbmd0aDtuPGk7KWlmKGFbbl08MTI4KXIucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGFbbl0pKSwrK247ZWxzZXtpZihhW25dPDE5Mik7ZWxzZSBpZihhW25dPDIyNCl7aWYoZS5fY2hlY2tDb250aW51YXRpb24oYSxuLDEpKXt2YXIgcz0oMzEmYVtuXSk8PDZ8NjMmYVtuKzFdO2lmKHM+PTEyOCl7ci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoNjU1MzUmcykpLG4rPTI7Y29udGludWV9fX1lbHNlIGlmKGFbbl08MjQwKXtpZihlLl9jaGVja0NvbnRpbnVhdGlvbihhLG4sMikpe3ZhciBvPSgxNSZhW25dKTw8MTJ8KDYzJmFbbisxXSk8PDZ8NjMmYVtuKzJdO2lmKG8+PTIwNDgmJjU1Mjk2IT0oNjM0ODgmbykpe3IucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKDY1NTM1Jm8pKSxuKz0zO2NvbnRpbnVlfX19ZWxzZSBpZihhW25dPDI0OCYmZS5fY2hlY2tDb250aW51YXRpb24oYSxuLDMpKXt2YXIgdT0oNyZhW25dKTw8MTh8KDYzJmFbbisxXSk8PDEyfCg2MyZhW24rMl0pPDw2fDYzJmFbbiszXTtpZih1PjY1NTM2JiZ1PDExMTQxMTIpe3UtPTY1NTM2LHIucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHU+Pj4xMHw1NTI5NikpLHIucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKDEwMjMmdXw1NjMyMCkpLG4rPTQ7Y29udGludWV9fXIucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKDY1NTMzKSksKytufXJldHVybiByLmpvaW4oIiIpfX0se2tleToiX2NoZWNrQ29udGludWF0aW9uIix2YWx1ZTpmdW5jdGlvbihlLHQscil7dmFyIGE9ZTtpZih0K3I8YS5sZW5ndGgpe2Zvcig7ci0tOylpZigxMjghPSgxOTImYVsrK3RdKSlyZXR1cm4hMTtyZXR1cm4hMH1yZXR1cm4hMX19XSksZX0oKSxLPSJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93LHE9SyYmbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvY2FsZUxvd2VyQ2FzZSgpLFc9SyYmL14oKD8hY2hyb21lfGFuZHJvaWQpLikqc2FmYXJpLy50ZXN0KHEpLFg9SyYmcS5pbmNsdWRlcygiZmlyZWZveCIpLFk9SyYmcS5pbmNsdWRlcygiYW5kcm9pZCIpO2Z1bmN0aW9uIFooKXtmb3IodmFyIGU9YXJndW1lbnRzLmxlbmd0aCx0PW5ldyBBcnJheShlKSxyPTA7cjxlO3IrKyl0W3JdPWFyZ3VtZW50c1tyXTt0PXQuZmlsdGVyKEJvb2xlYW4pO3ZhciBhPW5ldyBVaW50OEFycmF5KHQucmVkdWNlKChmdW5jdGlvbihlLHQpe3JldHVybiBlK3QuYnl0ZUxlbmd0aH0pLDApKSxuPTA7cmV0dXJuIHQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7YS5zZXQoZSxuKSxuKz1lLmJ5dGVMZW5ndGh9KSksYX12YXIgUT1NYXRoLnBvdygyLDMyKTtmdW5jdGlvbiBKKGUpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTowO3JldHVybihlW3RdPDw4KSsoZVt0KzFdfHwwKX1mdW5jdGlvbiAkKGUpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTowO3JldHVybihlW3RdPDwyND4+PjApKyhlW3QrMV08PDE2KSsoZVt0KzJdPDw4KSsoZVt0KzNdfHwwKX1mdW5jdGlvbiBlZShlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06MDtyZXR1cm4gJChlLHQpKlErJChlLHQrNCl9ZnVuY3Rpb24gdGUoZSl7Zm9yKHZhciB0LHI9ImF2YzEuIixhPTA7YTwzO2ErKykodD1lW2FdLnRvU3RyaW5nKDE2KSkubGVuZ3RoPDImJih0PSIwIi5jb25jYXQodCkpLHIrPXQ7cmV0dXJuIHJ9ZnVuY3Rpb24gcmUoZSl7dmFyIHQ9IiI7aWYoZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Kz1mdW5jdGlvbihlKXtyZXR1cm4oIjAiK051bWJlcihlKS50b1N0cmluZygxNikpLnNsaWNlKC0yKS50b1VwcGVyQ2FzZSgpfShlKX0pKSx0Lmxlbmd0aDw9MzIpZm9yKHZhciByPTMyLXQubGVuZ3RoLGE9MDthPHI7YSsrKXQrPSIwIjtyZXR1cm4gdH1mdW5jdGlvbiBhZShlKXtpZighQXJyYXkuaXNBcnJheShlKSl7Zm9yKHZhciB0PVtdLHI9IiIsYT0wO2E8ZS5sZW5ndGg7YSsrKWElMiYmKHI9ZVthLTFdK2VbYV0sdC5wdXNoKHBhcnNlSW50KHIsMTYpKSxyPSIiKTtyZXR1cm4gdH1yZXR1cm4gZS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBwYXJzZUludChlLDE2KX0pKX12YXIgbmU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToicGFyc2VBbm5leEIiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmxlbmd0aCxyPTIsYT0wO251bGwhPT1lW3JdJiZ2b2lkIDAhPT1lW3JdJiYxIT09ZVtyXTspcisrO2lmKChhPSsrcisyKT49dClyZXR1cm5bXTtmb3IodmFyIG49W107YTx0Oylzd2l0Y2goZVthXSl7Y2FzZSAwOmlmKDAhPT1lW2EtMV0pe2ErPTI7YnJlYWt9aWYoMCE9PWVbYS0yXSl7YSsrO2JyZWFrfXIhPT1hLTImJm4ucHVzaChlLnN1YmFycmF5KHIsYS0yKSk7ZG97YSsrfXdoaWxlKDEhPT1lW2FdJiZhPHQpO2E9KHI9YSsxKSsyO2JyZWFrO2Nhc2UgMTppZigwIT09ZVthLTFdfHwwIT09ZVthLTJdKXthKz0zO2JyZWFrfXIhPT1hLTImJm4ucHVzaChlLnN1YmFycmF5KHIsYS0yKSksYT0ocj1hKzEpKzI7YnJlYWs7ZGVmYXVsdDphKz0zfXJldHVybiByPHQmJm4ucHVzaChlLnN1YmFycmF5KHIpKSxufX0se2tleToicGFyc2VBdmNDIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06NDtpZighKGUubGVuZ3RoPDQpKXtmb3IodmFyIHIsYT1lLmxlbmd0aCxuPVtdLGk9MDtpK3Q8YTspaWYocj0kKGUsaSksMz09PXQmJihyPj4+PTgpLGkrPXQscil7aWYoaStyPmEpYnJlYWs7bi5wdXNoKGUuc3ViYXJyYXkoaSxpK3IpKSxpKz1yfXJldHVybiBufX19LHtrZXk6InBhcnNlU0VJIix2YWx1ZTpmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj1lLmxlbmd0aCxhPXQ/MjoxLG49MCxpPTAscz0iIjsyNTU9PT1lW2FdOyluKz0yNTUsYSsrO2ZvcihuKz1lW2ErK107MjU1PT09ZVthXTspaSs9MjU1LGErKztpZihpKz1lW2ErK10sNT09PW4mJnI+YSsxNilmb3IodmFyIG89MDtvPDE2O28rKylzKz1lW2FdLnRvU3RyaW5nKDE2KSxhKys7cmV0dXJue3BheWxvYWQ6ZS5zdWJhcnJheShhKSx0eXBlOm4sc2l6ZTppLHV1aWQ6c319fSx7a2V5OiJyZW1vdmVFUEIiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmJ5dGVMZW5ndGgscj1bXSxhPTE7YTx0LTI7KTA9PT1lW2FdJiYwPT09ZVthKzFdJiYzPT09ZVthKzJdPyhyLnB1c2goYSsyKSxhKz0yKTphKys7aWYoIXIubGVuZ3RoKXJldHVybiBlO3ZhciBuPXQtci5sZW5ndGgsaT1uZXcgVWludDhBcnJheShuKSxzPTA7Zm9yKGE9MDthPG47cysrLGErKylzPT09clswXSYmKHMrKyxyLnNoaWZ0KCkpLGlbYV09ZVtzXTtyZXR1cm4gaX19XSksZX0oKSxpZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSl9cmV0dXJuIG4oZSxudWxsLFt7a2V5OiJwYXJzZUFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkIix2YWx1ZTpmdW5jdGlvbih0KXtpZighKHQubGVuZ3RoPDcpKXtmb3IodmFyIHIsYSxuPTErKDMmdFs0XSksaT1bXSxzPVtdLG89Nix1PTMxJnRbNV0sYz0wO2M8dTtjKyspaWYoYT10W29dPDw4fHRbbysxXSxvKz0yLGEpe3ZhciBsPXQuc3ViYXJyYXkobyxvK2EpO28rPWEsaS5wdXNoKGwpLHJ8fChyPWUucGFyc2VTUFMobmUucmVtb3ZlRVBCKGwpKSl9dmFyIGQsZj10W29dO28rKztmb3IodmFyIGg9MDtoPGY7aCsrKWQ9dFtvXTw8OHx0W28rMV0sbys9MixkJiYocy5wdXNoKHQuc3ViYXJyYXkobyxvK2QpKSxvKz1kKTtyZXR1cm57c3BzOnIsc3BzQXJyOmkscHBzQXJyOnMsbmFsVW5pdFNpemU6bn19fX0se2tleToicGFyc2VTUFMiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBqKGUpO3QucmVhZFVCeXRlKCk7dmFyIHI9dC5yZWFkVUJ5dGUoKSxhPXQucmVhZFVCeXRlKCksbj10LnJlYWRVQnl0ZSgpO3Quc2tpcFVFRygpO3ZhciBpPTQyMDtpZigxMDA9PT1yfHwxMTA9PT1yfHwxMjI9PT1yfHwyNDQ9PT1yfHw0ND09PXJ8fDgzPT09cnx8ODY9PT1yfHwxMTg9PT1yfHwxMjg9PT1yfHwxMzg9PT1yfHwxNDQ9PT1yKXt2YXIgcz10LnJlYWRVRUcoKTtpZihzPD0zJiYoaT1bMCw0MjAsNDIyLDQ0NF1bc10pLDM9PT1zJiZ0LnNraXBCaXRzKDEpLHQuc2tpcFVFRygpLHQuc2tpcFVFRygpLHQuc2tpcEJpdHMoMSksdC5yZWFkQm9vbCgpKWZvcih2YXIgbz0zIT09cz84OjEyLHU9MDt1PG87dSsrKXQucmVhZEJvb2woKSYmKHU8Nj90LnNraXBTY2FsaW5nTGlzdCgxNik6dC5za2lwU2NhbGluZ0xpc3QoNjQpKX10LnNraXBVRUcoKTt2YXIgYz10LnJlYWRVRUcoKTtpZigwPT09Yyl0LnJlYWRVRUcoKTtlbHNlIGlmKDE9PT1jKXt0LnNraXBCaXRzKDEpLHQuc2tpcFVFRygpLHQuc2tpcFVFRygpO2Zvcih2YXIgbD10LnJlYWRVRUcoKSxkPTA7ZDxsO2QrKyl0LnNraXBVRUcoKX10LnNraXBVRUcoKSx0LnNraXBCaXRzKDEpO3ZhciBmPXQucmVhZFVFRygpLGg9dC5yZWFkVUVHKCkscD10LnJlYWRCaXRzKDEpOzA9PT1wJiZ0LnNraXBCaXRzKDEpLHQuc2tpcEJpdHMoMSk7dmFyIHYseSxtLGcsayxiPTAsXz0wLHc9MCx4PTA7aWYodC5yZWFkQm9vbCgpJiYoYj10LnJlYWRVRUcoKSxfPXQucmVhZFVFRygpLHc9dC5yZWFkVUVHKCkseD10LnJlYWRVRUcoKSksdC5yZWFkQm9vbCgpKXtpZih0LnJlYWRCb29sKCkpc3dpdGNoKHQucmVhZFVCeXRlKCkpe2Nhc2UgMTp2PVsxLDFdO2JyZWFrO2Nhc2UgMjp2PVsxMiwxMV07YnJlYWs7Y2FzZSAzOnY9WzEwLDExXTticmVhaztjYXNlIDQ6dj1bMTYsMTFdO2JyZWFrO2Nhc2UgNTp2PVs0MCwzM107YnJlYWs7Y2FzZSA2OnY9WzI0LDExXTticmVhaztjYXNlIDc6dj1bMjAsMTFdO2JyZWFrO2Nhc2UgODp2PVszMiwxMV07YnJlYWs7Y2FzZSA5OnY9WzgwLDMzXTticmVhaztjYXNlIDEwOnY9WzE4LDExXTticmVhaztjYXNlIDExOnY9WzE1LDExXTticmVhaztjYXNlIDEyOnY9WzY0LDMzXTticmVhaztjYXNlIDEzOnY9WzE2MCw5OV07YnJlYWs7Y2FzZSAxNDp2PVs0LDNdO2JyZWFrO2Nhc2UgMTU6dj1bMywyXTticmVhaztjYXNlIDE2OnY9WzIsMV07YnJlYWs7Y2FzZSAyNTU6dj1bdC5yZWFkVUJ5dGUoKTw8OHx0LnJlYWRVQnl0ZSgpLHQucmVhZFVCeXRlKCk8PDh8dC5yZWFkVUJ5dGUoKV19aWYodC5yZWFkQm9vbCgpJiZ0LnJlYWRCb29sKCksdC5yZWFkQm9vbCgpJiYodC5yZWFkQml0cyg0KSx0LnJlYWRCb29sKCkmJnQucmVhZEJpdHMoMjQpKSx0LnJlYWRCb29sKCkmJih0LnJlYWRVRUcoKSx0LnJlYWRVRUcoKSksdC5yZWFkQm9vbCgpKXt2YXIgUz10LnJlYWRCaXRzKDMyKSxBPXQucmVhZEJpdHMoMzIpO3k9dC5yZWFkQm9vbCgpLGs9KG09QSkvKGc9MipTKX19cmV0dXJue2NvZGVjOnRlKGUuc3ViYXJyYXkoMSw0KSkscHJvZmlsZUlkYzpyLHByb2ZpbGVDb21wYXRpYmlsaXR5OmEsbGV2ZWxJZGM6bixjaHJvbWFGb3JtYXQ6aSx3aWR0aDpNYXRoLmNlaWwoMTYqKGYrMSktMiooYitfKSksaGVpZ2h0OigyLXApKihoKzEpKjE2LShwPzI6NCkqKHcreCksc2FyUmF0aW86dixmcHNOdW06bSxmcHNEZW46ZyxmcHM6ayxmaXhlZEZyYW1lOnl9fX1dKSxlfSgpLHNlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKX1yZXR1cm4gbihlLG51bGwsW3trZXk6ImdldFJhdGVJbmRleEJ5UmF0ZSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuRlJFUS5pbmRleE9mKHQpfX0se2tleToicGFyc2VBRFRTIix2YWx1ZTpmdW5jdGlvbih0LHIpe2Zvcih2YXIgYT10Lmxlbmd0aCxuPTA7bisyPGEmJigyNTUhPT10W25dfHwyNDAhPSgyNDYmdFtuKzFdKSk7KW4rKztpZighKG4+PWEpKXt2YXIgaT1uLHM9W10sbz0oNjAmdFtuKzJdKT4+PjIsdT1lLkZSRVFbb107aWYoIXUpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHNhbXBsaW5nIGluZGV4OiAiLmNvbmNhdChvKSk7Zm9yKHZhciBjLGwsZD0xKygoMTkyJnRbbisyXSk+Pj42KSxmPSgxJnRbbisyXSk8PDJ8KDE5MiZ0W24rM10pPj4+NixoPWUuX2dldENvbmZpZyhvLGYsZCkscD1oLmNvbmZpZyx2PWguY29kZWMseT0wLG09ZS5nZXRGcmFtZUR1cmF0aW9uKHUpO24rNzxhOylpZigyNTU9PT10W25dJiYyNDA9PSgyNDYmdFtuKzFdKSl7aWYoYS1uPChsPSgzJnRbbiszXSk8PDExfHRbbis0XTw8M3woMjI0JnRbbis1XSk+PjUpKWJyZWFrO2M9MiooMSZ+dFtuKzFdKSxzLnB1c2goe3B0czpyK3kqbSxkYXRhOnQuc3ViYXJyYXkobis3K2MsbitsKX0pLHkrKyxuKz1sfWVsc2UgbisrO3JldHVybntza2lwOmkscmVtYWluaW5nOm4+PWE/dm9pZCAwOnQuc3ViYXJyYXkobiksZnJhbWVzOnMsc2FtcGxpbmdGcmVxdWVuY3lJbmRleDpvLHNhbXBsZVJhdGU6dSxvYmplY3RUeXBlOmQsY2hhbm5lbENvdW50OmYsY29kZWM6dixjb25maWc6cCxvcmlnaW5Db2RlYzoibXA0YS40MC4iLmNvbmNhdChkKX19fX0se2tleToicGFyc2VBdWRpb1NwZWNpZmljQ29uZmlnIix2YWx1ZTpmdW5jdGlvbih0KXtpZih0Lmxlbmd0aCl7dmFyIHI9dFswXT4+PjMsYT0oNyZ0WzBdKTw8MXx0WzFdPj4+NyxuPSgxMjAmdFsxXSk+Pj4zLGk9ZS5GUkVRW2FdO2lmKGkpe3ZhciBzPWUuX2dldENvbmZpZyhhLG4scik7cmV0dXJue3NhbXBsaW5nRnJlcXVlbmN5SW5kZXg6YSxzYW1wbGVSYXRlOmksb2JqZWN0VHlwZTpyLGNoYW5uZWxDb3VudDpuLGNvbmZpZzpzLmNvbmZpZyxjb2RlYzpzLmNvZGVjLG9yaWdpbkNvZGVjOiJtcDRhLjQwLiIuY29uY2F0KHIpfX19fX0se2tleToiZ2V0RnJhbWVEdXJhdGlvbiIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjllNDtyZXR1cm4gMTAyNCp0L2V9fSx7a2V5OiJfZ2V0Q29uZmlnIix2YWx1ZTpmdW5jdGlvbihlLHQscil7dmFyIGEsbixpPVtdO3JldHVybiBYP2U+PTY/KGE9NSxuPWUtMyk6KGE9MixuPWUpOlk/KGE9MixuPWUpOihhPTI9PT1yfHw1PT09cj9yOjUsbj1lLGU+PTY/bj1lLTM6MT09PXQmJihhPTIsbj1lKSksaVswXT1hPDwzLGlbMF18PSgxNCZlKT4+MSxpWzFdPSgxJmUpPDw3LGlbMV18PXQ8PDMsNT09PWEmJihpWzFdfD0oMTQmbik+PjEsaVsyXT0oMSZuKTw8NyxpWzJdfD04LGlbM109MCkse2NvbmZpZzppLGNvZGVjOiJtcDRhLjQwLiIuY29uY2F0KGEpfX19LHtrZXk6ImdldFNpbGVudEZyYW1lIix2YWx1ZTpmdW5jdGlvbihlLHQpe2lmKCJtcDRhLjQwLjIiPT09ZSl7aWYoMT09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFswLDIwMCwwLDEyOCwzNSwxMjhdKTtpZigyPT09dClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzMzLDAsNzMsMTQ0LDIsMjUsMCwzNSwxMjhdKTtpZigzPT09dClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzAsMjAwLDAsMTI4LDMyLDEzMiwxLDM4LDY0LDgsMTAwLDAsMTQyXSk7aWYoND09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFswLDIwMCwwLDEyOCwzMiwxMzIsMSwzOCw2NCw4LDEwMCwwLDEyOCw0NCwxMjgsOCwyLDU2XSk7aWYoNT09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFswLDIwMCwwLDEyOCwzMiwxMzIsMSwzOCw2NCw4LDEwMCwwLDEzMCw0OCw0LDE1MywwLDMzLDE0NCwyLDU2XSk7aWYoNj09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFswLDIwMCwwLDEyOCwzMiwxMzIsMSwzOCw2NCw4LDEwMCwwLDEzMCw0OCw0LDE1MywwLDMzLDE0NCwyLDAsMTc4LDAsMzIsOCwyMjRdKX1lbHNle2lmKDE9PT10KXJldHVybiBuZXcgVWludDhBcnJheShbMSw2NCwzNCwxMjgsMTYzLDc4LDIzMCwxMjgsMTg2LDgsMCwwLDAsMjgsNiwyNDEsMTkzLDEwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDk0XSk7aWYoMj09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFsxLDY0LDM0LDEyOCwxNjMsOTQsMjMwLDEyOCwxODYsOCwwLDAsMCwwLDE0OSwwLDYsMjQxLDE2MSwxMCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5NF0pO2lmKDM9PT10KXJldHVybiBuZXcgVWludDhBcnJheShbMSw2NCwzNCwxMjgsMTYzLDk0LDIzMCwxMjgsMTg2LDgsMCwwLDAsMCwxNDksMCw2LDI0MSwxNjEsMTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTRdKX19fV0pLGV9KCk7aShzZSwiRlJFUSIsWzk2ZTMsODgyMDAsNjRlMyw0OGUzLDQ0MTAwLDMyZTMsMjRlMywyMjA1MCwxNmUzLDEyZTMsMTEwMjUsOGUzLDczNTBdKTt2YXIgb2U9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToicGFyc2VIRVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTp7fTtpZighKHQubGVuZ3RoPDIzKSl7cj1yfHx7fTtmb3IodmFyIGEsbixpLHMsbyx1PTErKDMmdFsyMV0pLGM9W10sbD1bXSxkPVtdLGY9MjMsaD10WzIyXSxwPTA7cDxoO3ArKyl7aT02MyZ0W2ZdLHM9dFtmKzFdPDw4fHRbZisyXSxmKz0zO2Zvcih2YXIgdj0wO3Y8czt2KyspaWYobz10W2ZdPDw4fHRbZisxXSxmKz0yLG8pe3N3aXRjaChpKXtjYXNlIDMyOnZhciB5PXQuc3ViYXJyYXkoZixmK28pO2F8fChhPWUucGFyc2VWUFMobmUucmVtb3ZlRVBCKHkpLHIpKSxkLnB1c2goeSk7YnJlYWs7Y2FzZSAzMzp2YXIgbT10LnN1YmFycmF5KGYsZitvKTtufHwobj1lLnBhcnNlU1BTKG5lLnJlbW92ZUVQQihtKSxyKSksYy5wdXNoKG0pO2JyZWFrO2Nhc2UgMzQ6bC5wdXNoKHQuc3ViYXJyYXkoZixmK28pKX1mKz1vfX1yZXR1cm57aHZjQzpyLHNwczpuLHNwc0FycjpjLHBwc0FycjpsLHZwc0FycjpkLG5hbFVuaXRTaXplOnV9fX19LHtrZXk6InBhcnNlVlBTIix2YWx1ZTpmdW5jdGlvbih0LHIpe3I9cnx8e307dmFyIGE9bmV3IGoodCk7YS5yZWFkVUJ5dGUoKSxhLnJlYWRVQnl0ZSgpLGEucmVhZEJpdHMoMTIpO3ZhciBuPWEucmVhZEJpdHMoMyk7cmV0dXJuIHIubnVtVGVtcG9yYWxMYXllcnM9TWF0aC5tYXgoci5udW1UZW1wb3JhbExheWVyc3x8MCxuKzEpLGEucmVhZEJpdHMoMTcpLGUuX3BhcnNlUHJvZmlsZVRpZXJMZXZlbChhLG4scikscn19LHtrZXk6InBhcnNlU1BTIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e307cj1yfHx7fTt2YXIgYT1uZXcgaih0KTthLnJlYWRVQnl0ZSgpLGEucmVhZFVCeXRlKCksYS5yZWFkQml0cyg0KTt2YXIgbj1hLnJlYWRCaXRzKDMpO3IubnVtVGVtcG9yYWxMYXllcnM9TWF0aC5tYXgobisxLHIubnVtVGVtcG9yYWxMYXllcnN8fDApLHIudGVtcG9yYWxJZE5lc3RlZD1hLnJlYWRCaXRzKDEpLGUuX3BhcnNlUHJvZmlsZVRpZXJMZXZlbChhLG4sciksYS5yZWFkVUVHKCk7dmFyIGk9ci5jaHJvbWFGb3JtYXRJZGM9YS5yZWFkVUVHKCkscz00MjA7aTw9MyYmKHM9WzAsNDIwLDQyMiw0NDRdW2ldKTt2YXIgbz0wOzM9PT1pJiYobz1hLnJlYWRCaXRzKDEpKTt2YXIgdSxjLGwsZCxmPWEucmVhZFVFRygpLGg9YS5yZWFkVUVHKCkscD1hLnJlYWRCaXRzKDEpO2lmKDE9PT1wJiYodT1hLnJlYWRVRUcoKSxjPWEucmVhZFVFRygpLGw9YS5yZWFkVUVHKCksZD1hLnJlYWRVRUcoKSksci5iaXREZXB0aEx1bWFNaW51czg9YS5yZWFkVUVHKCksci5iaXREZXB0aENocm9tYU1pbnVzOD1hLnJlYWRVRUcoKSwxPT09cCl7dmFyIHY9MSE9PWkmJjIhPT1pfHwwIT09bz8xOjIseT0xPT09aSYmMD09PW8/MjoxO2YtPXYqKGMrdSksaC09eSooZCtsKX1yZXR1cm57Y29kZWM6ImhldjEuMS42Lkw5My5CMCIsd2lkdGg6ZixoZWlnaHQ6aCxjaHJvbWFGb3JtYXQ6cyxodmNDOnJ9fX0se2tleToiX3BhcnNlUHJvZmlsZVRpZXJMZXZlbCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBhPXIuZ2VuZXJhbFRpZXJGbGFnfHwwO3IuZ2VuZXJhbFByb2ZpbGVTcGFjZT1lLnJlYWRCaXRzKDIpLHIuZ2VuZXJhbFRpZXJGbGFnPU1hdGgubWF4KGUucmVhZEJpdHMoMSksYSksci5nZW5lcmFsUHJvZmlsZUlkYz1NYXRoLm1heChlLnJlYWRCaXRzKDUpLHIuZ2VuZXJhbFByb2ZpbGVJZGN8fDApLHIuZ2VuZXJhbFByb2ZpbGVDb21wYXRpYmlsaXR5RmxhZ3M9ZS5yZWFkQml0cygzMiksci5nZW5lcmFsQ29uc3RyYWludEluZGljYXRvckZsYWdzPVtlLnJlYWRCaXRzKDgpLGUucmVhZEJpdHMoOCksZS5yZWFkQml0cyg4KSxlLnJlYWRCaXRzKDgpLGUucmVhZEJpdHMoOCksZS5yZWFkQml0cyg4KV07dmFyIG49ZS5yZWFkQml0cyg4KTthPHIuZ2VuZXJhbFRpZXJGbGFnP3IuZ2VuZXJhbExldmVsSWRjPW46ci5nZW5lcmFsTGV2ZWxJZGM9TWF0aC5tYXgobixyLmdlbmVyYWxMZXZlbElkY3x8MCk7Zm9yKHZhciBpPVtdLHM9W10sbz0wO288dDtvKyspaVtvXT1lLnJlYWRCaXRzKDEpLHNbb109ZS5yZWFkQml0cygxKTt0PjAmJmUucmVhZEJpdHMoMiooOC10KSk7Zm9yKHZhciB1PTA7dTx0O3UrKykwIT09aVt1XSYmKGUucmVhZEJpdHMoMiksZS5yZWFkQml0cygxKSxlLnJlYWRCaXRzKDUpLGUucmVhZEJpdHMoMTYpLGUucmVhZEJpdHMoMTYpLGUucmVhZEJpdHMoNCksZS5yZWFkQml0cygxNiksZS5yZWFkQml0cygxNiksZS5yZWFkQml0cygxMikpLDAhPT1zW3VdJiZlLnJlYWRCaXRzKDgpfX1dKSxlfSgpLHVlPTFlMyxjZT01ZTMsbGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsYSxuKXtyKHRoaXMsZSksdGhpcy52aWRlb1RyYWNrPXQsdGhpcy5hdWRpb1RyYWNrPWEsdGhpcy5tZXRhZGF0YVRyYWNrPW4sdGhpcy5fYmFzZUR0cz0tMSx0aGlzLl9iYXNlRHRzSW5pdGVkPSExLHRoaXMuX2F1ZGlvTmV4dFB0cz12b2lkIDAsdGhpcy5fdmlkZW9OZXh0RHRzPXZvaWQgMCx0aGlzLl9hdWRpb1RpbWVzdGFtcEJyZWFrPTAsdGhpcy5fdmlkZW9UaW1lc3RhbXBCcmVhaz0wLHRoaXMuX2xhc3RWaWRlb0R1cmF0aW9uPTAsdGhpcy5fa2V5RnJhbWVJbk5leHRDaHVuaz0hMSx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25HYXBEb3Q9LTEvMCx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25PdmVybGFwRG90PS0xLzAsdGhpcy5fbGFzdEF1ZGlvRXhjZXB0aW9uTGFyZ2VHYXBEb3Q9LTEvMCx0aGlzLl9sYXN0VmlkZW9FeGNlcHRpb25MYXJnZUdhcERvdD0tMS8wLHRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkNodW5rRmlyc3REdHNEb3Q9LTEvMH1yZXR1cm4gbihlLFt7a2V5OiJmaXgiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTowLHI9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0mJmFyZ3VtZW50c1sxXSxhPSEoYXJndW1lbnRzLmxlbmd0aD4yJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0pfHxhcmd1bWVudHNbMl07dD1NYXRoLnJvdW5kKDFlMyp0KTt2YXIgbj10aGlzLnZpZGVvVHJhY2ssaT10aGlzLmF1ZGlvVHJhY2s7IXImJmF8fCh0aGlzLl92aWRlb0xhc3RTYW1wbGU9bnVsbCx0aGlzLl9hdWRpb05leHRQdHM9dm9pZCAwLHRoaXMuX3ZpZGVvTmV4dER0cz12b2lkIDAsdGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhaz0wLHRoaXMuX3ZpZGVvVGltZXN0YW1wQnJlYWs9MCx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25HYXBEb3Q9LTEvMCx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25PdmVybGFwRG90PS0xLzAsdGhpcy5fbGFzdEF1ZGlvRXhjZXB0aW9uTGFyZ2VHYXBEb3Q9LTEvMCx0aGlzLl9sYXN0VmlkZW9FeGNlcHRpb25MYXJnZUdhcERvdD0tMS8wLHRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkNodW5rRmlyc3REdHNEb3Q9LTEvMCksciYmIWEmJih0aGlzLl9iYXNlRHRzSW5pdGVkPSExKSx0aGlzLl9iYXNlRHRzSW5pdGVkfHx0aGlzLl9jYWxjdWxhdGVCYXNlRHRzKGksbiksIWEmJnQmJih0aGlzLl9hdWRpb05leHRQdHM9dGhpcy5fdmlkZW9OZXh0RHRzPXQpO3ZhciBzPXRoaXMuX2Jhc2VEdHNJbml0ZWQmJih0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrfHwhdGhpcy52aWRlb1RyYWNrLmV4aXN0KCkpJiYodGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVha3x8IXRoaXMuYXVkaW9UcmFjay5leGlzdCgpKTtpZihzJiZ0aGlzLl9yZXNldEJhc2VEdHNXaGVuU3RyZWFtQnJlYWtlZCgpLHRoaXMuX2ZpeEF1ZGlvKGkpLHRoaXMuX2tleUZyYW1lSW5OZXh0Q2h1bms9ITEsdGhpcy5fZml4VmlkZW8obiksdGhpcy5tZXRhZGF0YVRyYWNrLmV4aXN0KCkpe3ZhciBvPXRoaXMubWV0YWRhdGFUcmFjay50aW1lc2NhbGU7dGhpcy5tZXRhZGF0YVRyYWNrLnNlaVNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24odCl7dC5wdHM9dC5vcmlnaW5QdHMtZS5fYmFzZUR0cyx0LnRpbWU9TWF0aC5tYXgoMCx0LnB0cykvb30pKSx0aGlzLm1ldGFkYXRhVHJhY2suZmx2U2NyaXB0U2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbih0KXt0LnB0cz10Lm9yaWdpblB0cy1lLl9iYXNlRHRzLHQudGltZT1NYXRoLm1heCgwLHQucHRzKS9vfSkpfW4uc2FtcGxlcy5sZW5ndGgmJihuLmJhc2VNZWRpYURlY29kZVRpbWU9bi5zYW1wbGVzWzBdLmR0cyksaS5zYW1wbGVzLmxlbmd0aCYmKGkuYmFzZU1lZGlhRGVjb2RlVGltZT1pLnNhbXBsZXNbMF0ucHRzKmkudGltZXNjYWxlLzFlMyl9fSx7a2V5OiJfZml4VmlkZW8iLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1lLnNhbXBsZXM7aWYoci5sZW5ndGgpe3ZhciBhO2lmKHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS5kdHMtPXQuX2Jhc2VEdHMsZS5wdHMtPXQuX2Jhc2VEdHMsZS5rZXlmcmFtZSYmKHQuX2tleUZyYW1lSW5OZXh0Q2h1bms9ITApfSkpLGUuZnBzTnVtJiZlLmZwc0RlbilhPWUudGltZXNjYWxlKihlLmZwc0Rlbi9lLmZwc051bSk7ZWxzZSBpZihlLmxlbmd0aD4xKXt2YXIgbj1lLnNhbXBsZXNbMF0saT1lLnNhbXBsZXNbci5sZW5ndGgtMV07YT1NYXRoLmZsb29yKChpLmR0cy1uLmR0cykvKHIubGVuZ3RoLTEpKX1lbHNlIGE9dGhpcy5fbGFzdFZpZGVvRHVyYXRpb258fDQwO3ZhciBzPXIucG9wKCk7aWYodGhpcy5fdmlkZW9MYXN0U2FtcGxlJiZyLnVuc2hpZnQodGhpcy5fdmlkZW9MYXN0U2FtcGxlKSx0aGlzLl92aWRlb0xhc3RTYW1wbGU9cyxyLmxlbmd0aCl7aWYodm9pZCAwPT09dGhpcy5fdmlkZW9OZXh0RHRzKXt2YXIgbz1yWzBdO3RoaXMuX3ZpZGVvTmV4dER0cz1vLmR0c312YXIgdT1yLmxlbmd0aCxjPTAsbD1yWzBdLGQ9dGhpcy5fdmlkZW9OZXh0RHRzLWwuZHRzO2lmKE1hdGguYWJzKGQpPjIwMCl7dmFyIGY7aWYoTWF0aC5hYnMobC5kdHMtdGhpcy5fbGFzdFZpZGVvRXhjZXB0aW9uQ2h1bmtGaXJzdER0c0RvdCk+NWUzKXRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkNodW5rRmlyc3REdHNEb3Q9bC5kdHMsZS53YXJuaW5ncy5wdXNoKHt0eXBlOkMsbmV4dER0czp0aGlzLl92aWRlb05leHREdHMsZmlyc3RTYW1wbGVEdHM6bC5kdHMsbmV4dFNhbXBsZUR0czpudWxsPT09KGY9clsxXSl8fHZvaWQgMD09PWY/dm9pZCAwOmYuZHRzLHNhbXBsZUR1cmF0aW9uOmR9KTt0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrPj01Pyh0aGlzLl92aWRlb05leHREdHM9bC5kdHMsdGhpcy5fdmlkZW9UaW1lc3RhbXBCcmVhaz0wKToobC5kdHMrPWQsbC5wdHMrPWQsdGhpcy5hdWRpb1RyYWNrLmV4aXN0KCl8fCh0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrPTEpKX1mb3IodmFyIGg9MDtoPHU7aCsrKXt2YXIgcD1yW2hdLmR0cyx2PXJbaCsxXTsoKGM9aDx1LTE/di5kdHMtcDpzP3MuZHRzLXA6YSk+MWUzfHxjPDApJiYodGhpcy5fdmlkZW9UaW1lc3RhbXBCcmVhaysrLE1hdGguYWJzKHAtdGhpcy5fbGFzdFZpZGVvRXhjZXB0aW9uTGFyZ2VHYXBEb3QpPjVlMyYmKHRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkxhcmdlR2FwRG90PXAsZS53YXJuaW5ncy5wdXNoKHt0eXBlOlQsdGltZTpwL2UudGltZXNjYWxlLGR0czpwLG9yaWdpbkR0czpyW2hdLm9yaWdpbkR0cyxuZXh0RHRzOnRoaXMuX3ZpZGVvTmV4dER0cyxzYW1wbGVEdXJhdGlvbjpjLHJlZlNhbXBsZUR1cmF0aW9uOmF9KSksYz1hKSxyW2hdLmR1cmF0aW9uPWMsdGhpcy5fdmlkZW9OZXh0RHRzKz1jLHRoaXMuX2xhc3RWaWRlb0R1cmF0aW9uPWN9fX19fSx7a2V5OiJfZml4QXVkaW8iLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1lLnNhbXBsZXM7ci5sZW5ndGgmJihyLmZvckVhY2goKGZ1bmN0aW9uKGUpe2UuZHRzPWUucHRzLT10Ll9iYXNlRHRzfSkpLHRoaXMuX2RvRml4QXVkaW9JbnRlcm5hbChlLHIsMWUzKSl9fSx7a2V5OiJfY2FsY3VsYXRlQmFzZUR0cyIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgcj1lLnNhbXBsZXMsYT10LnNhbXBsZXM7aWYoIXIubGVuZ3RoJiYhYS5sZW5ndGgpcmV0dXJuITE7dmFyIG49MS8wLGk9MS8wO3IubGVuZ3RoJiYoZS5iYXNlRHRzPW49clswXS5wdHMpLGEubGVuZ3RoJiYodC5iYXNlRHRzPWk9YVswXS5kdHMpLHRoaXMuX2Jhc2VEdHM9TWF0aC5taW4obixpKTt2YXIgcz1pLW47cmV0dXJuIE51bWJlci5pc0Zpbml0ZShzKSYmTWF0aC5hYnMocyk+NTAwJiZ0Lndhcm5pbmdzLnB1c2goe3R5cGU6Qix2aWRlb0Jhc2VEdHM6aSxhdWRpb0Jhc2VQdHM6bixiYXNlRHRzOnRoaXMuX2Jhc2VEdHMsZGVsdGE6c30pLHRoaXMuX2Jhc2VEdHNJbml0ZWQ9ITAsITB9fSx7a2V5OiJfcmVzZXRCYXNlRHRzV2hlblN0cmVhbUJyZWFrZWQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fY2FsY3VsYXRlQmFzZUR0cyh0aGlzLmF1ZGlvVHJhY2ssdGhpcy52aWRlb1RyYWNrKSYmKHRoaXMuYXVkaW9UcmFjay5leGlzdCgpP3RoaXMudmlkZW9UcmFjay5leGlzdCgpP3RoaXMuX2Jhc2VEdHMtPU1hdGgubWluKHRoaXMuX2F1ZGlvTmV4dFB0cyx0aGlzLl92aWRlb05leHREdHMpOnRoaXMuX2Jhc2VEdHMtPXRoaXMuX2F1ZGlvTmV4dFB0czp0aGlzLl9iYXNlRHRzLT10aGlzLl92aWRlb05leHREdHMsdGhpcy5fdmlkZW9UaW1lc3RhbXBCcmVhaz0wLHRoaXMuX2F1ZGlvVGltZXN0YW1wQnJlYWs9MCl9fSx7a2V5OiJfZG9GaXhBdWRpb0ludGVybmFsIix2YWx1ZTpmdW5jdGlvbihlLHQscil7ZS5zYW1wbGVEdXJhdGlvbnx8KGUuc2FtcGxlRHVyYXRpb249ZS5jb2RlY1R5cGU9PT1BP3NlLmdldEZyYW1lRHVyYXRpb24oZS50aW1lc2NhbGUscik6dGhpcy5fZ2V0RzcxMUR1cmF0aW9uKGUpKTt2YXIgYT1lLnNhbXBsZUR1cmF0aW9uLG49ZS5jb2RlY1R5cGU9PT1BPzEwMjQ6YSplLnRpbWVzY2FsZS8xZTM7aWYodm9pZCAwPT09dGhpcy5fYXVkaW9OZXh0UHRzKXt2YXIgaT10WzBdO3RoaXMuX2F1ZGlvTmV4dFB0cz1pLnB0c31mb3IodmFyIHM9MDtzPHQubGVuZ3RoO3MrKyl7dmFyIG89dGhpcy5fYXVkaW9OZXh0UHRzLHU9dFtzXSxjPXUucHRzLW87aWYoMD09PXMmJnRoaXMuX2F1ZGlvVGltZXN0YW1wQnJlYWs+PTUmJnRoaXMuX2tleUZyYW1lSW5OZXh0Q2h1bmsmJihvPXRoaXMuX2F1ZGlvTmV4dFB0cz11LmR0cyxjPTAsdGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhaz0wKSwhdGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhayYmYz49MyphJiZjPD11ZSYmIVcpe3ZhciBsPXRoaXMuX2dldFNpbGVudEZyYW1lKGUpfHx0WzBdLmRhdGEuc3ViYXJyYXkoKSxkPU1hdGguZmxvb3IoYy9hKTtNYXRoLmFicyh1LnB0cy10aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25HYXBEb3QpPmNlJiYodGhpcy5fbGFzdEF1ZGlvRXhjZXB0aW9uR2FwRG90PXUucHRzLGUud2FybmluZ3MucHVzaCh7dHlwZTpQLHB0czp1LnB0cyxvcmlnaW5QdHM6dS5vcmlnaW5QdHMsY291bnQ6ZCxuZXh0UHRzOm8scmVmU2FtcGxlRHVyYXRpb246YX0pKTtmb3IodmFyIGY9MDtmPGQ7ZisrKXt2YXIgaD1uZXcgTyhNYXRoLmZsb29yKHRoaXMuX2F1ZGlvTmV4dFB0cythKS1NYXRoLmZsb29yKHRoaXMuX2F1ZGlvTmV4dFB0cyksbCxuKTtoLm9yaWdpblB0cz1NYXRoLmZsb29yKHRoaXMuX2Jhc2VEdHMrbyksdC5zcGxpY2UocywwLGgpLHRoaXMuX2F1ZGlvTmV4dFB0cys9YSxzKyt9cy0tfWVsc2UgYzw9LTMqYSYmYz49LTFlMz8oTWF0aC5hYnModS5wdHMtdGhpcy5fbGFzdEF1ZGlvRXhjZXB0aW9uT3ZlcmxhcERvdCk+Y2UmJih0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25PdmVybGFwRG90PXUucHRzLGUud2FybmluZ3MucHVzaCh7dHlwZTpJLHB0czp1LnB0cyxvcmlnaW5QdHM6dS5vcmlnaW5QdHMsbmV4dFB0czpvLHJlZlNhbXBsZUR1cmF0aW9uOmF9KSksdC5zcGxpY2UocywxKSxzLS0pOihNYXRoLmFicyhjKT51ZSYmKHRoaXMuX2F1ZGlvVGltZXN0YW1wQnJlYWsrKyxNYXRoLmFicyh1LnB0cy10aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25MYXJnZUdhcERvdCk+Y2UmJih0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25MYXJnZUdhcERvdD11LnB0cyxlLndhcm5pbmdzLnB1c2goe3R5cGU6VSx0aW1lOnUucHRzLzFlMyxwdHM6dS5wdHMsb3JpZ2luUHRzOnUub3JpZ2luUHRzLG5leHRQdHM6byxzYW1wbGVEdXJhdGlvbjpjLHJlZlNhbXBsZUR1cmF0aW9uOmF9KSkpLHUuZHRzPXUucHRzPW8sdS5kdXJhdGlvbj1uLHRoaXMuX2F1ZGlvTmV4dFB0cys9YSl9fX0se2tleToiX2dldEc3MTFEdXJhdGlvbiIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5zYW1wbGVTaXplLHI9ZS5jaGFubmVsQ291bnQsYT1lLnNhbXBsZVJhdGUsbj1lLnNhbXBsZXNbMF07aWYobilyZXR1cm4gMipuLmRhdGEuYnl0ZUxlbmd0aC9yLyh0LzgpL2EqMWUzfX0se2tleToiX2dldFNpbGVudEZyYW1lIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5jb2RlY1R5cGU9PT1BP3NlLmdldFNpbGVudEZyYW1lKGUuY29kZWMsZS5jaGFubmVsQ291bnQpOm5ldyBVaW50OEFycmF5KDgqZS5zYW1wbGVEdXJhdGlvbiplLmNoYW5uZWxDb3VudCl9fV0pLGV9KCksZGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToicGFyc2UiLHZhbHVlOmZ1bmN0aW9uKHQpe2lmKCEodC5sZW5ndGg8Mykpe3ZhciByPXt9LGE9ZS5fcGFyc2VWYWx1ZShuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0LHQuYnl0ZUxlbmd0aCkpLG49ZS5fcGFyc2VWYWx1ZShuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0K2Euc2l6ZSx0LmJ5dGVMZW5ndGgtYS5zaXplKSk7cmV0dXJuIHJbYS5kYXRhXT1uLmRhdGEscn19fSx7a2V5OiJfcGFyc2VWYWx1ZSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHIsYT10LmJ5dGVMZW5ndGgsbj0xLGk9ITE7c3dpdGNoKHQuZ2V0VWludDgoMCkpe2Nhc2UgMDpyPXQuZ2V0RmxvYXQ2NCgxKSxuKz04O2JyZWFrO2Nhc2UgMTpyPSEhdC5nZXRVaW50OCgxKSxuKz0xO2JyZWFrO2Nhc2UgMjp2YXIgcz1lLl9wYXJzZVN0cmluZyhuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0K24sdC5ieXRlTGVuZ3RoLW4pKTtyPXMuZGF0YSxuKz1zLnNpemU7YnJlYWs7Y2FzZSAzOnI9e307dmFyIG89MDtmb3IoOT09KDE2Nzc3MjE1JnQuZ2V0VWludDMyKGEtNCkpJiYobz0zKTtuPGEtNDspe3ZhciB1PWUuX3BhcnNlT2JqZWN0KG5ldyBEYXRhVmlldyh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbix0LmJ5dGVMZW5ndGgtbi1vKSksYz11LnNpemUsbD11LmRhdGE7aWYodS5pc0VuZClicmVhaztyW2wubmFtZV09bC52YWx1ZSxuKz1jfWlmKG48PWEtMyk5PT09KDE2Nzc3MjE1JnQuZ2V0VWludDMyKG4tMSkpJiYobis9Myk7YnJlYWs7Y2FzZSA4OnI9e30sbis9NDt2YXIgZD0wO2Zvcig5PT0oMTY3NzcyMTUmdC5nZXRVaW50MzIoYS00KSkmJihkPTMpO248YS04Oyl7dmFyIGY9ZS5fcGFyc2VPYmplY3QobmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCtuLHQuYnl0ZUxlbmd0aC1uLWQpKSxoPWYuc2l6ZSxwPWYuZGF0YTtpZihmLmlzRW5kKWJyZWFrO3JbcC5uYW1lXT1wLnZhbHVlLG4rPWh9aWYobjw9YS0zKTk9PT0oMTY3NzcyMTUmdC5nZXRVaW50MzIobi0xKSkmJihuKz0zKTticmVhaztjYXNlIDk6cj12b2lkIDAsbj0xLGk9ITA7YnJlYWs7Y2FzZSAxMDpyPVtdO3ZhciB2PXQuZ2V0VWludDMyKDEpO24rPTQ7Zm9yKHZhciB5PTA7eTx2O3krKyl7dmFyIG09ZS5fcGFyc2VWYWx1ZShuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0K24sdC5ieXRlTGVuZ3RoLW4pKSxnPW0uZGF0YSxrPW0uc2l6ZTtyLnB1c2goZyksbis9a31icmVhaztjYXNlIDExOnZhciBiPXQuZ2V0RmxvYXQ2NChuKSs2ZTQqdC5nZXRJbnQxNihuKzgpO3I9bmV3IERhdGUoYiksbis9MTA7YnJlYWs7Y2FzZSAxMjp2YXIgXz10LmdldFVpbnQzMigxKTtuKz00LHI9IiIsXz4wJiYocj1ILmRlY29kZShuZXcgVWludDhBcnJheSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbixfKSkpLG4rPV87YnJlYWs7ZGVmYXVsdDpuPWF9cmV0dXJue2RhdGE6cixzaXplOm4saXNFbmQ6aX19fSx7a2V5OiJfcGFyc2VTdHJpbmciLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZ2V0VWludDE2KDApLHI9IiI7cmV0dXJuIHQ+MCYmKHI9SC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoZS5idWZmZXIsZS5ieXRlT2Zmc2V0KzIsdCkpKSx7ZGF0YTpyLHNpemU6Mit0fX19LHtrZXk6Il9wYXJzZU9iamVjdCIsdmFsdWU6ZnVuY3Rpb24odCl7aWYoISh0LmJ5dGVMZW5ndGg8Mykpe3ZhciByPWUuX3BhcnNlU3RyaW5nKHQpLGE9ZS5fcGFyc2VWYWx1ZShuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0K3Iuc2l6ZSx0LmJ5dGVMZW5ndGgtci5zaXplKSk7cmV0dXJue2RhdGE6e25hbWU6ci5kYXRhLHZhbHVlOmEuZGF0YX0sc2l6ZTpyLnNpemUrYS5zaXplLGlzRW5kOmEuaXNFbmR9fX19XSksZX0oKSxmZT1uZXcgRygiRmx2RGVtdXhlciIpLGhlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LGEsbil7cih0aGlzLGUpLGkodGhpcywiX2hlYWRlclBhcnNlZCIsITEpLGkodGhpcywiX3JlbWFpbmluZ0RhdGEiLG51bGwpLGkodGhpcywiX2dvcElkIiwwKSxpKHRoaXMsIl9uZWVkQWRkTWV0YUJlZm9yZUtleUZyYW1lTmFsIiwhMCksdGhpcy52aWRlb1RyYWNrPXR8fG5ldyB6LHRoaXMuYXVkaW9UcmFjaz1hfHxuZXcgTSx0aGlzLm1ldGFkYXRhVHJhY2s9bnx8bmV3IE4sdGhpcy5fZml4ZXI9bmV3IGxlKHRoaXMudmlkZW9UcmFjayx0aGlzLmF1ZGlvVHJhY2ssdGhpcy5tZXRhZGF0YVRyYWNrKX1yZXR1cm4gbihlLFt7a2V5OiJkZW11eCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0mJmFyZ3VtZW50c1sxXSxhPSEoYXJndW1lbnRzLmxlbmd0aD4yJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0pfHxhcmd1bWVudHNbMl0sbj10aGlzLmF1ZGlvVHJhY2ssaT10aGlzLnZpZGVvVHJhY2sscz10aGlzLm1ldGFkYXRhVHJhY2s7aWYoIXImJmF8fCh0aGlzLl9yZW1haW5pbmdEYXRhPW51bGwsdGhpcy5faGVhZGVyUGFyc2VkPSExKSxyPyhpLnJlc2V0KCksbi5yZXNldCgpLHMucmVzZXQoKSk6KGkuc2FtcGxlcz1bXSxuLnNhbXBsZXM9W10scy5zZWlTYW1wbGVzPVtdLHMuZmx2U2NyaXB0U2FtcGxlcz1bXSxpLndhcm5pbmdzPVtdLG4ud2FybmluZ3M9W10sdGhpcy5fcmVtYWluaW5nRGF0YSYmKHQ9Wih0aGlzLl9yZW1haW5pbmdEYXRhLHQpLHRoaXMuX3JlbWFpbmluZ0RhdGE9bnVsbCkpLCF0Lmxlbmd0aClyZXR1cm57dmlkZW9UcmFjazppLGF1ZGlvVHJhY2s6bixtZXRhZGF0YVRyYWNrOnN9O3ZhciBvPTA7aWYoIXRoaXMuX2hlYWRlclBhcnNlZCl7aWYoIWUucHJvYmUodCkpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGZsdiBmaWxlIik7bi5wcmVzZW50PSg0JnRbNF0pPj4+MiE9MCxpLnByZXNlbnQ9MCE9KDEmdFs0XSksdGhpcy5faGVhZGVyUGFyc2VkPSEwLG89JCh0LDUpKzR9Zm9yKHZhciB1LGMsbCxkLGYsaD10Lmxlbmd0aDtvKzE1PGgmJih1PXRbb10sIShvKzE1KyhjPXRbbysxXTw8MTZ8dFtvKzJdPDw4fHRbbyszXSk+aCkpOylsPSh0W28rN108PDI0Pj4+MCkrKHRbbys0XTw8MTYpKyh0W28rNV08PDgpK3Rbbys2XSxvKz0xMSxkPXQuc3ViYXJyYXkobyxvK2MpLDg9PT11P3RoaXMuX3BhcnNlQXVkaW8oZCxsKTo5PT09dT90aGlzLl9wYXJzZVZpZGVvKGQsbCk6MTg9PT11P3RoaXMuX3BhcnNlU2NyaXB0KGQsbCk6ZmUud2FybigiSW52YWxpZCB0YWcgdHlwZTogIi5jb25jYXQodSkpLChmPSQodCxvKz1jKSkhPT0xMStjJiZmZS53YXJuKCJJbnZhbGlkIFByZXZUYWdTaXplICIuY29uY2F0KGYsIiAoIikuY29uY2F0KDExK2MsIikiKSksbys9NDtyZXR1cm4gbzxoJiYodGhpcy5fcmVtYWluaW5nRGF0YT10LnN1YmFycmF5KG8pKSxuLmZvcm1hdFRpbWVzY2FsZT1pLmZvcm1hdFRpbWVzY2FsZT1pLnRpbWVzY2FsZT1zLnRpbWVzY2FsZT0xZTMsbi50aW1lc2NhbGU9bi5zYW1wbGVSYXRlfHwwLCFuLmV4aXN0KCkmJm4uaGFzU2FtcGxlKCkmJm4ucmVzZXQoKSwhaS5leGlzdCgpJiZpLmhhc1NhbXBsZSgpJiZpLnJlc2V0KCkse3ZpZGVvVHJhY2s6aSxhdWRpb1RyYWNrOm4sbWV0YWRhdGFUcmFjazpzfX19LHtrZXk6ImZpeCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiB0aGlzLl9maXhlci5maXgoZSx0LHIpLHt2aWRlb1RyYWNrOnRoaXMudmlkZW9UcmFjayxhdWRpb1RyYWNrOnRoaXMuYXVkaW9UcmFjayxtZXRhZGF0YVRyYWNrOnRoaXMubWV0YWRhdGFUcmFja319fSx7a2V5OiJkZW11eEFuZEZpeCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSl7cmV0dXJuIHRoaXMuZGVtdXgoZSx0LHIpLHRoaXMuZml4KGEsdCxyKX19LHtrZXk6Il9wYXJzZUF1ZGlvIix2YWx1ZTpmdW5jdGlvbih0LHIpe2lmKHQubGVuZ3RoKXt2YXIgYT0oMjQwJnRbMF0pPj4+NCxuPXRoaXMuYXVkaW9UcmFjaztpZigxMCE9PWEmJjchPT1hJiY4IT09YSlyZXR1cm4gZmUud2FybigiVW5zdXBwb3J0ZWQgc291bmQgZm9ybWF0OiAiLmNvbmNhdChhKSksdm9pZCBuLnJlc2V0KCk7aWYoMTAhPT1hKXt2YXIgaT0oMTImdFswXSk+PjIscz0oMiZ0WzBdKT4+MSxvPTEmdFswXTtuLnNhbXBsZVJhdGU9ZS5BVURJT19SQVRFW2ldLG4uc2FtcGxlU2l6ZT1zPzE2Ojgsbi5jaGFubmVsQ291bnQ9bysxfTEwPT09YT90aGlzLl9wYXJzZUFhYyh0LHIpOnRoaXMuX3BhcnNlRzcxMSh0LHIsYSl9fX0se2tleToiX3BhcnNlRzcxMSIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBhPXRoaXMuYXVkaW9UcmFjazthLmNvZGVjVHlwZT03PT09cj9EOkUsYS5zYW1wbGVSYXRlPThlMyxhLmNvZGVjPWEuY29kZWNUeXBlLGEuc2FtcGxlcy5wdXNoKG5ldyBPKHQsZS5zdWJhcnJheSgxKSkpfX0se2tleToiX3BhcnNlQWFjIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMuYXVkaW9UcmFjaztpZihyLmNvZGVjVHlwZT1BLDA9PT1lWzFdKXt2YXIgYT1zZS5wYXJzZUF1ZGlvU3BlY2lmaWNDb25maWcoZS5zdWJhcnJheSgyKSk7YT8oci5jb2RlYz1hLmNvZGVjLHIuY2hhbm5lbENvdW50PWEuY2hhbm5lbENvdW50LHIuc2FtcGxlUmF0ZT1hLnNhbXBsZVJhdGUsci5jb25maWc9YS5jb25maWcsci5vYmplY3RUeXBlPWEub2JqZWN0VHlwZSxyLnNhbXBsZVJhdGVJbmRleD1hLnNhbXBsaW5nRnJlcXVlbmN5SW5kZXgpOihyLnJlc2V0KCksZmUud2FybigiQ2Fubm90IHBhcnNlIEF1ZGlvU3BlY2lmaWNDb25maWciLGUpKX1lbHNlIGlmKDE9PT1lWzFdKXtpZihudWxsPT10KXJldHVybjtyLnNhbXBsZXMucHVzaChuZXcgTyh0LGUuc3ViYXJyYXkoMikpKX1lbHNlIGZlLndhcm4oIlVua25vd24gQUFDUGFja2V0VHlwZTogIi5jb25jYXQoZVsxXSkpfX0se2tleToiX3BhcnNlVmlkZW8iLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcztpZighKGUubGVuZ3RoPDYpKXt2YXIgYT0oMjQwJmVbMF0pPj4+NCxuPTE1JmVbMF0saT10aGlzLnZpZGVvVHJhY2s7aWYoNyE9PW4mJjEyIT09bilyZXR1cm4gaS5yZXNldCgpLHZvaWQgZmUud2FybigiVW5zdXBwb3J0ZWQgY29kZWNJZDogIi5jb25jYXQobikpO3ZhciBzPTEyPT09bjtpLmNvZGVjVHlwZT1zP1M6eDt2YXIgbz1lWzFdLHU9KGVbMl08PDE2fGVbM108PDh8ZVs0XSk8PDg+Pjg7aWYoMD09PW8pe3ZhciBjPWUuc3ViYXJyYXkoNSksbD1zP29lLnBhcnNlSEVWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkKGMpOmllLnBhcnNlQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQoYyk7aWYobCl7dmFyIGQ9bC5odmNDLGY9bC5zcHMsaD1sLnBwc0FycixwPWwuc3BzQXJyLHY9bC52cHNBcnIseT1sLm5hbFVuaXRTaXplO2QmJihpLmh2Y0M9aS5odmNDfHxkKSxmJiYoaS5jb2RlYz1mLmNvZGVjLGkud2lkdGg9Zi53aWR0aCxpLmhlaWdodD1mLmhlaWdodCxpLnNhclJhdGlvPWYuc2FyUmF0aW8saS5mcHNOdW09Zi5mcHNOdW0saS5mcHNEZW49Zi5mcHNEZW4pLHAubGVuZ3RoJiYoaS5zcHM9cCksaC5sZW5ndGgmJihpLnBwcz1oKSx2JiZ2Lmxlbmd0aCYmKGkudnBzPXYpLHkmJihpLm5hbFVuaXRTaXplPXkpfWVsc2UgZmUud2FybigiQ2Fubm90IHBhcnNlICIuY29uY2F0KHM/IkhFVkMiOiJBVkMiLCJEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZCIpLGUpfWVsc2UgaWYoMT09PW8pe3ZhciBtPW5lLnBhcnNlQXZjQyhlLnN1YmFycmF5KDUpLGkubmFsVW5pdFNpemUpO2lmKChtPXRoaXMuX2NoZWNrQWRkTWV0YU5hbFRvVW5pdHMocyxtLGkpKSYmbS5sZW5ndGgpe3ZhciBnPW5ldyBSKHQrdSx0LG0pOzE9PT1hJiZnLnNldFRvS2V5ZnJhbWUoKSxpLnNhbXBsZXMucHVzaChnKSxtLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBhPXM/ZVswXT4+PjEmNjM6MzEmZVswXTtzd2l0Y2goYSl7Y2FzZSA1OmNhc2UgMTY6Y2FzZSAxNzpjYXNlIDE4OmNhc2UgMTk6Y2FzZSAyMDpjYXNlIDIxOmNhc2UgMjI6Y2FzZSAyMzppZighcyYmNSE9PWF8fHMmJjU9PT1hKWJyZWFrO2cuc2V0VG9LZXlmcmFtZSgpO2JyZWFrO2Nhc2UgNjpjYXNlIDM5OmNhc2UgNDA6aWYoIXMmJjYhPT1hfHxzJiY2PT09YSlicmVhaztyLm1ldGFkYXRhVHJhY2suc2VpU2FtcGxlcy5wdXNoKG5ldyBGKG5lLnBhcnNlU0VJKG5lLnJlbW92ZUVQQihlKSxzKSx0K3UpKX19KSksZy5rZXlmcmFtZSYmdGhpcy5fZ29wSWQrKyxnLmdvcElkPXRoaXMuX2dvcElkfWVsc2UgZmUud2FybigiQ2Fubm90IHBhcnNlIE5BTFVzIixlKX1lbHNlIDI9PT1vfHxmZS53YXJuKCJVbmtub3duIEFWQ1BhY2tldFR5cGU6ICIuY29uY2F0KG8pKX19fSx7a2V5OiJfY2hlY2tBZGRNZXRhTmFsVG9Vbml0cyIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlJiZ0aGlzLl9uZWVkQWRkTWV0YUJlZm9yZUtleUZyYW1lTmFsP3QubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZVswXT4+PjEmNjN9KSkuaW5jbHVkZXMoMzIpPyh0aGlzLl9uZWVkQWRkTWV0YUJlZm9yZUtleUZyYW1lTmFsPSExLHQpOih0LnVuc2hpZnQoci5wcHNbMF0pLHQudW5zaGlmdChyLnNwc1swXSksdC51bnNoaWZ0KHIudnBzWzBdKSx0LmZpbHRlcihCb29sZWFuKSk6KHRoaXMuX25lZWRBZGRNZXRhQmVmb3JlS2V5RnJhbWVOYWw9ITEsdCl9fSx7a2V5OiJfcGFyc2VTY3JpcHQiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5tZXRhZGF0YVRyYWNrLmZsdlNjcmlwdFNhbXBsZXMucHVzaChuZXcgVihkZS5wYXJzZShlKSx0KSl9fV0sW3trZXk6InByb2JlIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gNzA9PT1lWzBdJiY3Nj09PWVbMV0mJjg2PT09ZVsyXSYmMT09PWVbM10mJiQoZSw1KT49OX19XSksZX0oKTtpKGhlLCJBVURJT19SQVRFIixbNTUwMCwxMWUzLDIyZTMsNDRlM10pLG5ldyBHKCJUc0RlbXV4ZXIiKTt2YXIgcGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToiZmluZEJveCIsdmFsdWU6ZnVuY3Rpb24odCxyKXt2YXIgYT1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06MCxuPVtdO2lmKCF0KXJldHVybiBuO2Zvcih2YXIgaT0wLHM9IiIsbz0wO3QubGVuZ3RoPjc7KXtpZihpPSQodCkscz1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsdC5zdWJhcnJheSg0LDgpKSxvPTgsMT09PWk/KGk9ZWUodCw4KSxvKz04KTppfHwoaT10Lmxlbmd0aCksIXJbMF18fHM9PT1yWzBdKXt2YXIgdT10LnN1YmFycmF5KDAsaSk7aWYoIShyLmxlbmd0aDwyKSlyZXR1cm4gZS5maW5kQm94KHUuc3ViYXJyYXkobyksci5zbGljZSgxKSxhK28pO24ucHVzaCh7c3RhcnQ6YSxzaXplOmksaGVhZGVyU2l6ZTpvLHR5cGU6cyxkYXRhOnV9KX1hKz1pLHQ9dC5zdWJhcnJheShpKX1yZXR1cm4gbn19LHtrZXk6InRmaGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe2UudHJhY2tJZD0kKHQpO3ZhciByPTQsYT0xJmUuZmxhZ3Msbj0yJmUuZmxhZ3MsaT04JmUuZmxhZ3Mscz0xNiZlLmZsYWdzLG89MzImZS5mbGFnczthJiYocis9NCxlLmJhc2VEYXRhT2Zmc2V0PSQodCxyKSxyKz00KSxuJiYoZS5zYW1wbGVEZXNjcmlwdGlvbkluZGV4PSQodCxyKSxyKz00KSxpJiYoZS5kZWZhdWx0U2FtcGxlRHVyYXRpb249JCh0LHIpLHIrPTQpLHMmJihlLmRlZmF1bHRTYW1wbGVTaXplPSQodCxyKSxyKz00KSxvJiYoZS5kZWZhdWx0U2FtcGxlRmxhZ3M9JCh0LHIpKX0pKX19LHtrZXk6InNpZHgiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPTA7ZS5yZWZlcmVuY2VfSUQ9JCh0LHIpLHIrPTQsZS50aW1lc2NhbGU9JCh0LHIpLHIrPTQsMD09PWUudmVyc2lvbj8oZS5lYXJsaWVzdF9wcmVzZW50YXRpb25fdGltZT0kKHQscikscis9NCxlLmZpcnN0X29mZnNldD0kKHQscikscis9NCk6KGUuZWFybGllc3RfcHJlc2VudGF0aW9uX3RpbWU9ZWUodCxyKSxyKz04LGUuZmlyc3Rfb2Zmc2V0PWVlKHQscikscis9OCkscis9MixlLnJlZmVyZW5jZXM9W107dmFyIGE9Sih0LHIpO3IrPTI7Zm9yKHZhciBuPTA7bjxhO24rKyl7dmFyIGk9e307ZS5yZWZlcmVuY2VzLnB1c2goaSk7dmFyIHM9JCh0LHIpO3IrPTQsaS5yZWZlcmVuY2VfdHlwZT1zPj4zMSYxLGkucmVmZXJlbmNlZF9zaXplPTIxNDc0ODM2NDcmcyxpLnN1YnNlZ21lbnRfZHVyYXRpb249JCh0LHIpLHM9JCh0LHIrPTQpLHIrPTQsaS5zdGFydHNfd2l0aF9TQVA9cz4+MzEmMSxpLlNBUF90eXBlPXM+PjI4JjcsaS5TQVBfZGVsdGFfdGltZT0yNjg0MzU0NTUmc319KSl9fSx7a2V5OiJtb292Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZ2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3QubXZoZD1lLm12aGQoZS5maW5kQm94KHIsWyJtdmhkIl0sYSlbMF0pLHQudHJhaz1lLmZpbmRCb3gocixbInRyYWsiXSxhKS5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWsodCl9KSksdC5wc3NoPWUucHNzaChlLmZpbmRCb3gocixbInBzc2giXSxhKVswXSl9KSl9fSx7a2V5OiJtdmhkIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2UoZSwhMCwoZnVuY3Rpb24oZSx0KXt2YXIgcj0wOzE9PT1lLnZlcnNpb24/KGUudGltZXNjYWxlPSQodCwxNiksZS5kdXJhdGlvbj1lZSh0LDIwKSxyKz0yOCk6KGUudGltZXNjYWxlPSQodCw4KSxlLmR1cmF0aW9uPSQodCwxMikscis9MTYpLGUubmV4dFRyYWNrSWQ9JCh0LHIrNzYpfSkpfX0se2tleToidHJhayIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0LnRraGQ9ZS50a2hkKGUuZmluZEJveChyLFsidGtoZCJdLGEpWzBdKSx0Lm1kaWE9ZS5tZGlhKGUuZmluZEJveChyLFsibWRpYSJdLGEpWzBdKX0pKX19LHtrZXk6InRraGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPTA7MT09PWUudmVyc2lvbj8oZS50cmFja0lkPSQodCwxNiksZS5kdXJhdGlvbj1lZSh0LDI0KSxyKz0zMik6KGUudHJhY2tJZD0kKHQsOCksZS5kdXJhdGlvbj0kKHQsMTYpLHIrPTIwKSxlLndpZHRoPSQodCxyKzUyKSxlLmhlaWdodD0kKHQscis1Nil9KSl9fSx7a2V5OiJtZGlhIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZ2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3QubWRoZD1lLm1kaGQoZS5maW5kQm94KHIsWyJtZGhkIl0sYSlbMF0pLHQuaGRscj1lLmhkbHIoZS5maW5kQm94KHIsWyJoZGxyIl0sYSlbMF0pLHQubWluZj1lLm1pbmYoZS5maW5kQm94KHIsWyJtaW5mIl0sYSlbMF0pfSkpfX0se2tleToibWRoZCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGdlKGUsITAsKGZ1bmN0aW9uKGUsdCl7dmFyIHI9MDsxPT09ZS52ZXJzaW9uPyhlLnRpbWVzY2FsZT0kKHQsMTYpLGUuZHVyYXRpb249ZWUodCwyMCkscis9MjgpOihlLnRpbWVzY2FsZT0kKHQsOCksZS5kdXJhdGlvbj0kKHQsMTIpLHIrPTE2KTt2YXIgYT1KKHQscik7ZS5sYW5ndWFnZT1TdHJpbmcuZnJvbUNoYXJDb2RlKDk2KyhhPj4xMCYzMSksOTYrKGE+PjUmMzEpLDk2KygzMSZhKSl9KSl9fSx7a2V5OiJoZGxyIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2UoZSwhMCwoZnVuY3Rpb24oZSx0KXswPT09ZS52ZXJzaW9uJiYoZS5oYW5kbGVyVHlwZT1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsdC5zdWJhcnJheSg0LDgpKSl9KSl9fSx7a2V5OiJtaW5mIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZ2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3Qudm1oZD1lLnZtaGQoZS5maW5kQm94KHIsWyJ2bWhkIl0sYSlbMF0pLHQuc21oZD1lLnNtaGQoZS5maW5kQm94KHIsWyJzbWhkIl0sYSlbMF0pLHQuc3RibD1lLnN0YmwoZS5maW5kQm94KHIsWyJzdGJsIl0sYSlbMF0pfSkpfX0se2tleToidm1oZCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGdlKGUsITAsKGZ1bmN0aW9uKGUsdCl7ZS5ncmFwaGljc21vZGU9Sih0KSxlLm9wY29sb3I9W0oodCwyKSxKKHQsNCksSih0LDYpXX0pKX19LHtrZXk6InNtaGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe2UuYmFsYW5jZT1KKHQpfSkpfX0se2tleToic3RibCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt2YXIgbixpLHM7dC5zdHNkPWUuc3RzZChlLmZpbmRCb3gocixbInN0c2QiXSxhKVswXSksdC5zdHRzPWUuc3R0cyhlLmZpbmRCb3gocixbInN0dHMiXSxhKVswXSksdC5jdHRzPWUuY3R0cyhlLmZpbmRCb3gocixbImN0dHMiXSxhKVswXSksdC5zdHNjPWUuc3RzYyhlLmZpbmRCb3gocixbInN0c2MiXSxhKVswXSksdC5zdHN6PWUuc3RzeihlLmZpbmRCb3gocixbInN0c3oiXSxhKVswXSksdC5zdGNvPWUuc3RjbyhlLmZpbmRCb3gocixbInN0Y28iXSxhKVswXSksdC5zdGNvfHwodC5jbzY0PWUuY282NChlLmZpbmRCb3gocixbImNvNjQiXSxhKVswXSksdC5zdGNvPXQuY282NCk7dmFyIG89bnVsbD09PShuPXQuc3RzZC5lbnRyaWVzWzBdKXx8dm9pZCAwPT09bnx8bnVsbD09PShpPW4uc2luZil8fHZvaWQgMD09PWl8fG51bGw9PT0ocz1pLnNjaGkpfHx2b2lkIDA9PT1zP3ZvaWQgMDpzLnRlbmMuZGVmYXVsdF9JVl9zaXplO3Quc3Rzcz1lLnN0c3MoZS5maW5kQm94KHIsWyJzdHNzIl0sYSlbMF0pLHQuc2VuYz1lLnNlbmMoZS5maW5kQm94KHIsWyJzZW5jIl0sYSlbMF0sbyl9KSl9fSx7a2V5OiJzZW5jIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06ODtyZXR1cm4gZ2UoZSwhMCwoZnVuY3Rpb24oZSxyKXt2YXIgYT0wLG49JChyLGEpO2ErPTQsZS5zYW1wbGVzPVtdO2Zvcih2YXIgaT0wO2k8bjtpKyspe2Zvcih2YXIgcz17SW5pdGlhbGl6YXRpb25WZWN0b3I6W119LG89MDtvPHQ7bysrKXMuSW5pdGlhbGl6YXRpb25WZWN0b3Jbb109clthK29dO2lmKGErPXQsMiZlLmZsYWdzKXtzLnN1YnNhbXBsZXM9W107dmFyIHU9SihyLGEpO2ErPTI7Zm9yKHZhciBjPTA7Yzx1O2MrKyl7dmFyIGw9e307bC5CeXRlc09mQ2xlYXJEYXRhPUoocixhKSxhKz0yLGwuQnl0ZXNPZlByb3RlY3RlZERhdGE9JChyLGEpLGErPTQscy5zdWJzYW1wbGVzLnB1c2gobCl9fWUuc2FtcGxlcy5wdXNoKHMpfX0pKX19LHtrZXk6InBzc2giLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj1bXSxhPVtdLG49MCxpPTA7aTwxNjtpKyspYS5wdXNoKGJlKHRbbitpXSkpO2lmKG4rPTE2LGUudmVyc2lvbj4wKXt2YXIgcz0kKHQsbik7bis9NDtmb3IodmFyIG89MDtvPCgiIitzKS5sZW5ndGg7bysrKWZvcih2YXIgdT0wO3U8MTY7dSsrKXt2YXIgYz10W25dO24rPTEsci5wdXNoKGJlKGMpKX19dmFyIGw9JCh0LG4pO2UuZGF0YV9zaXplPWwsbis9NCxlLmtpZD1yLGUuc3lzdGVtX2lkPWEsZS5idWZmZXI9dH0pKX19LHtrZXk6InN0c2QiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBnZSh0LCEwLChmdW5jdGlvbih0LHIsYSl7dC5lbnRyeUNvdW50PSQociksdC5lbnRyaWVzPWUuZmluZEJveChyLnN1YmFycmF5KDQpLFtdLGErNCkubWFwKChmdW5jdGlvbih0KXtzd2l0Y2godC50eXBlKXtjYXNlImF2YzEiOmNhc2UiYXZjMiI6Y2FzZSJhdmMzIjpjYXNlImF2YzQiOnJldHVybiBlLmF2YzEodCk7Y2FzZSJodmMxIjpjYXNlImhldjEiOnJldHVybiBlLmh2YzEodCk7Y2FzZSJtcDRhIjpyZXR1cm4gZS5tcDRhKHQpO2Nhc2UiYWxhdyI6Y2FzZSJ1bGF3IjpyZXR1cm4gZS5hbGF3KHQpO2Nhc2UiZW5jYSI6cmV0dXJuIGdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0LmNoYW5uZWxDb3VudD1KKHIsMTYpLHQuc2FtcGxlc2l6ZT1KKHIsMTgpLHQuc2FtcGxlUmF0ZT0kKHIsMjQpLzY1NTM2LHI9ci5zdWJhcnJheSgyOCksdC5zaW5mPWUuc2luZihlLmZpbmRCb3gocixbInNpbmYiXSxhKVswXSksdC5lc2RzPWUuZXNkcyhlLmZpbmRCb3gocixbImVzZHMiXSxhKVswXSl9KSk7Y2FzZSJlbmN2IjpyZXR1cm4gZ2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3Qud2lkdGg9SihyLDI0KSx0LmhlaWdodD1KKHIsMjYpLHQuaG9yaXpyZXNvbHV0aW9uPSQociwyOCksdC52ZXJ0cmVzb2x1dGlvbj0kKHIsMzIpLHI9ci5zdWJhcnJheSg3OCksdC5zaW5mPWUuc2luZihlLmZpbmRCb3gocixbInNpbmYiXSxhKVswXSksdC5hdmNDPWUuYXZjQyhlLmZpbmRCb3gocixbImF2Y0MiXSxhKVswXSksdC5odmNDPWUuaHZjQyhlLmZpbmRCb3gocixbImh2Y0MiXSxhKVswXSksdC5wYXNwPWUucGFzcChlLmZpbmRCb3gocixbInBhc3AiXSxhKVswXSl9KSl9fSkpLmZpbHRlcihCb29sZWFuKX0pKX19LHtrZXk6InRlbmMiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCExLChmdW5jdGlvbihlLHQpe3ZhciByPTY7ZS5kZWZhdWx0X0lzRW5jcnlwdGVkPXRbcl0scis9MSxlLmRlZmF1bHRfSVZfc2l6ZT10W3JdLHIrPTEsZS5kZWZhdWx0X0tJRD1bXTtmb3IodmFyIGE9MDthPDE2O2ErKyllLmRlZmF1bHRfS0lELnB1c2goYmUodFtyXSkpLHIrPTF9KSl9fSx7a2V5OiJzY2hpIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZ2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3QudGVuYz1lLnRlbmMoZS5maW5kQm94KHIsWyJ0ZW5jIl0sYSlbMF0pfSkpfX0se2tleToic2luZiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0LnNjaGk9ZS5zY2hpKGUuZmluZEJveChyLFsic2NoaSJdLGEpWzBdKSx0LmZybWE9ZS5mcm1hKGUuZmluZEJveChyLFsiZnJtYSJdLGEpWzBdKX0pKX19LHtrZXk6ImZybWEiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCExLChmdW5jdGlvbihlLHQpe2UuZGF0YV9mb3JtYXQ9IiI7Zm9yKHZhciByPTA7cjw0O3IrKyllLmRhdGFfZm9ybWF0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKHRbcl0pfSkpfX0se2tleToiYXZjMSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt2YXIgbj15ZSh0LHIpLGk9ci5zdWJhcnJheShuKTthKz1uLHQuYXZjQz1lLmF2Y0MoZS5maW5kQm94KGksWyJhdmNDIl0sYSlbMF0pLHQucGFzcD1lLnBhc3AoZS5maW5kQm94KGksWyJwYXNwIl0sYSlbMF0pfSkpfX0se2tleToiYXZjQyIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGdlKGUsITEsKGZ1bmN0aW9uKGUsdCl7ZS5jb25maWd1cmF0aW9uVmVyc2lvbj10WzBdLGUuQVZDUHJvZmlsZUluZGljYXRpb249dFsxXSxlLnByb2ZpbGVDb21wYXRpYmlsaXR5PXRbMl0sZS5BVkNMZXZlbEluZGljYXRpb249dFszXSxlLmNvZGVjPXRlKFt0WzFdLHRbMl0sdFszXV0pLGUubGVuZ3RoU2l6ZU1pbnVzT25lPTMmdFs0XSxlLnNwc0xlbmd0aD0zMSZ0WzVdLGUuc3BzPVtdO2Zvcih2YXIgcj02LGE9MDthPGUuc3BzTGVuZ3RoO2ErKyl7dmFyIG49Sih0LHIpO3IrPTIsZS5zcHMucHVzaCh0LnN1YmFycmF5KHIscituKSkscis9bn1lLnBwc0xlbmd0aD10W3JdLHIrPTEsZS5wcHM9W107Zm9yKHZhciBpPTA7aTxlLnBwc0xlbmd0aDtpKyspe3ZhciBzPUoodCxyKTtyKz0yLGUucHBzLnB1c2godC5zdWJhcnJheShyLHIrPXMpKSxyKz1zfX0pKX19LHtrZXk6Imh2YzEiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBnZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dmFyIG49eWUodCxyKSxpPXIuc3ViYXJyYXkobik7YSs9bix0Lmh2Y0M9ZS5odmNDKGUuZmluZEJveChpLFsiaHZjQyJdLGEpWzBdKSx0LnBhc3A9ZS5wYXNwKGUuZmluZEJveChpLFsicGFzcCJdLGEpWzBdKX0pKX19LHtrZXk6Imh2Y0MiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCExLChmdW5jdGlvbih0LHIpe3QuZGF0YT1lLmRhdGEsdC5jb2RlYz0iaGV2MS4xLjYuTDkzLkIwIix0LmNvbmZpZ3VyYXRpb25WZXJzaW9uPXJbMF07dmFyIGE9clsxXTt0LmdlbmVyYWxQcm9maWxlU3BhY2U9YT4+Nix0LmdlbmVyYWxUaWVyRmxhZz0oMzImYSk+PjUsdC5nZW5lcmFsUHJvZmlsZUlkYz0zMSZhLHQuZ2VuZXJhbFByb2ZpbGVDb21wYXRpYmlsaXR5PSQociwyKSx0LmdlbmVyYWxDb25zdHJhaW50SW5kaWNhdG9yRmxhZ3M9ci5zdWJhcnJheSg2LDEyKSx0LmdlbmVyYWxMZXZlbElkYz1yWzEyXSx0LmF2Z0ZyYW1lUmF0ZT1KKHIsMTkpLHQubnVtT2ZBcnJheXM9clsyMl0sdC52cHM9W10sdC5zcHM9W10sdC5wcHM9W107Zm9yKHZhciBuPTIzLGk9MCxzPTAsbz0wLHU9MDt1PHQubnVtT2ZBcnJheXM7dSsrKXtpPTYzJnJbbl0scz1KKHIsbisxKSxuKz0zO2Zvcih2YXIgYyxsPVtdLGQ9MDtkPHM7ZCsrKW89SihyLG4pLG4rPTIsbC5wdXNoKHIuc3ViYXJyYXkobixuK28pKSxuKz1vO2lmKDMyPT09aSkoYz10LnZwcykucHVzaC5hcHBseShjLGwpO2Vsc2UgaWYoMzM9PT1pKXt2YXIgZjsoZj10LnNwcykucHVzaC5hcHBseShmLGwpfWVsc2UgaWYoMzQ9PT1pKXt2YXIgaDsoaD10LnBwcykucHVzaC5hcHBseShoLGwpfX19KSl9fSx7a2V5OiJwYXNwIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2UoZSwhMSwoZnVuY3Rpb24oZSx0KXtlLmhTcGFjaW5nPSQodCksZS52U3BhY2luZz0kKHQsNCl9KSl9fSx7a2V5OiJtcDRhIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZ2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3ZhciBuPW1lKHQscik7dC5lc2RzPWUuZXNkcyhlLmZpbmRCb3goci5zdWJhcnJheShuKSxbImVzZHMiXSxhK24pWzBdKX0pKX19LHtrZXk6ImVzZHMiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe2UuY29kZWM9Im1wNGEuIjtmb3IodmFyIHI9MCxhPTAsbj0wLGk9MDt0Lmxlbmd0aDspe2ZvcihpPXRbcj0wXSxhPXRbcisxXSxyKz0yOzEyOCZhOyluPSgxMjcmYSk8PDcsYT10W3JdLHIrPTE7aWYobis9MTI3JmEsMz09PWkpdD10LnN1YmFycmF5KHIrMyk7ZWxzZXtpZig0IT09aSl7aWYoNT09PWkpe3ZhciBzPWUuY29uZmlnPXQuc3ViYXJyYXkocixyK24pLG89KDI0OCZzWzBdKT4+MztyZXR1cm4gMzE9PT1vJiZzLmxlbmd0aD49MiYmKG89MzIrKCg3JnNbMF0pPDwzKSsoKDIyNCZzWzFdKT4+NSkpLGUub2JqZWN0VHlwZT1vLGUuY29kZWMrPW8udG9TdHJpbmcoMTYpLHZvaWQoIi4iPT09ZS5jb2RlY1tlLmNvZGVjLmxlbmd0aC0xXSYmKGUuY29kZWM9ZS5jb2RlYy5zdWJzdHJpbmcoMCxlLmNvZGVjLmxlbmd0aC0xKSkpfXJldHVybiB2b2lkKCIuIj09PWUuY29kZWNbZS5jb2RlYy5sZW5ndGgtMV0mJihlLmNvZGVjPWUuY29kZWMuc3Vic3RyaW5nKDAsZS5jb2RlYy5sZW5ndGgtMSkpKX1lLmNvZGVjKz0odFtyXS50b1N0cmluZygxNikrIi4iKS5wYWRTdGFydCgzLCIwIiksdD10LnN1YmFycmF5KHIrMTMpfX19KSl9fSx7a2V5OiJhbGF3Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2UoZSwhMSwoZnVuY3Rpb24oZSx0KXttZShlLHQpfSkpfX0se2tleToic3R0cyIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGdlKGUsITAsKGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByPSQodCksYT1bXSxuPTQsaT0wO2k8cjtpKyspYS5wdXNoKHtjb3VudDokKHQsbiksZGVsdGE6JCh0LG4rNCl9KSxuKz04O2UuZW50cnlDb3VudD1yLGUuZW50cmllcz1hfSkpfX0se2tleToiY3R0cyIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGdlKGUsITAsKGZ1bmN0aW9uKGUsdCl7dmFyIHI9JCh0KSxhPVtdLG49NDtpZigxPT09ZS52ZXJzaW9uKWZvcih2YXIgaT0wO2k8cjtpKyspYS5wdXNoKHtjb3VudDokKHQsbiksb2Zmc2V0OiQodCxuKzQpfSksbis9ODtlbHNlIGZvcih2YXIgcz0wO3M8cjtzKyspYS5wdXNoKHtjb3VudDokKHQsbiksb2Zmc2V0Oi0oMSt+JCh0LG4rNCkpfSksbis9ODtlLmVudHJ5Q291bnQ9cixlLmVudHJpZXM9YX0pKX19LHtrZXk6InN0c2MiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj0kKHQpLGE9W10sbj00LGk9MDtpPHI7aSsrKWEucHVzaCh7Zmlyc3RDaHVuazokKHQsbiksc2FtcGxlc1BlckNodW5rOiQodCxuKzQpLHNhbXBsZURlc2NyaXB0aW9uSW5kZXg6JCh0LG4rOCl9KSxuKz0xMjtlLmVudHJ5Q291bnQ9cixlLmVudHJpZXM9YX0pKX19LHtrZXk6InN0c3oiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPSQodCksYT0kKHQsNCksbj1bXTtpZighcilmb3IodmFyIGk9OCxzPTA7czxhO3MrKyluLnB1c2goJCh0LGkpKSxpKz00O2Uuc2FtcGxlU2l6ZT1yLGUuc2FtcGxlQ291bnQ9YSxlLmVudHJ5U2l6ZXM9bn0pKX19LHtrZXk6InN0Y28iLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj0kKHQpLGE9W10sbj00LGk9MDtpPHI7aSsrKWEucHVzaCgkKHQsbikpLG4rPTQ7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJjbzY0Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2UoZSwhMCwoZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9JCh0KSxhPVtdLG49NCxpPTA7aTxyO2krKylhLnB1c2goZWUodCxuKSksbis9ODtlLmVudHJ5Q291bnQ9cixlLmVudHJpZXM9YX0pKX19LHtrZXk6InN0c3MiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBnZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj0kKHQpLGE9W10sbj00LGk9MDtpPHI7aSsrKWEucHVzaCgkKHQsbikpLG4rPTQ7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJtb29mIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZ2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3QubWZoZD1lLm1maGQoZS5maW5kQm94KHIsWyJtZmhkIl0sYSlbMF0pLHQudHJhZj1lLmZpbmRCb3gocixbInRyYWYiXSxhKS5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWYodCl9KSl9KSl9fSx7a2V5OiJtZmhkIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2UoZSwhMCwoZnVuY3Rpb24oZSx0KXtlLnNlcXVlbmNlTnVtYmVyPSQodCl9KSl9fSx7a2V5OiJ0cmFmIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZ2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3QudGZoZD1lLnRmaGQoZS5maW5kQm94KHIsWyJ0ZmhkIl0sYSlbMF0pLHQudGZkdD1lLnRmZHQoZS5maW5kQm94KHIsWyJ0ZmR0Il0sYSlbMF0pLHQudHJ1bj1lLnRydW4oZS5maW5kQm94KHIsWyJ0cnVuIl0sYSlbMF0pfSkpfX0se2tleToidHJ1biIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGdlKGUsITAsKGZ1bmN0aW9uKGUsdCl7dmFyIHI9ZS52ZXJzaW9uLGE9ZS5mbGFncyxuPXQubGVuZ3RoLGk9ZS5zYW1wbGVDb3VudD0kKHQpLHM9NDtpZihuPnMmJjEmYSYmKGUuZGF0YU9mZnNldD0tKDErfiQodCxzKSkscys9NCksbj5zJiY0JmEmJihlLmZpcnN0U2FtcGxlRmxhZ3M9JCh0LHMpLHMrPTQpLGUuc2FtcGxlcz1bXSxuPnMpZm9yKHZhciBvLHU9MDt1PGk7dSsrKW89e30sMjU2JmEmJihvLmR1cmF0aW9uPSQodCxzKSxzKz00KSw1MTImYSYmKG8uc2l6ZT0kKHQscykscys9NCksMTAyNCZhJiYoby5mbGFncz0kKHQscykscys9NCksMjA0OCZhJiYoby5jdHM9cj8tKDErfiQodCxzKzQpKTokKHQscykscys9NCksZS5zYW1wbGVzLnB1c2gobyl9KSl9fSx7a2V5OiJ0ZmR0Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2UoZSwhMCwoZnVuY3Rpb24oZSx0KXsxPT09ZS52ZXJzaW9uP2UuYmFzZU1lZGlhRGVjb2RlVGltZT1lZSh0KTplLmJhc2VNZWRpYURlY29kZVRpbWU9JCh0KX0pKX19LHtrZXk6InByb2JlIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4hIWUuZmluZEJveCh0LFsiZnR5cCJdKX19LHtrZXk6InBhcnNlU2FtcGxlRmxhZ3MiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybntpc0xlYWRpbmc6KDEyJmVbMF0pPj4+MixkZXBlbmRzT246MyZlWzBdLGlzRGVwZW5kZWRPbjooMTkyJmVbMV0pPj4+NixoYXNSZWR1bmRhbmN5Oig0OCZlWzFdKT4+PjQscGFkZGluZ1ZhbHVlOigxNCZlWzFdKT4+PjEsaXNOb25TeW5jU2FtcGxlOjEmZVsxXSxkZWdyYWRhdGlvblByaW9yaXR5OmVbMl08PDh8ZVszXX19fSx7a2V5OiJtb292VG9UcmFjayIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBhLG4saT1lLnRyYWs7aWYoaSYmaS5sZW5ndGgpe3ZhciBzPWkuZmluZCgoZnVuY3Rpb24oZSl7dmFyIHQscjtyZXR1cm4idmlkZSI9PT0obnVsbD09PSh0PWUubWRpYSl8fHZvaWQgMD09PXR8fG51bGw9PT0ocj10LmhkbHIpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmhhbmRsZXJUeXBlKX0pKSxvPWkuZmluZCgoZnVuY3Rpb24oZSl7dmFyIHQscjtyZXR1cm4ic291biI9PT0obnVsbD09PSh0PWUubWRpYSl8fHZvaWQgMD09PXR8fG51bGw9PT0ocj10LmhkbHIpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmhhbmRsZXJUeXBlKX0pKTtpZihzJiZ0KXt2YXIgdSxjLGwsZCxmLGgscCx2PXQseT1udWxsPT09KHU9cy50a2hkKXx8dm9pZCAwPT09dT92b2lkIDA6dS50cmFja0lkO251bGwhPXkmJih2LmlkPXMudGtoZC50cmFja0lkKSx2LnRraGREdXJhdGlvbj1zLnRraGQuZHVyYXRpb24sdi5tdmhkRHVydGlvbj1lLm12aGQuZHVyYXRpb24sdi5tdmhkVGltZWNhbGU9ZS5tdmhkLnRpbWVzY2FsZSx2LnRpbWVzY2FsZT12LmZvcm1hdFRpbWVzY2FsZT1zLm1kaWEubWRoZC50aW1lc2NhbGUsdi5kdXJhdGlvbj1zLm1kaWEubWRoZC5kdXJhdGlvbnx8di5tdmhkRHVydGlvbi92Lm12aGRUaW1lY2FsZSp2LnRpbWVzY2FsZTt2YXIgbSxnLGssYixfLHcseCxBLEI9cy5tZGlhLm1pbmYuc3RibC5zdHNkLmVudHJpZXNbMF07aWYodi53aWR0aD1CLndpZHRoLHYuaGVpZ2h0PUIuaGVpZ2h0LEIucGFzcCYmKHYuc2FyUmF0aW89W0IucGFzcC5oU3BhY2luZyxCLnBhc3AudlNwYWNpbmddKSxCLmh2Y0Mpdi5jb2RlY1R5cGU9Uyx2LmNvZGVjPUIuaHZjQy5jb2RlYyx2LnZwcz1CLmh2Y0MudnBzLHYuc3BzPUIuaHZjQy5zcHMsdi5wcHM9Qi5odmNDLnBwcyx2Lmh2Y0M9Qi5odmNDLmRhdGE7ZWxzZXtpZighQi5hdmNDKXRocm93IG5ldyBFcnJvcigidW5rbm93biB2aWRlbyBzdHNkIGVudHJ5Iik7di5jb2RlYz1CLmF2Y0MuY29kZWMsdi5zcHM9Qi5hdmNDLnNwcyx2LnBwcz1CLmF2Y0MucHBzfWlmKHYucHJlc2VudD0hMCx2LmV4dD17fSx2LmV4dC5zdHNzPW51bGw9PT0oYz1zLm1kaWEpfHx2b2lkIDA9PT1jfHxudWxsPT09KGw9Yy5taW5mKXx8dm9pZCAwPT09bHx8bnVsbD09PShkPWwuc3RibCl8fHZvaWQgMD09PWQ/dm9pZCAwOmQuc3Rzcyx2LmV4dC5jdHRzPW51bGw9PT0oZj1zLm1kaWEpfHx2b2lkIDA9PT1mfHxudWxsPT09KGg9Zi5taW5mKXx8dm9pZCAwPT09aHx8bnVsbD09PShwPWguc3RibCl8fHZvaWQgMD09PXA/dm9pZCAwOnAuY3R0cyxCJiYiZW5jdiI9PT1CLnR5cGUpdi5pc1ZpZGVvRW5jcnlwdGlvbj0hMCxCLmRlZmF1bHRfS0lEPW51bGw9PT0obT1CLnNpbmYpfHx2b2lkIDA9PT1tfHxudWxsPT09KGc9bS5zY2hpKXx8dm9pZCAwPT09Zz92b2lkIDA6Zy50ZW5jLmRlZmF1bHRfS0lELEIuZGVmYXVsdF9Jc0VuY3J5cHRlZD1udWxsPT09KGs9Qi5zaW5mKXx8dm9pZCAwPT09a3x8bnVsbD09PShiPWsuc2NoaSl8fHZvaWQgMD09PWI/dm9pZCAwOmIudGVuYy5kZWZhdWx0X0lzRW5jcnlwdGVkLEIuZGVmYXVsdF9JVl9zaXplPW51bGw9PT0oXz1CLnNpbmYpfHx2b2lkIDA9PT1ffHxudWxsPT09KHc9Xy5zY2hpKXx8dm9pZCAwPT09dz92b2lkIDA6dy50ZW5jLmRlZmF1bHRfSVZfc2l6ZSx2LnZpZGVvU2VuYz1zLm1kaWEubWluZi5zdGJsLnNlbmMmJnMubWRpYS5taW5mLnN0Ymwuc2VuYy5zYW1wbGVzLEIuZGF0YV9mb3JtYXQ9bnVsbD09PSh4PUIuc2luZil8fHZvaWQgMD09PXh8fG51bGw9PT0oQT14LmZybWEpfHx2b2lkIDA9PT1BP3ZvaWQgMDpBLmRhdGFfZm9ybWF0LHYudXNlRU1FPWUudXNlRU1FLHYua2lkVmFsdWU9ZS5raWRWYWx1ZSx2LnBzc2g9ZS5wc3NoLHYuZW5jdj1CfWlmKG8mJnIpe3ZhciBULEMsVSxQLEkseixNLFIsTyxMPXIsVj1udWxsPT09KFQ9by50a2hkKXx8dm9pZCAwPT09VD92b2lkIDA6VC50cmFja0lkO251bGwhPVYmJihMLmlkPW8udGtoZC50cmFja0lkKSxMLnRraGREdXJhdGlvbj1vLnRraGQuZHVyYXRpb24sTC5tdmhkRHVydGlvbj1lLm12aGQuZHVyYXRpb24sTC5tdmhkVGltZWNhbGU9ZS5tdmhkLnRpbWVzY2FsZSxMLnRpbWVzY2FsZT1MLmZvcm1hdFRpbWVzY2FsZT1vLm1kaWEubWRoZC50aW1lc2NhbGUsTC5kdXJhdGlvbj1vLm1kaWEubWRoZC5kdXJhdGlvbnx8TC5tdmhkRHVydGlvbi9MLm12aGRUaW1lY2FsZSpMLnRpbWVzY2FsZTt2YXIgRixOLGosRyxILEsscSxXLFg9by5tZGlhLm1pbmYuc3RibC5zdHNkLmVudHJpZXNbMF07c3dpdGNoKEwuc2FtcGxlU2l6ZT1YLnNhbXBsZVNpemUsTC5zYW1wbGVSYXRlPVguc2FtcGxlUmF0ZSxMLmNoYW5uZWxDb3VudD1YLmNoYW5uZWxDb3VudCxMLnByZXNlbnQ9ITAsWC50eXBlKXtjYXNlImFsYXciOkwuY29kZWNUeXBlPUwuY29kZWM9RCxMLnNhbXBsZVJhdGU9OGUzO2JyZWFrO2Nhc2UidWxhdyI6TC5jb2RlY1R5cGU9TC5jb2RlYz1FLEwuc2FtcGxlUmF0ZT04ZTM7YnJlYWs7ZGVmYXVsdDpMLnNhbXBsZUR1cmF0aW9uPXNlLmdldEZyYW1lRHVyYXRpb24oTC5zYW1wbGVSYXRlLEwudGltZXNjYWxlKSxMLnNhbXBsZVJhdGVJbmRleD1zZS5nZXRSYXRlSW5kZXhCeVJhdGUoTC5zYW1wbGVSYXRlKSxMLm9iamVjdFR5cGU9KG51bGw9PT0oYT1YLmVzZHMpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLm9iamVjdFR5cGUpfHwyLFguZXNkcyYmKEwuY29uZmlnPUFycmF5LmZyb20oWC5lc2RzLmNvbmZpZykpLEwuY29kZWM9KG51bGw9PT0obj1YLmVzZHMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmNvZGVjKXx8Im1wNGEuNDAuMiJ9aWYoTC5zYW1wbGVEdXJhdGlvbj1zZS5nZXRGcmFtZUR1cmF0aW9uKEwuc2FtcGxlUmF0ZSxMLnRpbWVzY2FsZSksTC5vYmplY3RUeXBlPShudWxsPT09KEM9WC5lc2RzKXx8dm9pZCAwPT09Qz92b2lkIDA6Qy5vYmplY3RUeXBlKXx8MixYLmVzZHMmJihYLmVzZHMuY29uZmlnP0wuY29uZmlnPUFycmF5LmZyb20oWC5lc2RzLmNvbmZpZyk6Y29uc29sZS53YXJuKCJlc2RzIGNvbmZpZyBpcyBudWxsIikpLEwuY29kZWM9KG51bGw9PT0oVT1YLmVzZHMpfHx2b2lkIDA9PT1VP3ZvaWQgMDpVLmNvZGVjKXx8Im1wNGEuNDAuMiIsTC5zYW1wbGVSYXRlSW5kZXg9c2UuZ2V0UmF0ZUluZGV4QnlSYXRlKEwuc2FtcGxlUmF0ZSksTC5leHQ9e30sTC5leHQuc3Rzcz1udWxsPT09KFA9by5tZGlhKXx8dm9pZCAwPT09UHx8bnVsbD09PShJPVAubWluZil8fHZvaWQgMD09PUl8fG51bGw9PT0oej1JLnN0YmwpfHx2b2lkIDA9PT16P3ZvaWQgMDp6LnN0c3MsTC5leHQuY3R0cz1udWxsPT09KE09by5tZGlhKXx8dm9pZCAwPT09TXx8bnVsbD09PShSPU0ubWluZil8fHZvaWQgMD09PVJ8fG51bGw9PT0oTz1SLnN0YmwpfHx2b2lkIDA9PT1PP3ZvaWQgMDpPLmN0dHMsTC5wcmVzZW50PSEwLFgmJiJlbmNhIj09PVgudHlwZSlMLmlzQXVkaW9FbmNyeXB0aW9uPSEwLFguZGF0YV9mb3JtYXQ9bnVsbD09PShGPVguc2luZil8fHZvaWQgMD09PUZ8fG51bGw9PT0oTj1GLmZybWEpfHx2b2lkIDA9PT1OP3ZvaWQgMDpOLmRhdGFfZm9ybWF0LFguZGVmYXVsdF9LSUQ9bnVsbD09PShqPVguc2luZil8fHZvaWQgMD09PWp8fG51bGw9PT0oRz1qLnNjaGkpfHx2b2lkIDA9PT1HP3ZvaWQgMDpHLnRlbmMuZGVmYXVsdF9LSUQsWC5kZWZhdWx0X0lzRW5jcnlwdGVkPW51bGw9PT0oSD1YLnNpbmYpfHx2b2lkIDA9PT1IfHxudWxsPT09KEs9SC5zY2hpKXx8dm9pZCAwPT09Sz92b2lkIDA6Sy50ZW5jLmRlZmF1bHRfSXNFbmNyeXB0ZWQsWC5kZWZhdWx0X0lWX3NpemU9bnVsbD09PShxPVguc2luZil8fHZvaWQgMD09PXF8fG51bGw9PT0oVz1xLnNjaGkpfHx2b2lkIDA9PT1XP3ZvaWQgMDpXLnRlbmMuZGVmYXVsdF9JVl9zaXplLEwuYXVkaW9TZW5jPW8ubWRpYS5taW5mLnN0Ymwuc2VuYyYmby5tZGlhLm1pbmYuc3RibC5zZW5jLnNhbXBsZXMsTC51c2VFTUU9ZS51c2VFTUUsTC5raWRWYWx1ZT1lLmtpZFZhbHVlLEwuZW5jYT1YfWlmKHImJihyLmlzVmlkZW9FbmNyeXB0aW9uPSEhdCYmdC5pc1ZpZGVvRW5jcnlwdGlvbiksdCYmKHQuaXNBdWRpb0VuY3J5cHRpb249ISFyJiZyLmlzQXVkaW9FbmNyeXB0aW9uKSxudWxsIT10JiZ0LmVuY3Z8fG51bGwhPXImJnIuZW5jYSl7dmFyIFksWixRPW51bGw9PXR8fG51bGw9PT0oWT10LmVuY3YpfHx2b2lkIDA9PT1ZP3ZvaWQgMDpZLmRlZmF1bHRfS0lELEo9bnVsbD09cnx8bnVsbD09PShaPXIuZW5jYSl8fHZvaWQgMD09PVo/dm9pZCAwOlouZGVmYXVsdF9LSUQsJD1RfHxKPyhRfHxKKS5qb2luKCIiKTpudWxsO3QmJih0LmtpZD0kKSxyJiYoci5raWQ9JCl9cmV0dXJuIHQmJih0LmZsYWdzPTM4NDEpLHImJihyLmZsYWdzPTE3OTMpLHt2aWRlb1RyYWNrOnQsYXVkaW9UcmFjazpyfX19fSx7a2V5OiJldmFsdWF0ZURlZmF1bHREdXJhdGlvbiIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBhLG49bnVsbD09dHx8bnVsbD09PShhPXQuc2FtcGxlcyl8fHZvaWQgMD09PWE/dm9pZCAwOmEubGVuZ3RoO3JldHVybiBuPzEwMjQqbi90LnRpbWVzY2FsZSplLnRpbWVzY2FsZS9yOjEwMjR9fSx7a2V5OiJtb29mVG9TYW1wbGVzIix2YWx1ZTpmdW5jdGlvbih0LHIsYSl7dmFyIG49e307cmV0dXJuIHQubWZoZCYmKHImJihyLnNlcXVlbmNlTnVtYmVyPXQubWZoZC5zZXF1ZW5jZU51bWJlciksYSYmKGEuc2VxdWVuY2VOdW1iZXI9dC5tZmhkLnNlcXVlbmNlTnVtYmVyKSksdC50cmFmLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciBpPXQudGZoZCxzPXQudGZkdCxvPXQudHJ1bjtpZihpJiZvKXtzJiYociYmci5pZD09PWkudHJhY2tJZCYmKHIuYmFzZU1lZGlhRGVjb2RlVGltZT1zLmJhc2VNZWRpYURlY29kZVRpbWUpLGEmJmEuaWQ9PT1pLnRyYWNrSWQmJihhLmJhc2VNZWRpYURlY29kZVRpbWU9cy5iYXNlTWVkaWFEZWNvZGVUaW1lKSk7dmFyIHU9aS5kZWZhdWx0U2FtcGxlU2l6ZXx8MCxjPWkuZGVmYXVsdFNhbXBsZUR1cmF0aW9ufHxlLmV2YWx1YXRlRGVmYXVsdER1cmF0aW9uKHIsYSxvLnNhbXBsZXMubGVuZ3RofHxvLnNhbXBsZUNvdW50KSxsPW8uZGF0YU9mZnNldHx8MCxkPTAsZj0tMTtpZighby5zYW1wbGVzLmxlbmd0aCYmby5zYW1wbGVDb3VudCl7bltpLnRyYWNrSWRdPVtdO2Zvcih2YXIgaD0wO2g8by5zYW1wbGVDb3VudDtoKyspbltpLnRyYWNrSWRdLnB1c2goe29mZnNldDpsLGR0czpkLGR1cmF0aW9uOmMsc2l6ZTp1fSksZCs9YyxsKz11fWVsc2UgbltpLnRyYWNrSWRdPW8uc2FtcGxlcy5tYXAoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuKGU9e29mZnNldDpsLGR0czpkLHB0czpkKyhlLmN0c3x8MCksZHVyYXRpb246ZS5kdXJhdGlvbnx8YyxzaXplOmUuc2l6ZXx8dSxnb3BJZDpmLGtleWZyYW1lOjA9PT10fHxudWxsIT09ZS5mbGFncyYmdm9pZCAwIT09ZS5mbGFncyYmKDY1NTM2JmUuZmxhZ3MpPj4+MCE9NjU1MzZ9KS5rZXlmcmFtZSYmKGYrKyxlLmdvcElkPWYpLGQrPWUuZHVyYXRpb24sbCs9ZS5zaXplLGV9KSl9fSkpLG59fSx7a2V5OiJtb292VG9TYW1wbGVzIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnRyYWs7aWYodCYmdC5sZW5ndGgpe3ZhciByPXQuZmluZCgoZnVuY3Rpb24oZSl7dmFyIHQscjtyZXR1cm4idmlkZSI9PT0obnVsbD09PSh0PWUubWRpYSl8fHZvaWQgMD09PXR8fG51bGw9PT0ocj10LmhkbHIpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmhhbmRsZXJUeXBlKX0pKSxhPXQuZmluZCgoZnVuY3Rpb24oZSl7dmFyIHQscjtyZXR1cm4ic291biI9PT0obnVsbD09PSh0PWUubWRpYSl8fHZvaWQgMD09PXR8fG51bGw9PT0ocj10LmhkbHIpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmhhbmRsZXJUeXBlKX0pKTtpZihyfHxhKXt2YXIgbixpO2lmKHIpe3ZhciBzLG8sdT1udWxsPT09KHM9ci5tZGlhKXx8dm9pZCAwPT09c3x8bnVsbD09PShvPXMubWluZil8fHZvaWQgMD09PW8/dm9pZCAwOm8uc3RibDtpZighdSlyZXR1cm47dmFyIGM9dS5zdHRzLGw9dS5zdHNjLGQ9dS5zdHN6LGY9dS5zdGNvLGg9dS5zdHNzLHA9dS5jdHRzO2lmKCEoYyYmbCYmZCYmZiYmaCkpcmV0dXJuO249dmUoYyxsLGQsZixwLGgpfWlmKGEpe3ZhciB2LHksbSxnPW51bGw9PT0odj1hLm1kaWEpfHx2b2lkIDA9PT12fHxudWxsPT09KHk9di5taW5mKXx8dm9pZCAwPT09eT92b2lkIDA6eS5zdGJsO2lmKCFnKXJldHVybjt2YXIgaz1udWxsPT09KG09YS5tZGlhLm1kaGQpfHx2b2lkIDA9PT1tP3ZvaWQgMDptLnRpbWVzY2FsZSxiPWcuc3R0cyxfPWcuc3RzYyx3PWcuc3Rzeix4PWcuc3RjbztpZighKGsmJmImJl8mJncmJngpKXJldHVybjtpPXZlKGIsXyx3LHgpfXJldHVybnt2aWRlb1NhbXBsZXM6bixhdWRpb1NhbXBsZXM6aX19fX19XSksZX0oKTtmdW5jdGlvbiB2ZShlLHQscixhLG4saSl7dmFyIHMsbyx1LGM9W10sbD1udWxsPT1uP3ZvaWQgMDpuLmVudHJpZXMsZD10LmVudHJpZXMsZj1hLmVudHJpZXMsaD1yLmVudHJ5U2l6ZXMscD1udWxsPT1pP3ZvaWQgMDppLmVudHJpZXM7cCYmKHM9e30scC5mb3JFYWNoKChmdW5jdGlvbihlKXtzW2UtMV09ITB9KSkpLGwmJihvPVtdLGwuZm9yRWFjaCgoZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWUuY291bnQscj1lLm9mZnNldCxhPTA7YTx0O2ErKylvLnB1c2gocil9KSkpO3ZhciB2PS0xLHk9MCxtPTAsZz0wLGs9MCxiPTAsXz1kWzBdLnNhbXBsZXNQZXJDaHVuayx3PWRbMV0/ZFsxXS5maXJzdENodW5rLTE6MS8wO3JldHVybiBlLmVudHJpZXMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWUuY291bnQsYT1lLmRlbHRhLG49MDtuPHQ7bisrKXU9e2R0czp5LGR1cmF0aW9uOmEsc2l6ZTpoW21dfHxyLnNhbXBsZVNpemUsb2Zmc2V0OmZbZ10rYixpbmRleDptfSxwJiYodS5rZXlmcmFtZT1zW21dLHUua2V5ZnJhbWUmJnYrKyx1LmdvcElkPXYpLG8mJm08by5sZW5ndGgmJih1LnB0cz11LmR0cytvW21dKSxjLnB1c2godSkseSs9YSwrK208Xz9iKz11LnNpemU6KGcrKyxiPTAsZz49dyYmKGsrKyx3PWRbaysxXT9kW2srMV0uZmlyc3RDaHVuay0xOjEvMCksXys9ZFtrXS5zYW1wbGVzUGVyQ2h1bmspfSkpLGN9ZnVuY3Rpb24geWUoZSx0KXtyZXR1cm4gZS5kYXRhUmVmZXJlbmNlSW5kZXg9Sih0LDYpLGUud2lkdGg9Sih0LDI0KSxlLmhlaWdodD1KKHQsMjYpLGUuaG9yaXpyZXNvbHV0aW9uPSQodCwyOCksZS52ZXJ0cmVzb2x1dGlvbj0kKHQsMzIpLGUuZnJhbWVDb3VudD1KKHQsNDApLGUuZGVwdGg9Sih0LDc0KSw3OH1mdW5jdGlvbiBtZShlLHQpe3JldHVybiBlLmRhdGFSZWZlcmVuY2VJbmRleD1KKHQsNiksZS5jaGFubmVsQ291bnQ9Sih0LDE2KSxlLnNhbXBsZVNpemU9Sih0LDE4KSxlLnNhbXBsZVJhdGU9JCh0LDI0KS82NTUzNiwyOH1mdW5jdGlvbiBnZShlLHQscil7aWYoZSl7aWYoZS5zaXplIT09ZS5kYXRhLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImJveCAiLmNvbmNhdChlLnR5cGUsIiBzaXplICE9PSBkYXRhLmxlbmd0aCIpKTt2YXIgYT17c3RhcnQ6ZS5zdGFydCxzaXplOmUuc2l6ZSxoZWFkZXJTaXplOmUuaGVhZGVyU2l6ZSx0eXBlOmUudHlwZX07cmV0dXJuIHQmJihhLnZlcnNpb249ZS5kYXRhW2UuaGVhZGVyU2l6ZV0sYS5mbGFncz1mdW5jdGlvbihlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06MDtyZXR1cm4oZVt0XTw8MTYpKyhlW3QrMV08PDgpKyhlW3QrMl18fDApfShlLmRhdGEsZS5oZWFkZXJTaXplKzEpLGEuaGVhZGVyU2l6ZSs9NCkscihhLGUuZGF0YS5zdWJhcnJheShhLmhlYWRlclNpemUpLGEuc3RhcnQrYS5oZWFkZXJTaXplKSxhfX12YXIga2U9ZnVuY3Rpb24oZSx0LHIpe2Zvcih2YXIgYT1TdHJpbmcociksbj10Pj4wLGk9TWF0aC5jZWlsKG4vYS5sZW5ndGgpLHM9W10sbz1TdHJpbmcoZSk7aS0tOylzLnB1c2goYSk7cmV0dXJuIHMuam9pbigiIikuc3Vic3RyaW5nKDAsbi1vLmxlbmd0aCkrb30sYmU9ZnVuY3Rpb24oKXtmb3IodmFyIGU9W10sdD1hcmd1bWVudHMubGVuZ3RoLHI9bmV3IEFycmF5KHQpLGE9MDthPHQ7YSsrKXJbYV09YXJndW1lbnRzW2FdO3JldHVybiByLmZvckVhY2goKGZ1bmN0aW9uKHQpe2UucHVzaChrZShOdW1iZXIodCkudG9TdHJpbmcoMTYpLDIsMCkpfSkpLGVbMF19O2Z1bmN0aW9uIF9lKGUpe2Zvcih2YXIgdD0wLHI9YXJndW1lbnRzLmxlbmd0aCxhPW5ldyBBcnJheShyPjE/ci0xOjApLG49MTtuPHI7bisrKWFbbi0xXT1hcmd1bWVudHNbbl07YS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Kz1lLmxlbmd0aH0pKTt2YXIgaT1uZXcgZSh0KSxzPTA7cmV0dXJuIGEuZm9yRWFjaCgoZnVuY3Rpb24oZSl7aS5zZXQoZSxzKSxzKz1lLmxlbmd0aH0pKSxpfXZhciB3ZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSksdGhpcy5idWZmZXI9bmV3IFVpbnQ4QXJyYXkoMCl9cmV0dXJuIG4oZSxbe2tleToid3JpdGUiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPXRoaXMsdD1hcmd1bWVudHMubGVuZ3RoLHI9bmV3IEFycmF5KHQpLGE9MDthPHQ7YSsrKXJbYV09YXJndW1lbnRzW2FdO3IuZm9yRWFjaCgoZnVuY3Rpb24odCl7dD9lLmJ1ZmZlcj1fZShVaW50OEFycmF5LGUuYnVmZmVyLHQpOndpbmRvdy5jb25zb2xlLndhcm4odCl9KSl9fV0sW3trZXk6IndyaXRlVWludDE2Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoW2U+PjgmMjU1LDI1NSZlXSl9fSx7a2V5OiJ3cml0ZVVpbnQzMiIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBVaW50OEFycmF5KFtlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdKX19XSksZX0oKSx4ZT1NYXRoLnBvdygyLDMyKS0xLFNlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKX1yZXR1cm4gbihlLG51bGwsW3trZXk6ImJveCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWFyZ3VtZW50cy5sZW5ndGgscj1uZXcgQXJyYXkodD4xP3QtMTowKSxhPTE7YTx0O2ErKylyW2EtMV09YXJndW1lbnRzW2FdO3ZhciBuPTgrKHI9ci5maWx0ZXIoQm9vbGVhbikpLnJlZHVjZSgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZSt0LmJ5dGVMZW5ndGh9KSwwKSxpPW5ldyBVaW50OEFycmF5KG4pO2lbMF09bj4+MjQmMjU1LGlbMV09bj4+MTYmMjU1LGlbMl09bj4+OCYyNTUsaVszXT0yNTUmbixpLnNldChlLDQpO3ZhciBzPTg7cmV0dXJuIHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7aS5zZXQoZSxzKSxzKz1lLmJ5dGVMZW5ndGh9KSksaX19LHtrZXk6ImZ0eXAiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0LmZpbmQoKGZ1bmN0aW9uKGUpe3JldHVybiBlLnR5cGU9PT1iJiZlLmNvZGVjVHlwZT09PVN9KSk/ZS5GVFlQSEVWMTplLkZUWVBBVkMxfX0se2tleToiaW5pdFNlZ21lbnQiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBaKGUuZnR5cCh0KSxlLm1vb3YodCkpfX0se2tleToicHNzaCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IFVpbnQ4QXJyYXkoWzEsMCwwLDBdLmNvbmNhdChbMTYsMTE5LDIzOSwyMzYsMTkyLDE3OCw3NywyLDE3MiwyMjcsNjAsMzAsODIsMjI2LDI1MSw3NV0sWzAsMCwwLDFdLGFlKHQua2lkKSxbMCwwLDAsMF0pKTtyZXR1cm4gZS5ib3goZS50eXBlcy5wc3NoLHIpfX0se2tleToibW9vdiIsdmFsdWU6ZnVuY3Rpb24odCl7aWYodFswXS51c2VFTUUmJih0WzBdLmVuY3Z8fHRbMF0uZW5jYSkpe3RbMF0ucHNzaHx8KHRbMF0ucHNzaD17a2lkOnRbMF0ua2lkfSk7dmFyIHI9dGhpcy5wc3NoKHRbMF0ucHNzaCk7cmV0dXJuIGUuYm94LmFwcGx5KGUsW2UudHlwZXMubW9vdixlLm12aGQodFswXS5tdmhkRHVydGlvbnx8dFswXS5kdXJhdGlvbix0WzBdLm12aGRUaW1lY2FsZXx8dFswXS50aW1lc2NhbGUpLGUubXZleCh0KV0uY29uY2F0KHkodC5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWsodCl9KSkpLFtyXSkpfXJldHVybiBlLmJveC5hcHBseShlLFtlLnR5cGVzLm1vb3YsZS5tdmhkKHRbMF0ubXZoZER1cnRpb258fHRbMF0uZHVyYXRpb24sdFswXS5tdmhkVGltZWNhbGV8fHRbMF0udGltZXNjYWxlKV0uY29uY2F0KHkodC5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWsodCl9KSkpLFtlLm12ZXgodCldKSl9fSx7a2V5OiJtdmhkIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06OWU0LGE9ZS5ib3goZS50eXBlcy5tdmhkLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCxyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyLHQ+PjI0JjI1NSx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnQsMCwxLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsNjQsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMjU1LDI1NSwyNTUsMjU1XSkpO3JldHVybiBhfX0se2tleToidHJhayIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMudHJhayxlLnRraGQodC5pZCx0LnRraGREdXJhdGlvbnx8MCx0LndpZHRoLHQuaGVpZ2h0KSxlLm1kaWEodCkpfX0se2tleToidGtoZCIsdmFsdWU6ZnVuY3Rpb24odCxyKXt2YXIgYT1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06MCxuPWFyZ3VtZW50cy5sZW5ndGg+MyYmdm9pZCAwIT09YXJndW1lbnRzWzNdP2FyZ3VtZW50c1szXTowLGk9ZS5ib3goZS50eXBlcy50a2hkLG5ldyBVaW50OEFycmF5KFswLDAsMCw3LDAsMCwwLDAsMCwwLDAsMCx0Pj4yNCYyNTUsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0LDAsMCwwLDAscj4+MjQmMjU1LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmciwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCw2NCwwLDAsMCxhPj44JjI1NSwyNTUmYSwwLDAsbj4+OCYyNTUsMjU1Jm4sMCwwXSkpO3JldHVybiBpfX0se2tleToibWRpYSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMubWRpYSxlLm1kaGQodC5kdXJhdGlvbix0LnRpbWVzY2FsZSksZS5oZGxyKHQudHlwZSksZS5taW5mKHQpKX19LHtrZXk6Im1kaGQiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTo5ZTQsYT1lLmJveChlLnR5cGVzLm1kaGQsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLHI+PjI0JjI1NSxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsdD4+MjQmMjU1LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdCw4NSwxOTYsMCwwXSkpO3JldHVybiBhfX0se2tleToiaGRsciIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMuaGRscixlLkhETFJfVFlQRVNbdF0pfX0se2tleToibWluZiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMubWluZix0LnR5cGU9PT1iP2UuVk1IRDplLlNNSEQsZS5ESU5GLGUuc3RibCh0KSl9fSx7a2V5OiJzdGJsIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1bXTtyZXR1cm4gdCYmdC5leHQmJnQuZXh0LnN0c3MmJnIucHVzaChlLnN0c3ModC5leHQuc3Rzcy5lbnRyaWVzKSksZS5ib3goZS50eXBlcy5zdGJsLGUuc3RzZCh0KSxlLlNUVFMsclswXSxlLlNUU0MsZS5TVFNaLGUuU1RDTyl9fSx7a2V5OiJzdHNkIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcjtyZXR1cm4gcj0iYXVkaW8iPT09dC50eXBlP3QudXNlRU1FJiZ0LmVuY2E/ZS5lbmNhKHQpOmUubXA0YSh0KTp0LnVzZUVNRSYmdC5lbmN2P2UuZW5jdih0KTplLmF2YzFoZXYxKHQpLGUuYm94KGUudHlwZXMuc3RzZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxXSkscil9fSx7a2V5OiJlbmNhIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10LmVuY2EuY2hhbm5lbENvdW50LGE9dC5lbmNhLnNhbXBsZVJhdGUsbj1uZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLHIsMCwxNiwwLDAsMCwwLGE+PjgmMjU1LDI1NSZhLDAsMF0pLGk9ZS5lc2RzKHQuY29uZmlnKSxzPWUuc2luZih0LmVuY2EpO3JldHVybiBlLmJveChlLnR5cGVzLmVuY2EsbixpLHMpfX0se2tleToiZW5jdiIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHIsYSxuPXQuc3BzLmxlbmd0aD4wP3Quc3BzWzBdOltdLGk9dC5wcHMubGVuZ3RoPjA/dC5wcHNbMF06W10scz10LndpZHRoLG89dC5oZWlnaHQsdT10LnNhclJhdGlvWzBdLGM9dC5zYXJSYXRpb1sxXSxsPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCxzPj44JjI1NSwyNTUmcyxvPj44JjI1NSwyNTUmbywwLDcyLDAsMCwwLDcyLDAsMCwwLDAsMCwwLDAsMSwxOCwxMDAsOTcsMTA1LDEwOCwxMjEsMTA5LDExMSwxMTYsMTA1LDExMSwxMTAsNDcsMTA0LDEwOCwxMTUsNDYsMTA2LDExNSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMjQsMTcsMTddKSxkPW5ldyBVaW50OEFycmF5KChyPShhPVsxLG5bMV0sblsyXSxuWzNdLDI1NSwyMjUsbi5sZW5ndGg+Pj44JjI1NSwyNTUmbi5sZW5ndGhdKS5jb25jYXQuYXBwbHkoYSx5KG4pKS5jb25jYXQoWzEsaS5sZW5ndGg+Pj44JjI1NSwyNTUmaS5sZW5ndGhdKSkuY29uY2F0LmFwcGx5KHIseShpKSkpLGY9bmV3IFVpbnQ4QXJyYXkoWzAsMCw4OCw1NywwLDE1LDIwMCwxOTIsMCw0LDg2LDcyXSksaD1lLnNpbmYodC5lbmN2KSxwPW5ldyBVaW50OEFycmF5KFt1Pj4yNCx1Pj4xNiYyNTUsdT4+OCYyNTUsMjU1JnUsYz4+MjQsYz4+MTYmMjU1LGM+PjgmMjU1LDI1NSZjXSk7cmV0dXJuIGUuYm94KGUudHlwZXMuZW5jdixsLGUuYm94KGUudHlwZXMuYXZjQyxkKSxlLmJveChlLnR5cGVzLmJ0cnQsZiksaCxlLmJveChlLnR5cGVzLnBhc3AscCkpfX0se2tleToic2NoaSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IFVpbnQ4QXJyYXkoW10pLGE9ZS50ZW5jKHQpO3JldHVybiBlLmJveChlLnR5cGVzLnNjaGkscixhKX19LHtrZXk6InRlbmMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwyNTUmdC5kZWZhdWx0X0lzRW5jcnlwdGVkLDI1NSZ0LmRlZmF1bHRfSVZfc2l6ZV0uY29uY2F0KGFlKHQuZGVmYXVsdF9LSUQpKSk7cmV0dXJuIGUuYm94KGUudHlwZXMudGVuYyxyKX19LHtrZXk6InNpbmYiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyBVaW50OEFycmF5KFtdKSxhPW5ldyBVaW50OEFycmF5KFt0LmRhdGFfZm9ybWF0LmNoYXJDb2RlQXQoMCksdC5kYXRhX2Zvcm1hdC5jaGFyQ29kZUF0KDEpLHQuZGF0YV9mb3JtYXQuY2hhckNvZGVBdCgyKSx0LmRhdGFfZm9ybWF0LmNoYXJDb2RlQXQoMyldKSxuPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDk5LDEwMSwxMTAsOTksMCwxLDAsMF0pLGk9ZS5zY2hpKHQpO3JldHVybiBlLmJveChlLnR5cGVzLnNpbmYscixlLmJveChlLnR5cGVzLmZybWEsYSksZS5ib3goZS50eXBlcy5zY2htLG4pLGkpfX0se2tleToiYXZjMWhldjEiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQuY29kZWNUeXBlPT09UyxhPXI/ZS50eXBlcy5odmMxOmUudHlwZXMuYXZjMSxuPXI/ZS5odmNDKHQpOmUuYXZjQyh0KSxpPVtuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsdC53aWR0aD4+OCYyNTUsMjU1JnQud2lkdGgsdC5oZWlnaHQ+PjgmMjU1LDI1NSZ0LmhlaWdodCwwLDcyLDAsMCwwLDcyLDAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyNCwxNywxN10pLG5dO3JldHVybiByP2kucHVzaChlLmJveChlLnR5cGVzLmZpZWwsbmV3IFVpbnQ4QXJyYXkoWzEsMF0pKSk6dC5zYXJSYXRpbyYmdC5zYXJSYXRpby5sZW5ndGg+MSYmaS5wdXNoKGUucGFzcCh0LnNhclJhdGlvKSksZS5ib3guYXBwbHkoZSxbYV0uY29uY2F0KGkpKX19LHtrZXk6ImF2Y0MiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByLGEsbixpPVtdLHM9W107cmV0dXJuIHQuc3BzLmZvckVhY2goKGZ1bmN0aW9uKGUpe249ZS5ieXRlTGVuZ3RoLGkucHVzaChuPj4+OCYyNTUpLGkucHVzaCgyNTUmbiksaS5wdXNoLmFwcGx5KGkseShlKSl9KSksdC5wcHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7bj1lLmJ5dGVMZW5ndGgscy5wdXNoKG4+Pj44JjI1NSkscy5wdXNoKDI1NSZuKSxzLnB1c2guYXBwbHkocyx5KGUpKX0pKSxlLmJveChlLnR5cGVzLmF2Y0MsbmV3IFVpbnQ4QXJyYXkoKHI9KGE9WzEsaVszXSxpWzRdLGlbNV0sMjU1LDIyNHx0LnNwcy5sZW5ndGhdKS5jb25jYXQuYXBwbHkoYSxpKS5jb25jYXQoW3QucHBzLmxlbmd0aF0pKS5jb25jYXQuYXBwbHkocixzKSkpfX0se2tleToiaHZjQyIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dC5odmNDO2lmKHIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcnx8ciBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpcmV0dXJuIHI7dmFyIGEsbj10LnZwcyxpPXQuc3BzLHM9dC5wcHM7aWYocil7dmFyIG89ci5nZW5lcmFsUHJvZmlsZUNvbXBhdGliaWxpdHlGbGFncyx1PXIuZ2VuZXJhbENvbnN0cmFpbnRJbmRpY2F0b3JGbGFncyxjPShuLmxlbmd0aCYmMSkrKGkubGVuZ3RoJiYxKSsocy5sZW5ndGgmJjEpO2E9WzEsci5nZW5lcmFsUHJvZmlsZVNwYWNlPDw2fHIuZ2VuZXJhbFRpZXJGbGFnPDw1fHIuZ2VuZXJhbFByb2ZpbGVJZGMsbz4+PjI0LG8+Pj4xNixvPj4+OCxvLHVbMF0sdVsxXSx1WzJdLHVbM10sdVs0XSx1WzVdLHIuZ2VuZXJhbExldmVsSWRjLDI0MCwwLDI1MiwyNTJ8ci5jaHJvbWFGb3JtYXRJZGMsMjQ4fHIuYml0RGVwdGhMdW1hTWludXM4LDI0OHxyLmJpdERlcHRoQ2hyb21hTWludXM4LDAsMCxyLm51bVRlbXBvcmFsTGF5ZXJzPDwzfHIudGVtcG9yYWxJZE5lc3RlZDw8MnwzLGNdO3ZhciBsPWZ1bmN0aW9uKGUpe3ZhciB0O2EucHVzaChlLmxlbmd0aD4+OCxlLmxlbmd0aCksKHQ9YSkucHVzaC5hcHBseSh0LHkoZSkpfTtuLmxlbmd0aCYmKGEucHVzaCgxNjAsMCxuLmxlbmd0aCksbi5mb3JFYWNoKGwpKSxpLmxlbmd0aCYmKGEucHVzaCgxNjEsMCxpLmxlbmd0aCksaS5mb3JFYWNoKGwpKSxzLmxlbmd0aCYmKGEucHVzaCgxNjIsMCxzLmxlbmd0aCkscy5mb3JFYWNoKGwpKX1lbHNlIGE9WzEsMSw5NiwwLDAsMCwxNDQsMCwwLDAsMCwwLDkzLDI0MCwwLDI1MiwyNTMsMjQ4LDI0OCwwLDAsMTUsMywxNjAsMCwxLDAsMjQsNjQsMSwxMiwxLDI1NSwyNTUsMSw5NiwwLDAsMywwLDE0NCwwLDAsMywwLDAsMywwLDkzLDE1MywxNTIsOSwxNjEsMCwxLDAsNDUsNjYsMSwxLDEsOTYsMCwwLDMsMCwxNDQsMCwwLDMsMCwwLDMsMCw5MywxNjAsMiwxMjgsMTI4LDQ1LDIyLDg5LDE1MywxNjQsMTQ3LDQzLDE1NCwxMjgsMTI4LDEyOCwxMzAsMCwwLDMsMCwyLDAsMCwzLDAsNTAsMTYsMTYyLDAsMSwwLDcsNjgsMSwxOTMsMTE0LDE4MCw5OCw2NF07cmV0dXJuIGUuYm94KGUudHlwZXMuaHZjQyxuZXcgVWludDhBcnJheShhKSl9fSx7a2V5OiJwYXNwIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj12KHQsMiksYT1yWzBdLG49clsxXTtyZXR1cm4gZS5ib3goZS50eXBlcy5wYXNwLG5ldyBVaW50OEFycmF5KFthPj4yNCxhPj4xNiYyNTUsYT4+OCYyNTUsMjU1JmEsbj4+MjQsbj4+MTYmMjU1LG4+PjgmMjU1LDI1NSZuXSkpfX0se2tleToibXA0YSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMubXA0YSxuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLHQuY2hhbm5lbENvdW50LDAsMTYsMCwwLDAsMCx0LnNhbXBsZVJhdGU+PjgmMjU1LDI1NSZ0LnNhbXBsZVJhdGUsMCwwXSksdC5jb25maWcubGVuZ3RoP2UuZXNkcyh0LmNvbmZpZyk6dm9pZCAwKX19LHtrZXk6ImVzZHMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQubGVuZ3RoO3JldHVybiBlLmJveChlLnR5cGVzLmVzZHMsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMywyMytyLDAsMCwwLDQsMTUrciw2NCwyMSwwLDYsMCwwLDAsMjE4LDE5MiwwLDAsMjE4LDE5Miw1XS5jb25jYXQoW3JdKS5jb25jYXQodCkuY29uY2F0KFs2LDEsMl0pKSl9fSx7a2V5OiJtdmV4Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3guYXBwbHkoZSxbZS50eXBlcy5tdmV4XS5jb25jYXQoeSh0Lm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIGUudHJleCh0LmlkKX0pKSkpKX19LHtrZXk6InRyZXgiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLnRyZXgsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsdD4+MjQsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0LDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMSwwLDFdKSl9fSx7a2V5OiJ0cmV4MSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMudHJleCxuZXcgVWludDhBcnJheShbMCwwLDAsMCx0Pj4yNCx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnQsMCwwLDAsMSwwLDAsMiwwLDAsMCwwLDAsMCwxLDAsMF0pKX19LHtrZXk6InRyZXgyIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy50cmV4LG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHQ+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdCwwLDAsMCwxLDAsMCw0LDAsMCwwLDAsMCwyLDAsMCwwXSkpfX0se2tleToibW9vZiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94LmFwcGx5KGUsW2UudHlwZXMubW9vZixlLm1maGQodFswXS5zYW1wbGVzP3RbMF0uc2FtcGxlc1swXS5nb3BJZDowKV0uY29uY2F0KHkodC5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWYodCl9KSkpKSl9fSx7a2V5OiJtZmhkIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy5tZmhkLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHQ+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdF0pKX19LHtrZXk6InRyYWYiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPWUudGZoZCh0LmlkKSxhPWUudGZkdCh0LHQuYmFzZU1lZGlhRGVjb2RlVGltZSksbj0wO2lmKHQuaXNWaWRlbyYmdC52aWRlb1NlbmMmJnQudmlkZW9TZW5jLmZvckVhY2goKGZ1bmN0aW9uKGUpe24rPTgsZS5zdWJzYW1wbGVzJiZlLnN1YnNhbXBsZXMubGVuZ3RoJiYobis9MixuKz02KmUuc3Vic2FtcGxlcy5sZW5ndGgpfSkpLHQudmlkZW9TZW5jTGVuZ3RoPW4sdC51c2VFTUUmJih0LmlzVmlkZW9FbmNyeXB0aW9ufHx0LmlzQXVkaW9FbmNyeXB0aW9uKSl7aWYodC5pc1ZpZGVvRW5jcnlwdGlvbil7aWYodC5pc1ZpZGVvKXt2YXIgaT1lLnNhaXoodCkscz1lLnNhaW8odCksbz1lLnRydW4xKHQpLHU9ZS5zZW5jKHQpO3JldHVybiBlLmJveChlLnR5cGVzLnRyYWYscixhLGkscyxvLHUpfWlmKHQuaXNBdWRpb0VuY3J5cHRpb24pe3ZhciBjPWUuc2JncCgpLGw9ZS5zYWl6KHQpLGQ9ZS5zYWlvKHQpLGY9ZS5zZW5jKHQpLGg9ZS50cnVuMSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFmLHIsYSxjLGwsZCxmLGgpfXZhciBwPWUuc2JncCgpLHY9ZS50cnVuMSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFmLHIsYSxwLHYpfWlmKHQuaXNWaWRlbyl7dmFyIHk9ZS50cnVuMSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFmLHIsYSx5KX12YXIgbT1lLnNiZ3AoKSxnPWUuc2Fpeih0KSxrPWUuc2Fpbyh0KSxiPWUuc2VuYyh0KSxfPWUudHJ1bjEodCk7cmV0dXJuIGUuYm94KGUudHlwZXMudHJhZixyLGEsbSxnLGssYixfKX12YXIgdz1lLnNkdHAodCk7cmV0dXJuIGUuYm94KGUudHlwZXMudHJhZixyLGEsdyxlLnRydW4odC5zYW1wbGVzLHcuYnl0ZUxlbmd0aCs3NikpfX0se2tleToic2R0cCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IHdlO3JldHVybiB0LnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ci53cml0ZShuZXcgVWludDhBcnJheSh0LmlzVmlkZW8/W2Uua2V5ZnJhbWU/MzI6MTZdOlsxNl0pKX0pKSxlLmJveChlLnR5cGVzLnNkdHAsdGhpcy5leHRlbnNpb24oMCwwKSxyLmJ1ZmZlcil9fSx7a2V5OiJ0cnVuMSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IHdlLGE9d2Uud3JpdGVVaW50MzIodC5zYW1wbGVzLmxlbmd0aCksbj1udWxsO2lmKHQuaXNWaWRlbyl7dmFyIGk9dC52aWRlb1NlbmNMZW5ndGg7bj13ZS53cml0ZVVpbnQzMigxNip0LnNhbXBsZXMubGVuZ3RoK2krMTQ5KSwhdC5pc1ZpZGVvRW5jcnlwdGlvbiYmdC5pc0F1ZGlvRW5jcnlwdGlvbiYmKG49d2Uud3JpdGVVaW50MzIoMTYqdC5zYW1wbGVzLmxlbmd0aCs5MikpfWVsc2V7dmFyIHM9MTIqdC5zYW1wbGVzLmxlbmd0aCsxMjQ7dC5pc0F1ZGlvRW5jcnlwdGlvbiYmKHM9MTIqdC5zYW1wbGVzLmxlbmd0aCs4KnQuYXVkaW9TZW5jLmxlbmd0aCsxNzcpLG49d2Uud3JpdGVVaW50MzIocyl9cmV0dXJuIHQuc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihlKXtyLndyaXRlKHdlLndyaXRlVWludDMyKGUuZHVyYXRpb24pKSxyLndyaXRlKHdlLndyaXRlVWludDMyKGUuc2l6ZSkpLHIud3JpdGUod2Uud3JpdGVVaW50MzIoZS5rZXlmcmFtZT8zMzU1NDQzMjo2NTUzNikpLHQuaXNWaWRlbyYmci53cml0ZSh3ZS53cml0ZVVpbnQzMihlLmN0cz9lLmN0czowKSl9KSksZS5ib3goZS50eXBlcy50cnVuLHRoaXMuZXh0ZW5zaW9uKDAsdC5mbGFncyksYSxuLHIuYnVmZmVyKX19LHtrZXk6InNlbmMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyB3ZSxhPXQuc2FtcGxlcy5sZW5ndGgsbj10LmlzVmlkZW8/MTY6OCxpPXQuaXNWaWRlbz8yOjAscz1bXSxvPTA7cmV0dXJuIHQuaXNWaWRlbz8ocz10LnZpZGVvU2VuYyxvPXQudmlkZW9TZW5jTGVuZ3RoKTpzPXQuYXVkaW9TZW5jLG89b3x8biphLHIud3JpdGUod2Uud3JpdGVVaW50MzIoMTYrbyksZS50eXBlcy5zZW5jLHRoaXMuZXh0ZW5zaW9uKDAsaSkpLHIud3JpdGUod2Uud3JpdGVVaW50MzIoYSkpLHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDxlLkluaXRpYWxpemF0aW9uVmVjdG9yLmxlbmd0aDt0Kyspci53cml0ZShuZXcgVWludDhBcnJheShbZS5Jbml0aWFsaXphdGlvblZlY3Rvclt0XV0pKTtlLnN1YnNhbXBsZXMmJmUuc3Vic2FtcGxlcy5sZW5ndGgmJihyLndyaXRlKHdlLndyaXRlVWludDE2KGUuc3Vic2FtcGxlcy5sZW5ndGgpKSxlLnN1YnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ci53cml0ZSh3ZS53cml0ZVVpbnQxNihlLkJ5dGVzT2ZDbGVhckRhdGEpKSxyLndyaXRlKHdlLndyaXRlVWludDMyKGUuQnl0ZXNPZlByb3RlY3RlZERhdGEpKX0pKSl9KSksci5idWZmZXJ9fSx7a2V5OiJzYWlvIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj0xMip0LnNhbXBsZXMubGVuZ3RoKzE0MTshdC5pc1ZpZGVvJiZ0LmlzQXVkaW9FbmNyeXB0aW9uJiYocj0xNDkpO3ZhciBhPW5ldyBVaW50OEFycmF5KFsxLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCxyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSk7cmV0dXJuIGUuYm94KGUudHlwZXMuc2FpbyxhKX19LHtrZXk6InNhaXoiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQuc2FtcGxlcy5sZW5ndGgsYT1uZXcgVWludDhBcnJheShbMCwwLDAsMCwxNixyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSk7cmV0dXJuIGUuYm94KGUudHlwZXMuc2FpeixhKX19LHtrZXk6InNiZ3AiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IFVpbnQ4QXJyYXkoWzExNCwxMTEsMTA4LDEwOCwwLDAsMCwxLDAsMCwxLDI1LDAsMCwwLDFdKTtyZXR1cm4gZS5ib3goZS50eXBlcy5zYmdwLHRoaXMuZXh0ZW5zaW9uKDAsMCksdCl9fSx7a2V5OiJleHRlbnNpb24iLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIG5ldyBVaW50OEFycmF5KFtlLHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdF0pfX0se2tleToidGZoZCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMudGZoZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCx0Pj4yNCx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnRdKSl9fSx7a2V5OiJ0ZmR0Iix2YWx1ZTpmdW5jdGlvbih0LHIpe3ZhciBhPU1hdGguZmxvb3Ioci8oeGUrMSkpLG49TWF0aC5mbG9vcihyJSh4ZSsxKSk7cmV0dXJuIHQudXNlRU1FJiYodC5pc1ZpZGVvRW5jcnlwdGlvbnx8dC5pc0F1ZGlvRW5jcnlwdGlvbik/ZS5ib3goZS50eXBlcy50ZmR0LG5ldyBVaW50OEFycmF5KFswLDAsMCwwLG4+PjI0LG4+PjE2JjI1NSxuPj44JjI1NSwyNTUmbl0pKTplLmJveChlLnR5cGVzLnRmZHQsbmV3IFVpbnQ4QXJyYXkoWzEsMCwwLDAsYT4+MjQsYT4+MTYmMjU1LGE+PjgmMjU1LDI1NSZhLG4+PjI0LG4+PjE2JjI1NSxuPj44JjI1NSwyNTUmbl0pKX19LHtrZXk6InRydW4iLHZhbHVlOmZ1bmN0aW9uKHQscil7dmFyIGE9dC5sZW5ndGgsbj0xMisxNiphO3IrPTgrbjt2YXIgaT1uZXcgVWludDhBcnJheShuKTtpLnNldChbMCwwLDE1LDEsYT4+PjI0JjI1NSxhPj4+MTYmMjU1LGE+Pj44JjI1NSwyNTUmYSxyPj4+MjQmMjU1LHI+Pj4xNiYyNTUscj4+PjgmMjU1LDI1NSZyXSwwKTtmb3IodmFyIHM9MDtzPGE7cysrKXt2YXIgbz10W3NdLHU9by5kdXJhdGlvbixjPW8uc2l6ZSxsPW8uZmxhZyxkPXZvaWQgMD09PWw/e306bCxmPW8uY3RzLGg9dm9pZCAwPT09Zj8wOmY7aS5zZXQoW3U+Pj4yNCYyNTUsdT4+PjE2JjI1NSx1Pj4+OCYyNTUsMjU1JnUsYz4+PjI0JjI1NSxjPj4+MTYmMjU1LGM+Pj44JjI1NSwyNTUmYyxkLmlzTGVhZGluZzw8MnwobnVsbD09PWQuZGVwZW5kc09ufHx2b2lkIDA9PT1kLmRlcGVuZHNPbj8xOmQuZGVwZW5kc09uKSxkLmlzRGVwZW5kZWRPbjw8NnxkLmhhc1JlZHVuZGFuY3k8PDR8ZC5wYWRkaW5nVmFsdWU8PDF8KG51bGw9PT1kLmlzTm9uU3luY1NhbXBsZXx8dm9pZCAwPT09ZC5pc05vblN5bmNTYW1wbGU/MTpkLmlzTm9uU3luY1NhbXBsZSksNjE0NDAmZC5kZWdyYWRhdGlvblByaW9yaXR5LDE1JmQuZGVncmFkYXRpb25Qcmlvcml0eSxoPj4+MjQmMjU1LGg+Pj4xNiYyNTUsaD4+PjgmMjU1LDI1NSZoXSwxMisxNipzKX1yZXR1cm4gZS5ib3goZS50eXBlcy50cnVuLGkpfX0se2tleToibW9vdk1QNCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94LmFwcGx5KGUsW2UudHlwZXMubW9vdixlLm12aGQodFswXS5kdXJhdGlvbix0WzBdLnRpbWVzY2FsZSldLmNvbmNhdCh5KHQubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gZS50cmFja01QNCh0KX0pKSkpKX19LHtrZXk6InRyYWNrTVA0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFrLGUudGtoZCh0LmlkLHQuZHVyYXRpb24sdC53aWR0aCx0LmhlaWdodCksZS5tZGlhTVA0KHQpKX19LHtrZXk6Im1kaWFNUDQiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLm1kaWEsZS5tZGhkKHQuZHVyYXRpb24sdC50aW1lc2NhbGUpLGUuaGRscih0LnR5cGUpLGUubWluZk1QNCh0KSl9fSx7a2V5OiJtaW5mTVA0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy5taW5mLHQudHlwZT09PWI/ZS5WTUhEOmUuU01IRCxlLkRJTkYsZS5zdGJsTVA0KHQpKX19LHtrZXk6InN0YmxNUDQiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQuZXh0LGE9W2Uuc3RzZCh0KSxlLnN0dHMoci5zdHRzKSxlLnN0c2Moci5zdHNjKSxlLnN0c3ooci5zdHN6KSxlLnN0Y28oci5zdGNvKV07cmV0dXJuIHIuc3Rzcy5sZW5ndGgmJmEucHVzaChlLnN0c3Moci5zdHNzKSksci5jdHRzLmxlbmd0aCYmYS5wdXNoKGUuY3R0cyhyLmN0dHMpKSxlLmJveC5hcHBseShlLFtlLnR5cGVzLnN0YmxdLmNvbmNhdChhKSl9fSx7a2V5OiJzdHRzIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aCxhPW5ldyBVaW50OEFycmF5KDgqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUudmFsdWUscj1lLmNvdW50O2Euc2V0KFtyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsdD4+MjQsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0XSxuKSxuKz04fSkpLGUuYm94KGUudHlwZXMuc3R0cyxaKG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHI+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcl0pLGEpKX19LHtrZXk6InN0c2MiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQubGVuZ3RoLGE9bmV3IFVpbnQ4QXJyYXkoMTIqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUuZmlyc3RDaHVuayxyPWUuc2FtcGxlc1BlckNodW5rLGk9ZS5zYW1wbGVEZXNjSW5kZXg7YS5zZXQoW3Q+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsaT4+MjQsaT4+MTYmMjU1LGk+PjgmMjU1LDI1NSZpXSxuKSxuKz0xMn0pKSxlLmJveChlLnR5cGVzLnN0c2MsWihuZXcgVWludDhBcnJheShbMCwwLDAsMCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnJdKSxhKSl9fSx7a2V5OiJzdHN6Iix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aCxhPW5ldyBVaW50OEFycmF5KDQqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe2Euc2V0KFtlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdLG4pLG4rPTR9KSksZS5ib3goZS50eXBlcy5zdHN6LFoobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnJdKSxhKSl9fSx7a2V5OiJzdGNvIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aCxhPW5ldyBVaW50OEFycmF5KDQqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe2Euc2V0KFtlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdLG4pLG4rPTR9KSksZS5ib3goZS50eXBlcy5zdGNvLFoobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAscj4+MjQscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSksYSkpfX0se2tleToic3RzcyIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dC5sZW5ndGgsYT1uZXcgVWludDhBcnJheSg0KnIpLG49MDtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbihlKXthLnNldChbZT4+MjQsZT4+MTYmMjU1LGU+PjgmMjU1LDI1NSZlXSxuKSxuKz00fSkpLGUuYm94KGUudHlwZXMuc3RzcyxaKG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHI+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcl0pLGEpKX19LHtrZXk6ImN0dHMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQubGVuZ3RoLGE9bmV3IFVpbnQ4QXJyYXkoOCpyKSxuPTA7cmV0dXJuIHQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS52YWx1ZSxyPWUuY291bnQ7YS5zZXQoW3I+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcix0Pj4yNCx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnRdLG4pLG4rPTh9KSksZS5ib3goZS50eXBlcy5jdHRzLFoobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAscj4+MjQscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSksYSkpfX0se2tleToic3R5cCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gZS5ib3goZS50eXBlcy5zdHlwLG5ldyBVaW50OEFycmF5KFsxMDksMTE1LDEwMCwxMDQsMCwwLDAsMCwxMDksMTE1LDEwMCwxMDQsMTA5LDExNSwxMDUsMTIwXSkpfX0se2tleToic2lkeCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dC50aW1lc2NhbGUsYT10LnNhbXBsZXNbMF0uZHVyYXRpb24sbj1hKnQuc2FtcGxlcy5sZW5ndGgsaT10LnNhbXBsZXNbMF0uc2FtcGxlT2Zmc2V0KmEscz04O3Quc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihlKXtzKz1lLnNpemV9KSk7dmFyIG89MDtpZih0LmlzVmlkZW8pe3ZhciB1LGM9MDt0LnZpZGVvU2VuYyYmKHU9dC52aWRlb1NlbmMpLHQuaXNWaWRlbyYmdS5mb3JFYWNoKChmdW5jdGlvbihlKXtjKz04LGUuc3Vic2FtcGxlcyYmZS5zdWJzYW1wbGVzLmxlbmd0aCYmKGMrPTIsYys9NiplLnN1YnNhbXBsZXMubGVuZ3RoKX0pKSx0LnZpZGVvU2VuY0xlbmd0aD1jLG89cysxNDErMTYqdC5zYW1wbGVzLmxlbmd0aCtjLHQudXNlRU1FJiZ0LmlzQXVkaW9FbmNyeXB0aW9uJiYhdC5pc1ZpZGVvRW5jcnlwdGlvbiYmKG89cysxNip0LnNhbXBsZXMubGVuZ3RoKzg0KX1lbHNlIG89cysxMTYrMTIqdC5zYW1wbGVzLmxlbmd0aCx0LnVzZUVNRSYmdC5pc0F1ZGlvRW5jcnlwdGlvbiYmKG89cysxNjkrMTIqdC5zYW1wbGVzLmxlbmd0aCs4KnQuYXVkaW9TZW5jLmxlbmd0aCk7dmFyIGw9bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMjU1JnQuaWQscj4+MjQmMjU1LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcixpPj4yNCYyNTUsaT4+MTYmMjU1LGk+PjgmMjU1LDI1NSZpLDAsMCwwLDAsMCwwLDAsMSwwLG8+PjE2JjI1NSxvPj44JjI1NSwyNTUmbyxuPj4yNCYyNTUsbj4+MTYmMjU1LG4+PjgmMjU1LDI1NSZuLDE0NCwwLDAsMF0pO3JldHVybiBlLmJveChlLnR5cGVzLnNpZHgsbCl9fSx7a2V5OiJtZGF0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy5tZGF0LHQpfX1dKSxlfSgpO2koU2UsInR5cGVzIixbImF2YzEiLCJhdmNDIiwiaHZjMSIsImh2Y0MiLCJkaW5mIiwiZHJlZiIsImVzZHMiLCJmdHlwIiwiaGRsciIsIm1kYXQiLCJtZGhkIiwibWRpYSIsIm1maGQiLCJtaW5mIiwibW9vZiIsIm1vb3YiLCJtcDRhIiwibXZleCIsIm12aGQiLCJwYXNwIiwic3RibCIsInN0Y28iLCJzdHNjIiwic3RzZCIsInN0c3oiLCJzdHRzIiwidGZkdCIsInRmaGQiLCJ0cmFmIiwidHJhayIsInRyZXgiLCJ0a2hkIiwidm1oZCIsInNtaGQiLCJjdHRzIiwic3RzcyIsInN0eXAiLCJwc3NoIiwic2lkeCIsInNiZ3AiLCJzYWl6Iiwic2FpbyIsInNlbmMiLCJ0cnVuIiwiZW5jdiIsImVuY2EiLCJzaW5mIiwiYnRydCIsImZybWEiLCJ0ZW5jIiwic2NobSIsInNjaGkiLCJtZWhkIiwiZmllbCIsInNkdHAiXS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGVbdF09W3QuY2hhckNvZGVBdCgwKSx0LmNoYXJDb2RlQXQoMSksdC5jaGFyQ29kZUF0KDIpLHQuY2hhckNvZGVBdCgzKV0sZX0pLE9iamVjdC5jcmVhdGUobnVsbCkpKSxpKFNlLCJIRExSX1RZUEVTIix7dmlkZW86bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCwxMTgsMTA1LDEwMCwxMDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsODYsMTA1LDEwMCwxMDEsMTExLDcyLDk3LDExMCwxMDAsMTA4LDEwMSwxMTQsMF0pLGF1ZGlvOm5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDAsMTE1LDExMSwxMTcsMTEwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDgzLDExMSwxMTcsMTEwLDEwMCw3Miw5NywxMTAsMTAwLDEwOCwxMDEsMTE0LDBdKX0pLGkoU2UsIkZUWVBBVkMxIixTZS5ib3goU2UudHlwZXMuZnR5cCxuZXcgVWludDhBcnJheShbMTA1LDExNSwxMTEsMTA5LDAsMCwwLDEsMTA1LDExNSwxMTEsMTA5LDk3LDExOCw5OSw0OV0pKSksaShTZSwiRlRZUEhFVjEiLFNlLmJveChTZS50eXBlcy5mdHlwLG5ldyBVaW50OEFycmF5KFsxMDUsMTE1LDExMSwxMDksMCwwLDAsMSwxMDUsMTE1LDExMSwxMDksMTA0LDEwMSwxMTgsNDldKSkpLGkoU2UsIkRJTkYiLFNlLmJveChTZS50eXBlcy5kaW5mLFNlLmJveChTZS50eXBlcy5kcmVmLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDEsMCwwLDAsMTIsMTE3LDExNCwxMDgsMzIsMCwwLDAsMV0pKSkpLGkoU2UsIlZNSEQiLFNlLmJveChTZS50eXBlcy52bWhkLG5ldyBVaW50OEFycmF5KFswLDAsMCwxLDAsMCwwLDAsMCwwLDAsMF0pKSksaShTZSwiU01IRCIsU2UuYm94KFNlLnR5cGVzLnNtaGQsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMF0pKSksaShTZSwiU3RibFRhYmxlIixuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwXSkpLGkoU2UsIlNUVFMiLFNlLmJveChTZS50eXBlcy5zdHRzLFNlLlN0YmxUYWJsZSkpLGkoU2UsIlNUU0MiLFNlLmJveChTZS50eXBlcy5zdHNjLFNlLlN0YmxUYWJsZSkpLGkoU2UsIlNUU1oiLFNlLmJveChTZS50eXBlcy5zdHN6LG5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDAsMCwwLDAsMF0pKSksaShTZSwiU1RDTyIsU2UuYm94KFNlLnR5cGVzLnN0Y28sU2UuU3RibFRhYmxlKSk7dmFyIEFlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LGEpe3IodGhpcyxlKSx0aGlzLm5hbWU9dHx8IiIsdGhpcy5fcHJlZml4PSJbIi5jb25jYXQodGhpcy5uYW1lLCJdIiksZS5kaXNhYmxlZD1hfXJldHVybiBuKGUsW3trZXk6ImRlYnVnIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0O2lmKCFlLmRpc2FibGVkKXtmb3IodmFyIHI9YXJndW1lbnRzLmxlbmd0aCxhPW5ldyBBcnJheShyKSxuPTA7bjxyO24rKylhW25dPWFyZ3VtZW50c1tuXTsodD1jb25zb2xlKS5kZWJ1Zy5hcHBseSh0LFt0aGlzLl9wcmVmaXhdLmNvbmNhdChhKSl9fX0se2tleToibG9nIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0O2lmKCFlLmRpc2FibGVkKXtmb3IodmFyIHI9YXJndW1lbnRzLmxlbmd0aCxhPW5ldyBBcnJheShyKSxuPTA7bjxyO24rKylhW25dPWFyZ3VtZW50c1tuXTsodD1jb25zb2xlKS5sb2cuYXBwbHkodCxbdGhpcy5fcHJlZml4XS5jb25jYXQoYSkpfX19LHtrZXk6Indhcm4iLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ7aWYoIWUuZGlzYWJsZWQpe2Zvcih2YXIgcj1hcmd1bWVudHMubGVuZ3RoLGE9bmV3IEFycmF5KHIpLG49MDtuPHI7bisrKWFbbl09YXJndW1lbnRzW25dOyh0PWNvbnNvbGUpLndhcm4uYXBwbHkodCxbdGhpcy5fcHJlZml4XS5jb25jYXQoYSkpfX19LHtrZXk6ImVycm9yIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0O2lmKCFlLmRpc2FibGVkKXtmb3IodmFyIHI9YXJndW1lbnRzLmxlbmd0aCxhPW5ldyBBcnJheShyKSxuPTA7bjxyO24rKylhW25dPWFyZ3VtZW50c1tuXTsodD1jb25zb2xlKS5lcnJvci5hcHBseSh0LFt0aGlzLl9wcmVmaXhdLmNvbmNhdChhKSl9fX0se2tleToidGFibGUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ7ZS5kaXNhYmxlZHx8KGNvbnNvbGUuZ3JvdXAodGhpcy5fcHJlZml4KSwodD1jb25zb2xlKS50YWJsZS5hcHBseSh0LGFyZ3VtZW50cyksY29uc29sZS5ncm91cEVuZCgpKX19XSxbe2tleToiZW5hYmxlIix2YWx1ZTpmdW5jdGlvbigpe2UuZGlzYWJsZWQ9ITF9fSx7a2V5OiJkaXNhYmxlIix2YWx1ZTpmdW5jdGlvbigpe2UuZGlzYWJsZWQ9ITB9fV0pLGV9KCk7aShBZSwiZGlzYWJsZWQiLCEwKTtmb3IodmFyIERlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LGEsbil7cih0aGlzLGUpLHRoaXMudmlkZW9UcmFjaz10LHRoaXMuYXVkaW9UcmFjaz1hO3ZhciBpPS9DaHJvbWVcLyhbXi5dKykvLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudCk7dGhpcy5mb3JjZUZpcnN0SURSPWkmJk51bWJlcihpWzFdKTw1MCx0aGlzLmxvZz1uZXcgQWUoIkZNUDRSZW11eGVyIiwhbnx8IW4ub3BlbkxvZ3x8IW4ub3BlbkxvZyl9cmV0dXJuIG4oZSxbe2tleToicmVtdXgiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGUsdCxyLGEsbixpPWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdJiZhcmd1bWVudHNbMF0scz1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e30sbz10aGlzLnZpZGVvVHJhY2ssdT10aGlzLmF1ZGlvVHJhY2ssYz1vLmV4aXN0KCksbD11LmV4aXN0KCksZD1bXTtyZXR1cm4gaSYmKHMmJnMuaW5pdE1lcmdlPyhjJiZkLnB1c2godGhpcy52aWRlb1RyYWNrKSxsJiZkLnB1c2godGhpcy5hdWRpb1RyYWNrKSxyPVNlLmluaXRTZWdtZW50KGQpKTooYyYmKGU9U2UuaW5pdFNlZ21lbnQoW3RoaXMudmlkZW9UcmFja10pKSxsJiYodD1TZS5pbml0U2VnbWVudChbdGhpcy5hdWRpb1RyYWNrXSkpKSksYyYmby5oYXNTYW1wbGUoKSYmKGE9dGhpcy5fcmVtdXhWaWRlbygpKSxsJiZ1Lmhhc1NhbXBsZSgpJiYobj10aGlzLl9yZW11eEF1ZGlvKCkpLG8uc2FtcGxlcz1bXSx1LnNhbXBsZXM9W10se2luaXRTZWdtZW50OnIsdmlkZW9Jbml0U2VnbWVudDplLGF1ZGlvSW5pdFNlZ21lbnQ6dCx2aWRlb1NlZ21lbnQ6YSxhdWRpb1NlZ21lbnQ6bn19fSx7a2V5OiJfcmVtdXhWaWRlbyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnZpZGVvVHJhY2s7dGhpcy5mb3JjZUZpcnN0SURSJiYoZS5zYW1wbGVzWzBdLmZsYWc9e2RlcGVuZHNPbjoyLGlzTm9uU3luY1NhbXBsZTowfSk7dmFyIHQ9ZS5zYW1wbGVzLHI9MDt0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3IrPWUudW5pdHMucmVkdWNlKChmdW5jdGlvbihlLHQpe3JldHVybiBlK3QuYnl0ZUxlbmd0aH0pLDApLHIrPTQqZS51bml0cy5sZW5ndGh9KSk7Zm9yKHZhciBhLG49bmV3IFVpbnQ4QXJyYXkociksaT1uZXcgRGF0YVZpZXcobi5idWZmZXIpLHM9ZnVuY3Rpb24oZSxyKXtyPXRbb107dmFyIHM9MDtyLnVuaXRzLmZvckVhY2goKGZ1bmN0aW9uKHQpe2kuc2V0VWludDMyKGUsdC5ieXRlTGVuZ3RoKSxlKz00LG4uc2V0KHQsZSksZSs9dC5ieXRlTGVuZ3RoLHMrPTQrdC5ieXRlTGVuZ3RofSkpLHIuc2l6ZT1zLGM9ZSxhPXJ9LG89MCx1PXQubGVuZ3RoLGM9MDtvPHU7bysrKXMoYyxhKTt2YXIgbD1TZS5tZGF0KG4pO3JldHVybiBaKFNlLm1vb2YoW2VdKSxsKX19LHtrZXk6Il9yZW11eEF1ZGlvIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuYXVkaW9UcmFjayx0PW5ldyBVaW50OEFycmF5KGUuc2FtcGxlcy5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC5zaXplfSksMCkpO2Uuc2FtcGxlcy5yZWR1Y2UoKGZ1bmN0aW9uKGUscil7cmV0dXJuIHQuc2V0KHIuZGF0YSxlKSxlK3Iuc2l6ZX0pLDApO3ZhciByPVNlLm1kYXQodCk7cmV0dXJuIFooU2UubW9vZihbZV0pLHIpfX0se2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy52aWRlb1RyYWNrLnJlc2V0KCksdGhpcy5hdWRpb1RyYWNrLnJlc2V0KCl9fV0pLGV9KCksRWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsW3trZXk6Im1peEluIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih0aGlzLGUpfX0se2tleToiY2xvbmUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9bmV3IHRoaXMuY29uc3RydWN0b3I7cmV0dXJuIE9iamVjdC5hc3NpZ24oZSx0aGlzKSxlfX1dLFt7a2V5OiJjcmVhdGUiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPWFyZ3VtZW50cy5sZW5ndGgsdD1uZXcgQXJyYXkoZSkscj0wO3I8ZTtyKyspdFtyXT1hcmd1bWVudHNbcl07cmV0dXJuIGwodGhpcyx0KX19XSksZX0oKSxCZT1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZihhKTtmdW5jdGlvbiBhKCl7dmFyIGUsbj1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06W10saT1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06NCpuLmxlbmd0aDtyKHRoaXMsYSksZT10LmNhbGwodGhpcyk7dmFyIHM9bjtpZihzIGluc3RhbmNlb2YgQXJyYXlCdWZmZXImJihzPW5ldyBVaW50OEFycmF5KHMpKSwocyBpbnN0YW5jZW9mIEludDhBcnJheXx8cyBpbnN0YW5jZW9mIFVpbnQ4Q2xhbXBlZEFycmF5fHxzIGluc3RhbmNlb2YgSW50MTZBcnJheXx8cyBpbnN0YW5jZW9mIFVpbnQxNkFycmF5fHxzIGluc3RhbmNlb2YgSW50MzJBcnJheXx8cyBpbnN0YW5jZW9mIFVpbnQzMkFycmF5fHxzIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHxzIGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KSYmKHM9bmV3IFVpbnQ4QXJyYXkocy5idWZmZXIscy5ieXRlT2Zmc2V0LHMuYnl0ZUxlbmd0aCkpLHMgaW5zdGFuY2VvZiBVaW50OEFycmF5KXtmb3IodmFyIG89cy5ieXRlTGVuZ3RoLHU9W10sYz0wO2M8bztjKz0xKXVbYz4+PjJdfD1zW2NdPDwyNC1jJTQqODtlLndvcmRzPXUsZS5zaWdCeXRlcz1vfWVsc2UgZS53b3Jkcz1uLGUuc2lnQnl0ZXM9aTtyZXR1cm4gZX1yZXR1cm4gbihhLFt7a2V5OiJ0b1N0cmluZyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06VGU7cmV0dXJuIGUuc3RyaW5naWZ5KHRoaXMpfX0se2tleToiY29uY2F0Iix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLndvcmRzLHI9ZS53b3JkcyxhPXRoaXMuc2lnQnl0ZXMsbj1lLnNpZ0J5dGVzO2lmKHRoaXMuY2xhbXAoKSxhJTQpZm9yKHZhciBpPTA7aTxuO2krPTEpe3ZhciBzPXJbaT4+PjJdPj4+MjQtaSU0KjgmMjU1O3RbYStpPj4+Ml18PXM8PDI0LShhK2kpJTQqOH1lbHNlIGZvcih2YXIgbz0wO288bjtvKz00KXRbYStvPj4+Ml09cltvPj4+Ml07cmV0dXJuIHRoaXMuc2lnQnl0ZXMrPW4sdGhpc319LHtrZXk6ImNsYW1wIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMud29yZHMsdD10aGlzLnNpZ0J5dGVzO2VbdD4+PjJdJj00Mjk0OTY3Mjk1PDwzMi10JTQqOCxlLmxlbmd0aD1NYXRoLmNlaWwodC80KX19LHtrZXk6ImNsb25lIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXAobyhhLnByb3RvdHlwZSksImNsb25lIix0aGlzKS5jYWxsKHRoaXMpO3JldHVybiBlLndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCksZX19XSxbe2tleToicmFuZG9tIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQscj1bXSxuPWZ1bmN0aW9uKGUpe3ZhciB0PWUscj05ODc2NTQzMjEsYT00Mjk0OTY3Mjk1O3JldHVybiBmdW5jdGlvbigpe3ZhciBlPSgocj0zNjk2OSooNjU1MzUmcikrKHI+PjE2KSZhKTw8MTYpKyh0PTE4ZTMqKDY1NTM1JnQpKyh0Pj4xNikmYSkmYTtyZXR1cm4gZS89NDI5NDk2NzI5NiwoZSs9LjUpKihNYXRoLnJhbmRvbSgpPi41PzE6LTEpfX0saT0wO2k8ZTtpKz00KXt2YXIgcz1uKDQyOTQ5NjcyOTYqKHR8fE1hdGgucmFuZG9tKCkpKTt0PTk4NzY1NDA3MSpzKCksci5wdXNoKDQyOTQ5NjcyOTYqcygpfDApfXJldHVybiBuZXcgYShyLGUpfX1dKSxhfShFZSksVGU9e3N0cmluZ2lmeTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS53b3JkcyxyPWUuc2lnQnl0ZXMsYT1bXSxuPTA7bjxyO24rPTEpe3ZhciBpPXRbbj4+PjJdPj4+MjQtbiU0KjgmMjU1O2EucHVzaCgoaT4+PjQpLnRvU3RyaW5nKDE2KSksYS5wdXNoKCgxNSZpKS50b1N0cmluZygxNikpfXJldHVybiBhLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5sZW5ndGgscj1bXSxhPTA7YTx0O2ErPTIpclthPj4+M118PXBhcnNlSW50KGUuc3Vic3RyKGEsMiksMTYpPDwyNC1hJTgqNDtyZXR1cm4gbmV3IEJlKHIsdC8yKX19LENlPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmxlbmd0aCxyPVtdLGE9MDthPHQ7YSs9MSlyW2E+Pj4yXXw9KDI1NSZlLmNoYXJDb2RlQXQoYSkpPDwyNC1hJTQqODtyZXR1cm4gbmV3IEJlKHIsdCl9LFVlPWZ1bmN0aW9uKGUpe3JldHVybiBDZSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZSkpKX0sUGU9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWYoYSk7ZnVuY3Rpb24gYSgpe3ZhciBlO3JldHVybiByKHRoaXMsYSksKGU9dC5jYWxsKHRoaXMpKS5fbWluQnVmZmVyU2l6ZT0wLGV9cmV0dXJuIG4oYSxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgQmUsdGhpcy5fbkRhdGFCeXRlcz0wfX0se2tleToiX2FwcGVuZCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZTsic3RyaW5nIj09dHlwZW9mIHQmJih0PVVlKHQpKSx0aGlzLl9kYXRhLmNvbmNhdCh0KSx0aGlzLl9uRGF0YUJ5dGVzKz10LnNpZ0J5dGVzfX0se2tleToiX3Byb2Nlc3MiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0LHI9dGhpcy5fZGF0YSxhPXRoaXMuYmxvY2tTaXplLG49ci53b3JkcyxpPXIuc2lnQnl0ZXMscz1pLyg0KmEpLG89KHM9ZT9NYXRoLmNlaWwocyk6TWF0aC5tYXgoKDB8cyktdGhpcy5fbWluQnVmZmVyU2l6ZSwwKSkqYSx1PU1hdGgubWluKDQqbyxpKTtpZihvKXtmb3IodmFyIGM9MDtjPG87Yys9YSl0aGlzLl9kb1Byb2Nlc3NCbG9jayhuLGMpO3Q9bi5zcGxpY2UoMCxvKSxyLnNpZ0J5dGVzLT11fXJldHVybiBuZXcgQmUodCx1KX19LHtrZXk6ImNsb25lIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXAobyhhLnByb3RvdHlwZSksImNsb25lIix0aGlzKS5jYWxsKHRoaXMpO3JldHVybiBlLl9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKSxlfX1dKSxhfShFZSksSWU9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWYoYSk7ZnVuY3Rpb24gYShlKXt2YXIgbjtyZXR1cm4gcih0aGlzLGEpLChuPXQuY2FsbCh0aGlzKSkuYmxvY2tTaXplPTE2LG4uY2ZnPU9iamVjdC5hc3NpZ24obmV3IEVlLGUpLG4ucmVzZXQoKSxufXJldHVybiBuKGEsW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3AobyhhLnByb3RvdHlwZSksInJlc2V0Iix0aGlzKS5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX19LHtrZXk6InVwZGF0ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2FwcGVuZChlKSx0aGlzLl9wcm9jZXNzKCksdGhpc319LHtrZXk6ImZpbmFsaXplIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy5fYXBwZW5kKGUpLHRoaXMuX2RvRmluYWxpemUoKX19XSxbe2tleToiX2NyZWF0ZUhlbHBlciIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHIpLmZpbmFsaXplKHQpfX19LHtrZXk6Il9jcmVhdGVIbWFjSGVscGVyIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCxyKXtyZXR1cm4gbmV3IHplKGUscikuZmluYWxpemUodCl9fX1dKSxhfShQZSksemU9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWYoYSk7ZnVuY3Rpb24gYShlLG4pe3ZhciBpO3IodGhpcyxhKSxpPXQuY2FsbCh0aGlzKTt2YXIgcz1uZXcgZTtpLl9oYXNoZXI9czt2YXIgbz1uOyJzdHJpbmciPT10eXBlb2YgbyYmKG89VWUobykpO3ZhciB1PXMuYmxvY2tTaXplLGM9NCp1O28uc2lnQnl0ZXM+YyYmKG89cy5maW5hbGl6ZShuKSksby5jbGFtcCgpO3ZhciBsPW8uY2xvbmUoKTtpLl9vS2V5PWw7dmFyIGQ9by5jbG9uZSgpO2kuX2lLZXk9ZDtmb3IodmFyIGY9bC53b3JkcyxoPWQud29yZHMscD0wO3A8dTtwKz0xKWZbcF1ePTE1NDk1NTY4MjgsaFtwXV49OTA5NTIyNDg2O3JldHVybiBsLnNpZ0J5dGVzPWMsZC5zaWdCeXRlcz1jLGkucmVzZXQoKSxpfXJldHVybiBuKGEsW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX2hhc2hlcjtlLnJlc2V0KCksZS51cGRhdGUodGhpcy5faUtleSl9fSx7a2V5OiJ1cGRhdGUiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9oYXNoZXIudXBkYXRlKGUpLHRoaXN9fSx7a2V5OiJmaW5hbGl6ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5faGFzaGVyLHI9dC5maW5hbGl6ZShlKTtyZXR1cm4gdC5yZXNldCgpLHQuZmluYWxpemUodGhpcy5fb0tleS5jbG9uZSgpLmNvbmNhdChyKSl9fV0pLGF9KEVlKSxNZT17c3RyaW5naWZ5OmZ1bmN0aW9uKGUpe3ZhciB0PWUud29yZHMscj1lLnNpZ0J5dGVzLGE9dGhpcy5fbWFwO2UuY2xhbXAoKTtmb3IodmFyIG49W10saT0wO2k8cjtpKz0zKWZvcih2YXIgcz0odFtpPj4+Ml0+Pj4yNC1pJTQqOCYyNTUpPDwxNnwodFtpKzE+Pj4yXT4+PjI0LShpKzEpJTQqOCYyNTUpPDw4fHRbaSsyPj4+Ml0+Pj4yNC0oaSsyKSU0KjgmMjU1LG89MDtvPDQmJmkrLjc1Km88cjtvKz0xKW4ucHVzaChhLmNoYXJBdChzPj4+NiooMy1vKSY2MykpO3ZhciB1PWEuY2hhckF0KDY0KTtpZih1KWZvcig7bi5sZW5ndGglNDspbi5wdXNoKHUpO3JldHVybiBuLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbihlKXt2YXIgdD1lLmxlbmd0aCxyPXRoaXMuX21hcCxhPXRoaXMuX3JldmVyc2VNYXA7aWYoIWEpe3RoaXMuX3JldmVyc2VNYXA9W10sYT10aGlzLl9yZXZlcnNlTWFwO2Zvcih2YXIgbj0wO248ci5sZW5ndGg7bis9MSlhW3IuY2hhckNvZGVBdChuKV09bn12YXIgaT1yLmNoYXJBdCg2NCk7aWYoaSl7dmFyIHM9ZS5pbmRleE9mKGkpOy0xIT09cyYmKHQ9cyl9cmV0dXJuIGZ1bmN0aW9uKGUsdCxyKXtmb3IodmFyIGE9W10sbj0wLGk9MDtpPHQ7aSs9MSlpZihpJTQpe3ZhciBzPXJbZS5jaGFyQ29kZUF0KGktMSldPDxpJTQqMnxyW2UuY2hhckNvZGVBdChpKV0+Pj42LWklNCoyO2Fbbj4+PjJdfD1zPDwyNC1uJTQqOCxuKz0xfXJldHVybiBCZS5jcmVhdGUoYSxuKX0oZSx0LGEpfSxfbWFwOiJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSJ9LFJlPVtdLE9lPTA7T2U8NjQ7T2UrPTEpUmVbT2VdPTQyOTQ5NjcyOTYqTWF0aC5hYnMoTWF0aC5zaW4oT2UrMSkpfDA7dmFyIExlPWZ1bmN0aW9uKGUsdCxyLGEsbixpLHMpe3ZhciBvPWUrKHQmcnx+dCZhKStuK3M7cmV0dXJuKG88PGl8bz4+PjMyLWkpK3R9LFZlPWZ1bmN0aW9uKGUsdCxyLGEsbixpLHMpe3ZhciBvPWUrKHQmYXxyJn5hKStuK3M7cmV0dXJuKG88PGl8bz4+PjMyLWkpK3R9LEZlPWZ1bmN0aW9uKGUsdCxyLGEsbixpLHMpe3ZhciBvPWUrKHRecl5hKStuK3M7cmV0dXJuKG88PGl8bz4+PjMyLWkpK3R9LE5lPWZ1bmN0aW9uKGUsdCxyLGEsbixpLHMpe3ZhciBvPWUrKHJeKHR8fmEpKStuK3M7cmV0dXJuKG88PGl8bz4+PjMyLWkpK3R9LGplPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1mKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEsW3trZXk6Il9kb1Jlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IEJlKFsxNzMyNTg0MTkzLDQwMjMyMzM0MTcsMjU2MjM4MzEwMiwyNzE3MzM4NzhdKX19LHtrZXk6Il9kb1Byb2Nlc3NCbG9jayIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9ZSxhPTA7YTwxNjthKz0xKXt2YXIgbj10K2EsaT1lW25dO3Jbbl09MTY3MTE5MzUmKGk8PDh8aT4+PjI0KXw0Mjc4MjU1MzYwJihpPDwyNHxpPj4+OCl9dmFyIHM9dGhpcy5faGFzaC53b3JkcyxvPXJbdCswXSx1PXJbdCsxXSxjPXJbdCsyXSxsPXJbdCszXSxkPXJbdCs0XSxmPXJbdCs1XSxoPXJbdCs2XSxwPXJbdCs3XSx2PXJbdCs4XSx5PXJbdCs5XSxtPXJbdCsxMF0sZz1yW3QrMTFdLGs9clt0KzEyXSxiPXJbdCsxM10sXz1yW3QrMTRdLHc9clt0KzE1XSx4PXNbMF0sUz1zWzFdLEE9c1syXSxEPXNbM107eD1MZSh4LFMsQSxELG8sNyxSZVswXSksRD1MZShELHgsUyxBLHUsMTIsUmVbMV0pLEE9TGUoQSxELHgsUyxjLDE3LFJlWzJdKSxTPUxlKFMsQSxELHgsbCwyMixSZVszXSkseD1MZSh4LFMsQSxELGQsNyxSZVs0XSksRD1MZShELHgsUyxBLGYsMTIsUmVbNV0pLEE9TGUoQSxELHgsUyxoLDE3LFJlWzZdKSxTPUxlKFMsQSxELHgscCwyMixSZVs3XSkseD1MZSh4LFMsQSxELHYsNyxSZVs4XSksRD1MZShELHgsUyxBLHksMTIsUmVbOV0pLEE9TGUoQSxELHgsUyxtLDE3LFJlWzEwXSksUz1MZShTLEEsRCx4LGcsMjIsUmVbMTFdKSx4PUxlKHgsUyxBLEQsayw3LFJlWzEyXSksRD1MZShELHgsUyxBLGIsMTIsUmVbMTNdKSxBPUxlKEEsRCx4LFMsXywxNyxSZVsxNF0pLFM9TGUoUyxBLEQseCx3LDIyLFJlWzE1XSkseD1WZSh4LFMsQSxELHUsNSxSZVsxNl0pLEQ9VmUoRCx4LFMsQSxoLDksUmVbMTddKSxBPVZlKEEsRCx4LFMsZywxNCxSZVsxOF0pLFM9VmUoUyxBLEQseCxvLDIwLFJlWzE5XSkseD1WZSh4LFMsQSxELGYsNSxSZVsyMF0pLEQ9VmUoRCx4LFMsQSxtLDksUmVbMjFdKSxBPVZlKEEsRCx4LFMsdywxNCxSZVsyMl0pLFM9VmUoUyxBLEQseCxkLDIwLFJlWzIzXSkseD1WZSh4LFMsQSxELHksNSxSZVsyNF0pLEQ9VmUoRCx4LFMsQSxfLDksUmVbMjVdKSxBPVZlKEEsRCx4LFMsbCwxNCxSZVsyNl0pLFM9VmUoUyxBLEQseCx2LDIwLFJlWzI3XSkseD1WZSh4LFMsQSxELGIsNSxSZVsyOF0pLEQ9VmUoRCx4LFMsQSxjLDksUmVbMjldKSxBPVZlKEEsRCx4LFMscCwxNCxSZVszMF0pLFM9VmUoUyxBLEQseCxrLDIwLFJlWzMxXSkseD1GZSh4LFMsQSxELGYsNCxSZVszMl0pLEQ9RmUoRCx4LFMsQSx2LDExLFJlWzMzXSksQT1GZShBLEQseCxTLGcsMTYsUmVbMzRdKSxTPUZlKFMsQSxELHgsXywyMyxSZVszNV0pLHg9RmUoeCxTLEEsRCx1LDQsUmVbMzZdKSxEPUZlKEQseCxTLEEsZCwxMSxSZVszN10pLEE9RmUoQSxELHgsUyxwLDE2LFJlWzM4XSksUz1GZShTLEEsRCx4LG0sMjMsUmVbMzldKSx4PUZlKHgsUyxBLEQsYiw0LFJlWzQwXSksRD1GZShELHgsUyxBLG8sMTEsUmVbNDFdKSxBPUZlKEEsRCx4LFMsbCwxNixSZVs0Ml0pLFM9RmUoUyxBLEQseCxoLDIzLFJlWzQzXSkseD1GZSh4LFMsQSxELHksNCxSZVs0NF0pLEQ9RmUoRCx4LFMsQSxrLDExLFJlWzQ1XSksQT1GZShBLEQseCxTLHcsMTYsUmVbNDZdKSxTPUZlKFMsQSxELHgsYywyMyxSZVs0N10pLHg9TmUoeCxTLEEsRCxvLDYsUmVbNDhdKSxEPU5lKEQseCxTLEEscCwxMCxSZVs0OV0pLEE9TmUoQSxELHgsUyxfLDE1LFJlWzUwXSksUz1OZShTLEEsRCx4LGYsMjEsUmVbNTFdKSx4PU5lKHgsUyxBLEQsayw2LFJlWzUyXSksRD1OZShELHgsUyxBLGwsMTAsUmVbNTNdKSxBPU5lKEEsRCx4LFMsbSwxNSxSZVs1NF0pLFM9TmUoUyxBLEQseCx1LDIxLFJlWzU1XSkseD1OZSh4LFMsQSxELHYsNixSZVs1Nl0pLEQ9TmUoRCx4LFMsQSx3LDEwLFJlWzU3XSksQT1OZShBLEQseCxTLGgsMTUsUmVbNThdKSxTPU5lKFMsQSxELHgsYiwyMSxSZVs1OV0pLHg9TmUoeCxTLEEsRCxkLDYsUmVbNjBdKSxEPU5lKEQseCxTLEEsZywxMCxSZVs2MV0pLEE9TmUoQSxELHgsUyxjLDE1LFJlWzYyXSksUz1OZShTLEEsRCx4LHksMjEsUmVbNjNdKSxzWzBdPXNbMF0reHwwLHNbMV09c1sxXStTfDAsc1syXT1zWzJdK0F8MCxzWzNdPXNbM10rRHwwfX0se2tleToiX2RvRmluYWxpemUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fZGF0YSx0PWUud29yZHMscj04KnRoaXMuX25EYXRhQnl0ZXMsYT04KmUuc2lnQnl0ZXM7dFthPj4+NV18PTEyODw8MjQtYSUzMjt2YXIgbj1NYXRoLmZsb29yKHIvNDI5NDk2NzI5NiksaT1yO3RbMTUrKGErNjQ+Pj45PDw0KV09MTY3MTE5MzUmKG48PDh8bj4+PjI0KXw0Mjc4MjU1MzYwJihuPDwyNHxuPj4+OCksdFsxNCsoYSs2ND4+Pjk8PDQpXT0xNjcxMTkzNSYoaTw8OHxpPj4+MjQpfDQyNzgyNTUzNjAmKGk8PDI0fGk+Pj44KSxlLnNpZ0J5dGVzPTQqKHQubGVuZ3RoKzEpLHRoaXMuX3Byb2Nlc3MoKTtmb3IodmFyIHM9dGhpcy5faGFzaCxvPXMud29yZHMsdT0wO3U8NDt1Kz0xKXt2YXIgYz1vW3VdO29bdV09MTY3MTE5MzUmKGM8PDh8Yz4+PjI0KXw0Mjc4MjU1MzYwJihjPDwyNHxjPj4+OCl9cmV0dXJuIHN9fSx7a2V5OiJjbG9uZSIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1wKG8oYS5wcm90b3R5cGUpLCJjbG9uZSIsdGhpcykuY2FsbCh0aGlzKTtyZXR1cm4gZS5faGFzaD10aGlzLl9oYXNoLmNsb25lKCksZX19XSksYX0oSWUpO0llLl9jcmVhdGVIZWxwZXIoamUpLEllLl9jcmVhdGVIbWFjSGVscGVyKGplKTt2YXIgR2U9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWYoYSk7ZnVuY3Rpb24gYShlKXt2YXIgbjtyZXR1cm4gcih0aGlzLGEpLChuPXQuY2FsbCh0aGlzKSkuY2ZnPU9iamVjdC5hc3NpZ24obmV3IEVlLHtrZXlTaXplOjQsaGFzaGVyOmplLGl0ZXJhdGlvbnM6MX0sZSksbn1yZXR1cm4gbihhLFt7a2V5OiJjb21wdXRlIix2YWx1ZTpmdW5jdGlvbihlLHQpe2Zvcih2YXIgcixhPXRoaXMuY2ZnLG49YS5oYXNoZXIuY3JlYXRlKCksaT1CZS5jcmVhdGUoKSxzPWkud29yZHMsbz1hLmtleVNpemUsdT1hLml0ZXJhdGlvbnM7cy5sZW5ndGg8bzspe3ImJm4udXBkYXRlKHIpLHI9bi51cGRhdGUoZSkuZmluYWxpemUodCksbi5yZXNldCgpO2Zvcih2YXIgYz0xO2M8dTtjKz0xKXI9bi5maW5hbGl6ZShyKSxuLnJlc2V0KCk7aS5jb25jYXQocil9cmV0dXJuIGkuc2lnQnl0ZXM9NCpvLGl9fV0pLGF9KEVlKSxIZT1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZihhKTtmdW5jdGlvbiBhKGUsbixpKXt2YXIgcztyZXR1cm4gcih0aGlzLGEpLChzPXQuY2FsbCh0aGlzKSkuY2ZnPU9iamVjdC5hc3NpZ24obmV3IEVlLGkpLHMuX3hmb3JtTW9kZT1lLHMuX2tleT1uLHMucmVzZXQoKSxzfXJldHVybiBuKGEsW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3AobyhhLnByb3RvdHlwZSksInJlc2V0Iix0aGlzKS5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX19LHtrZXk6InByb2Nlc3MiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9hcHBlbmQoZSksdGhpcy5fcHJvY2VzcygpfX0se2tleToiZmluYWxpemUiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZ0aGlzLl9hcHBlbmQoZSksdGhpcy5fZG9GaW5hbGl6ZSgpfX1dLFt7a2V5OiJjcmVhdGVFbmNyeXB0b3IiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuY3JlYXRlKHRoaXMuX0VOQ19YRk9STV9NT0RFLGUsdCl9fSx7a2V5OiJjcmVhdGVEZWNyeXB0b3IiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuY3JlYXRlKHRoaXMuX0RFQ19YRk9STV9NT0RFLGUsdCl9fSx7a2V5OiJfY3JlYXRlSGVscGVyIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbihlKXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGU/ZXQ6SmV9O3JldHVybntlbmNyeXB0OmZ1bmN0aW9uKHIsYSxuKXtyZXR1cm4gdChhKS5lbmNyeXB0KGUscixhLG4pfSxkZWNyeXB0OmZ1bmN0aW9uKHIsYSxuKXtyZXR1cm4gdChhKS5kZWNyeXB0KGUscixhLG4pfX19fV0pLGF9KFBlKTtIZS5fRU5DX1hGT1JNX01PREU9MSxIZS5fREVDX1hGT1JNX01PREU9MixIZS5rZXlTaXplPTQsSGUuaXZTaXplPTQ7dmFyIEtlPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1mKGEpO2Z1bmN0aW9uIGEoZSxuKXt2YXIgaTtyZXR1cm4gcih0aGlzLGEpLChpPXQuY2FsbCh0aGlzKSkuX2NpcGhlcj1lLGkuX2l2PW4saX1yZXR1cm4gbihhLG51bGwsW3trZXk6ImNyZWF0ZUVuY3J5cHRvciIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5FbmNyeXB0b3IuY3JlYXRlKGUsdCl9fSx7a2V5OiJjcmVhdGVEZWNyeXB0b3IiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuRGVjcnlwdG9yLmNyZWF0ZShlLHQpfX1dKSxhfShFZSk7ZnVuY3Rpb24gcWUoZSx0LHIpe3ZhciBhLG49ZSxpPXRoaXMuX2l2O2k/KGE9aSx0aGlzLl9pdj12b2lkIDApOmE9dGhpcy5fcHJldkJsb2NrO2Zvcih2YXIgcz0wO3M8cjtzKz0xKW5bdCtzXV49YVtzXX12YXIgV2U9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWYoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSl9KEtlKTtXZS5FbmNyeXB0b3I9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWYoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSxbe2tleToicHJvY2Vzc0Jsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMuX2NpcGhlcixhPXIuYmxvY2tTaXplO3FlLmNhbGwodGhpcyxlLHQsYSksci5lbmNyeXB0QmxvY2soZSx0KSx0aGlzLl9wcmV2QmxvY2s9ZS5zbGljZSh0LHQrYSl9fV0pLGF9KFdlKSxXZS5EZWNyeXB0b3I9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWYoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSxbe2tleToicHJvY2Vzc0Jsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMuX2NpcGhlcixhPXIuYmxvY2tTaXplLG49ZS5zbGljZSh0LHQrYSk7ci5kZWNyeXB0QmxvY2soZSx0KSxxZS5jYWxsKHRoaXMsZSx0LGEpLHRoaXMuX3ByZXZCbG9jaz1ufX1dKSxhfShXZSk7dmFyIFhlPXtwYWQ6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9NCp0LGE9ci1lLnNpZ0J5dGVzJXIsbj1hPDwyNHxhPDwxNnxhPDw4fGEsaT1bXSxzPTA7czxhO3MrPTQpaS5wdXNoKG4pO3ZhciBvPUJlLmNyZWF0ZShpLGEpO2UuY29uY2F0KG8pfSx1bnBhZDpmdW5jdGlvbihlKXt2YXIgdD1lLHI9MjU1JnQud29yZHNbdC5zaWdCeXRlcy0xPj4+Ml07dC5zaWdCeXRlcy09cn19LFllPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1mKGEpO2Z1bmN0aW9uIGEoZSxuLGkpe3ZhciBzO3JldHVybiByKHRoaXMsYSksKHM9dC5jYWxsKHRoaXMsZSxuLE9iamVjdC5hc3NpZ24oe21vZGU6V2UscGFkZGluZzpYZX0saSkpKS5ibG9ja1NpemU9NCxzfXJldHVybiBuKGEsW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlO3AobyhhLnByb3RvdHlwZSksInJlc2V0Iix0aGlzKS5jYWxsKHRoaXMpO3ZhciB0PXRoaXMuY2ZnLHI9dC5pdixuPXQubW9kZTt0aGlzLl94Zm9ybU1vZGU9PT10aGlzLmNvbnN0cnVjdG9yLl9FTkNfWEZPUk1fTU9ERT9lPW4uY3JlYXRlRW5jcnlwdG9yOihlPW4uY3JlYXRlRGVjcnlwdG9yLHRoaXMuX21pbkJ1ZmZlclNpemU9MSksdGhpcy5fbW9kZT1lLmNhbGwobix0aGlzLHImJnIud29yZHMpLHRoaXMuX21vZGUuX19jcmVhdG9yPWV9fSx7a2V5OiJfZG9Qcm9jZXNzQmxvY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5fbW9kZS5wcm9jZXNzQmxvY2soZSx0KX19LHtrZXk6Il9kb0ZpbmFsaXplIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlLHQ9dGhpcy5jZmcucGFkZGluZztyZXR1cm4gdGhpcy5feGZvcm1Nb2RlPT09dGhpcy5jb25zdHJ1Y3Rvci5fRU5DX1hGT1JNX01PREU/KHQucGFkKHRoaXMuX2RhdGEsdGhpcy5ibG9ja1NpemUpLGU9dGhpcy5fcHJvY2VzcyghMCkpOihlPXRoaXMuX3Byb2Nlc3MoITApLHQudW5wYWQoZSkpLGV9fV0pLGF9KEhlKSxaZT1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZihhKTtmdW5jdGlvbiBhKGUpe3ZhciBuO3JldHVybiByKHRoaXMsYSksKG49dC5jYWxsKHRoaXMpKS5taXhJbihlKSxufXJldHVybiBuKGEsW3trZXk6InRvU3RyaW5nIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4oZXx8dGhpcy5mb3JtYXR0ZXIpLnN0cmluZ2lmeSh0aGlzKX19XSksYX0oRWUpLFFlPXtzdHJpbmdpZnk6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jaXBoZXJ0ZXh0LHI9ZS5zYWx0O3JldHVybihyP0JlLmNyZWF0ZShbMTM5ODg5MzY4NCwxNzAxMDc2ODMxXSkuY29uY2F0KHIpLmNvbmNhdCh0KTp0KS50b1N0cmluZyhNZSl9LHBhcnNlOmZ1bmN0aW9uKGUpe3ZhciB0LHI9TWUucGFyc2UoZSksYT1yLndvcmRzO3JldHVybiAxMzk4ODkzNjg0PT09YVswXSYmMTcwMTA3NjgzMT09PWFbMV0mJih0PUJlLmNyZWF0ZShhLnNsaWNlKDIsNCkpLGEuc3BsaWNlKDAsNCksci5zaWdCeXRlcy09MTYpLFplLmNyZWF0ZSh7Y2lwaGVydGV4dDpyLHNhbHQ6dH0pfX0sSmU9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWYoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSxudWxsLFt7a2V5OiJlbmNyeXB0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixhKXt2YXIgbj1PYmplY3QuYXNzaWduKG5ldyBFZSx0aGlzLmNmZyxhKSxpPWUuY3JlYXRlRW5jcnlwdG9yKHIsbikscz1pLmZpbmFsaXplKHQpLG89aS5jZmc7cmV0dXJuIFplLmNyZWF0ZSh7Y2lwaGVydGV4dDpzLGtleTpyLGl2Om8uaXYsYWxnb3JpdGhtOmUsbW9kZTpvLm1vZGUscGFkZGluZzpvLnBhZGRpbmcsYmxvY2tTaXplOmkuYmxvY2tTaXplLGZvcm1hdHRlcjpuLmZvcm1hdH0pfX0se2tleToiZGVjcnlwdCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSl7dmFyIG49dCxpPU9iamVjdC5hc3NpZ24obmV3IEVlLHRoaXMuY2ZnLGEpO3JldHVybiBuPXRoaXMuX3BhcnNlKG4saS5mb3JtYXQpLGUuY3JlYXRlRGVjcnlwdG9yKHIsaSkuZmluYWxpemUobi5jaXBoZXJ0ZXh0KX19LHtrZXk6Il9wYXJzZSIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGU/dC5wYXJzZShlLHRoaXMpOmV9fV0pLGF9KEVlKTtKZS5jZmc9T2JqZWN0LmFzc2lnbihuZXcgRWUse2Zvcm1hdDpRZX0pO3ZhciAkZT17ZXhlY3V0ZTpmdW5jdGlvbihlLHQscixhKXt2YXIgbj1hO258fChuPUJlLnJhbmRvbSg4KSk7dmFyIGk9R2UuY3JlYXRlKHtrZXlTaXplOnQrcn0pLmNvbXB1dGUoZSxuKSxzPUJlLmNyZWF0ZShpLndvcmRzLnNsaWNlKHQpLDQqcik7cmV0dXJuIGkuc2lnQnl0ZXM9NCp0LFplLmNyZWF0ZSh7a2V5OmksaXY6cyxzYWx0Om59KX19LGV0PWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1mKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEsbnVsbCxbe2tleToiZW5jcnlwdCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSl7dmFyIG49T2JqZWN0LmFzc2lnbihuZXcgRWUsdGhpcy5jZmcsYSksaT1uLmtkZi5leGVjdXRlKHIsZS5rZXlTaXplLGUuaXZTaXplKTtuLml2PWkuaXY7dmFyIHM9SmUuZW5jcnlwdC5jYWxsKHRoaXMsZSx0LGkua2V5LG4pO3JldHVybiBzLm1peEluKGkpLHN9fSx7a2V5OiJkZWNyeXB0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixhKXt2YXIgbj10LGk9T2JqZWN0LmFzc2lnbihuZXcgRWUsdGhpcy5jZmcsYSk7bj10aGlzLl9wYXJzZShuLGkuZm9ybWF0KTt2YXIgcz1pLmtkZi5leGVjdXRlKHIsZS5rZXlTaXplLGUuaXZTaXplLG4uc2FsdCk7cmV0dXJuIGkuaXY9cy5pdixKZS5kZWNyeXB0LmNhbGwodGhpcyxlLG4scy5rZXksaSl9fV0pLGF9KEplKTtldC5jZmc9T2JqZWN0LmFzc2lnbihKZS5jZmcse2tkZjokZX0pO2Zvcih2YXIgdHQ9W10scnQ9W10sYXQ9W10sbnQ9W10saXQ9W10sc3Q9W10sb3Q9W10sdXQ9W10sY3Q9W10sbHQ9W10sZHQ9W10sZnQ9MDtmdDwyNTY7ZnQrPTEpZHRbZnRdPWZ0PDEyOD9mdDw8MTpmdDw8MV4yODM7Zm9yKHZhciBodD0wLHB0PTAsdnQ9MDt2dDwyNTY7dnQrPTEpe3ZhciB5dD1wdF5wdDw8MV5wdDw8Ml5wdDw8M15wdDw8NDt5dD15dD4+PjheMjU1Jnl0Xjk5LHR0W2h0XT15dCxydFt5dF09aHQ7dmFyIG10PWR0W2h0XSxndD1kdFttdF0sa3Q9ZHRbZ3RdLGJ0PTI1NypkdFt5dF1eMTY4NDMwMDgqeXQ7YXRbaHRdPWJ0PDwyNHxidD4+PjgsbnRbaHRdPWJ0PDwxNnxidD4+PjE2LGl0W2h0XT1idDw8OHxidD4+PjI0LHN0W2h0XT1idCxidD0xNjg0MzAwOSprdF42NTUzNypndF4yNTcqbXReMTY4NDMwMDgqaHQsb3RbeXRdPWJ0PDwyNHxidD4+PjgsdXRbeXRdPWJ0PDwxNnxidD4+PjE2LGN0W3l0XT1idDw8OHxidD4+PjI0LGx0W3l0XT1idCxodD8oaHQ9bXReZHRbZHRbZHRba3RebXRdXV0scHRePWR0W2R0W3B0XV0pOmh0PXB0PTF9dmFyIF90PVswLDEsMiw0LDgsMTYsMzIsNjQsMTI4LDI3LDU0XSx3dD1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZihhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhLFt7a2V5OiJfZG9SZXNldCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZTtpZighdGhpcy5fblJvdW5kc3x8dGhpcy5fa2V5UHJpb3JSZXNldCE9PXRoaXMuX2tleSl7dGhpcy5fa2V5UHJpb3JSZXNldD10aGlzLl9rZXk7dmFyIHQ9dGhpcy5fa2V5UHJpb3JSZXNldCxyPXQud29yZHMsYT10LnNpZ0J5dGVzLzQ7dGhpcy5fblJvdW5kcz1hKzY7dmFyIG49NCoodGhpcy5fblJvdW5kcysxKTt0aGlzLl9rZXlTY2hlZHVsZT1bXTtmb3IodmFyIGk9dGhpcy5fa2V5U2NoZWR1bGUscz0wO3M8bjtzKz0xKXM8YT9pW3NdPXJbc106KGU9aVtzLTFdLHMlYT9hPjYmJnMlYT09NCYmKGU9dHRbZT4+PjI0XTw8MjR8dHRbZT4+PjE2JjI1NV08PDE2fHR0W2U+Pj44JjI1NV08PDh8dHRbMjU1JmVdKTooZT10dFsoZT1lPDw4fGU+Pj4yNCk+Pj4yNF08PDI0fHR0W2U+Pj4xNiYyNTVdPDwxNnx0dFtlPj4+OCYyNTVdPDw4fHR0WzI1NSZlXSxlXj1fdFtzL2F8MF08PDI0KSxpW3NdPWlbcy1hXV5lKTt0aGlzLl9pbnZLZXlTY2hlZHVsZT1bXTtmb3IodmFyIG89dGhpcy5faW52S2V5U2NoZWR1bGUsdT0wO3U8bjt1Kz0xKXt2YXIgYz1uLXU7ZT11JTQ/aVtjXTppW2MtNF0sb1t1XT11PDR8fGM8PTQ/ZTpvdFt0dFtlPj4+MjRdXV51dFt0dFtlPj4+MTYmMjU1XV1eY3RbdHRbZT4+PjgmMjU1XV1ebHRbdHRbMjU1JmVdXX19fX0se2tleToiZW5jcnlwdEJsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuX2RvQ3J5cHRCbG9jayhlLHQsdGhpcy5fa2V5U2NoZWR1bGUsYXQsbnQsaXQsc3QsdHQpfX0se2tleToiZGVjcnlwdEJsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPWUsYT1yW3QrMV07clt0KzFdPXJbdCszXSxyW3QrM109YSx0aGlzLl9kb0NyeXB0QmxvY2socix0LHRoaXMuX2ludktleVNjaGVkdWxlLG90LHV0LGN0LGx0LHJ0KSxhPXJbdCsxXSxyW3QrMV09clt0KzNdLHJbdCszXT1hfX0se2tleToiX2RvQ3J5cHRCbG9jayIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSxuLGkscyxvKXtmb3IodmFyIHU9ZSxjPXRoaXMuX25Sb3VuZHMsbD11W3RdXnJbMF0sZD11W3QrMV1eclsxXSxmPXVbdCsyXV5yWzJdLGg9dVt0KzNdXnJbM10scD00LHY9MTt2PGM7dis9MSl7dmFyIHk9YVtsPj4+MjRdXm5bZD4+PjE2JjI1NV1eaVtmPj4+OCYyNTVdXnNbMjU1JmhdXnJbcF07cCs9MTt2YXIgbT1hW2Q+Pj4yNF1ebltmPj4+MTYmMjU1XV5pW2g+Pj44JjI1NV1ec1syNTUmbF1ecltwXTtwKz0xO3ZhciBnPWFbZj4+PjI0XV5uW2g+Pj4xNiYyNTVdXmlbbD4+PjgmMjU1XV5zWzI1NSZkXV5yW3BdO3ArPTE7dmFyIGs9YVtoPj4+MjRdXm5bbD4+PjE2JjI1NV1eaVtkPj4+OCYyNTVdXnNbMjU1JmZdXnJbcF07cCs9MSxsPXksZD1tLGY9ZyxoPWt9dmFyIGI9KG9bbD4+PjI0XTw8MjR8b1tkPj4+MTYmMjU1XTw8MTZ8b1tmPj4+OCYyNTVdPDw4fG9bMjU1JmhdKV5yW3BdO3ArPTE7dmFyIF89KG9bZD4+PjI0XTw8MjR8b1tmPj4+MTYmMjU1XTw8MTZ8b1toPj4+OCYyNTVdPDw4fG9bMjU1JmxdKV5yW3BdO3ArPTE7dmFyIHc9KG9bZj4+PjI0XTw8MjR8b1toPj4+MTYmMjU1XTw8MTZ8b1tsPj4+OCYyNTVdPDw4fG9bMjU1JmRdKV5yW3BdO3ArPTE7dmFyIHg9KG9baD4+PjI0XTw8MjR8b1tsPj4+MTYmMjU1XTw8MTZ8b1tkPj4+OCYyNTVdPDw4fG9bMjU1JmZdKV5yW3BdO3ArPTEsdVt0XT1iLHVbdCsxXT1fLHVbdCsyXT13LHVbdCszXT14fX1dKSxhfShZZSk7d3Qua2V5U2l6ZT04O3ZhciB4dD1ZZS5fY3JlYXRlSGVscGVyKHd0KSxTdD1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZihhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhKX0oS2UpO1N0LkVuY3J5cHRvcj1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZihhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhLFt7a2V5OiJwcm9jZXNzQmxvY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9ZSxhPXRoaXMuX2NpcGhlcixuPWEuYmxvY2tTaXplLGk9dGhpcy5faXYscz10aGlzLl9jb3VudGVyO2kmJih0aGlzLl9jb3VudGVyPWkuc2xpY2UoMCkscz10aGlzLl9jb3VudGVyLHRoaXMuX2l2PXZvaWQgMCk7dmFyIG89cy5zbGljZSgwKTthLmVuY3J5cHRCbG9jayhvLDApLHNbbi0xXT1zW24tMV0rMXwwO2Zvcih2YXIgdT0wO3U8bjt1Kz0xKXJbdCt1XV49b1t1XX19XSksYX0oU3QpLFN0LkRlY3J5cHRvcj1TdC5FbmNyeXB0b3I7dmFyIEF0PXtwYWQ6ZnVuY3Rpb24oKXt9LHVucGFkOmZ1bmN0aW9uKCl7fX0sRHQ9e2RlY3J5cHRXb3JkQXJyYXk6ZnVuY3Rpb24oZSx0LHIpe3ZhciBhPVRlLnBhcnNlKHQpLG49VGUucGFyc2UocmUocikpLGk9QmUuY3JlYXRlKG5ldyBVaW50OEFycmF5KGUpKSxzPXh0LmRlY3J5cHQoWmUuY3JlYXRlKHtjaXBoZXJ0ZXh0Oml9KSxhLHtpdjpuLG1vZGU6U3QscGFkZGluZzpBdH0pO3JldHVybiBEdC53b3JkQXJyYXlUb1VpbnQ4QXJyYXkocyl9LHdvcmRBcnJheVRvVWludDhBcnJheTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5zaWdCeXRlcyxyPWUud29yZHMsYT1uZXcgVWludDhBcnJheSh0KSxuPTAsaT0wO24hPT10Oyl7dmFyIHM9cltpKytdO2lmKGFbbisrXT0oNDI3ODE5MDA4MCZzKT4+PjI0LG49PT10KWJyZWFrO2lmKGFbbisrXT0oMTY3MTE2ODAmcyk+Pj4xNixuPT09dClicmVhaztpZihhW24rK109KDY1MjgwJnMpPj4+OCxuPT09dClicmVhazthW24rK109MjU1JnN9cmV0dXJuIGF9LGRlY29kZXJBRVNDVFJEYXRhOmZ1bmN0aW9uKGUsdCxyKXtpZihlLnZpZGVvU2VuYyl7dmFyIGE9ZS5raWRWYWx1ZSxuPWUudmlkZW9TZW5jO2Uuc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbih0LGkpe3ZhciBzPW5baV0sbz10LmRhdGEsdT1bXSxjPVtdLGw9cy5Jbml0aWFsaXphdGlvblZlY3RvcjtpZihzLnN1YnNhbXBsZXMmJnMuc3Vic2FtcGxlcy5sZW5ndGgpcy5zdWJzYW1wbGVzLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUuQnl0ZXNPZkNsZWFyRGF0YStlLkJ5dGVzT2ZQcm90ZWN0ZWREYXRhLHI9by5zbGljZSgwLHQpO3UucHVzaChyLnNsaWNlKDAsZS5CeXRlc09mQ2xlYXJEYXRhKSksYy5wdXNoKHIuc2xpY2UoZS5CeXRlc09mQ2xlYXJEYXRhKSksbz1vLnNsaWNlKHQpfSkpO2Vsc2V7dmFyIGQ9dC5zaXplO3UucHVzaChvLnNsaWNlKDAsMCkpLGMucHVzaChvLnNsaWNlKDAsZCkpLG89by5zbGljZShkKX12YXIgZj1uZXcgd2U7Zi53cml0ZS5hcHBseShmLGMpO3ZhciBoPXI/cihmLmJ1ZmZlcixhLGwpOkR0LmRlY3J5cHRXb3JkQXJyYXkoZi5idWZmZXIsYSxsKSxwPW5ldyB3ZTt1LmZvckVhY2goKGZ1bmN0aW9uKGUsdCl7dmFyIHI9Y1t0XS5sZW5ndGgsYT1oLnNsaWNlKDAscik7cC53cml0ZShlKSxwLndyaXRlKGEpLGg9aC5zbGljZShyKX0pKSxlLnNhbXBsZXNbaV0uZGF0YT1wLmJ1ZmZlcn0pKX1pZih0LmF1ZGlvU2VuYyl7dmFyIGk9dC5raWRWYWx1ZSxzPXQuYXVkaW9TZW5jO3Quc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihlLGEpe3ZhciBuPXNbYV0sbz1yP3IoZS5kYXRhLGksbi5Jbml0aWFsaXphdGlvblZlY3Rvcik6RHQuZGVjcnlwdFdvcmRBcnJheShlLmRhdGEsaSxuLkluaXRpYWxpemF0aW9uVmVjdG9yKTt0LnNhbXBsZXNbYV0uZGF0YT1vfSkpfX19LEV0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LGEsbixzKXt2YXIgbz10aGlzO3IodGhpcyxlKSxpKHRoaXMsIl92aWRlb1NhbXBsZXMiLFtdKSxpKHRoaXMsIl9hdWRpb1NhbXBsZXMiLFtdKSxpKHRoaXMsIl9sYXN0UmVtYWluQnVmZmVyIixbXSksaSh0aGlzLCJfbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zIiwwKSx0aGlzLnZpZGVvVHJhY2s9bmV3IHosdGhpcy5hdWRpb1RyYWNrPW5ldyBNLHRoaXMubWV0YWRhdGFUcmFjaz1ufHxuZXcgTix0aGlzLmxvZz1uZXcgQWUoIk1QNERlbXV4ZXIiLCFzfHwhcy5vcGVuTG9nfHwhcy5vcGVuTG9nKSx0JiZ0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0Oyh0PW8uX3ZpZGVvU2FtcGxlcykucHVzaC5hcHBseSh0LHkoZS5mcmFtZXMpKX0pKSxhJiZhLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0Oyh0PW8uX2F1ZGlvU2FtcGxlcykucHVzaC5hcHBseSh0LHkoZS5mcmFtZXMpKX0pKX1yZXR1cm4gbihlLFt7a2V5OiJwYXJzZVNhbXBsZXMiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKCFlKXRocm93IG5ldyBFcnJvcigibW9vdiBpcyByZXF1aXJlZCIpO2lmKHRoaXMudmlkZW9UcmFjay5jb2RlY3x8dGhpcy5hdWRpb1RyYWNrLmNvZGVjfHwocGUubW9vdlRvVHJhY2soZSx0aGlzLnZpZGVvVHJhY2ssdGhpcy5hdWRpb1RyYWNrKSx0aGlzLnZpZGVvU2VuYz10aGlzLnZpZGVvVHJhY2sudmlkZW9TZW5jLHRoaXMuYXVkaW9TZW5jPXRoaXMuYXVkaW9UcmFjay5hdWRpb1NlbmMpLCF0aGlzLl9hdWRpb1NhbXBsZXMubGVuZ3RoJiYhdGhpcy5fdmlkZW9TYW1wbGVzLmxlbmd0aCl7dmFyIHQ9cGUubW9vdlRvU2FtcGxlcyhlKTtpZighdCl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBwYXJzZSBzYW1wbGVzIGZyb20gbW9vdiBib3giKTt0aGlzLl92aWRlb1NhbXBsZXM9dC52aWRlb1NhbXBsZXN8fFtdLHRoaXMuX2F1ZGlvU2FtcGxlcz10LmF1ZGlvU2FtcGxlc3x8W119fX0se2tleToiZGVtdXgiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyLGEsbil7dGhpcy5wYXJzZVNhbXBsZXMobik7dmFyIGkscyxvLHU9dGhpcy52aWRlb1RyYWNrLGM9dGhpcy5hdWRpb1RyYWNrO2lmKHUuc2FtcGxlcz1bXSxjLnNhbXBsZXM9W10scil7Zm9yKHZhciBsLGQ9MCxmPXJbMF0saD1yWzFdO2Y8PWg7ZisrKXtpZighKGk9dGhpcy5fdmlkZW9TYW1wbGVzW2ZdKSl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBmb3VuZCB2aWRlbyBmcmFtZSAjIi5jb25jYXQoZikpO289aS5vZmZzZXQtdCxzPWUuc3ViYXJyYXkobyxvK2kuc2l6ZSksKGw9bmV3IFIoaS5wdHN8fGkuZHRzLGkuZHRzKSkuZHVyYXRpb249aS5kdXJhdGlvbixsLmdvcElkPWkuZ29wSWQsaS5rZXlmcmFtZSYmbC5zZXRUb0tleWZyYW1lKCk7Zm9yKHZhciBwPTAsdj1zLmxlbmd0aC0xO3A8djspZD0kKHMscCkscCs9NCxsLnVuaXRzLnB1c2gocy5zdWJhcnJheShwLHArZCkpLHArPWQ7dS5zYW1wbGVzLnB1c2gobCl9dS5iYXNlTWVkaWFEZWNvZGVUaW1lPXUuc2FtcGxlc1swXS5kdHN9aWYoYSl7Zm9yKHZhciB5PWFbMF0sbT1hWzFdO3k8PW07eSsrKXtpZighKGk9dGhpcy5fYXVkaW9TYW1wbGVzW3ldKSl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBmb3VuZCB2aWRlbyBmcmFtZSAjIi5jb25jYXQoeSkpO289aS5vZmZzZXQtdCxzPWUuc3ViYXJyYXkobyxvK2kuc2l6ZSksYy5zYW1wbGVzLnB1c2gobmV3IE8oaS5kdHMscyxpLmR1cmF0aW9uKSl9Yy5iYXNlTWVkaWFEZWNvZGVUaW1lPWMuc2FtcGxlc1swXS5kdHN9cmV0dXJue3ZpZGVvVHJhY2s6dSxhdWRpb1RyYWNrOmMsbWV0YWRhdGFUcmFjazp0aGlzLm1ldGFkYXRhVHJhY2t9fX0se2tleToiZGVtdXhQYXJ0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixhLG4saSxzLG8pe2lmKHRoaXMucGFyc2VTYW1wbGVzKG4pLHRoaXMudmlkZW9UcmFjay51c2VFTUU9aSx0aGlzLmF1ZGlvVHJhY2sudXNlRU1FPWksdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlciYmdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5ieXRlTGVuZ3RoPjAmJnQ+dGhpcy5fbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zJiZ0PD10aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3MrdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5ieXRlTGVuZ3RoKWZvcih2YXIgdT0wO3U8MjA7KXRyeXt2YXIgYz10aGlzLl9sYXN0UmVtYWluQnVmZmVyLnN1YmFycmF5KDAsdC10aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3MpLGw9bmV3IFVpbnQ4QXJyYXkoZS5ieXRlTGVuZ3RoK2MuYnl0ZUxlbmd0aCk7bC5zZXQoYywwKSxsLnNldChuZXcgVWludDhBcnJheShlKSxjLmJ5dGVMZW5ndGgpLGU9bCx0LT1jLmJ5dGVMZW5ndGgsdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlcj1udWxsLHRoaXMuX2xhc3RSZW1haW5CdWZmZXJTdGFydFBvcz0wO2JyZWFrfWNhdGNoKEUpe2lmKCEodTwyMCkpdGhyb3cgbmV3IEVycm9yKCJuZXcgVWludDhBcnJheSBlcnJvcjosIitFLmVycm9yTWVzc2FnZSk7dSsrfXZhciBkLGYsaCxwPXRoaXMudmlkZW9UcmFjayx2PXRoaXMuYXVkaW9UcmFjaztwLnNhbXBsZXM9W10sdi5zYW1wbGVzPVtdLHAudmlkZW9TZW5jPW51bGwsdi5hdWRpb1NlbmM9bnVsbDt2YXIgeT0wLG09MDtpZih0aGlzLl92aWRlb1NhbXBsZXMubGVuZ3RoPjAmJnIubGVuZ3RoPjApe2Zvcih2YXIgZyxrPWUuYnl0ZUxlbmd0aCt0LGI9clswXTtiPD1yWzFdO2IrKyl7aWYoIShkPXRoaXMuX3ZpZGVvU2FtcGxlc1tiXSkpdGhyb3cgbmV3IEVycm9yKCJjYW5ub3QgZm91bmQgdmlkZW8gZnJhbWUgIyIuY29uY2F0KGIpKTtkLm9mZnNldD49dCYmZC5vZmZzZXQrZC5zaXplPD1rJiYoeT0oaD1kLm9mZnNldC10KStkLnNpemUsZj1lLnN1YmFycmF5KGgseSksKGc9bmV3IFIoZC5wdHN8fGQuZHRzLGQuZHRzKSkuZHVyYXRpb249ZC5kdXJhdGlvbixnLmdvcElkPWQuZ29wSWQsZy5zYW1wbGVPZmZzZXQ9ZC5pbmRleCxkLmtleWZyYW1lJiZnLnNldFRvS2V5ZnJhbWUoKSxnLmRhdGE9ZixnLnNpemU9ZC5zaXplLHAuc2FtcGxlcy5wdXNoKGcpKX1wLnNhbXBsZXMubGVuZ3RoPjAmJihwLmdvcElkPXAuc2FtcGxlc1swXS5nb3BJZCxwLmJhc2VNZWRpYURlY29kZVRpbWU9cC5zYW1wbGVzWzBdLmR0cyxwLnN0YXJ0UHRzPXAuc2FtcGxlc1swXS5wdHMvcC50aW1lc2NhbGUscC5lbmRQdHM9cC5zYW1wbGVzW3Auc2FtcGxlcy5sZW5ndGgtMV0ucHRzL3AudGltZXNjYWxlLHRoaXMudmlkZW9TZW5jJiYocC52aWRlb1NlbmM9dGhpcy52aWRlb1NlbmMuc2xpY2UocC5zYW1wbGVzWzBdLnNhbXBsZU9mZnNldCxwLnNhbXBsZXNbMF0uc2FtcGxlT2Zmc2V0K3Auc2FtcGxlcy5sZW5ndGgpLHAua2lkVmFsdWU9cykpfWlmKHRoaXMuX2F1ZGlvU2FtcGxlcy5sZW5ndGg+MCYmYS5sZW5ndGg+MCl7Zm9yKHZhciBfPWFbMF07Xzw9YVsxXTtfKyspe2lmKCEoZD10aGlzLl9hdWRpb1NhbXBsZXNbX10pKXRocm93IG5ldyBFcnJvcigiY2Fubm90IGZvdW5kIHZpZGVvIGZyYW1lICMiLmNvbmNhdChfKSk7ZC5vZmZzZXQ+PXQmJmQub2Zmc2V0K2Quc2l6ZTw9ZS5ieXRlTGVuZ3RoK3QmJihtPShoPWQub2Zmc2V0LXQpK2Quc2l6ZSxmPWUuc3ViYXJyYXkoaCxtKSx2LnNhbXBsZXMucHVzaChuZXcgTyhkLmR0cyxmLGQuZHVyYXRpb24sZC5pbmRleCkpKX12LnNhbXBsZXMubGVuZ3RoPjAmJih2LmdvcElkPXYuc2FtcGxlc1swXS5nb3BJZHx8cC5nb3BJZCx2LmJhc2VNZWRpYURlY29kZVRpbWU9di5zYW1wbGVzWzBdLmR0cyx2LnN0YXJ0UHRzPXYuc2FtcGxlc1swXS5wdHMvdi50aW1lc2NhbGUsdi5lbmRQdHM9di5zYW1wbGVzW3Yuc2FtcGxlcy5sZW5ndGgtMV0ucHRzL3YudGltZXNjYWxlLHRoaXMuYXVkaW9TZW5jJiYodi5hdWRpb1NlbmM9dGhpcy5hdWRpb1NlbmMuc2xpY2Uodi5zYW1wbGVzWzBdLnNhbXBsZU9mZnNldCx2LnNhbXBsZXNbMF0uc2FtcGxlT2Zmc2V0K3Yuc2FtcGxlcy5sZW5ndGgpLHYua2lkVmFsdWU9cykpfXRoaXMuZGVjb2RlckRhdGEocCx2LG8pO2Zvcih2YXIgdz0wLHg9MDt4PHAuc2FtcGxlcy5sZW5ndGg7eCsrKWZvcih2YXIgUz0wLEE9cC5zYW1wbGVzW3hdLmRhdGEsRD1BLmxlbmd0aC0xO1M8RDspdz0kKEEsUyksUys9NCxwLnNhbXBsZXNbeF0udW5pdHMucHVzaChBLnN1YmFycmF5KFMsUyt3KSksUys9dztyZXR1cm4gdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlcj1lLnN1YmFycmF5KE1hdGgubWF4KHksbSkpLHRoaXMuX2xhc3RSZW1haW5CdWZmZXIuYnl0ZUxlbmd0aD4wP3RoaXMuX2xhc3RSZW1haW5CdWZmZXJTdGFydFBvcz10K2UuYnl0ZUxlbmd0aC10aGlzLl9sYXN0UmVtYWluQnVmZmVyLmJ5dGVMZW5ndGg6dGhpcy5fbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zPTAse3ZpZGVvVHJhY2s6cCxhdWRpb1RyYWNrOnYsbWV0YWRhdGFUcmFjazp0aGlzLm1ldGFkYXRhVHJhY2t9fX0se2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fdmlkZW9TYW1wbGVzPVtdLHRoaXMuX2F1ZGlvU2FtcGxlcz1bXSx0aGlzLl9sYXN0UmVtYWluQnVmZmVyPW51bGwsdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zPTAsdGhpcy52aWRlb1RyYWNrLnJlc2V0KCksdGhpcy5hdWRpb1RyYWNrLnJlc2V0KCksdGhpcy5tZXRhZGF0YVRyYWNrLnJlc2V0KCl9fSx7a2V5OiJkZWNvZGVyRGF0YSIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe2UudXNlRU1FfHx0LnVzZUVNRXx8RHQuZGVjb2RlckFFU0NUUkRhdGEoZSx0LHIpfX1dLFt7a2V5OiJwcm9iZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHBlLnByb2JlKGUpfX1dKSxlfSgpLEJ0PXtub3dUaW1lOmZ1bmN0aW9uKCl7dHJ5e3JldHVybiBwYXJzZUludChwZXJmb3JtYW5jZS5ub3coKSwxMCl9Y2F0Y2goZSl7cmV0dXJuKG5ldyBEYXRlKS5nZXRUaW1lKCl9fSxjb25jYXREYXRhOmZ1bmN0aW9uKGUsdCl7dmFyIHI9W10sYT0wO2UmJnIucHVzaChlKSx0JiZyLnB1c2godCksci5ldmVyeSgoZnVuY3Rpb24oZSl7cmV0dXJuIGUmJihhKz1lLmJ5dGVMZW5ndGgpLCEwfSkpO3ZhciBuPW5ldyBVaW50OEFycmF5KGEpLGk9MDtyZXR1cm4gci5ldmVyeSgoZnVuY3Rpb24oZSl7cmV0dXJuIGUmJihuLnNldChlLGkpLGkrPWUuYnl0ZUxlbmd0aCksITB9KSksbn19O29ubWVzc2FnZT1mdW5jdGlvbihlKXt2YXIgcj1lLmRhdGE7c3dpdGNoKHIubWV0aG9kKXtjYXNlImluaXQiOnRoaXMuY29kZWNUeXBlPXIuYXJncy5jb2RlY1R5cGUsdGhpcy5vcGVubG9nPXIuYXJncy5vcGVuTG9nLHRoaXMuTVA0RGVtdXhlcj1udWxsLHRoaXMuRk1QNFJlbXV4ZXI9bnVsbCx0aGlzLl9uZWVkSW5pdFNlZ21lbnQ9ITAsdGhpcy5zdXBwb3J0SGV2Yz1yLmFyZ3Muc3VwcG9ydEhldmM7YnJlYWs7Y2FzZSJ0cmFuc211eCI6dmFyIGE9ZS5kYXRhLmFyZ3Msbj1uZXcgVWludDhBcnJheShlLmRhdGEuYnVmZmVyKTt0aGlzLk1QNERlbXV4ZXJ8fCh0aGlzLk1QNERlbXV4ZXI9bmV3IEV0KG51bGwsbnVsbCxudWxsLHtvcGVubG9nOnRoaXMub3BlbmxvZ30pKTt2YXIgaSxzPXRoaXMuTVA0RGVtdXhlci5kZW11eFBhcnQobixhLnN0YXJ0LGEudmlkZW9JZHgsYS5hdWRpb0lkeCxhLm1vb3YsYS51c2VFTUUsYS5raWRWYWx1ZSk7aWYodGhpcy5GTVA0UmVtdXhlcnx8ImgyNjUiPT09dGhpcy5jb2RlY1R5cGUmJiF0aGlzLnN1cHBvcnRIZXZjfHwodGhpcy5GTVA0UmVtdXhlcj1uZXcgRGUodGhpcy5NUDREZW11eGVyLnZpZGVvVHJhY2ssdGhpcy5NUDREZW11eGVyLmF1ZGlvVHJhY2sse29wZW5Mb2c6dGhpcy5vcGVubG9nfSkpLHRoaXMuRk1QNFJlbXV4ZXIpe3ZhciBvPXRoaXMuRk1QNFJlbXV4ZXIucmVtdXgodGhpcy5fbmVlZEluaXRTZWdtZW50LHtpbml0TWVyZ2U6ITB9KTtvLmluaXRTZWdtZW50JiYodGhpcy5fbmVlZEluaXRTZWdtZW50PSExKSxpPXtidWZmZXI6QnQuY29uY2F0RGF0YShvLmF1ZGlvU2VnbWVudCxvLnZpZGVvU2VnbWVudCkscmFuZ2U6YS5jb250ZXh0LnJhbmdlLHN0YXRlOmEuY29udGV4dC5zdGF0ZSxjb250ZXh0OntyYW5nZTphLmNvbnRleHQucmFuZ2UsZnJhZ0luZGV4OmEuY29udGV4dC5mcmFnSW5kZXgsc3RhcnRQdHM6TWF0aC5taW4ocy52aWRlb1RyYWNrLnN0YXJ0UHRzLHMuYXVkaW9UcmFjay5zdGFydFB0cyksZW5kUHRzOk1hdGgubWF4KHMudmlkZW9UcmFjay5lbmRQdHMscy5hdWRpb1RyYWNrLmVuZFB0cyl9LGluaXRTZWc6by5pbml0U2VnbWVudH19dGhpcy5wb3N0TWVzc2FnZSh7bWV0aG9kOiJ0cmFuc211eCIsaWQ6ZS5kYXRhLmlkLGFyZ3M6dCh7fSxpKX0pO2JyZWFrO2Nhc2UicmVzZXQiOnRoaXMuRk1QNFJlbXV4ZXImJnRoaXMuRk1QNFJlbXV4ZXIucmVzZXQoKSx0aGlzLk1QNERlbXV4ZXImJnRoaXMuTVA0RGVtdXhlci5yZXNldCgpLHRoaXMuRk1QNFJlbXV4ZXI9bnVsbCx0aGlzLk1QNERlbXV4ZXI9bnVsbCx0aGlzLl9uZWVkSW5pdFNlZ21lbnQ9ITB9fX0oKTsK",Wr=typeof window<"u"&&window.Blob&&new Blob([atob(Ka)],{type:"text/javascript;charset=utf-8"});function Co(){var a=Wr&&(window.URL||window.webkitURL).createObjectURL(Wr);try{return a?new Worker(a,{}):new Worker("data:application/javascript;base64,"+Ka,{type:"module"})}finally{a&&(window.URL||window.webkitURL).revokeObjectURL(a)}}var To=function(a){ks(t,a);var i=Rs(t);function t(n){var e;return At(this,t),e=i.call(this),e.openlog=n.openLog,e.codecType=n.codecType,e.supportHevc=n.supportHevc,e.worker=new Co,e.worker.onmessage=function(s){e.emit(s.data.method,s.data)},e.worker.postMessage({method:"init",id:n.id||0,args:{openlog:e.openlog,supportHevc:e.supportHevc,codecType:e.codecType}}),e}return Ut(t,[{key:"transmux",value:function(e,s,r,l,o,u,c,p,m){var f=s.buffer;this.worker&&this.worker.postMessage({method:"transmux",id:e,buffer:f,args:{start:r,videoIdx:l,audioIdx:o,moov:u,useEME:c,kidValue:p,context:m}},[f])}},{key:"reset",value:function(){this.worker&&this.worker.postMessage({method:"reset"})}},{key:"destroy",value:function(){this.worker&&this.worker.terminate()}}]),t}(Dt),Ce={ERROR:"error",META_READY:"metaReady",MOOV_REQ_PROGRESS:"moov_request_Progress",UPDATE_LOAD_IDX:"update_load_fragmentIdx"},ko=function(a){ks(t,a);var i=Rs(t);function t(n,e){var s;if(At(this,t),s=i.call(this),ze(ge(s),"onprogressDataArrive",function(){var r=Fe(te().mark(function l(o,u,c){var p;return te().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:o&&o.byteLength>0&&(p=s.timeRange[c.index].range,p&&c.range[1]>=p[1]&&!u&&(u=!0),s.log("[mp4.loadFragment onprogressDataArrive ] receive data, >>> index,",c.index,",range,",JSON.stringify(c.range),", dataLen,",o.byteLength),s._mux(o,c.range[0],c.index,u)),u&&(s.timeRange[c.index].downloaded=!0,s.bufferLoadedPos=-1,s.log("[FragLoadDowned],fragmentIdx,",c.index,",rangeEnd,",c.range[1]));case 2:case"end":return f.stop()}},l)}));return function(l,o,u){return r.apply(this,arguments)}}()),s.url=n,s.options=t.getDefaultConfig(),Object.keys(e).map(function(r){e[r]!==void 0&&e[r]!==null&&(s.options[r]=e[r])}),s.timeRange=[],s.CHUNK_SIZE=s.options.chunkSize,s.bufferLoaded=new Uint8Array(0),s.bufferLoadedPos=0,s.meta=null,s.videoTrak=null,s.audioTrak=null,s.canDownload=!0,s._loadSuccessCallBack=null,s._isPending=!1,s._metaLoading=!1,s.MP4Loader=new Xo(Zt(Zt({segmentDuration:s.options.segmentDuration,url:n,vid:e.vid,retry:s.options.retryCount,retryDelay:s.options.retryDelay,timeout:s.options.timeout},e.reqOptions),{},{openLog:Jt()})),s.MP4Demuxer=null,s.FMP4Remuxer=null,s._needInitSegment=!0,s._switchBitRate=!1,s.enableWorker=s.options.enableWorker,s.enableWorker&&typeof Worker<"u")try{s.workerSequence=0,s.transmuxerWorkerControl=new To({id:s.workerSequence,codecType:e.codecType,supportHevc:s.options.supportHevc,openLog:Jt()}),s.transmuxerWorkerControl.on("transmux",function(r){var l=r.args;s.log("[transmuxerworker end] ,range, ",JSON.stringify(l.range),",dataLen,",l.buffer.byteLength,l.context),s._loadSuccessCallBack&&s._loadSuccessCallBack(l)})}catch(r){s.log("Error in worker:",r),s.enableWorker=!1,s.transmuxerWorkerControl=null}return s.enableWorker||(s.MP4Demuxer=null,s.FMP4Remuxer=null),s.seekTime=-1,s.changeBitRateTime=-1,s}return Ut(t,[{key:"changeBitRate",value:function(){var n=Fe(te().mark(function s(r){return te().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.url=r.url,o.next=3,this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE);case 3:this._switchBitRate=!0,this.log("[switchBitrate] changeUrl, bitRate,",this.url);case 5:case"end":return o.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"log",value:function(e){for(var s=this.options,r=s&&s.vid?"[MP4] ".concat(s.vid," ").concat(e):"[MP4] ".concat(e),l=arguments.length,o=new Array(l>1?l-1:0),u=1;u<l;u++)o[u-1]=arguments[u];Pa.apply(void 0,[r].concat(o))}},{key:"errorHandler",value:function(){var n=Fe(te().mark(function s(r,l){var o,u,c,p;return te().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:o=r.response,u=r.message,c=this.options?this.options.vid:"",p=null,this._isPending=!0,o?(p=new no("network",o.status,{httpText:o.httpText,message:u,url:o.url}),this.emit(Ce.ERROR,p)):(console.log("[MP4] [".concat(c,"] errorHandler,"),r),p=r,this.emit(Ce.ERROR,p));case 6:case"end":return f.stop()}},s,this)}));function e(s,r){return n.apply(this,arguments)}return e}()},{key:"init",value:function(){var n=Fe(te().mark(function s(){return te().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.url){l.next=3;break}return l.next=3,this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE);case 3:return l.next=5,this.getMetaInfo();case 5:case"end":return l.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"getTimeRange",value:function(){for(var e=[],s=null,r=0;this.videoTrak&&r<this.videoTrak.length;r++)s={startTime:this.videoTrak[r].startTime,endTime:this.videoTrak[r].endTime,downloaded:!1,isLoading:!1},e.push(s);if(this.audioTrak&&this.audioTrak.length>e.length)for(var l=e.length;l<this.audioTrak.length;l++)s={startTime:Math.max(this.audioTrak[l].startTime,s?s.endTime:0),endTime:Math.max(this.audioTrak[l].endTime,s?s.endTime:0),downloaded:!1,isLoading:!1},e.push(s);return e}},{key:"getMetaInfo",value:function(){var n=Fe(te().mark(function s(){var r=this,l,o,u,c=arguments;return te().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return l=c.length>0&&c[0]!==void 0?c[0]:!0,m.prev=1,this._metaLoading=!0,this.log("getMetaInfo start"),this.bufferLoaded=new Uint8Array(0),o=0,u=function(){var f=Fe(te().mark(function b(v,g,X){var D;return te().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:r.log("getMetaInfo onProgressHandle, dataLen,",v?v.byteLength:-1,", state,",g,",range,",JSON.stringify(X.range)),v&&X.range[0]===o&&(r.bufferLoaded=to(Uint8Array,r.bufferLoaded,new Uint8Array(v)),o+=v.byteLength),X.meta&&!r.meta&&(D=X.meta,r.videoTrak=D.videoSegments,r.audioTrak=D.audioSegments,r.timeRange=r.getTimeRange(),r.meta=Zt(Zt({},D.meta),{},{ext:{videoTrak:r.videoTrak,audioTrak:r.audioTrak}}),D.bufferLoaded=r.bufferLoaded,r.log("meta reach"),l&&r.emit(Ce.META_READY,r.meta)),r.meta&&g&&(r.log("[getMetaInfo req end]"),r._metaLoading=!1),r.meta&&(v||g)&&(r.log("emit moov_req_progress"),r.emit(Ce.MOOV_REQ_PROGRESS));case 5:case"end":return w.stop()}},b)}));return function(v,g,X){return f.apply(this,arguments)}}(),m.next=9,this.MP4Loader.loadMetaProcess(this.MP4Loader.cache,[0,this.CHUNK_SIZE],u);case 9:m.next=15;break;case 11:m.prev=11,m.t0=m.catch(1),console.error("[MP4] trigger errorHandler getMetaInfo",m.t0===null||m.t0===void 0?void 0:m.t0.message),this.loadError(m.t0,"getMetaInfo");case 15:case"end":return m.stop()}},s,this,[[1,11]])}));function e(){return n.apply(this,arguments)}return e}()},{key:"getFragmentIdx",value:function(e){var s,r;if(this.videoTrak.length){if(s=this.videoTrak.find(function(o){return o.startTime<=e&&o.endTime>e}),r=this.audioTrak.find(function(o){return o.startTime<=e&&o.endTime>e}),s&&r)return Math.min(s.index,r.index);if(s||r)return s?s.index:r.index;var l=Number.MAX_VALUE;return this.videoTrak&&this.videoTrak.length>0&&(l=this.videoTrak.length-1),this.audioTrak&&this.audioTrak.length>0&&(l=Math.min(this.audioTrak.length-1,l)),l}else return r=this.audioTrak.find(function(o){return o.startTime<=e&&o.endTime>e}),r?r.index:0}},{key:"_checkHasMeta",value:function(){var n=Fe(te().mark(function s(){var r;return te().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.log(" loadMeta start"),this._metaLoading=!0,o.next=4,this.MP4Loader.loadMeta(this.MP4Loader.cache,Math.round(this.CHUNK_SIZE/2));case 4:return r=o.sent,this._metaLoading=!1,this.videoTrak=r.videoSegments,this.audioTrak=r.audioSegments,this.meta=Zt(Zt({},r.meta),{},{ext:{videoTrak:this.videoTrak,audioTrak:this.audioTrak}}),this.timeRange=this.getTimeRange(),this.bufferLoaded=new Uint8Array(0),r.bufferLoaded=this.bufferLoaded,o.abrupt("return",!0);case 13:case"end":return o.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"resetFragmentLoadState",value:function(e){for(var s=0;s<this.timeRange.length;s++)s<e?(this.timeRange[s].downloaded=!0,this.timeRange[s].isLoading=!0):(this.timeRange[s].downloaded=!1,this.timeRange[s].isLoading=!1)}},{key:"getFragRange",value:function(e){var s,r,l,o,u=null;this.videoTrak&&(u=e<this.videoTrak.length?this.videoTrak[e]:this.videoTrak[this.videoTrak.length-1]);var c=null;this.audioTrak&&(c=e<this.audioTrak.length?this.audioTrak[e]:this.audioTrak[this.audioTrak.length-1]);var p=0,m=0;this.videoTrak&&e>=this.videoTrak.length-1&&(p=-1),this.audioTrak&&e>=this.audioTrak.length-1&&(m=-1);var f=[Math.min(((s=u)===null||s===void 0?void 0:s.range[0])||1/0,((r=c)===null||r===void 0?void 0:r.range[0])||1/0),Math.max(((l=u)===null||l===void 0?void 0:l.range[1])+p||0,((o=c)===null||o===void 0?void 0:o.range[1])+m||0)];return e<this.timeRange.length&&(this.timeRange[e].range=f),f}},{key:"load",value:function(){var n=Fe(te().mark(function s(r,l){var o,u,c;return te().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(this._loadSuccessCallBack=l,!(this._switchBitRate&&!this._metaLoading)){m.next=12;break}return this.log("[switchBitrate], switch bitRate start load, time,",r>=this.videoTrak.length?this.audioTrak[r].startTime:this.videoTrak[r].startTime,", fragIndex,",r),m.next=5,this._checkHasMeta();case 5:o=m.sent,this.changeBitRateTime>0&&(this.timeRange[r].startTime<=this.changeBitRateTime&&this.changeBitRateTime<this.timeRange[r].endTime?this.log("[switchBitrate], not need update load fragIndex",r,",stTime,",this.changeBitRateTime):(r=this.getFragmentIdx(this.changeBitRateTime),this.log("[switchBitrate], need update load fragIndex",r,",stTime,",this.changeBitRateTime,",newBitrateTimeRange,",this.timeRange[r].startTime,"-",this.timeRange[r].endTime),this.emit(Ce.UPDATE_LOAD_IDX,r)),this.seekTime=this.changeBitRateTime,this.changeBitRateTime=-1),this.resetFragmentLoadState(r),this.log("[switchBitrate], reset timerange state,",r),this._needInitSegment=!0,this.resetTansmuxer(),o&&(this._switchBitRate=!1);case 12:if(!(this._switchBitRate&&this._metaLoading)){m.next=14;break}return m.abrupt("return");case 14:u=this.getFragRange(r),this.log("loadFragment,",r,",range,",JSON.stringify(u)),this.seekTime>0?(c=this.getSubRange(r,this.seekTime,u),this.loadFragment(r,c),this.seekTime=-1):this.loadFragment(r,u);case 17:case"end":return m.stop()}},s,this)}));function e(s,r){return n.apply(this,arguments)}return e}()},{key:"getSubRange",value:function(e,s,r){var l=r[0],o=r[0],u=1,c=!1;if(this.log(">>>>>getSubRange time,",s,JSON.stringify(r)),this.videoTrak){var p=e<this.videoTrak.length?this.videoTrak[e]:this.videoTrak[this.videoTrak.length-1],m=p.frames.filter(Ro),f=this.meta.videoTimescale,b=m[0].startTime/f;this.log(">>>>>getSubRange video, startTime,",p.startTime,",endTime,",p.endTime);for(var v=0;v<m.length;v++)this.log(">>>>>getSubRange video keyFrameList, startTime,",m[v].startTime/f,",range,",m[v].offset);for(;u<m.length;u++){var g=m[u].startTime/f;if(b<=s&&s<g&&r[0]<m[u-1].offset){l=m[u-1].offset,c=!0,this.log(">>>>>getSubRange video end, startTime,",b,",endTime,",g,",startRange,",l,", keyFrameIndex,",u-1);break}b=g}!c&&b<=s&&s<p.endTime+.8&&(l=m[u-1].offset,this.log(">>>>>getSubRange video last, startTime,",b,",endTime,",p.endTime,",startRange,",l))}if(u=1,this.audioTrak){var X=e<this.audioTrak.length?this.audioTrak[e]:this.audioTrak[this.audioTrak.length-1],D=X.frames,F=this.meta.audioTimescale;u=Math.floor((s*F-D[0].startTime)/X.frames[0].duration),u=Math.min(D.length-1,u);for(var w=u>0?D[u-1].startTime/F:D[0].startTime/F;u>=0&&u<D.length;){if(u>0&&w>s){u-=1,w=D[u].startTime/F;continue}var S=(D[u].startTime+D[u].duration)/F;if(w<=s&&s<S&&r[0]<D[u].offset){o=D[u].offset,c=!0,this.log(">>>>>getSubRange audio end, startTime,",w,",endTime,",S,",startRange,",o,", index,",u);break}w=S,u++}}var G=[Math.min(o,l),r[1]];return this.log(">>>>>getSubRange finalRange ",JSON.stringify(G),",oldRange,",JSON.stringify(r)),G}},{key:"_mux",value:function(e,s,r,l){var o=this.getSamplesRange(r,"video"),u=this.getSamplesRange(r,"audio"),c=[s,s+e.byteLength];if(this.transmuxerWorkerControl){var p={range:c,state:l,fragIndex:r};this.log("[transmuxerworker start] ,range, ",JSON.stringify(c),",dataLen,",e.byteLength,p),this.transmuxerWorkerControl.transmux(this.workerSequence,e,s,o,u,this.meta.moov,this.useEME,this.kidValue,p)}else try{this.MP4Demuxer||(this.MP4Demuxer=new gl(this.videoTrak,this.audioTrak,null,{openLog:Jt()}));var m=this.MP4Demuxer.demuxPart(e,s,o,u,this.meta.moov,this.useEME,this.kidValue);!this.FMP4Remuxer&&(!this.checkCodecH265()||this.options.supportHevc)&&(this.FMP4Remuxer=new Cs(this.MP4Demuxer.videoTrack,this.MP4Demuxer.audioTrack,{openLog:Jt()}));var f;this.log("[mux], videoTimeRange,",m.videoTrack?[m.videoTrack.startPts,m.videoTrack.endPts]:null,",audioTimeRange,",m.audioTrack?[m.audioTrack.startPts,m.audioTrack.endPts]:null);var b=Math.min(m.videoTrack.startPts,m.audioTrack.startPts),v=Math.max(m.videoTrack.endPts,m.audioTrack.endPts),g=[b,v];if(this.FMP4Remuxer){var X=this.FMP4Remuxer.remux(this._needInitSegment,{initMerge:!0,range:c});X.initSegment&&(this._needInitSegment=!1);var D=et.concatData(X.audioSegment,X.videoSegment);f={buffer:D,range:c,state:l,context:{range:c,fragIndex:r,timeRange:g},initSeg:X.initSegment}}else f={videoTrack:m.videoTrack,audioTrack:m.audioTrack,buffer:null,range:c,state:l,context:{range:c,fragIndex:r,timeRange:g}};this._loadSuccessCallBack&&this._loadSuccessCallBack(f)}catch(w){console.error("mux err:",w);var F=new so(Ct.remux,gt.muxError,{msg:JSON.stringify(w)});this.errorHandler(F,"mux",{fragIndex:r,range:[s,s+e.byteLength]})}}},{key:"getSamplesRange",value:function(e,s){var r=[];switch(s){case"video":if(this.videoTrak&&e<this.videoTrak.length){var l=this.videoTrak[e].frames;r.push(l[0].index),r.push(l[l.length-1].index)}break;case"audio":if(this.audioTrak&&e<this.audioTrak.length){var o=this.audioTrak[e].frames;r.push(o[0].index),r.push(o[o.length-1].index)}break;default:console.warn("[getSamplesRange] type ",s," is invalid");break}return r}},{key:"loadFragment",value:function(){var n=Fe(te().mark(function s(r,l){var o,u,c,p;return te().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(this._isPending||l===[0,0]||this.timeRange[r].isLoading)){f.next=2;break}return f.abrupt("return");case 2:if(this.log("[MP4.loadFragment] ,fragIndex,",r,",range ",l,",len ,",l[1]-l[0],", bufferLoaded_Len,",this.bufferLoaded.byteLength),!(l.length>=2&&l[1]&&l[1]>0&&l[1]<=this.bufferLoaded.byteLength)){f.next=13;break}this.timeRange[r].isLoading=!0,o=Math.max(l[0],this.bufferLoadedPos),u=new Uint8Array(this.bufferLoaded.slice(o,l[1])),this.log("[mp4.loadFragment] has all data: ",o,l[1]),this.timeRange[r].downloaded=!0,this.bufferLoadedPos=-1,this._mux(u,o,r,!0),f.next=34;break;case 13:if(!(l.length>=2&&l[0]&&l[0]<=this.bufferLoaded.byteLength)){f.next=29;break}if(this.timeRange[r].isLoading){f.next=27;break}if(c=Math.max(l[0],this.bufferLoadedPos),p=new Uint8Array(this.bufferLoaded.slice(c,l[1])),!(p.byteLength>0)){f.next=22;break}return this.bufferLoadedPos=c+p.byteLength,this.log("[mp4.loadFragment] has part data: ",c,c+p.byteLength),this._mux(p,c,r,l[1]<=this.bufferLoadedPos),f.abrupt("return");case 22:if(!(!this._metaLoading&&!this.timeRange[r].isLoading)){f.next=27;break}return this.log("[mp4.loadFragment] ready to load part data >>> ",this.bufferLoaded.byteLength,l[1]),this.timeRange[r].isLoading=!0,f.next=27,this.startLoad([this.bufferLoaded.byteLength,l[1]],r);case 27:f.next=34;break;case 29:if(!((!this._metaLoading||l[0]>=this.CHUNK_SIZE)&&!this.timeRange[r].isLoading)){f.next=34;break}return this.timeRange[r].isLoading=!0,this.log("[mp4.loadFragment],ready to load all data ,segmentIdx, ",r,",range >>> ",JSON.stringify(l)),f.next=34,this.startLoad(l,r);case 34:case"end":return f.stop()}},s,this)}));function e(s,r){return n.apply(this,arguments)}return e}()},{key:"startLoad",value:function(){var n=Fe(te().mark(function s(r,l){return te().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,this.MP4Loader.loadData(r,this.MP4Loader.cache,{index:l,onProgress:this.onprogressDataArrive,onProcessMinLen:this.options.onProcessMinLen});case 3:u.next=9;break;case 5:u.prev=5,u.t0=u.catch(0),console.error("[MP4] trigger errorHandler getMetaInfo",u.t0===null||u.t0===void 0?void 0:u.t0.message),this.loadError(u.t0,"loadFragment",{range:r,fragIndex:l});case 9:case"end":return u.stop()}},s,this,[[0,5]])}));function e(s,r){return n.apply(this,arguments)}return e}()},{key:"loadError",value:function(e,s,r){var l;!e.response&&(e.response={}),e.isTimeout?e.response.status="timeout":e!=null&&(l=e.response)!==null&&l!==void 0&&l.status||(e.response.status="networkError"),this.errorHandler(e,s,r)}},{key:"cancelLoading",value:function(){var n=Fe(te().mark(function s(){return te().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.MP4Loader;case 2:if(l.t0=l.sent,!l.t0){l.next=5;break}this.MP4Loader.cancel();case 5:case"end":return l.stop()}},s,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"update",value:function(e){this.url=e}},{key:"checkCodecH265",value:function(){var e=this.meta&&(this.meta.videoCodec.indexOf("hvc1")>-1||this.meta.videoCodec.indexOf("hev1")>-1);return e}},{key:"destroy",value:function(){this.hasDestroyed||(this.resetTansmuxer(),this.transmuxerWorkerControl&&this.transmuxerWorkerControl.destroy(),this._isPending=!1,this._metaLoading=!1,this.bufferLoadedPos=0,this.bufferLoaded=new Uint8Array(0),this.MP4Loader&&(this.MP4Loader.cancel(),this.MP4Loader.destroy()),this.hasDestroyed=!0)}},{key:"resetTansmuxer",value:function(){this.MP4Demuxer&&this.MP4Demuxer.reset(),this.MP4Demuxer=null,this.FMP4Remuxer&&this.FMP4Remuxer.reset(),this.FMP4Remuxer=null,this.transmuxerWorkerControl&&this.transmuxerWorkerControl.reset()}}],[{key:"getDefaultConfig",value:function(){return{segmentDuration:5,onProcessMinLen:1024,chunkSize:8e5,retryCount:3,retryDelay:1e3,timeout:3e3,enableWorker:!1,playerId:"",vid:"",ext:{}}}}]),t}(Dt);function Ro(a){if(a.keyframe)return a}var Vo=function(){function a(i){At(this,a),this.onTick_=i,this.cancelPending_=null}return Ut(a,[{key:"tickAfter",value:function(t){var n=this,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.stop();var s=!0,r=null;this.cancelPending_=function(){window.clearTimeout(r),s=!1};var l=function(){s&&(n.onTick_(),e&&e())};return r=window.setTimeout(l,t*1e3),this}},{key:"tickEvery",value:function(t){var n=this;this.tickAfter(t,function(){n.tickEvery(t)})}},{key:"stop",value:function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)}}]),a}(),Cr=null,xo=null,Tr=null,kr=null,Mo=function(a){ks(t,a);var i=Rs(t);function t(n){var e;return At(this,t),e=i.call(this,n),ze(ge(e),"_onMp4DataCallBack",function(){e._isMseInit&&e._onTimeUpdate()}),ze(ge(e),"_onMp4MetaReady",function(s){var r=ge(e),l=r.config,o=e.mp4.checkCodecH265();try{if(o&&!e.config.supportHevc){var u="browser not support HEVC",c=new It(e.player,{errorType:"runtime",errorTypeCode:Ct.runtime,errorCode:gt.h265Error,errorMessage:u,vid:l.vid,mediaError:{code:gt.h265Error,message:u}});e._errorHandler(c)}else e._initMse(s)}catch(f){var p=new It(e.player,{errorType:"runtime",errorTypeCode:Ct.runtime,errorCode:gt.mse,errorMessage:f==null?void 0:f.message,vid:l.vid,mediaError:{code:gt.other1,message:f==null?void 0:f.message}});e._errorHandler(p)}finally{var m=e.config.url;e.mse&&(m=e.mse.url,e._proxyPlayer()),e.player._startInit.call(e.player,m)}e._loadData()}),ze(ge(e),"_onMp4Error",function(s){var r=e.playerConfig.vid;console.error("[Index] _onMp4Error",r,s),e._errorHandler(s)}),ze(ge(e),"_loadDataSuccess",function(s){if(!(e.isDestroy||!e.mse)){e.log("[loadFragment] _loadDataSuccess ",JSON.stringify(s.context.range),",dataLen,",s.buffer?s.buffer.byteLength:0,s.state);try{s.initSeg&&(e._appendInitSeg(s.initSeg),(!s.buffer||s.buffer.byteLength<1)&&(e.log("no data, must load data"),e._onTimeUpdate()));var r=s.buffer,l=s.state,o=s.context;if(e.mse&&l&&(!r||r.byteLength<=0)&&o.fragIndex===e.mp4.timeRange.length-1){var u=e.player.buffered;u&&u.length>0&&(e.bufferEndTime=u.end(u.length-1)),e._isEnded(),e.log("loaded ended !!!==>>>",JSON.stringify(o.range),", fragIndex,",o.fragIndex,", bufferEndTime,",e.bufferEndTime,",meta_duration,",e.mp4.meta.duration)}if(e.mse&&l&&o.fragIndex===e.mp4.timeRange.length-1&&(!r||r.byteLength<=0)){var c=e.player.buffered;c&&c.length>0&&(e.bufferEndTime=c.end(c.length-1)),e._isEnded(),e.log("load ended !!!==>>>",e.playerConfig.vid,JSON.stringify(o.range),", fragIndex,",o.fragIndex,", bufferEndTime,",e.bufferEndTime,",meta_duration,",e.mp4.meta.duration)}r&&e.mse&&r&&r.byteLength>0&&e._appendBuffer(he.VIDEO,r,o,l)}catch(m){e.log("appendBuffer error",m);var p=new It(e.player,{errorType:"runtime",errorTypeCode:Ct.runtime,errorCode:gt.mse,vid:e.player.config.vid,errorMessage:m.message,mediaError:{code:gt.mse,message:m.message}});e._errorHandler(p)}s!=null&&s.state&&e._onTimeUpdate()}}),ze(ge(e),"_onWaiting",function(){var s=ge(e),r=s.player,l=s.config;clearTimeout(e._waitInBufferTimer),e._waitInBufferTimer=null;var o=r.currentTime;console.log("[>>>>onWaiting],currentTime, ",o,et.nowTime());var u=r.bufferedPoint;u.end>0&&u.end-r.currentTime>=2&&e._waitAdjustTimeCnt<l.waitJampBufferMaxCnt&&(e._waitInBufferTimer=setTimeout(function(){e._waitAdjustTimeCnt++,r.currentTime=r.currentTime+.5,e.log("[waitInBufferTimeout], waitAdjustTimeCnt,",e._waitAdjustTimeCnt,",curtime,",o,et.nowTime())},l.waitingInBufferTimeOut))}),ze(ge(e),"_onSeeking",Fe(te().mark(function s(){var r,l,o,u,c,p,m,f,b,v,g;return te().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(r=ge(e),l=r.player,o=r.mp4,u=l.currentTime,e.log("[seekTime], curTime,",u,",buffer,",l.buffered2.bufferedList),!(!o||!o.meta)){D.next=5;break}return D.abrupt("return");case 5:if(e.endofstream=!1,o.bufferLoadedPos=-1,o._metaLoading=!1,c=l.bufferedPoint,p=!1,m=0,!(c.end>0)){D.next=25;break}if(p=!0,!(o.meta.duration-c.end<.5)){D.next=17;break}return e._startProgress(),e.log("[seeking in buffered range], buffer end,",c.end,", duration,",o.meta.duration),D.abrupt("return");case 17:if(m=o.getFragmentIdx(c.end),e._curLoadSegmentIdx!==m){D.next=22;break}return e._startProgress(),e.log("[seeking in buffered range], seek fragIndex is current load segmentIdx",m),D.abrupt("return");case 22:o.seekTime=c.end,m<0&&(m=e._curLoadSegmentIdx),e.log("[seeking in buffered range], seekTime ",u,",bufferRange,",c.start,"-",c.end,", fragIndex,",m);case 25:return p||(o.seekTime=u,m=o.getFragmentIdx(u),m<0&&(m=e._curLoadSegmentIdx),e.log("[seekTime out buffer range], curTime,",u,", Idx,",m),f=ge(e),b=f.mse,b&&b.isFull()&&(v=l.buffered2.bufferedList,g=v[v.length-1],b.clearOpQueues(he.VIDEO),e._checkRemoveSourceBuffer([g.start,g.end],l.currentTime,!0,!0))),D.next=28,o.cancelLoading();case 28:o.resetFragmentLoadState(m),e._curLoadSegmentIdx=m,e._onTimeUpdate(),e._startProgress(),e._isEnded();case 33:case"end":return D.stop()}},s)}))),ze(ge(e),"changeDefineCanPlay",function(s,r,l,o){var u=ge(e),c=u.player;if(c.ended){c.currentTime=0;return}e.log("[oldChangeDefinition],this._changeDefState,",e._changeDefState),c.currentTime=e._changeDefState?e._changeDefState.currentTime:s;var p=e._changeDefState?e._changeDefState.paused:r;p?c.pause():c.play(),e._changeDefState=null,c.emit(Aa,{from:l,to:o})}),ze(ge(e),"changeDefinition",function(){var s=Fe(te().mark(function r(l,o){var u,c,p,m,f,b,v;return te().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(u=ge(e),c=u.player,p=u.config,m=u.mp4,o||(o=c.curDefinition),e._MSEError=!1,!p.witchBitRateWay){X.next=6;break}return e.oldChangeDefinition(l,o),X.abrupt("return");case 6:if(c.emit(Ua,{from:o,to:l}),f=c.currentTime,b=m.getFragmentIdx(f),b<0&&(b=e._curLoadSegmentIdx),e.log("switchBitrate:point,fragIndex,",b,",startTime,",m.timeRange[b].startTime,",currentTime,",c.currentTime),!m){X.next=16;break}return e.mp4.changeBitRateTime=f,X.next=15,m.cancelLoading();case 15:m._metaLoading&&(m._metaLoading=!1);case 16:return e._removeBuffeEndTime=m.timeRange[b].startTime,e._isChangeDefinition=!0,v=c.getBufferedRange(c.buffered),v[1]>0&&v[1]-c.currentTime>5&&(e.mse.clearOpQueues(he.VIDEO),e.mse.remove(he.VIDEO,c.currentTime+5,v[1])),e.log("switchBitrate: resetFragmentLoadState,",b),m.resetFragmentLoadState(b),e._curLoadSegmentIdx=b,X.next=25,e.mp4.changeBitRate(l);case 25:e._onTimeUpdate(),c.emit("RESOLUTION_UPDATE",l);case 27:case"end":return X.stop()}},r)}));return function(r,l){return s.apply(this,arguments)}}()),ze(ge(e),"_replayHook",function(){var s;return(s=e.player)===null||s===void 0||s.play(),!1}),ze(ge(e),"_retryHook",function(){return e.beforePlayerInit(),!1}),e.mp4=null,e.mse=null,e._waitAdjustTimeCnt=0,e._lastCheckTime=et.nowTime(),e._removeBuffeEndTime=0,e}return Ut(t,[{key:"afterCreate",value:function(){var e=this;window.__mp4player=this;try{kt.defineGetterOrSetter(this.player,{__url:{get:function(){try{return e.mse?e.mse.url:e.config.url}catch{return null}}}})}catch{}}},{key:"beforePlayerInit",value:function(){var e=this.config;e.supportHevc===void 0&&un!==null&&un!==void 0&&un.isHevcSupported&&un.isHevcSupported()&&(e.supportHevc=!0),this.initMp4(),this.attachEvents(),this._startProgress()}},{key:"attachEvents",value:function(){this.off(Hn,this._onSeeking),this.on(Hn,this._onSeeking),this.on(Ps,this._onWaiting),this.off(Bt,this.switchURL),this.on(Bt,this.switchURL)}},{key:"detachEvents",value:function(){this.off(Hn,this._onSeeking),this.off(Ps,this._onWaiting),this.off(Bt,this.switchURL)}},{key:"initMp4",value:function(){var e=this,s=this.player;s.config.vid||(s.config.vid=Date.now()),this.mp4&&(this.mp4.off(Ce.META_READY,this._onMp4MetaReady),this.mp4.off(Ce.ERROR,this._onMp4Error),this.mp4.off(Ce.MOOV_REQ_PROGRESS,this._onMp4DataCallBack),this.mp4.destroy()),this.mp4=new ko(s.config.url,Zt(Zt({},this.config),{},{vid:s.config.vid})),this.mp4.on(Ce.META_READY,this._onMp4MetaReady),this.mp4.on(Ce.ERROR,this._onMp4Error),this.mp4.on(Ce.MOOV_REQ_PROGRESS,this._onMp4DataCallBack),this.mp4.on(Ce.UPDATE_LOAD_IDX,function(r){e._curLoadSegmentIdx=r,e.log("[update curLoadSegmentIdx]",r)}),this.mp4.init()}},{key:"_proxyPlayer",value:function(){var e=this;typeof this.player.playNext=="function"&&(Cr=this.player.playNext),this.player.playNext=function(){e.playNext.apply(e,arguments)},kr=this.player.switchURL,Tr=this.player.changeDefinition,this.player.switchURL=this.switchURL.bind(this),this.player.changeDefinition=this.changeDefinition.bind(this),this.player.removeHooks("replay",this._replayHook),this.player.removeHooks("retry",this._retryHook)}},{key:"setConfig",value:function(e){this.config=Object.assign(this.config,e)}},{key:"playNext",value:function(e){var s=this.player;this._defInited=!1,s.resetState(),s._currentTime=0,s._duration=0,s.isPlaying=!1,this._MSEError=!1,s.pause(),this._reset(),s.setConfig(e),this.log("[Index] playNext",e),s.play(),this.emit("playnext")}},{key:"_errorHandler",value:function(e){var s=this.player,r=this.config;s&&(console.log("final error !!!!, ",r.vid,e),this.emit("error",e))}},{key:"_initMse",value:function(){var n=Fe(te().mark(function s(r){var l=this,o,u,c,p,m,f;return te().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!this.mse){v.next=4;break}return v.next=3,this.mse.unbindMedia();case 3:this.mse=null;case 4:o=this.mp4&&this.mp4.checkCodecH265(),u=!!r.videoCodec,c=!!r.audioCodec,u&&c?p=o?'video/mp4; codecs="hev1.1.6.L93.B0, mp4a.40.5"':'video/mp4; codecs="avc1.64001E, mp4a.40.5"':u?p=o?'video/mp4; codecs="hev1.1.6.L93.B0"':'video/mp4; codecs="avc1.64001E"':p='video/mp4; codecs="mp4a.40.5"',m=ze({},he.VIDEO,{mimeType:"video/mp4",codec:p}),this.mse=new he,f=this.mse.bindMedia(this.player.video),f.then(function(){var g=Object.keys(m);try{for(var X=0;X<g.length;X++){var D=g[X];l.mse.createSource(D,m[D].codec)}}catch(F){console.error("MSE error: ",F),l._errorHandler(F)}l._isMseInit=!0,l._onTimeUpdate()});case 12:case"end":return v.stop()}},s,this)}));function e(s){return n.apply(this,arguments)}return e}()},{key:"_onTimeUpdate",value:function(){var e=this,s=this.mse,r=this.mp4,l=this.player,o=this.config;if(r){var u=r.timeRange,c=l.getBufferedRange(l.buffered2);if(s&&r&&r.canDownload){et.nowTime()-this._lastCheckTime>1e3&&(this._lastCheckTime=et.nowTime(),this._loadStuckCheck(),this._checkRemoveSourceBuffer(c,l.currentTime));var p=l.paused?l.currentTime+o.minBufferLength:l.currentTime+o.maxBufferLength;c[1]-p<0&&u.every(function(m,f){if(m.downloaded)return!0;if(!e._isChangeDefinition&&m.endTime-m.startTime>1&&e._isInBuffer(m))return m.downloaded=!0,m.isLoading=!0,e.log("onTimeUpdate, ".concat(f," download segment, has buffer"),m.startTime,m.endTime),!0;m.startTime-l.currentTime<o.maxBufferLength&&(e._curLoadSegmentIdx=f,e.log("[onTimeUpdate],load index==>>>, ",f,",IdxTimeRange, ",m.startTime,"-",m.endTime,",buffEnd, ",c[1],",playCurTime,",l.currentTime,", bufferLen,",c[1]-l.currentTime,",bufferRangeList,",e.player.buffered2?e.player.buffered2.bufferedList:null),e._loadData())}),this._isEnded()}this.checkRemoveOldBitrateBuffer()}}},{key:"checkRemoveOldBitrateBuffer",value:function(){var e=this.mse,s=this.player;e&&this._removeBuffeEndTime>0&&s.currentTime>this._removeBuffeEndTime+1&&(this.log("remove old bitrate buffer",this._removeBuffeEndTime),e.remove(he.VIDEO,0,this._removeBuffeEndTime-1),this._removeBuffeEndTime=0)}},{key:"_isInBuffer",value:function(e){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=!1,l=this.player.video.buffered,o=0;o<l.length;o++){var u=l.start(o)-s,c=l.end(o)+s;if(u<=e.startTime&&e.endTime<=c){r=!0;break}}return r}},{key:"_loadData",value:function(){var n=Fe(te().mark(function s(){return te().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(!this.mp4||!this._isMseInit)){l.next=3;break}return this.log("loadData, player.mp4 null",this._isMseInit),l.abrupt("return");case 3:return l.prev=3,l.next=6,this.mp4.load(this._curLoadSegmentIdx,this._loadDataSuccess);case 6:l.next=11;break;case 8:l.prev=8,l.t0=l.catch(3),console.error("[Index] _loadData error",this.playerConfig.vid,l.t0);case 11:case"end":return l.stop()}},s,this,[[3,8]])}));function e(){return n.apply(this,arguments)}return e}()},{key:"_appendInitSeg",value:function(e){var s=this;!this.mp4||!this.mse||this.mse.append(he.VIDEO,e,{vid:this.playerConfig.vid,range:null,dataLen:e.byteLength,isinit:!0}).then(function(r){s.log("appendInitSeg end ==>>>",r.context?r.context:null,", costTime,",r.costtime)})}},{key:"_appendBuffer",value:function(e,s){var r=this,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,u=this.mse,c=this.config;u.append(e,s,{vid:c.vid,fragIndex:l.fragIndex,range:l.range,dataLen:s.byteLength,state:o}).then(function(p){if(r.log("player appendBuffer end ==>>>",p.context?p.context:null,", costTime,",p.costtime,", opt,",p.name,",bufferRange,",r.player.getBufferedRange()),r.mse&&l.state&&l.fragIndex===r.mp4.timeRange.length-1){var m=r.player.buffered;m&&m.length>0&&(r.bufferEndTime=m.end(m.length-1)),r._isEnded(),r.log("loaded ended !!!==>>>",l.range,", fragIndex,",l.fragIndex,", bufferEndTime,",r.bufferEndTime,",meta_duration,",r.mp4.meta.duration)}}).catch(function(p){if(console.log("[MSE error]",p),p&&u!==null&&u!==void 0&&u.isFull()){var m=r.player.getBufferedRange(r.player.buffered2);r._checkRemoveSourceBuffer(m,r.player.currentTime,!0)}})}},{key:"_checkRemoveSourceBuffer",value:function(e,s,r){var l=this,o=this.mse,u=this.mp4,c=this.player;if(!(!o||!u||!c)&&(r&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),e||(e=c.getBufferedRange(c.buffered2)),s||(s=c.currentTime),!(!r&&et.nowTime()-this._checkRemoveBufferLastTime<=this.config.removeBufferLen||this.endofstream)&&(this._checkRemoveBufferLastTime=et.nowTime(),e&&e[0]>=0&&(s-e[0]>this.config.removeBufferLen||o.isFull())))){var p=e[1],m=u.getFragmentIdx(p);if(m>=0&&u.timeRange[m].startTime<s){var f=Math.floor(Math.min(u.timeRange[m].startTime,e[1]));e[0]<f?(this.log("[checkremoveSourceBuffer], remove range==>>>",e[0],f),o.remove(he.VIDEO,e[0],f)):o.isFull()&&!this._removeBufferTimer&&(this._removeBufferTimer=setTimeout(function(){l._checkRemoveSourceBuffer(null,null,!0)},10*1e3))}}}},{key:"_isEnded",value:function(){var e=this.player,s=this.mp4,r=e.bufferedPoint,l=r?r.end:0;return!this.endofstream&&this.mse&&s.meta.duration-e.currentTime<.5&&(this.log("[check player isEnded],deal mse.endOfStream, currentTime,",e.currentTime,", bufferend,",l,", duration,",s.meta.duration),this.endofstream=!0,this.mse.endOfStream()),s&&s.meta&&s.meta.duration-e.currentTime<.5?(this._stopProgress(),this.log("[check player isEnded],stopProgress and endOfStream,currentTime, ",e.currentTime,", bufferend,",l,", duration,",s.meta.duration),this.mse&&this.mse.endOfStream(),!0):!1}},{key:"switchURL",value:function(e){this.changeDefinition(e)}},{key:"oldChangeDefinition",value:function(e,s){var r=this,l=this.config,o=this.player;this.log("[oldChangeDefinition],currentTime,",o.currentTime,",from,",s,",to,",e);var u=o.currentTime,c=o.paused;this._changeDefState||(this._changeDefState={currentTime:u,paused:c},this.log("[oldChangeDefinition],currentTime,",o.currentTime,",pause,",c)),o.config.url=e.url,l.focusUserDefinition=!0,o.currentTime=0,o.pause(),this._reset(),this._isMseInit=!1,this._changeDefineCanPlay&&o.off("canplay",this._changeDefineCanPlay),this._changeDefineCanPlay=function(){r.changeDefineCanPlay(u,c,s,e),r._changeDefineCanPlay=null},o.once("canplay",this._changeDefineCanPlay),this.player.video.load(),this.initMp4()}},{key:"_loadStuckCheck",value:function(){var e=this,s=this.config,r=this.player;s.disableBufferBreakCheck||(r.currentTime-(this._lastCurrentTime||0)>.1||r.paused?(this._bufferBreakFlag===1||this._bufferBreakFlag===2)&&(this.log("视频没有卡死,重置卡死标记"),this._bufferBreakFlag=0,clearTimeout(this._bufferBreakTimer),this._bufferBreakFlag=null):this._bufferBreakFlag||(this._bufferBreakFlag=1,this.log("卡死计时开始! 持续".concat(s.waitingTimeOut,"毫秒则确认卡死")),this._bufferBreakTimer=setTimeout(function(){e.isDestroy||(e._bufferBreakFlag===1&&(e._bufferBreakFlag=2,e.log("确认卡死!!!"),e._errorHandler(new It(e.player,{errorType:"runtime",errorTypeCode:Ct.runtime,errorCode:gt.waitTimeout,errorMessage:"wait_timeout",vid:s.vid}))),e._bufferBreakTimer=null)},s.waitingTimeOut)),this._lastCurrentTime=r.currentTime)}},{key:"isDestroy",get:function(){return!this.player}},{key:"_stopProgress",value:function(){this._hasStartProgress=!1,this._requestTimer&&(this._requestTimer.stop(),this._requestTimer=null),this._bufferBreakTimer&&(clearTimeout(this._bufferBreakTimer),this._bufferBreakTimer=null,this._bufferBreakFlag=void 0)}},{key:"_startProgress",value:function(){var e=this;this._hasStartProgress||(this._stopProgress(),this._requestTimer=new Vo(function(){e._requestTimer&&e._onTimeUpdate()}),this._requestTimer.tickEvery(this.config.tickInSeconds),this._hasStartProgress=!0)}},{key:"log",value:function(e){for(var s=this.playerConfig,r=s&&s.vid?"[Index]".concat(s.vid," ").concat(e):"[Index] ".concat(e),l=arguments.length,o=new Array(l>1?l-1:0),u=1;u<l;u++)o[u-1]=arguments[u];Pa.apply(void 0,[r].concat(o))}},{key:"_reset",value:function(){this._isMseInit=!1,this.endofstream=!1,this._curLoadSegmentIdx=0,this._removeBuffeEndTime=0,this._isChangeDefinition=!1,this._stopProgress(),this.mp4&&(this.mp4.off(Ce.META_READY,this._onMp4MetaReady),this.mp4.off(Ce.ERROR,this._onMp4Error),this.mp4.off(Ce.MOOV_REQ_PROGRESS,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null),this.mse&&(this.mse.unbindMedia(),this.mse=null),this._unloadVideo()}},{key:"_unloadVideo",value:function(){var e=this.player;try{this.log("unloadVideo src ".concat(e.video.src)),e.video&&e.video.src&&(e.video.removeAttribute("src"),e.video.load())}catch(s){this.log("unloadVideo error",s)}}},{key:"destroy",value:function(){var e=this.player;e.removeHooks("replay",this._replayHook),e.removeHooks("retry",this._retryHook),this.detachEvents(),this._reset(),this.player.playNext=Cr,this.player._startInit=xo,this.player.changeDefinition=Tr,this.player.switchURL=kr,this._bufferBreakTimer&&clearInterval(this._bufferBreakTimer),this._removeBufferTimer&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),this._waitInBufferTimer&&(clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null)}}],[{key:"pluginName",get:function(){return"mp4Plugin"}},{key:"defaultConfig",get:function(){return{maxBufferLength:40,minBufferLength:5,disableBufferBreakCheck:!1,waitingTimeOut:15e3,waitingInBufferTimeOut:5e3,waitJampBufferMaxCnt:3,tickInSeconds:.1,reqOptions:null}}},{key:"version",get:function(){return"3.0.7"}}]),t}(kt);const Yo=Xt("div",{id:"mse"},null,-1),Eo={__name:"xgVideoPlay",setup(a){Nn({type:null});const i=Nn({url:[{value:"https://stream7.iqilu.com/10339/upload_transcode/202002/18/20200218114723HDu3hhxqIT.mp4",label:"mp4测试用例"},{value:"https://vip.lz-cdn5.com/20220401/3315_dbd60bc0/index.m3u8",label:"m3u8测试用例"},{value:"https://sf1-hscdn-tos.pstatp.com/obj/media-fe/xgplayer_doc_video/flv/xgplayer-demo-360p.flv",label:"flv测试用例"}]}),t=Nn({id:"mse",url:"https://vip.lz-cdn5.com/20220401/3315_dbd60bc0/index.m3u8",height:"300",width:"400",fluid:!0,fitVideoSize:"auto",volume:.6,autoplay:!1,loop:!1,videoInit:!0,poster:"",playbackRate:[.5,.75,1,1.5,2],defaultPlaybackRate:1,rotate:{clockwise:!0,innerRotate:!0},playsinline:!0,plugins:[],playsinline:!0,whitelist:[""],keyShortcut:"on",closeVideoClick:!0,closeVideoDblclick:!0,closeVideoTouch:!0,playbackRate:[null],pip:!0,download:!0,thumbnail:{pic_num:44,width:160,height:90,col:10,row:10,urls:[""]},progressDot:[{time:10,text:"标记文字",duration:8,style:{background:"blue"}},{time:22,text:"标记文字"},{time:56,duration:8},{time:76}]});let n=rs();Hr(()=>{t.plugins.push(Dn),n.value=new ts(t)});const e=()=>{if(n.value.destroy(),t.url){let s=t.url.split(".").at(-1);switch(console.log(s),s){case"m3u8":t.plugins=[Dn];break;case"flv":t.plugins=[xa];break;case"mp4":t.plugins=[Mo];break;default:t.plugins=[]}n.value=new ts(t)}};return(s,r)=>(_t(),as(Ze(Kr),null,{default:ke(()=>[Se(Ze(Er),{"label-width":"100px"},{default:ke(()=>[Se(Ze(Ir),null,{default:ke(()=>[Se(Ze(ns),{span:11,offset:0},{default:ke(()=>[Se(Ze(ss),{label:"视频源src"},{default:ke(()=>[Se(Ze(_r),{modelValue:t.url,"onUpdate:modelValue":r[0]||(r[0]=l=>t.url=l),placeholder:"请输入视频源（src）",onChange:e,clearable:""},{default:ke(()=>[(_t(!0),Gs(Nr,null,Ar(i.url,l=>(_t(),as(Ze(Pr),{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),Se(Ze(ns),{span:11,offset:0},{default:ke(()=>[Se(Ze(ss),{label:"视频源src"},{default:ke(()=>[Se(Ze(Ba),{modelValue:t.url,"onUpdate:modelValue":r[1]||(r[1]=l=>t.url=l),placeholder:"请输入视频源（src）",onChange:e,clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),Yo]),_:1}))}};function Rr(a,i){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);i&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),t.push.apply(t,n)}return t}function Wn(a){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?arguments[i]:{};i%2?Rr(Object(t),!0).forEach(function(n){Lt(a,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):Rr(Object(t)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(t,n))})}return a}function yt(a,i){if(!(a instanceof i))throw new TypeError("Cannot call a class as a function")}function Vr(a,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,Ha(n.key),n)}}function bt(a,i,t){return i&&Vr(a.prototype,i),t&&Vr(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function Lt(a,i,t){return i=Ha(i),i in a?Object.defineProperty(a,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[i]=t,a}function xt(a,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(i&&i.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),i&&ws(a,i)}function Cn(a){return Cn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Cn(a)}function ws(a,i){return ws=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},ws(a,i)}function Io(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Je(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _o(a,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Je(a)}function Mt(a){var i=Io();return function(){var n=Cn(a),e;if(i){var s=Cn(this).constructor;e=Reflect.construct(n,arguments,s)}else e=n.apply(this,arguments);return _o(this,e)}}function Po(a,i){if(typeof a!="object"||a===null)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var n=t.call(a,i||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(a)}function Ha(a){var i=Po(a,"string");return typeof i=="symbol"?i:String(i)}var Ko=function(){function a(i,t){yt(this,a),this.url=i;var n=new window.XMLHttpRequest;n.target=this,n.responseType="arraybuffer",n.open("get",i),n.onload=function(){(n.status===200||n.status===206)&&t&&t instanceof Function&&t(n.response)},n.onerror=function(e){},this.xhr=n,this.run()}return bt(a,[{key:"cancel",value:function(){this.xhr.abort()}},{key:"run",value:function(){this.xhr.readyState===1&&this.xhr.send()}}]),a}(),Ae={ORDER:"order",SLOOP:"sloop",LOOP:"loop",RANDOM:"random"},xr="xgplayer-music";function vn(a,i,t){var n=Math.floor(Math.random()*(i-a)+a);return n===t?(n>i/2?i=i/2:a=i/2,i-a>2?vn(a,i,t):n):n}var Ho=function(a){xt(t,a);var i=Mt(t);function t(){var n;yt(this,t);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=i.call.apply(i,[this].concat(s)),Lt(Je(n),"_onEnded",function(){if(n.mode==="order"&&n.index+1>=n.list.length){n.player.pause(),n.player.currentTime=0;return}switch(n.mode){case Ae.SLOOP:n.change();break;case Ae.ORDER:case Ae.LOOP:default:n.next();break}}),Lt(Je(n),"_onDurationChange",function(){var l=n.config.abCycle;n._initABCycle(l,n.player)}),Lt(Je(n),"_onTimeUpdate",function(){var l=Je(n),o=l.config,u=l.player;if(!n.halfPass&&u.currentTime>u.duration/2&&n.confirmOrder(),o.abCycle){var c=o.abCycle,p=c.end>u.duration?u.duration:c.end;u.currentTime>=p?(c.loop||(u.pause(),n.emit("abCycle_ended")),u.currentTime=c.start||0):u.currentTime<c.start&&(u.currentTime=c.start||0)}}),n}return bt(t,[{key:"afterCreate",value:function(){var e=this.player,s=this.playerConfig;jt.addClass(e.root,xr),this.halfPass=!1,this.list=this.config.list||[],this.nextIndex=-1,this.prevIndex=-1,this.history=[],this.disable=!(this.list.length>0),this.list.length!==0&&(!s.url&&this.list.length>0&&(s.url=this.list[0].src),s.poster||(s.poster=this.list[0].poster),s.title||(s.title=this.list[0].title||""),s.vid||(s.vid=this.list[0].vid||""),this._curInfo={src:s.url,poster:s.poster,title:s.title,vid:s.vid},this.index=0,this.on(za,this._onTimeUpdate),this.on(Oa,this._onEnded),this.on(Ja,this._onDurationChange),this.config.offline&&this.checkOffline(this._curInfo.src,this._curInfo.vid).then(function(r){r.code===0&&(s.url=r.url,e.state>=4&&(e.src=r.url))}).catch(function(r){}))}},{key:"destroy",value:function(){jt.removeClass(this.player.root,xr)}},{key:"_nextCompute",value:function(){if(!this.disable)switch(this.mode){case Ae.SLOOP:case Ae.ORDER:case Ae.LOOP:this.index+1<this.list.length?this.nextIndex=this.index+1:this.nextIndex=0;break;default:this.nextIndex=vn(0,this.list.length,this.index);break}}},{key:"_prevCompute",value:function(){if(!this.disable)switch(this.mode){case Ae.SLOOP:case Ae.ORDER:case Ae.LOOP:this.index-1>=0?this.prevIndex=this.index-1:this.prevIndex=this.list.length-1;break;default:this.prevIndex=vn(0,this.list.length,this.index);break}}},{key:"_emitChange",value:function(){this.emit("change",this._curInfo)}},{key:"_initABCycle",value:function(e,s){var r=s.plugins.progresspreview;if(e&&s){var l=e.end>this.player.duration?this.player.duration:e.end,o=e.start>this.player.duration?0:e.start,u={id:s.playerId,time:e.start,duration:l-o,text:e.text,color:e.color};r.findDot(u.id)?r.updateDot(u):r.createDot(u)}else r.findDot(s.playerId)&&r.deleteDot(s.playerId)}},{key:"random",value:function(){if(this.list.length<0)return null;var e=vn(0,this.list.length,this.index);return this.list[e]}},{key:"next",value:function(){this.disable||(this.halfPass||(this.halfPass=!0,this._nextCompute()),this.index=this.nextIndex,this.change())}},{key:"prev",value:function(){this.disable||(this.halfPass||(this.halfPass=!0,this._prevCompute()),this.index=this.prevIndex,this.change())}},{key:"forward",value:function(){var e=this.player,s=this.config.timeScale;e.currentTime=e.currentTime+s<e.duration?e.currentTime+s:e.duration-.1}},{key:"backward",value:function(){var e=this.player,s=this.config.timeScale;e.currentTime=e.currentTime-s>0?e.currentTime-s:0}},{key:"add",value:function(e){this.list.push({src:e.src,title:e.title,vid:e.vid,poster:e.poster})}},{key:"remove",value:function(e){var s=-1;this.list.every(function(r,l){return r.vid===e?(s=l,!1):!0}),s>-1&&this.list.splice(s,1)}},{key:"setAbCycle",value:function(e,s,r){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e&&jt.typeof(e)==="Object"?this.config.abCycle=Wn({},e):this.config.abCycle=Wn({start:e||0,end:s||this.player.duration,loop:r},l),this._initABCycle(this.config.abCycle,this.player)}},{key:"removeAbCycle",value:function(){this.config.abCycle=null,this._initABCycle(null,this.player)}},{key:"updateList",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.removeAbCycle(),this.player.pause(),this.player.currentTime=0,this.list=e,this.nextIndex=0,this.index=0,this.change()}},{key:"setIndex",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e<0||e>=this.list.length||(this.nextIndex=e,this.index=e,this.change())}},{key:"change",value:function(){var e=this;if(!this.disable){var s=this.player,r=this.list,l=this.index,o=r[l].vid;this.halfPass=!1,this.checkOffline(r[l].src,o).then(function(u){e._curInfo={title:e.list[e.index].title||"",vid:e.list[e.index].vid,poster:e.list[e.index].poster||"",src:u.url},s.playNext({url:u.url,vid:e.list[e.index].vid||0,poster:e.list[e.index].poster||"",autoplay:!0}),s.off("timeupdate",e._emitChange),s.once("timeupdate",e._emitChange),s.play()})}}},{key:"checkOffline",value:function(e,s){var r=this;return new Promise(function(l,o){(!r.config.offline||r.disable)&&l({url:e,code:-1,vid:s});var u=r.player.database;u.openDB(function(){u.getDataByKey(u.myDB.ojstore.name,s,function(c){setTimeout(function(){u.closeDB()},5e3),l(c?{url:URL.createObjectURL(c.blob),code:0,vid:c.vid}:{url:e,code:-2,vid:s})})})})}},{key:"confirmOrder",value:function(){this.halfPass=!0,this._nextCompute(),this._prevCompute(),this.config.preloadNext&&this.preload(this.nextIndex)}},{key:"preload",value:function(e){if(!(e<0||e>=this.list.length)){var s=this.list[e],r=this.player;this.checkOffline(s.src,s.vid).then(function(l){if(l.code===-2){var o=s.vid;new Ko(s.src,function(u){r.database.openDB(function(){r.database.addData(r.database.myDB.ojstore.name,[{vid:o,blob:new Blob([u],{type:'audio/mp4; codecs="mp4a.40.5"'})}]),setTimeout(function(){r.database.closeDB()},5e3)})})}})}}},{key:"timeScale",get:function(){return this.config.timeScale||15},set:function(e){this.config.timeScale=e}},{key:"mode",get:function(){return this.config.mode||Ae.RANDOM},set:function(e){this.config.mode=e}}],[{key:"pluginName",get:function(){return"music"}},{key:"defaultConfig",get:function(){return{offline:!1,preloadNext:!0,abCycle:null,timeScale:15,mode:Ae.ORDER,list:[]}}},{key:"ModeType",get:function(){return Object.keys(Ae).map(function(e){return Ae[e]})}}]),t}(kt),No=function(a){xt(t,a);var i=Mt(t);function t(){return yt(this,t),i.apply(this,arguments)}return bt(t,[{key:"afterCreate",value:function(){var e=this;if(this.on("change",function(r){if(r&&r.poster){if(e.find("img"))e.find("img").src=r.poster;else{var l=new Image;l.src=r.poster,e.appendChild(l)}e.find("img").src=r.poster,e.show()}else e.hide()}),this.playerConfig.poster){var s=new Image;s.src=this.playerConfig.poster,this.appendChild(s)}}},{key:"render",value:function(){return'<xg-icon class="xgplayer-cover"></xg-icon>'}}],[{key:"pluginName",get:function(){return"musiccover"}},{key:"defaultConfig",get:function(){return{index:6,position:nt.POSITIONS.CONTROLS_LEFT}}}]),t}(nt),Ao=function(a){xt(t,a);var i=Mt(t);function t(){var n;yt(this,t);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=i.call.apply(i,[this].concat(s)),Lt(Je(n),"onClick",function(l){var o=Je(n),u=o.player;l.preventDefault(),l.stopPropagation(),u.plugins.music.backward()}),n}return bt(t,[{key:"afterCreate",value:function(){var e=this;this.initIcons();var s=["click","touchstart"];s.forEach(function(r){e.bind(r,e.onClick)})}},{key:"registerIcons",value:function(){return{musicBackward:{icon:`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-2 0 21 15">
      <path d="m 14,2.99996 0,10 -7,-5 7,-5 z m -7,5 0,5 -7,-5 7,-5 0,5 z m -7,0 0,0 z"></path>
  </svg>`,class:"xg-icon-mbackward"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.musicBackward)}},{key:"destroy",value:function(){var e=this,s=["click","touchstart"];s.forEach(function(r){e.unbind(r,e.onClick)})}},{key:"render",value:function(){return`<xg-icon class="xgplayer-backward">
            <div class="xgplayer-icon">
            </div>
          </xg-icon>`}}],[{key:"pluginName",get:function(){return"musicbackword"}},{key:"defaultConfig",get:function(){return{index:1,position:nt.POSITIONS.CONTROLS_LEFT}}}]),t}(nt),Uo=function(a){xt(t,a);var i=Mt(t);function t(){var n;yt(this,t);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=i.call.apply(i,[this].concat(s)),Lt(Je(n),"onClick",function(l){var o=Je(n),u=o.player;l.preventDefault(),l.stopPropagation(),u.plugins.music.prev()}),n}return bt(t,[{key:"afterCreate",value:function(){var e=this;this.initIcons();var s=["click","touchstart"];s.forEach(function(r){e.bind(r,e.onClick)})}},{key:"registerIcons",value:function(){return{musicPrev:{icon:` <svg xmlns="http://www.w3.org/2000/svg" width="40" height="32" viewBox="300 200 1024 1024">
        <path d="M600 1140v-768h128v352l320-320v704l-320-320v352zz"></path>
    </svg>`,class:"xg-icon-mprev"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.musicPrev)}},{key:"destroy",value:function(){var e=this,s=["click","touchstart"];s.forEach(function(r){e.unbind(r,e.onClick)})}},{key:"render",value:function(){return`<xg-icon class="xgplayer-next">
            <div class="xgplayer-icon">
            </div>
          </xg-icon>`}}],[{key:"pluginName",get:function(){return"musicprev"}},{key:"defaultConfig",get:function(){return{index:2,position:nt.POSITIONS.CONTROLS_LEFT}}}]),t}(nt),zo=function(a){xt(t,a);var i=Mt(t);function t(){var n;yt(this,t);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=i.call.apply(i,[this].concat(s)),Lt(Je(n),"onClick",function(l){var o=Je(n),u=o.player;l.preventDefault(),l.stopPropagation(),u.plugins.music.forward()}),n}return bt(t,[{key:"afterCreate",value:function(){var e=this;this.initIcons();var s=["click","touchstart"];s.forEach(function(r){e.bind(r,e.onClick)})}},{key:"registerIcons",value:function(){return{musicForward:{icon:`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-2 0 21 15">
        <path d="m 2,2.99996 0,10 7,-5 -7,-5 z m 7,5 0,5 7,-5 -7,-5 0,5 z m 7,0 0,0 z"></path>
      </svg>`,class:"xg-icon-mforward"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.musicForward)}},{key:"destroy",value:function(){var e=this,s=["click","touchstart"];s.forEach(function(r){e.unbind(r,e.onClick)})}},{key:"render",value:function(){return`<xg-icon class="xgplayer-forward">
            <div class="xgplayer-icon">
            </div>
          </xg-icon>`}}],[{key:"pluginName",get:function(){return"musicforward"}},{key:"defaultConfig",get:function(){return{index:5,position:nt.POSITIONS.CONTROLS_LEFT}}}]),t}(nt),Oo=function(a){xt(t,a);var i=Mt(t);function t(){var n;yt(this,t);for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=i.call.apply(i,[this].concat(s)),Lt(Je(n),"onClick",function(l){var o=Je(n),u=o.player;l.preventDefault(),l.stopPropagation(),u.plugins.music.next()}),n}return bt(t,[{key:"afterCreate",value:function(){var e=this;this.initIcons();var s=["click","touchstart"];s.forEach(function(r){e.bind(r,e.onClick)})}},{key:"registerIcons",value:function(){return{musicNext:{icon:` <svg xmlns="http://www.w3.org/2000/svg" width="40" height="32" viewBox="100 200 1024 1024">
        <path d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z">
      </svg>`,class:"xg-icon-mnext"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.musicNext)}},{key:"destroy",value:function(){var e=this,s=["click","touchstart"];s.forEach(function(r){e.unbind(r,e.onClick)})}},{key:"render",value:function(){return`<xg-icon class="xgplayer-next">
            <div class="xgplayer-icon">
            </div>
          </xg-icon>`}}],[{key:"pluginName",get:function(){return"musicnext"}},{key:"defaultConfig",get:function(){return{index:4,position:nt.POSITIONS.CONTROLS_LEFT}}}]),t}(nt),Jo=function(a){xt(t,a);var i=Mt(t);function t(){return yt(this,t),i.apply(this,arguments)}return bt(t,[{key:"beforeCreate",value:function(e){var s=e.player.plugins.progress;s&&(e.root=s.root)}},{key:"afterCreate",value:function(){var e=this;this.on("change",function(s){s&&s.title?e.root.innerHTML="".concat(s.title):e.root.innerHTML=""})}},{key:"render",value:function(){var e=this.playerConfig;return`<xg-title class="xgplayer-name">
          `.concat(e.title||"",`
       </xg-title>`)}}],[{key:"pluginName",get:function(){return"musicmeta"}},{key:"defaultConfig",get:function(){return{index:0}}}]),t}(nt);function Bo(a){if(jt.typeOf(a.controls)!=="Object")a.controls={mode:"flex",initShow:!0};else{var i=a.controls;a.controls=Wn({mode:"flex",initShow:!0},i)}var t=a.play||{};a.play=Wn({index:3},t),a.marginControls=!0,a.mediaType="audio"}var es=bt(function a(i,t){yt(this,a),console.log("config",i,t),console.log("playerConfig",jt.typeOf(t.controls)!=="Object"),Bo(t),this.plugins=[Ho,Ao,Uo,zo,Oo,No,Jo],this.ignores=["start","cssFullScreen","fullscreen","pip","enter","replay","pc","loading","poster"]});const Ys=a=>(qa("data-v-75b6b10b"),a=a(),$a(),a),jo=Ys(()=>Xt("div",{id:"canvas"},[Xt("canvas",{width:"550",height:"110"})],-1)),Qo=Ys(()=>Xt("div",{id:"mask"},[Xt("div",{id:"gc"})],-1)),qo=Ys(()=>Xt("div",{id:"xgmusic"},"play",-1)),$o={__name:"xgMusicPlay",setup(a){let i=rs();Hr(()=>{i.value=new ts({id:"xgmusic",url:"https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/xgplayer_doc_video/music/audio.mp3",volume:.8,width:window.innerWidth,height:50,mediaType:"audio",presets:["default",es],ignores:["playbackrate"],controls:{initShow:!0,mode:"flex"},marginControls:!0,videoConfig:{crossOrigin:"anonymous"}}),i.value.crossOrigin="anonymous";let e=`[00:00.00] 脆弱一分钟
[00:00.00] 作曲 : 林家谦
[00:00.00] 作词 : 徐世珍/吴辉福
[00:00.000]编曲：林家谦
[00:00.000]时钟不要走
[00:04.220]让我脆弱一分钟
[00:07.440]要多久才能习惯被放手
[00:15.800]马克杯空了 暖暖的温热
[00:22.660]却还在我手中停留
[00:27.960]
[00:29.790]勇气不要走
[00:32.200]给我理由再冲动
[00:35.690]去相信爱情 就算还在痛
[00:43.960]如果我不说不会有人懂
[00:50.720]失去你我有多寂寞
[00:55.610]还是愿意
[00:57.580]付出一切仅仅为了一个好梦
[01:03.980]梦里有人真心爱我 陪我快乐也陪我沉默
[01:11.260]没有无缘无故的痛承受越多越成熟
[01:18.630]能让你拥抱更好的我
[01:25.030] 谁也不要走
[01:28.270]应该是一种奢求
[01:31.900]可是我只想 握紧你的手
[01:39.780]我宁愿等候 也不愿错过
[01:46.630]你对我微笑的时候
[01:56.780]
[02:18.910]还是愿意
[02:21.320]用尽全力仅仅为了一个以后
[02:27.870]哪怕生命并不温柔哪怕被幸福一再反驳
[02:34.870]也要相信伤痕累累 其实只是在琢磨
[02:42.070]能让你为之一亮 的我
[02:53.910]
[02:56.350]制作人：林宥嘉
[02:57.750]制作助理：张婕汝
[02:59.010]录音师：陈文骏、叶育轩
[03:00.410]录音室：白金录音室
[03:01.740]混音师：SimonLi @ nOiz
[03:03.000]OP: Terence Lam Production & Co. (Warner/Chappell Music, HK Ltd.)
[03:04.050]SP: Warner/Chappell Music Taiwan Ltd.
[03:04.910]OP：Universal Ms Publ Ltd Taiwan
`;new es.Analyze(i.value,document.querySelector("canvas"),{bgColor:"rgba(0,0,0,0.7)",stroke:3});var s=new es.Lyric([e],document.querySelector("#gc"),{});s.bind(i.value),i.value.on("lyricUpdate",r=>{console.log(r),r.lyric}),i.value.on("lyricUpdate",r=>{console.log(r),r.lyric}),i.value.on("playing",function(){s.show(),s.adjust(),i.value.mode=2}),i.value.on("pause",function(){s.hide()}),i.value.on("destroy",()=>{s.unbind(i.value)}),document.getElementById("canvas").width=window.innerWidth,document.getElementById("canvas").height=window.innerHeight*.25});const t=rs(),n=[{value:"waves",label:"waves"},{value:"bars",label:"bars"},{value:"lightning",label:"lightning"},{value:"vertLines",label:"vertLines"},{value:"doubleLine",label:"doubleLine"},{value:"doubleBars",label:"doubleBars"}];return(e,s)=>(_t(),as(Ze(Kr),null,{default:ke(()=>[Se(Ze(Er),{"label-width":"100px"},{default:ke(()=>[Se(Ze(Ir),null,{default:ke(()=>[Se(Ze(ns),{span:11,offset:0},{default:ke(()=>[Se(Ze(ss),{label:"选择样式"},{default:ke(()=>[Se(Ze(_r),{modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"m-2",placeholder:"Select"},{default:ke(()=>[(_t(),Gs(Nr,null,Ar(n,r=>Se(Ze(Pr),{key:r.value,label:r.label,value:r.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),jo,Qo,qo]),_:1}))}},eu=Qa($o,[["__scopeId","data-v-75b6b10b"]]),tu=Xt("h2",{id:"西瓜视频播放器测试用例",tabindex:"-1"},[ti("西瓜视频播放器测试用例 "),Xt("a",{class:"header-anchor",href:"#西瓜视频播放器测试用例","aria-label":'Permalink to "西瓜视频播放器测试用例"'},"​")],-1),nu=ni("",4),Zu=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"pages/ComponentsExample/xgVideoPlay.md","filePath":"pages/ComponentsExample/xgVideoPlay.md","lastUpdated":1695744503000}'),su={name:"pages/ComponentsExample/xgVideoPlay.md"},Su=Object.assign(su,{setup(a){return(i,t)=>{const n=ei("client-only");return _t(),Gs("div",null,[tu,Se(n,null,{default:ke(()=>[Se(Eo),Se(eu)]),_:1}),nu])}}});export{Zu as __pageData,Su as default};
