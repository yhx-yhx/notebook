import{p as le,i as W,r as ie}from"./get.c64e1ee4.js";import{a as $,b as ce}from"./index.ab09b7d4.js";import{d as O,V as ue,h as v,g as x,ab as fe,q as K,o as L,b as D,w as ae,af as me,k as X,n as M,l as b,W as j,ag as de,T as ve,c as ne,N as U,K as pe,z as V,E as q,$ as he,aq as ge,j as ye,I as be,r as we,S as Se,e as Ee,aa as Te}from"./framework.5e255872.js";import{b as Y,_ as F,u as re,d as ze,w as ke}from"./plugin-vue_export-helper.b1fcb036.js";import{t as _e}from"./error.78e43d3e.js";import{b as se,i as B,l as xe}from"./types.d10ab546.js";import{q as G}from"./index.c33c0a6b.js";var He=/\s/;function Ce(e){for(var a=e.length;a--&&He.test(e.charAt(a)););return a}var Ne=/^\s+/;function Re(e){return e&&e.slice(0,Ce(e)+1).replace(Ne,"")}var J=0/0,Be=/^[-+]0x[0-9a-f]+$/i,Le=/^0b[01]+$/i,Me=/^0o[0-7]+$/i,Pe=parseInt;function Q(e){if(typeof e=="number")return e;if(le(e))return J;if(W(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=W(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=Re(e);var r=Le.test(e);return r||Me.test(e)?Pe(e.slice(2),r?2:8):Be.test(e)?J:+e}var Ie=function(){return ie.Date.now()};const A=Ie;var Oe="Expected a function",Ae=Math.max,We=Math.min;function lt(e,a,r){var s,c,f,i,u,o,d=0,p=!1,l=!1,h=!0;if(typeof e!="function")throw new TypeError(Oe);a=Q(a)||0,W(r)&&(p=!!r.leading,l="maxWait"in r,f=l?Ae(Q(r.maxWait)||0,a):f,h="trailing"in r?!!r.trailing:h);function g(n){var t=s,m=c;return s=c=void 0,d=n,i=e.apply(m,t),i}function w(n){return d=n,u=setTimeout(S,a),p?g(n):i}function H(n){var t=n-o,m=n-d,y=a-t;return l?We(y,f-m):y}function k(n){var t=n-o,m=n-d;return o===void 0||t>=a||t<0||l&&m>=f}function S(){var n=A();if(k(n))return E(n);u=setTimeout(S,H(n))}function E(n){return u=void 0,h&&s?g(n):(s=c=void 0,i)}function C(){u!==void 0&&clearTimeout(u),d=0,s=o=c=u=void 0}function N(){return u===void 0?i:E(A())}function T(){var n=A(),t=k(n);if(s=arguments,c=this,o=n,t){if(u===void 0)return w(o);if(l)return clearTimeout(u),u=setTimeout(S,a),g(o)}return u===void 0&&(u=setTimeout(S,a)),i}return T.cancel=C,T.flush=N,T}const _=4,$e={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},De=({move:e,size:a,bar:r})=>({[r.size]:a,transform:`translate${r.axis}(${e}%)`}),oe=Symbol("scrollbarContextKey"),Xe=Y({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),je="Thumb",Ye=O({__name:"thumb",props:Xe,setup(e){const a=e,r=ue(oe),s=re("scrollbar");r||_e(je,"can not inject scrollbar context");const c=v(),f=v(),i=v({}),u=v(!1);let o=!1,d=!1,p=se?document.onselectstart:null;const l=x(()=>$e[a.vertical?"vertical":"horizontal"]),h=x(()=>De({size:a.size,move:a.move,bar:l.value})),g=x(()=>c.value[l.value.offset]**2/r.wrapElement[l.value.scrollSize]/a.ratio/f.value[l.value.offset]),w=n=>{var t;if(n.stopPropagation(),n.ctrlKey||[1,2].includes(n.button))return;(t=window.getSelection())==null||t.removeAllRanges(),k(n);const m=n.currentTarget;m&&(i.value[l.value.axis]=m[l.value.offset]-(n[l.value.client]-m.getBoundingClientRect()[l.value.direction]))},H=n=>{if(!f.value||!c.value||!r.wrapElement)return;const t=Math.abs(n.target.getBoundingClientRect()[l.value.direction]-n[l.value.client]),m=f.value[l.value.offset]/2,y=(t-m)*100*g.value/c.value[l.value.offset];r.wrapElement[l.value.scroll]=y*r.wrapElement[l.value.scrollSize]/100},k=n=>{n.stopImmediatePropagation(),o=!0,document.addEventListener("mousemove",S),document.addEventListener("mouseup",E),p=document.onselectstart,document.onselectstart=()=>!1},S=n=>{if(!c.value||!f.value||o===!1)return;const t=i.value[l.value.axis];if(!t)return;const m=(c.value.getBoundingClientRect()[l.value.direction]-n[l.value.client])*-1,y=f.value[l.value.offset]-t,R=(m-y)*100*g.value/c.value[l.value.offset];r.wrapElement[l.value.scroll]=R*r.wrapElement[l.value.scrollSize]/100},E=()=>{o=!1,i.value[l.value.axis]=0,document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",E),T(),d&&(u.value=!1)},C=()=>{d=!1,u.value=!!a.size},N=()=>{d=!0,u.value=o};fe(()=>{T(),document.removeEventListener("mouseup",E)});const T=()=>{document.onselectstart!==p&&(document.onselectstart=p)};return $(K(r,"scrollbarElement"),"mousemove",C),$(K(r,"scrollbarElement"),"mouseleave",N),(n,t)=>(L(),D(ve,{name:b(s).b("fade"),persisted:""},{default:ae(()=>[me(X("div",{ref_key:"instance",ref:c,class:M([b(s).e("bar"),b(s).is(b(l).key)]),onMousedown:H},[X("div",{ref_key:"thumb",ref:f,class:M(b(s).e("thumb")),style:j(b(h)),onMousedown:w},null,38)],34),[[de,n.always||u.value]])]),_:1},8,["name"]))}});var Z=F(Ye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const Fe=Y({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),Ke=O({__name:"bar",props:Fe,setup(e,{expose:a}){const r=e,s=v(0),c=v(0);return a({handleScroll:i=>{if(i){const u=i.offsetHeight-_,o=i.offsetWidth-_;c.value=i.scrollTop*100/u*r.ratioY,s.value=i.scrollLeft*100/o*r.ratioX}}}),(i,u)=>(L(),ne(pe,null,[U(Z,{move:s.value,ratio:i.ratioX,size:i.width,always:i.always},null,8,["move","ratio","size","always"]),U(Z,{move:c.value,ratio:i.ratioY,size:i.height,vertical:"",always:i.always},null,8,["move","ratio","size","always"])],64))}});var Ue=F(Ke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const Ve=Y({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:ze([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20}}),qe={scroll:({scrollTop:e,scrollLeft:a})=>[e,a].every(B)},Ge="ElScrollbar",Je=O({name:Ge}),Qe=O({...Je,props:Ve,emits:qe,setup(e,{expose:a,emit:r}){const s=e,c=re("scrollbar");let f,i;const u=v(),o=v(),d=v(),p=v("0"),l=v("0"),h=v(),g=v(1),w=v(1),H=x(()=>{const t={};return s.height&&(t.height=G(s.height)),s.maxHeight&&(t.maxHeight=G(s.maxHeight)),[s.wrapStyle,t]}),k=x(()=>[s.wrapClass,c.e("wrap"),{[c.em("wrap","hidden-default")]:!s.native}]),S=x(()=>[c.e("view"),s.viewClass]),E=()=>{var t;o.value&&((t=h.value)==null||t.handleScroll(o.value),r("scroll",{scrollTop:o.value.scrollTop,scrollLeft:o.value.scrollLeft}))};function C(t,m){Te(t)?o.value.scrollTo(t):B(t)&&B(m)&&o.value.scrollTo(t,m)}const N=t=>{B(t)&&(o.value.scrollTop=t)},T=t=>{B(t)&&(o.value.scrollLeft=t)},n=()=>{if(!o.value)return;const t=o.value.offsetHeight-_,m=o.value.offsetWidth-_,y=t**2/o.value.scrollHeight,R=m**2/o.value.scrollWidth,P=Math.max(y,s.minSize),I=Math.max(R,s.minSize);g.value=y/(t-y)/(P/(t-P)),w.value=R/(m-R)/(I/(m-I)),l.value=P+_<t?`${P}px`:"",p.value=I+_<m?`${I}px`:""};return V(()=>s.noresize,t=>{t?(f==null||f(),i==null||i()):({stop:f}=ce(d,n),i=$("resize",n))},{immediate:!0}),V(()=>[s.maxHeight,s.height],()=>{s.native||q(()=>{var t;n(),o.value&&((t=h.value)==null||t.handleScroll(o.value))})}),he(oe,ge({scrollbarElement:u,wrapElement:o})),ye(()=>{s.native||q(()=>{n()})}),be(()=>n()),a({wrapRef:o,update:n,scrollTo:C,setScrollTop:N,setScrollLeft:T,handleScroll:E}),(t,m)=>(L(),ne("div",{ref_key:"scrollbarRef",ref:u,class:M(b(c).b())},[X("div",{ref_key:"wrapRef",ref:o,class:M(b(k)),style:j(b(H)),onScroll:E},[(L(),D(Se(t.tag),{ref_key:"resizeRef",ref:d,class:M(b(S)),style:j(t.viewStyle)},{default:ae(()=>[we(t.$slots,"default")]),_:3},8,["class","style"]))],38),t.native?Ee("v-if",!0):(L(),D(Ue,{key:0,ref_key:"barRef",ref:h,height:l.value,width:p.value,always:t.always,"ratio-x":w.value,"ratio-y":g.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}});var Ze=F(Qe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const it=ke(Ze),z=new Map;let ee;se&&(document.addEventListener("mousedown",e=>ee=e),document.addEventListener("mouseup",e=>{for(const a of z.values())for(const{documentHandler:r}of a)r(e,ee)}));function te(e,a){let r=[];return Array.isArray(a.arg)?r=a.arg:xe(a.arg)&&r.push(a.arg),function(s,c){const f=a.instance.popperRef,i=s.target,u=c==null?void 0:c.target,o=!a||!a.instance,d=!i||!u,p=e.contains(i)||e.contains(u),l=e===i,h=r.length&&r.some(w=>w==null?void 0:w.contains(i))||r.length&&r.includes(u),g=f&&(f.contains(i)||f.contains(u));o||d||p||l||h||g||a.value(s,c)}}const ct={beforeMount(e,a){z.has(e)||z.set(e,[]),z.get(e).push({documentHandler:te(e,a),bindingFn:a.value})},updated(e,a){z.has(e)||z.set(e,[]);const r=z.get(e),s=r.findIndex(f=>f.bindingFn===a.oldValue),c={documentHandler:te(e,a),bindingFn:a.value};s>=0?r.splice(s,1,c):r.push(c)},unmounted(e){z.delete(e)}};export{ct as C,it as E,lt as d};
