import{a as D,b as ae}from"./index.ClFtIAma.js";import{d as N,O as oe,h as m,k as _,aD as le,ap as U,o as T,b as W,w as Q,aj as re,m as $,n as C,p as d,Q as X,aG as ne,T as ie,c as Z,J as F,F as ce,y as K,U as I,$ as ue,ao as fe,l as ve,C as me,r as de,L as pe,e as he,aq as ye}from"./framework.Cyz3vTHn.js";import{b as Y,_ as j,u as ee,d as be,w as ge}from"./plugin-vue_export-helper.Fsmj3gze.js";import{t as we}from"./event.BE20p1dL.js";import{b as te,i as H,l as Se}from"./types.DTMeA5EJ.js";import{q as V}from"./index.4hICx8yr.js";const E=4,ze={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},Ee=({move:a,size:t,bar:s})=>({[s.size]:t,transform:`translate${s.axis}(${a}%)`}),se=Symbol("scrollbarContextKey"),_e=Y({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),ke="Thumb",He=N({__name:"thumb",props:_e,setup(a){const t=a,s=oe(se),o=ee("scrollbar");s||we(ke,"can not inject scrollbar context");const i=m(),u=m(),n=m({}),v=m(!1);let r=!1,p=!1,h=te?document.onselectstart:null;const l=_(()=>ze[t.vertical?"vertical":"horizontal"]),b=_(()=>Ee({size:t.size,move:t.move,bar:l.value})),g=_(()=>i.value[l.value.offset]**2/s.wrapElement[l.value.scrollSize]/t.ratio/u.value[l.value.offset]),w=c=>{var e;if(c.stopPropagation(),c.ctrlKey||[1,2].includes(c.button))return;(e=window.getSelection())==null||e.removeAllRanges(),M(c);const f=c.currentTarget;f&&(n.value[l.value.axis]=f[l.value.offset]-(c[l.value.client]-f.getBoundingClientRect()[l.value.direction]))},P=c=>{if(!u.value||!i.value||!s.wrapElement)return;const e=Math.abs(c.target.getBoundingClientRect()[l.value.direction]-c[l.value.client]),f=u.value[l.value.offset]/2,S=(e-f)*100*g.value/i.value[l.value.offset];s.wrapElement[l.value.scroll]=S*s.wrapElement[l.value.scrollSize]/100},M=c=>{c.stopImmediatePropagation(),r=!0,document.addEventListener("mousemove",x),document.addEventListener("mouseup",z),h=document.onselectstart,document.onselectstart=()=>!1},x=c=>{if(!i.value||!u.value||r===!1)return;const e=n.value[l.value.axis];if(!e)return;const f=(i.value.getBoundingClientRect()[l.value.direction]-c[l.value.client])*-1,S=u.value[l.value.offset]-e,k=(f-S)*100*g.value/i.value[l.value.offset];s.wrapElement[l.value.scroll]=k*s.wrapElement[l.value.scrollSize]/100},z=()=>{r=!1,n.value[l.value.axis]=0,document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",z),R(),p&&(v.value=!1)},O=()=>{p=!1,v.value=!!t.size},A=()=>{p=!0,v.value=r};le(()=>{R(),document.removeEventListener("mouseup",z)});const R=()=>{document.onselectstart!==h&&(document.onselectstart=h)};return D(U(s,"scrollbarElement"),"mousemove",O),D(U(s,"scrollbarElement"),"mouseleave",A),(c,e)=>(T(),W(ie,{name:d(o).b("fade"),persisted:""},{default:Q(()=>[re($("div",{ref_key:"instance",ref:i,class:C([d(o).e("bar"),d(o).is(d(l).key)]),onMousedown:P},[$("div",{ref_key:"thumb",ref:u,class:C(d(o).e("thumb")),style:X(d(b)),onMousedown:w},null,38)],34),[[ne,c.always||v.value]])]),_:1},8,["name"]))}});var q=j(He,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const Te=Y({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),Ce=N({__name:"bar",props:Te,setup(a,{expose:t}){const s=a,o=m(0),i=m(0);return t({handleScroll:n=>{if(n){const v=n.offsetHeight-E,r=n.offsetWidth-E;i.value=n.scrollTop*100/v*s.ratioY,o.value=n.scrollLeft*100/r*s.ratioX}}}),(n,v)=>(T(),Z(ce,null,[F(q,{move:o.value,ratio:n.ratioX,size:n.width,always:n.always},null,8,["move","ratio","size","always"]),F(q,{move:i.value,ratio:n.ratioY,size:n.height,vertical:"",always:n.always},null,8,["move","ratio","size","always"])],64))}});var xe=j(Ce,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const Re=Y({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:be([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20}}),Be={scroll:({scrollTop:a,scrollLeft:t})=>[a,t].every(H)},Le="ElScrollbar",Ne=N({name:Le}),Pe=N({...Ne,props:Re,emits:Be,setup(a,{expose:t,emit:s}){const o=a,i=ee("scrollbar");let u,n;const v=m(),r=m(),p=m(),h=m("0"),l=m("0"),b=m(),g=m(1),w=m(1),P=_(()=>{const e={};return o.height&&(e.height=V(o.height)),o.maxHeight&&(e.maxHeight=V(o.maxHeight)),[o.wrapStyle,e]}),M=_(()=>[o.wrapClass,i.e("wrap"),{[i.em("wrap","hidden-default")]:!o.native}]),x=_(()=>[i.e("view"),o.viewClass]),z=()=>{var e;r.value&&((e=b.value)==null||e.handleScroll(r.value),s("scroll",{scrollTop:r.value.scrollTop,scrollLeft:r.value.scrollLeft}))};function O(e,f){ye(e)?r.value.scrollTo(e):H(e)&&H(f)&&r.value.scrollTo(e,f)}const A=e=>{H(e)&&(r.value.scrollTop=e)},R=e=>{H(e)&&(r.value.scrollLeft=e)},c=()=>{if(!r.value)return;const e=r.value.offsetHeight-E,f=r.value.offsetWidth-E,S=e**2/r.value.scrollHeight,k=f**2/r.value.scrollWidth,B=Math.max(S,o.minSize),L=Math.max(k,o.minSize);g.value=S/(e-S)/(B/(e-B)),w.value=k/(f-k)/(L/(f-L)),l.value=B+E<e?`${B}px`:"",h.value=L+E<f?`${L}px`:""};return K(()=>o.noresize,e=>{e?(u==null||u(),n==null||n()):({stop:u}=ae(p,c),n=D("resize",c))},{immediate:!0}),K(()=>[o.maxHeight,o.height],()=>{o.native||I(()=>{var e;c(),r.value&&((e=b.value)==null||e.handleScroll(r.value))})}),ue(se,fe({scrollbarElement:v,wrapElement:r})),ve(()=>{o.native||I(()=>{c()})}),me(()=>c()),t({wrapRef:r,update:c,scrollTo:O,setScrollTop:A,setScrollLeft:R,handleScroll:z}),(e,f)=>(T(),Z("div",{ref_key:"scrollbarRef",ref:v,class:C(d(i).b())},[$("div",{ref_key:"wrapRef",ref:r,class:C(d(M)),style:X(d(P)),onScroll:z},[(T(),W(pe(e.tag),{ref_key:"resizeRef",ref:p,class:C(d(x)),style:X(e.viewStyle)},{default:Q(()=>[de(e.$slots,"default")]),_:3},8,["class","style"]))],38),e.native?he("v-if",!0):(T(),W(xe,{key:0,ref_key:"barRef",ref:b,height:l.value,width:h.value,always:e.always,"ratio-x":w.value,"ratio-y":g.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}});var Me=j(Pe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const Ye=ge(Me),y=new Map;let G;te&&(document.addEventListener("mousedown",a=>G=a),document.addEventListener("mouseup",a=>{for(const t of y.values())for(const{documentHandler:s}of t)s(a,G)}));function J(a,t){let s=[];return Array.isArray(t.arg)?s=t.arg:Se(t.arg)&&s.push(t.arg),function(o,i){const u=t.instance.popperRef,n=o.target,v=i==null?void 0:i.target,r=!t||!t.instance,p=!n||!v,h=a.contains(n)||a.contains(v),l=a===n,b=s.length&&s.some(w=>w==null?void 0:w.contains(n))||s.length&&s.includes(v),g=u&&(u.contains(n)||u.contains(v));r||p||h||l||b||g||t.value(o,i)}}const je={beforeMount(a,t){y.has(a)||y.set(a,[]),y.get(a).push({documentHandler:J(a,t),bindingFn:t.value})},updated(a,t){y.has(a)||y.set(a,[]);const s=y.get(a),o=s.findIndex(u=>u.bindingFn===t.oldValue),i={documentHandler:J(a,t),bindingFn:t.value};o>=0?s.splice(o,1,i):s.push(i)},unmounted(a){y.delete(a)}};export{je as C,Ye as E};
